"use strict";(self.webpackChunkshell=self.webpackChunkshell||[]).push([[130],{152(ce,$,w){w.d($,{B:()=>z});var g=w(3236),q=w(9974),V=w(4360);function z(k,x=g.E){return(0,q.N)((S,T)=>{let s=null,r=null,B=null;const O=()=>{if(s){s.unsubscribe(),s=null;const oe=r;r=null,T.next(oe)}};function te(){const oe=B+k,X=x.now();if(X<oe)return s=this.schedule(void 0,oe-X),void T.add(s);O()}S.subscribe((0,V._)(T,oe=>{r=oe,B=x.now(),s||(s=x.schedule(te,k),T.add(s))},()=>{O(),T.complete()},void 0,()=>{r=s=null}))})}},1584(ce,$,w){w.d($,{O:()=>k});var g=w(1985),q=w(3236),V=w(9470);function k(x=0,S,T=q.b){let s=-1;return null!=S&&((0,V.m)(S)?T=S:s=S),new g.c(r=>{let B=function z(x){return x instanceof Date&&!isNaN(x)}(x)?+x-T.now():x;B<0&&(B=0);let O=0;return T.schedule(function(){r.closed||(r.next(O++),0<=s?this.schedule(void 0,s):r.complete())},B)})}},1655(ce,$,w){w.d($,{c:()=>oe});var g=w(3236),q=w(8793),V=w(6697),z=w(9974),k=w(4360),x=w(5343),T=w(6354),r=w(1397),B=w(8750);function O(X,le){return le?ae=>(0,q.x)(le.pipe((0,V.s)(1),function S(){return(0,z.N)((X,le)=>{X.subscribe((0,k._)(le,x.l))})}()),ae.pipe(O(X))):(0,r.Z)((ae,We)=>(0,B.Tg)(X(ae,We)).pipe((0,V.s)(1),function s(X){return(0,T.T)(()=>X)}(ae)))}var te=w(1584);function oe(X,le=g.E){const ae=(0,te.O)(X,le);return O(()=>ae)}},3236(ce,$,w){w.d($,{E:()=>V,b:()=>z});var g=w(6780);const V=new(w(9687).q)(g.R),z=V},3294(ce,$,w){w.d($,{F:()=>z});var g=w(3669),q=w(9974),V=w(4360);function z(x,S=g.D){return x=x??k,(0,q.N)((T,s)=>{let r,B=!0;T.subscribe((0,V._)(s,O=>{const te=S(O);(B||!x(r,te))&&(B=!1,r=te,s.next(O))}))})}function k(x,S){return x===S}},6780(ce,$,w){w.d($,{R:()=>k});var g=w(8359);class q extends g.yU{constructor(S,T){super()}schedule(S,T=0){return this}}const V={setInterval(x,S,...T){const{delegate:s}=V;return s?.setInterval?s.setInterval(x,S,...T):setInterval(x,S,...T)},clearInterval(x){const{delegate:S}=V;return(S?.clearInterval||clearInterval)(x)},delegate:void 0};var z=w(7908);class k extends q{constructor(S,T){super(S,T),this.scheduler=S,this.work=T,this.pending=!1}schedule(S,T=0){var s;if(this.closed)return this;this.state=S;const r=this.id,B=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(B,r,T)),this.pending=!0,this.delay=T,this.id=null!==(s=this.id)&&void 0!==s?s:this.requestAsyncId(B,this.id,T),this}requestAsyncId(S,T,s=0){return V.setInterval(S.flush.bind(S,this),s)}recycleAsyncId(S,T,s=0){if(null!=s&&this.delay===s&&!1===this.pending)return T;null!=T&&V.clearInterval(T)}execute(S,T){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const s=this._execute(S,T);if(s)return s;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(S,T){let r,s=!1;try{this.work(S)}catch(B){s=!0,r=B||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:S,scheduler:T}=this,{actions:s}=T;this.work=this.state=this.scheduler=null,this.pending=!1,(0,z.o)(s,this),null!=S&&(this.id=this.recycleAsyncId(T,S,null)),this.delay=null,super.unsubscribe()}}}},7006(ce,$,w){w.d($,{M4:()=>nf,ZU:()=>ue});var g=w(467);class S{}function T(n,e){return n.replace(/\{([^}]+)\}/g,(o,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const l=e[i];return null!=l?String(l):""}throw new Error(`Key '${i}' not found in valueMap.`)})}function s(n,e,t){for(let l=0;l<e.length-1;l++){const a=e[l];if(a.endsWith("[]")){const d=a.slice(0,-2);if(!(d in n)){if(!Array.isArray(t))throw new Error(`Value must be a list given an array path ${a}`);n[d]=Array.from({length:t.length},()=>({}))}if(Array.isArray(n[d])){const f=n[d];if(Array.isArray(t))for(let c=0;c<f.length;c++)s(f[c],e.slice(l+1),t[c]);else for(const c of f)s(c,e.slice(l+1),t)}return}if(a.endsWith("[0]")){const d=a.slice(0,-3);return d in n||(n[d]=[{}]),void s(n[d][0],e.slice(l+1),t)}(!n[a]||"object"!=typeof n[a])&&(n[a]={}),n=n[a]}const o=e[e.length-1],i=n[o];if(void 0!==i){if(!t||"object"==typeof t&&0===Object.keys(t).length||t===i)return;if("object"!=typeof i||"object"!=typeof t||null===i||null===t)throw new Error(`Cannot set value for an existing key. Key: ${o}`);Object.assign(i,t)}else"_self"!==o||"object"!=typeof t||null===t||Array.isArray(t)?n[o]=t:Object.assign(n,t)}function r(n,e,t=void 0){try{if(1===e.length&&"_self"===e[0])return n;for(let o=0;o<e.length;o++){if("object"!=typeof n||null===n)return t;const i=e[o];if(i.endsWith("[]")){const l=i.slice(0,-2);if(l in n){const a=n[l];return Array.isArray(a)?a.map(d=>r(d,e.slice(o+1),t)):t}return t}n=n[i]}return n}catch(o){if(o instanceof TypeError)return t;throw o}}function O(n,e,t,o,i){if(o>=e.length||"object"!=typeof n||null===n)return;const l=e[o];if(l.endsWith("[]")){const a=l.slice(0,-2),d=n;if(a in d&&Array.isArray(d[a]))for(const f of d[a])O(f,e,t,o+1,i)}else if("*"===l){if("object"==typeof n&&null!==n&&!Array.isArray(n)){const a=n,d=Object.keys(a).filter(c=>!c.startsWith("_")&&!i.has(c)),f={};for(const c of d)f[c]=a[c];for(const[c,u]of Object.entries(f)){const p=[];for(const h of t.slice(o))p.push("*"===h?c:h);s(a,p,u)}for(const c of d)delete a[c]}}else l in n&&O(n[l],e,t,o+1,i)}function te(n){if("string"!=typeof n)throw new Error("fromImageBytes must be a string");return n}function Mn(n){const e={},t=r(n,["name"]);null!=t&&s(e,["name"],t);const o=r(n,["metadata"]);null!=o&&s(e,["metadata"],o);const i=r(n,["done"]);null!=i&&s(e,["done"],i);const l=r(n,["error"]);null!=l&&s(e,["error"],l);const a=r(n,["response"]);return null!=a&&s(e,["response"],function po(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["parent"]);null!=o&&s(e,["parent"],o);const i=r(n,["documentName"]);return null!=i&&s(e,["documentName"],i),e}(a)),e}var ue=function(n){return n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL",n}(ue||{}),Ke=function(n){return n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO",n}(Ke||{}),Nn=function(n){return n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED",n}(Nn||{}),Ie=function(n){return n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT",n}(Ie||{});class Ye{constructor(e){const t={};for(const o of e.headers.entries())t[o[0]]=o[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class ve{get text(){var e,t,o,i,l,a,d,f;if(0===(null===(i=null===(o=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===o?void 0:o.parts)||void 0===i?void 0:i.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let c="",u=!1;const p=[];for(const h of null!==(f=null===(d=null===(a=null===(l=this.candidates)||void 0===l?void 0:l[0])||void 0===a?void 0:a.content)||void 0===d?void 0:d.parts)&&void 0!==f?f:[]){for(const[m,y]of Object.entries(h))"text"!==m&&"thought"!==m&&"thoughtSignature"!==m&&(null!==y||void 0!==y)&&p.push(m);if("string"==typeof h.text){if("boolean"==typeof h.thought&&h.thought)continue;u=!0,c+=h.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?c:void 0}get data(){var e,t,o,i,l,a,d,f;if(0===(null===(i=null===(o=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===o?void 0:o.parts)||void 0===i?void 0:i.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let c="";const u=[];for(const p of null!==(f=null===(d=null===(a=null===(l=this.candidates)||void 0===l?void 0:l[0])||void 0===a?void 0:a.content)||void 0===d?void 0:d.parts)&&void 0!==f?f:[]){for(const[h,m]of Object.entries(p))"inlineData"!==h&&(null!==m||void 0!==m)&&u.push(h);p.inlineData&&"string"==typeof p.inlineData.data&&(c+=atob(p.inlineData.data))}return u.length>0&&console.warn(`there are non-data parts ${u} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}get functionCalls(){var e,t,o,i,l,a,d,f;if(0===(null===(i=null===(o=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===o?void 0:o.parts)||void 0===i?void 0:i.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const c=null===(f=null===(d=null===(a=null===(l=this.candidates)||void 0===l?void 0:l[0])||void 0===a?void 0:a.content)||void 0===d?void 0:d.parts)||void 0===f?void 0:f.filter(u=>u.functionCall).map(u=>u.functionCall).filter(u=>void 0!==u);return 0!==c?.length?c:void 0}get executableCode(){var e,t,o,i,l,a,d,f,c;if(0===(null===(i=null===(o=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===o?void 0:o.parts)||void 0===i?void 0:i.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const u=null===(f=null===(d=null===(a=null===(l=this.candidates)||void 0===l?void 0:l[0])||void 0===a?void 0:a.content)||void 0===d?void 0:d.parts)||void 0===f?void 0:f.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>void 0!==p);return 0!==u?.length?null===(c=u?.[0])||void 0===c?void 0:c.code:void 0}get codeExecutionResult(){var e,t,o,i,l,a,d,f,c;if(0===(null===(i=null===(o=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===o?void 0:o.parts)||void 0===i?void 0:i.length))return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const u=null===(f=null===(d=null===(a=null===(l=this.candidates)||void 0===l?void 0:l[0])||void 0===a?void 0:a.content)||void 0===d?void 0:d.parts)||void 0===f?void 0:f.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>void 0!==p);return 0!==u?.length?null===(c=u?.[0])||void 0===c?void 0:c.output:void 0}}class Un{}class Ln{}class pi{}class mi{}class hi{}class gi{}class kn{}class Fn{}class Gn{}class yi{}class Pe{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const o=new Pe;let i;const l=e;return i=t?function le(n){const e={},t=r(n,["name"]);null!=t&&s(e,["name"],t);const o=r(n,["metadata"]);null!=o&&s(e,["metadata"],o);const i=r(n,["done"]);null!=i&&s(e,["done"],i);const l=r(n,["error"]);null!=l&&s(e,["error"],l);const a=r(n,["response"]);return null!=a&&s(e,["response"],function We(n){const e={},t=r(n,["videos"]);if(null!=t){let l=t;Array.isArray(l)&&(l=l.map(a=>function lo(n){const e={},t=r(n,["_self"]);return null!=t&&s(e,["video"],function ho(n){const e={},t=r(n,["gcsUri"]);null!=t&&s(e,["uri"],t);const o=r(n,["bytesBase64Encoded"]);null!=o&&s(e,["videoBytes"],te(o));const i=r(n,["mimeType"]);return null!=i&&s(e,["mimeType"],i),e}(t)),e}(a))),s(e,["generatedVideos"],l)}const o=r(n,["raiMediaFilteredCount"]);null!=o&&s(e,["raiMediaFilteredCount"],o);const i=r(n,["raiMediaFilteredReasons"]);return null!=i&&s(e,["raiMediaFilteredReasons"],i),e}(a)),e}(l):function X(n){const e={},t=r(n,["name"]);null!=t&&s(e,["name"],t);const o=r(n,["metadata"]);null!=o&&s(e,["metadata"],o);const i=r(n,["done"]);null!=i&&s(e,["done"],i);const l=r(n,["error"]);null!=l&&s(e,["error"],l);const a=r(n,["response","generateVideoResponse"]);return null!=a&&s(e,["response"],function ae(n){const e={},t=r(n,["generatedSamples"]);if(null!=t){let l=t;Array.isArray(l)&&(l=l.map(a=>function so(n){const e={},t=r(n,["video"]);return null!=t&&s(e,["video"],function mo(n){const e={},t=r(n,["uri"]);null!=t&&s(e,["uri"],t);const o=r(n,["encodedVideo"]);null!=o&&s(e,["videoBytes"],te(o));const i=r(n,["encoding"]);return null!=i&&s(e,["mimeType"],i),e}(t)),e}(a))),s(e,["generatedVideos"],l)}const o=r(n,["raiMediaFilteredCount"]);null!=o&&s(e,["raiMediaFilteredCount"],o);const i=r(n,["raiMediaFilteredReasons"]);return null!=i&&s(e,["raiMediaFilteredReasons"],i),e}(a)),e}(l),Object.assign(o,i),o}}class Vn{}class qn{}class Hn{}class Bn{}class _i{}class Ti{}class Ei{}class Oe{_fromAPIResponse({apiResponse:e}){const o=new Oe,l=function fo(n){const e={},t=r(n,["name"]);null!=t&&s(e,["name"],t);const o=r(n,["metadata"]);null!=o&&s(e,["metadata"],o);const i=r(n,["done"]);null!=i&&s(e,["done"],i);const l=r(n,["error"]);null!=l&&s(e,["error"],l);const a=r(n,["response"]);return null!=a&&s(e,["response"],function co(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["parent"]);null!=o&&s(e,["parent"],o);const i=r(n,["documentName"]);return null!=i&&s(e,["documentName"],i),e}(a)),e}(e);return Object.assign(o,l),o}}class Ci{}class Ii{}class vi{}class bn{}class Ai{get text(){var e,t,o;let i="",l=!1;const a=[];for(const d of null!==(o=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==o?o:[]){for(const[f,c]of Object.entries(d))"text"!==f&&"thought"!==f&&null!==c&&a.push(f);if("string"==typeof d.text){if("boolean"==typeof d.thought&&d.thought)continue;l=!0,i+=d.text}}return a.length>0&&console.warn(`there are non-text parts ${a} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?i:void 0}get data(){var e,t,o;let i="";const l=[];for(const a of null!==(o=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==o?o:[]){for(const[d,f]of Object.entries(a))"inlineData"!==d&&null!==f&&l.push(d);a.inlineData&&"string"==typeof a.inlineData.data&&(i+=atob(a.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class Si{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class ze{_fromAPIResponse({apiResponse:e}){const o=new ze,l=Mn(e);return Object.assign(o,l),o}}function L(n,e){if(!e||"string"!=typeof e)throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}return`publishers/google/models/${e}`}return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Jn(n,e){const t=L(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function $n(n){return Array.isArray(n)?n.map(e=>Me(e)):[Me(n)]}function Me(n){if("object"==typeof n&&null!==n)return n;throw new Error("Could not parse input as Blob. Unsupported blob type: "+typeof n)}function Wn(n){const e=Me(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Kn(n){const e=Me(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Yn(n){if(null==n)throw new Error("PartUnion is required");if("object"==typeof n)return n;if("string"==typeof n)return{text:n};throw new Error("Unsupported part type: "+typeof n)}function On(n){if(null==n||Array.isArray(n)&&0===n.length)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>Yn(e)):[Yn(n)]}function Xe(n){return null!=n&&"object"==typeof n&&"parts"in n&&Array.isArray(n.parts)}function zn(n){return null!=n&&"object"==typeof n&&"functionCall"in n}function Xn(n){return null!=n&&"object"==typeof n&&"functionResponse"in n}function J(n){if(null==n)throw new Error("ContentUnion is required");return Xe(n)?n:{role:"user",parts:On(n)}}function Qe(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const o=J(t);return o.parts&&o.parts.length>0&&void 0!==o.parts[0].text?[o.parts[0].text]:[]});if(n.isVertexAI()){const t=J(e);return t.parts&&t.parts.length>0&&void 0!==t.parts[0].text?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>J(t)):[J(e)]}function Q(n){if(null==n||Array.isArray(n)&&0===n.length)throw new Error("contents are required");if(!Array.isArray(n)){if(zn(n)||Xn(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[J(n)]}const e=[],t=[],o=Xe(n[0]);for(const i of n){const l=Xe(i);if(l!=o)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)e.push(i);else{if(zn(i)||Xn(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(i)}}return o||e.push({role:"user",parts:On(t)}),e}function he(n){const e={},t=["items"],o=["anyOf"],i=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const l=n.anyOf;null!=l&&2==l.length&&("null"===l[0].type?(e.nullable=!0,n=l[1]):"null"===l[1].type&&(e.nullable=!0,n=l[0])),n.type instanceof Array&&function Ri(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(o=>"null"!==o);if(1===t.length)e.type=Object.values(ue).includes(t[0].toUpperCase())?t[0].toUpperCase():ue.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const o of t)e.anyOf.push({type:Object.values(ue).includes(o.toUpperCase())?o.toUpperCase():ue.TYPE_UNSPECIFIED})}}(n.type,e);for(const[a,d]of Object.entries(n))if(null!=d)if("type"==a){if("null"===d)throw new Error("type: null can not be the only possible type for the field.");if(d instanceof Array)continue;e.type=Object.values(ue).includes(d.toUpperCase())?d.toUpperCase():ue.TYPE_UNSPECIFIED}else if(t.includes(a))e[a]=he(d);else if(o.includes(a)){const f=[];for(const c of d)"null"!=c.type?f.push(he(c)):e.nullable=!0;e[a]=f}else if(i.includes(a)){const f={};for(const[c,u]of Object.entries(d))f[c]=he(u);e[a]=f}else{if("additionalProperties"===a)continue;e[a]=d}return e}function Ze(n){return he(n)}function je(n){if("object"==typeof n)return n;if("string"==typeof n)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error("Unsupported speechConfig type: "+typeof n)}function en(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function ge(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=he(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=he(e.response));return n}function ye(n){if(null==n)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function re(n,e){if("string"!=typeof e)throw new Error("name must be a string");return function Pi(n,e,t,o=1){const i=!e.startsWith(`${t}/`)&&e.split("/").length===o;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:i?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:i?`${t}/${e}`:e}(n,e,"cachedContents")}function Qn(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function de(n){return te(n)}function Zn(n){var e;let t;if(function Mi(n){return null!=n&&"object"==typeof n&&"name"in n}(n)&&(t=n.name),!(function wi(n){return null!=n&&"object"==typeof n&&"uri"in n}(n)&&(t=n.uri,void 0===t)||function Ni(n){return null!=n&&"object"==typeof n&&"video"in n}(n)&&(t=null===(e=n.video)||void 0===e?void 0:e.uri,void 0===t))){if("string"==typeof n&&(t=n),void 0===t)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const i=t.split("files/")[1].match(/[a-z0-9]+/);if(null===i)throw new Error(`Could not extract file name from URI ${t}`);t=i[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function jn(n,e){let t;return t=n.isVertexAI()?e?"publishers/google/models":"models":e?"models":"tunedModels",t}function et(n){for(const e of["models","tunedModels","publisherModels"])if(xi(n,e))return n[e];return[]}function xi(n,e){return null!==n&&"object"==typeof n&&e in n}function Di(n,e={}){const o={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(o.responseJsonSchema=n.outputSchema),e.behavior&&(o.behavior=e.behavior),{functionDeclarations:[o]}}function nt(n,e){let t;if("string"==typeof e)if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else{if(!e.startsWith("bq://"))throw new Error(`Unsupported string source for Vertex AI: ${e}`);t={format:"bigquery",bigqueryUri:e}}else{if(!e.startsWith("files/"))throw new Error(`Unsupported string source for Gemini API: ${e}`);t={fileName:e}}else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const o=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,i=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(i>0||1!==o)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(o>0||1!==i)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function tt(n){if("object"!=typeof n||null===n)return{};const e=n,t=e.inlinedResponses;if("object"!=typeof t||null===t)return n;const i=t.inlinedResponses;if(!Array.isArray(i)||0===i.length)return n;let l=!1;for(const a of i){if("object"!=typeof a||null===a)continue;const f=a.response;if("object"==typeof f&&null!==f&&void 0!==f.embedding){l=!0;break}}return l&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function _e(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function ot(n){return"BATCH_STATE_UNSPECIFIED"===n?"JOB_STATE_UNSPECIFIED":"BATCH_STATE_PENDING"===n?"JOB_STATE_PENDING":"BATCH_STATE_RUNNING"===n?"JOB_STATE_RUNNING":"BATCH_STATE_SUCCEEDED"===n?"JOB_STATE_SUCCEEDED":"BATCH_STATE_FAILED"===n?"JOB_STATE_FAILED":"BATCH_STATE_CANCELLED"===n?"JOB_STATE_CANCELLED":"BATCH_STATE_EXPIRED"===n?"JOB_STATE_EXPIRED":n}function Ne(n){const e={},t=r(n,["name"]);null!=t&&s(e,["name"],t);const o=r(n,["metadata","displayName"]);null!=o&&s(e,["displayName"],o);const i=r(n,["metadata","state"]);null!=i&&s(e,["state"],ot(i));const l=r(n,["metadata","createTime"]);null!=l&&s(e,["createTime"],l);const a=r(n,["metadata","endTime"]);null!=a&&s(e,["endTime"],a);const d=r(n,["metadata","updateTime"]);null!=d&&s(e,["updateTime"],d);const f=r(n,["metadata","model"]);null!=f&&s(e,["model"],f);const c=r(n,["metadata","output"]);return null!=c&&s(e,["dest"],function ki(n){const e={},t=r(n,["responsesFile"]);null!=t&&s(e,["fileName"],t);const o=r(n,["inlinedResponses","inlinedResponses"]);if(null!=o){let l=o;Array.isArray(l)&&(l=l.map(a=>function hr(n){const e={},t=r(n,["response"]);null!=t&&s(e,["response"],function ar(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["candidates"]);if(null!=o){let f=o;Array.isArray(f)&&(f=f.map(c=>function $i(n){const e={},t=r(n,["content"]);null!=t&&s(e,["content"],t);const o=r(n,["citationMetadata"]);null!=o&&s(e,["citationMetadata"],function Wi(n){const e={},t=r(n,["citationSources"]);if(null!=t){let o=t;Array.isArray(o)&&(o=o.map(i=>i)),s(e,["citations"],o)}return e}(o));const i=r(n,["tokenCount"]);null!=i&&s(e,["tokenCount"],i);const l=r(n,["finishReason"]);null!=l&&s(e,["finishReason"],l);const a=r(n,["avgLogprobs"]);null!=a&&s(e,["avgLogprobs"],a);const d=r(n,["groundingMetadata"]);null!=d&&s(e,["groundingMetadata"],d);const f=r(n,["index"]);null!=f&&s(e,["index"],f);const c=r(n,["logprobsResult"]);null!=c&&s(e,["logprobsResult"],c);const u=r(n,["safetyRatings"]);if(null!=u){let h=u;Array.isArray(h)&&(h=h.map(m=>m)),s(e,["safetyRatings"],h)}const p=r(n,["urlContextMetadata"]);return null!=p&&s(e,["urlContextMetadata"],p),e}(c))),s(e,["candidates"],f)}const i=r(n,["modelVersion"]);null!=i&&s(e,["modelVersion"],i);const l=r(n,["promptFeedback"]);null!=l&&s(e,["promptFeedback"],l);const a=r(n,["responseId"]);null!=a&&s(e,["responseId"],a);const d=r(n,["usageMetadata"]);return null!=d&&s(e,["usageMetadata"],d),e}(t));const o=r(n,["error"]);return null!=o&&s(e,["error"],o),e}(a))),s(e,["inlinedResponses"],l)}const i=r(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(null!=i){let l=i;Array.isArray(l)&&(l=l.map(a=>a)),s(e,["inlinedEmbedContentResponses"],l)}return e}(tt(c))),e}function nn(n){const e={},t=r(n,["name"]);null!=t&&s(e,["name"],t);const o=r(n,["displayName"]);null!=o&&s(e,["displayName"],o);const i=r(n,["state"]);null!=i&&s(e,["state"],ot(i));const l=r(n,["error"]);null!=l&&s(e,["error"],l);const a=r(n,["createTime"]);null!=a&&s(e,["createTime"],a);const d=r(n,["startTime"]);null!=d&&s(e,["startTime"],d);const f=r(n,["endTime"]);null!=f&&s(e,["endTime"],f);const c=r(n,["updateTime"]);null!=c&&s(e,["updateTime"],c);const u=r(n,["model"]);null!=u&&s(e,["model"],u);const p=r(n,["inputConfig"]);null!=p&&s(e,["src"],function Vi(n){const e={},t=r(n,["instancesFormat"]);null!=t&&s(e,["format"],t);const o=r(n,["gcsSource","uris"]);null!=o&&s(e,["gcsUri"],o);const i=r(n,["bigquerySource","inputUri"]);return null!=i&&s(e,["bigqueryUri"],i),e}(p));const h=r(n,["outputConfig"]);null!=h&&s(e,["dest"],function Fi(n){const e={},t=r(n,["predictionsFormat"]);null!=t&&s(e,["format"],t);const o=r(n,["gcsDestination","outputUriPrefix"]);null!=o&&s(e,["gcsUri"],o);const i=r(n,["bigqueryDestination","outputUri"]);return null!=i&&s(e,["bigqueryUri"],i),e}(tt(h)));const m=r(n,["completionStats"]);return null!=m&&s(e,["completionStats"],m),e}function it(n){const e={},t=r(n,["parts"]);if(null!=t){let i=t;Array.isArray(i)&&(i=i.map(l=>function Ir(n){const e={},t=r(n,["mediaResolution"]);null!=t&&s(e,["mediaResolution"],t);const o=r(n,["codeExecutionResult"]);null!=o&&s(e,["codeExecutionResult"],o);const i=r(n,["executableCode"]);null!=i&&s(e,["executableCode"],i);const l=r(n,["fileData"]);null!=l&&s(e,["fileData"],function ir(n){const e={};if(void 0!==r(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const t=r(n,["fileUri"]);null!=t&&s(e,["fileUri"],t);const o=r(n,["mimeType"]);return null!=o&&s(e,["mimeType"],o),e}(l));const a=r(n,["functionCall"]);null!=a&&s(e,["functionCall"],function rr(n){const e={},t=r(n,["id"]);null!=t&&s(e,["id"],t);const o=r(n,["args"]);null!=o&&s(e,["args"],o);const i=r(n,["name"]);if(null!=i&&s(e,["name"],i),void 0!==r(n,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==r(n,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return e}(a));const d=r(n,["functionResponse"]);null!=d&&s(e,["functionResponse"],d);const f=r(n,["inlineData"]);null!=f&&s(e,["inlineData"],function Bi(n){const e={},t=r(n,["data"]);if(null!=t&&s(e,["data"],t),void 0!==r(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const o=r(n,["mimeType"]);return null!=o&&s(e,["mimeType"],o),e}(f));const c=r(n,["text"]);null!=c&&s(e,["text"],c);const u=r(n,["thought"]);null!=u&&s(e,["thought"],u);const p=r(n,["thoughtSignature"]);null!=p&&s(e,["thoughtSignature"],p);const h=r(n,["videoMetadata"]);return null!=h&&s(e,["videoMetadata"],h),e}(l))),s(e,["parts"],i)}const o=r(n,["role"]);return null!=o&&s(e,["role"],o),e}function rt(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["_url","model"],L(n,o));const i=r(e,["src"]);null!=i&&s(t,["batch","inputConfig"],function qi(n,e){const t={};if(void 0!==r(e,["format"]))throw new Error("format parameter is not supported in Gemini API.");if(void 0!==r(e,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==r(e,["bigqueryUri"]))throw new Error("bigqueryUri parameter is not supported in Gemini API.");const o=r(e,["fileName"]);null!=o&&s(t,["fileName"],o);const i=r(e,["inlinedRequests"]);if(null!=i){let l=i;Array.isArray(l)&&(l=l.map(a=>function mr(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["request","model"],L(n,o));const i=r(e,["contents"]);if(null!=i){let d=Q(i);Array.isArray(d)&&(d=d.map(f=>it(f))),s(t,["request","contents"],d)}const l=r(e,["metadata"]);null!=l&&s(t,["metadata"],l);const a=r(e,["config"]);return null!=a&&s(t,["request","generationConfig"],function lr(n,e,t){const o={},i=r(e,["systemInstruction"]);void 0!==t&&null!=i&&s(t,["systemInstruction"],it(J(i)));const l=r(e,["temperature"]);null!=l&&s(o,["temperature"],l);const a=r(e,["topP"]);null!=a&&s(o,["topP"],a);const d=r(e,["topK"]);null!=d&&s(o,["topK"],d);const f=r(e,["candidateCount"]);null!=f&&s(o,["candidateCount"],f);const c=r(e,["maxOutputTokens"]);null!=c&&s(o,["maxOutputTokens"],c);const u=r(e,["stopSequences"]);null!=u&&s(o,["stopSequences"],u);const p=r(e,["responseLogprobs"]);null!=p&&s(o,["responseLogprobs"],p);const h=r(e,["logprobs"]);null!=h&&s(o,["logprobs"],h);const m=r(e,["presencePenalty"]);null!=m&&s(o,["presencePenalty"],m);const y=r(e,["frequencyPenalty"]);null!=y&&s(o,["frequencyPenalty"],y);const E=r(e,["seed"]);null!=E&&s(o,["seed"],E);const _=r(e,["responseMimeType"]);null!=_&&s(o,["responseMimeType"],_);const I=r(e,["responseSchema"]);null!=I&&s(o,["responseSchema"],Ze(I));const C=r(e,["responseJsonSchema"]);if(null!=C&&s(o,["responseJsonSchema"],C),void 0!==r(e,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==r(e,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const v=r(e,["safetySettings"]);if(void 0!==t&&null!=v){let G=v;Array.isArray(G)&&(G=G.map(ie=>function vr(n){const e={},t=r(n,["category"]);if(null!=t&&s(e,["category"],t),void 0!==r(n,["method"]))throw new Error("method parameter is not supported in Gemini API.");const o=r(n,["threshold"]);return null!=o&&s(e,["threshold"],o),e}(ie))),s(t,["safetySettings"],G)}const A=r(e,["tools"]);if(void 0!==t&&null!=A){let G=ye(A);Array.isArray(G)&&(G=G.map(ie=>function Sr(n){const e={};if(void 0!==r(n,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const t=r(n,["computerUse"]);null!=t&&s(e,["computerUse"],t);const o=r(n,["fileSearch"]);null!=o&&s(e,["fileSearch"],o);const i=r(n,["codeExecution"]);if(null!=i&&s(e,["codeExecution"],i),void 0!==r(n,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=r(n,["functionDeclarations"]);if(null!=l){let u=l;Array.isArray(u)&&(u=u.map(p=>p)),s(e,["functionDeclarations"],u)}const a=r(n,["googleMaps"]);null!=a&&s(e,["googleMaps"],function fr(n){const e={};if(void 0!==r(n,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const t=r(n,["enableWidget"]);return null!=t&&s(e,["enableWidget"],t),e}(a));const d=r(n,["googleSearch"]);null!=d&&s(e,["googleSearch"],function cr(n){const e={};if(void 0!==r(n,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==r(n,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=r(n,["timeRangeFilter"]);return null!=t&&s(e,["timeRangeFilter"],t),e}(d));const f=r(n,["googleSearchRetrieval"]);null!=f&&s(e,["googleSearchRetrieval"],f);const c=r(n,["urlContext"]);return null!=c&&s(e,["urlContext"],c),e}(ge(ie)))),s(t,["tools"],G)}const P=r(e,["toolConfig"]);if(void 0!==t&&null!=P&&s(t,["toolConfig"],function Ar(n){const e={},t=r(n,["retrievalConfig"]);null!=t&&s(e,["retrievalConfig"],t);const o=r(n,["functionCallingConfig"]);return null!=o&&s(e,["functionCallingConfig"],function sr(n){const e={},t=r(n,["allowedFunctionNames"]);null!=t&&s(e,["allowedFunctionNames"],t);const o=r(n,["mode"]);if(null!=o&&s(e,["mode"],o),void 0!==r(n,["streamFunctionCallArguments"]))throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}(o)),e}(P)),void 0!==r(e,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const R=r(e,["cachedContent"]);void 0!==t&&null!=R&&s(t,["cachedContent"],re(n,R));const U=r(e,["responseModalities"]);null!=U&&s(o,["responseModalities"],U);const F=r(e,["mediaResolution"]);null!=F&&s(o,["mediaResolution"],F);const H=r(e,["speechConfig"]);if(null!=H&&s(o,["speechConfig"],je(H)),void 0!==r(e,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=r(e,["thinkingConfig"]);null!=N&&s(o,["thinkingConfig"],N);const D=r(e,["imageConfig"]);null!=D&&s(o,["imageConfig"],function pr(n){const e={},t=r(n,["aspectRatio"]);null!=t&&s(e,["aspectRatio"],t);const o=r(n,["imageSize"]);if(null!=o&&s(e,["imageSize"],o),void 0!==r(n,["personGeneration"]))throw new Error("personGeneration parameter is not supported in Gemini API.");if(void 0!==r(n,["outputMimeType"]))throw new Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==r(n,["outputCompressionQuality"]))throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}(D));const Y=r(e,["enableEnhancedCivicAnswers"]);return null!=Y&&s(o,["enableEnhancedCivicAnswers"],Y),o}(n,a,r(t,["request"],{}))),t}(n,a))),s(t,["requests","requests"],l)}return t}(n,nt(n,i)));const l=r(e,["config"]);return null!=l&&function Ki(n,e){const o=r(n,["displayName"]);if(void 0!==e&&null!=o&&s(e,["batch","displayName"],o),void 0!==r(n,["dest"]))throw new Error("dest parameter is not supported in Gemini API.")}(l,t),t}function Oi(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["model"],L(n,o));const i=r(e,["src"]);null!=i&&s(t,["inputConfig"],function Hi(n){const e={},t=r(n,["format"]);null!=t&&s(e,["instancesFormat"],t);const o=r(n,["gcsUri"]);null!=o&&s(e,["gcsSource","uris"],o);const i=r(n,["bigqueryUri"]);if(null!=i&&s(e,["bigquerySource","inputUri"],i),void 0!==r(n,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==r(n,["inlinedRequests"]))throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}(nt(n,i)));const l=r(e,["config"]);return null!=l&&function Yi(n,e){const o=r(n,["displayName"]);void 0!==e&&null!=o&&s(e,["displayName"],o);const i=r(n,["dest"]);return void 0!==e&&null!=i&&s(e,["outputConfig"],function Gi(n){const e={},t=r(n,["format"]);null!=t&&s(e,["predictionsFormat"],t);const o=r(n,["gcsUri"]);null!=o&&s(e,["gcsDestination","outputUriPrefix"],o);const i=r(n,["bigqueryUri"]);if(null!=i&&s(e,["bigqueryDestination","outputUri"],i),void 0!==r(n,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==r(n,["inlinedResponses"]))throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(void 0!==r(n,["inlinedEmbedContentResponses"]))throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}(function Li(n){if("string"!=typeof n)return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}(i))),{}}(l,t),t}var fe=function(n){return n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents",n}(fe||{});class pe{constructor(e,t,o,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,o,i)}init(e,t,o){var i,l;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t?.sdkHttpResponse,this.idxInternal=0;let a={config:{}};a=o&&0!==Object.keys(o).length?"object"==typeof o?Object.assign({},o):o:{config:{}},a.config&&(a.config.pageToken=t.nextPageToken),this.paramsInternal=a,this.pageInternalSize=null!==(l=null===(i=a.config)||void 0===i?void 0:i.pageSize)&&void 0!==l?l:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){var t,e=this;return{next:(t=(0,g.A)(function*(){if(e.idxInternal>=e.pageLength){if(!e.hasNextPage())return{value:void 0,done:!0};yield e.nextPage()}const o=e.getItem(e.idxInternal);return e.idxInternal+=1,{value:o,done:!1}}),function(){return t.apply(this,arguments)}),return:function(){var t=(0,g.A)(function*(){return{value:void 0,done:!0}});return function(){return t.apply(this,arguments)}}()}}nextPage(){var e=this;return(0,g.A)(function*(){if(!e.hasNextPage())throw new Error("No more pages to fetch.");const t=yield e.requestInternal(e.params);return e.initNextPage(t),e.page})()}hasNextPage(){var e;return void 0!==(null===(e=this.params.config)||void 0===e?void 0:e.pageToken)}}class Rr extends S{constructor(e){var t;super(),t=this,this.apiClient=e,this.list=(0,g.A)(function*(o={}){return new pe(fe.PAGED_ITEM_BATCH_JOBS,i=>t.listInternal(i),yield t.listInternal(o),o)}),this.create=function(){var o=(0,g.A)(function*(i){return t.apiClient.isVertexAI()&&(i.config=t.formatDestination(i.src,i.config)),t.createInternal(i)});return function(i){return o.apply(this,arguments)}}(),this.createEmbeddings=function(){var o=(0,g.A)(function*(i){if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),t.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return t.createEmbeddingsInternal(i)});return function(i){return o.apply(this,arguments)}}()}createInlinedGenerateContentRequest(e){const t=rt(this.apiClient,e),i=T("{model}:batchGenerateContent",t._url),d=t.batch.inputConfig.requests,f=d.requests,c=[];for(const u of f){const p=Object.assign({},u);if(p.systemInstruction){const h=p.systemInstruction;delete p.systemInstruction;const m=p.request;m.systemInstruction=h,p.request=m}c.push(p)}return d.requests=c,delete t.config,delete t._url,delete t._query,{path:i,body:t}}getGcsUri(e){return"string"==typeof e?e.startsWith("gs://")?e:void 0:!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0?e.gcsUri[0]:void 0}getBigqueryUri(e){return"string"==typeof e?e.startsWith("bq://")?e:void 0:Array.isArray(e)?void 0:e.bigqueryUri}formatDestination(e,t){const o=t?Object.assign({},t):{},i=Date.now().toString();if(o.displayName||(o.displayName=`genaiBatchJob_${i}`),void 0===o.dest){const l=this.getGcsUri(e),a=this.getBigqueryUri(e);if(l)o.dest=l.endsWith(".jsonl")?`${l.slice(0,-6)}/dest`:`${l}_dest_${i}`;else{if(!a)throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.");o.dest=`${a}_dest_${i}`}}return o}createInternal(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=Oi(t.apiClient,e);return f=T("batchPredictionJobs",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json()),d.then(p=>nn(p))}{const u=rt(t.apiClient,e);return f=T("{model}:batchGenerateContent",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json()),d.then(p=>Ne(p))}})()}createEmbeddingsInternal(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=function Xi(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["_url","model"],L(n,o));const i=r(e,["src"]);null!=i&&s(t,["batch","inputConfig"],function or(n,e){const t={},o=r(e,["fileName"]);null!=o&&s(t,["file_name"],o);const i=r(e,["inlinedRequests"]);return null!=i&&s(t,["requests"],function nr(n,e){const t={},o=r(e,["contents"]);if(null!=o){let l=Qe(n,o);Array.isArray(l)&&(l=l.map(a=>a)),s(t,["requests[]","request","content"],l)}const i=r(e,["config"]);return null!=i&&(s(t,["_self"],function tr(n,e){const o=r(n,["taskType"]);void 0!==e&&null!=o&&s(e,["requests[]","taskType"],o);const i=r(n,["title"]);void 0!==e&&null!=i&&s(e,["requests[]","title"],i);const l=r(n,["outputDimensionality"]);if(void 0!==e&&null!=l&&s(e,["requests[]","outputDimensionality"],l),void 0!==r(n,["mimeType"]))throw new Error("mimeType parameter is not supported in Gemini API.");if(void 0!==r(n,["autoTruncate"]))throw new Error("autoTruncate parameter is not supported in Gemini API.");return{}}(i,t)),function B(n,e){for(const[t,o]of Object.entries(e)){const i=t.split("."),l=o.split("."),a=new Set;let d=-1;for(let f=0;f<i.length;f++)if("*"===i[f]){d=f;break}if(-1!==d&&l.length>d)for(let f=d;f<l.length;f++){const c=l[f];"*"!==c&&!c.endsWith("[]")&&!c.endsWith("[0]")&&a.add(c)}O(n,i,l,0,a)}}(t,{"requests[].*":"requests[].request.*"})),t}(n,i)),t}(n,i));const l=r(e,["config"]);return null!=l&&function zi(n,e){const o=r(n,["displayName"]);void 0!==e&&null!=o&&s(e,["batch","displayName"],o)}(l,t),t}(t.apiClient,e);return a=T("{model}:asyncBatchEmbedContent",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json()),l.then(c=>Ne(c))}})()}get(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=function dr(n,e){const t={},o=r(e,["name"]);return null!=o&&s(t,["_url","name"],_e(n,o)),t}(t.apiClient,e);return f=T("batchPredictionJobs/{name}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json()),d.then(p=>nn(p))}{const u=function ur(n,e){const t={},o=r(e,["name"]);return null!=o&&s(t,["_url","name"],_e(n,o)),t}(t.apiClient,e);return f=T("batches/{name}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json()),d.then(p=>Ne(p))}})()}cancel(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d="",f={};if(t.apiClient.isVertexAI()){const c=function Ji(n,e){const t={},o=r(e,["name"]);return null!=o&&s(t,["_url","name"],_e(n,o)),t}(t.apiClient,e);d=T("batchPredictionJobs/{name}:cancel",c._url),f=c._query,delete c._url,delete c._query,yield t.apiClient.request({path:d,queryParams:f,body:JSON.stringify(c),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal})}else{const c=function bi(n,e){const t={},o=r(e,["name"]);return null!=o&&s(t,["_url","name"],_e(n,o)),t}(t.apiClient,e);d=T("batches/{name}:cancel",c._url),f=c._query,delete c._url,delete c._query,yield t.apiClient.request({path:d,queryParams:f,body:JSON.stringify(c),httpMethod:"POST",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal})}})()}listInternal(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=function Tr(n){const e={},t=r(n,["config"]);return null!=t&&function yr(n,e){const o=r(n,["pageSize"]);void 0!==e&&null!=o&&s(e,["_query","pageSize"],o);const i=r(n,["pageToken"]);void 0!==e&&null!=i&&s(e,["_query","pageToken"],i);const l=r(n,["filter"]);void 0!==e&&null!=l&&s(e,["_query","filter"],l)}(t,e),e}(e);return f=T("batchPredictionJobs",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function Cr(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["nextPageToken"]);null!=o&&s(e,["nextPageToken"],o);const i=r(n,["batchPredictionJobs"]);if(null!=i){let l=i;Array.isArray(l)&&(l=l.map(a=>nn(a))),s(e,["batchJobs"],l)}return e}(p),m=new bn;return Object.assign(m,h),m})}{const u=function _r(n){const e={},t=r(n,["config"]);return null!=t&&function gr(n,e){const o=r(n,["pageSize"]);void 0!==e&&null!=o&&s(e,["_query","pageSize"],o);const i=r(n,["pageToken"]);if(void 0!==e&&null!=i&&s(e,["_query","pageToken"],i),void 0!==r(n,["filter"]))throw new Error("filter parameter is not supported in Gemini API.")}(t,e),e}(e);return f=T("batches",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function Er(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["nextPageToken"]);null!=o&&s(e,["nextPageToken"],o);const i=r(n,["operations"]);if(null!=i){let l=i;Array.isArray(l)&&(l=l.map(a=>Ne(a))),s(e,["batchJobs"],l)}return e}(p),m=new bn;return Object.assign(m,h),m})}})()}delete(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=function Zi(n,e){const t={},o=r(e,["name"]);return null!=o&&s(t,["_url","name"],_e(n,o)),t}(t.apiClient,e);return f=T("batchPredictionJobs/{name}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>function er(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["name"]);null!=o&&s(e,["name"],o);const i=r(n,["done"]);null!=i&&s(e,["done"],i);const l=r(n,["error"]);return null!=l&&s(e,["error"],l),e}(p))}{const u=function Qi(n,e){const t={},o=r(e,["name"]);return null!=o&&s(t,["_url","name"],_e(n,o)),t}(t.apiClient,e);return f=T("batches/{name}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>function ji(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["name"]);null!=o&&s(e,["name"],o);const i=r(n,["done"]);null!=i&&s(e,["done"],i);const l=r(n,["error"]);return null!=l&&s(e,["error"],l),e}(p))}})()}}function st(n){const e={},t=r(n,["parts"]);if(null!=t){let i=t;Array.isArray(i)&&(i=i.map(l=>function Xr(n){const e={},t=r(n,["mediaResolution"]);null!=t&&s(e,["mediaResolution"],t);const o=r(n,["codeExecutionResult"]);null!=o&&s(e,["codeExecutionResult"],o);const i=r(n,["executableCode"]);null!=i&&s(e,["executableCode"],i);const l=r(n,["fileData"]);null!=l&&s(e,["fileData"],function Fr(n){const e={};if(void 0!==r(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const t=r(n,["fileUri"]);null!=t&&s(e,["fileUri"],t);const o=r(n,["mimeType"]);return null!=o&&s(e,["mimeType"],o),e}(l));const a=r(n,["functionCall"]);null!=a&&s(e,["functionCall"],function Gr(n){const e={},t=r(n,["id"]);null!=t&&s(e,["id"],t);const o=r(n,["args"]);null!=o&&s(e,["args"],o);const i=r(n,["name"]);if(null!=i&&s(e,["name"],i),void 0!==r(n,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==r(n,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return e}(a));const d=r(n,["functionResponse"]);null!=d&&s(e,["functionResponse"],d);const f=r(n,["inlineData"]);null!=f&&s(e,["inlineData"],function Pr(n){const e={},t=r(n,["data"]);if(null!=t&&s(e,["data"],t),void 0!==r(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const o=r(n,["mimeType"]);return null!=o&&s(e,["mimeType"],o),e}(f));const c=r(n,["text"]);null!=c&&s(e,["text"],c);const u=r(n,["thought"]);null!=u&&s(e,["thought"],u);const p=r(n,["thoughtSignature"]);null!=p&&s(e,["thoughtSignature"],p);const h=r(n,["videoMetadata"]);return null!=h&&s(e,["videoMetadata"],h),e}(l))),s(e,["parts"],i)}const o=r(n,["role"]);return null!=o&&s(e,["role"],o),e}class is extends S{constructor(e){var t;super(),t=this,this.apiClient=e,this.list=(0,g.A)(function*(o={}){return new pe(fe.PAGED_ITEM_CACHED_CONTENTS,i=>t.listInternal(i),yield t.listInternal(o),o)})}create(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=function xr(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["model"],Jn(n,o));const i=r(e,["config"]);return null!=i&&function Nr(n,e){const o=r(n,["ttl"]);void 0!==e&&null!=o&&s(e,["ttl"],o);const i=r(n,["expireTime"]);void 0!==e&&null!=i&&s(e,["expireTime"],i);const l=r(n,["displayName"]);void 0!==e&&null!=l&&s(e,["displayName"],l);const a=r(n,["contents"]);if(void 0!==e&&null!=a){let p=Q(a);Array.isArray(p)&&(p=p.map(h=>h)),s(e,["contents"],p)}const d=r(n,["systemInstruction"]);void 0!==e&&null!=d&&s(e,["systemInstruction"],J(d));const f=r(n,["tools"]);if(void 0!==e&&null!=f){let p=f;Array.isArray(p)&&(p=p.map(h=>function jr(n){const e={},t=r(n,["retrieval"]);null!=t&&s(e,["retrieval"],t);const o=r(n,["computerUse"]);if(null!=o&&s(e,["computerUse"],o),void 0!==r(n,["fileSearch"]))throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=r(n,["codeExecution"]);null!=i&&s(e,["codeExecution"],i);const l=r(n,["enterpriseWebSearch"]);null!=l&&s(e,["enterpriseWebSearch"],l);const a=r(n,["functionDeclarations"]);if(null!=a){let p=a;Array.isArray(p)&&(p=p.map(h=>function qr(n){const e={},t=r(n,["description"]);null!=t&&s(e,["description"],t);const o=r(n,["name"]);null!=o&&s(e,["name"],o);const i=r(n,["parameters"]);null!=i&&s(e,["parameters"],i);const l=r(n,["parametersJsonSchema"]);null!=l&&s(e,["parametersJsonSchema"],l);const a=r(n,["response"]);null!=a&&s(e,["response"],a);const d=r(n,["responseJsonSchema"]);if(null!=d&&s(e,["responseJsonSchema"],d),void 0!==r(n,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");return e}(h))),s(e,["functionDeclarations"],p)}const d=r(n,["googleMaps"]);null!=d&&s(e,["googleMaps"],d);const f=r(n,["googleSearch"]);null!=f&&s(e,["googleSearch"],f);const c=r(n,["googleSearchRetrieval"]);null!=c&&s(e,["googleSearchRetrieval"],c);const u=r(n,["urlContext"]);return null!=u&&s(e,["urlContext"],u),e}(h))),s(e,["tools"],p)}const c=r(n,["toolConfig"]);void 0!==e&&null!=c&&s(e,["toolConfig"],c);const u=r(n,["kmsKeyName"]);return void 0!==e&&null!=u&&s(e,["encryption_spec","kmsKeyName"],u),{}}(i,t),t}(t.apiClient,e);return f=T("cachedContents",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json()),d.then(p=>p)}{const u=function wr(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["model"],Jn(n,o));const i=r(e,["config"]);return null!=i&&function Mr(n,e){const o=r(n,["ttl"]);void 0!==e&&null!=o&&s(e,["ttl"],o);const i=r(n,["expireTime"]);void 0!==e&&null!=i&&s(e,["expireTime"],i);const l=r(n,["displayName"]);void 0!==e&&null!=l&&s(e,["displayName"],l);const a=r(n,["contents"]);if(void 0!==e&&null!=a){let u=Q(a);Array.isArray(u)&&(u=u.map(p=>st(p))),s(e,["contents"],u)}const d=r(n,["systemInstruction"]);void 0!==e&&null!=d&&s(e,["systemInstruction"],st(J(d)));const f=r(n,["tools"]);if(void 0!==e&&null!=f){let u=f;Array.isArray(u)&&(u=u.map(p=>function Zr(n){const e={};if(void 0!==r(n,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const t=r(n,["computerUse"]);null!=t&&s(e,["computerUse"],t);const o=r(n,["fileSearch"]);null!=o&&s(e,["fileSearch"],o);const i=r(n,["codeExecution"]);if(null!=i&&s(e,["codeExecution"],i),void 0!==r(n,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=r(n,["functionDeclarations"]);if(null!=l){let u=l;Array.isArray(u)&&(u=u.map(p=>p)),s(e,["functionDeclarations"],u)}const a=r(n,["googleMaps"]);null!=a&&s(e,["googleMaps"],function br(n){const e={};if(void 0!==r(n,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const t=r(n,["enableWidget"]);return null!=t&&s(e,["enableWidget"],t),e}(a));const d=r(n,["googleSearch"]);null!=d&&s(e,["googleSearch"],function Jr(n){const e={};if(void 0!==r(n,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==r(n,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=r(n,["timeRangeFilter"]);return null!=t&&s(e,["timeRangeFilter"],t),e}(d));const f=r(n,["googleSearchRetrieval"]);null!=f&&s(e,["googleSearchRetrieval"],f);const c=r(n,["urlContext"]);return null!=c&&s(e,["urlContext"],c),e}(p))),s(e,["tools"],u)}const c=r(n,["toolConfig"]);if(void 0!==e&&null!=c&&s(e,["toolConfig"],function Qr(n){const e={},t=r(n,["retrievalConfig"]);null!=t&&s(e,["retrievalConfig"],t);const o=r(n,["functionCallingConfig"]);return null!=o&&s(e,["functionCallingConfig"],function Vr(n){const e={},t=r(n,["allowedFunctionNames"]);null!=t&&s(e,["allowedFunctionNames"],t);const o=r(n,["mode"]);if(null!=o&&s(e,["mode"],o),void 0!==r(n,["streamFunctionCallArguments"]))throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}(o)),e}(c)),void 0!==r(n,["kmsKeyName"]))throw new Error("kmsKeyName parameter is not supported in Gemini API.");return{}}(i,t),t}(t.apiClient,e);return f=T("cachedContents",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json()),d.then(p=>p)}})()}get(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=function Br(n,e){const t={},o=r(e,["name"]);return null!=o&&s(t,["_url","name"],re(n,o)),t}(t.apiClient,e);return f=T("{name}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json()),d.then(p=>p)}{const u=function Hr(n,e){const t={},o=r(e,["name"]);return null!=o&&s(t,["_url","name"],re(n,o)),t}(t.apiClient,e);return f=T("{name}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json()),d.then(p=>p)}})()}delete(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=function Ur(n,e){const t={},o=r(e,["name"]);return null!=o&&s(t,["_url","name"],re(n,o)),t}(t.apiClient,e);return f=T("{name}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function kr(n){const e={},t=r(n,["sdkHttpResponse"]);return null!=t&&s(e,["sdkHttpResponse"],t),e}(p),m=new Hn;return Object.assign(m,h),m})}{const u=function Dr(n,e){const t={},o=r(e,["name"]);return null!=o&&s(t,["_url","name"],re(n,o)),t}(t.apiClient,e);return f=T("{name}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function Lr(n){const e={},t=r(n,["sdkHttpResponse"]);return null!=t&&s(e,["sdkHttpResponse"],t),e}(p),m=new Hn;return Object.assign(m,h),m})}})()}update(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=function os(n,e){const t={},o=r(e,["name"]);null!=o&&s(t,["_url","name"],re(n,o));const i=r(e,["config"]);return null!=i&&function ns(n,e){const o=r(n,["ttl"]);void 0!==e&&null!=o&&s(e,["ttl"],o);const i=r(n,["expireTime"]);void 0!==e&&null!=i&&s(e,["expireTime"],i)}(i,t),t}(t.apiClient,e);return f=T("{name}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json()),d.then(p=>p)}{const u=function ts(n,e){const t={},o=r(e,["name"]);null!=o&&s(t,["_url","name"],re(n,o));const i=r(e,["config"]);return null!=i&&function es(n,e){const o=r(n,["ttl"]);void 0!==e&&null!=o&&s(e,["ttl"],o);const i=r(n,["expireTime"]);void 0!==e&&null!=i&&s(e,["expireTime"],i)}(i,t),t}(t.apiClient,e);return f=T("{name}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json()),d.then(p=>p)}})()}listInternal(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=function Yr(n){const e={},t=r(n,["config"]);return null!=t&&function Wr(n,e){const o=r(n,["pageSize"]);void 0!==e&&null!=o&&s(e,["_query","pageSize"],o);const i=r(n,["pageToken"]);void 0!==e&&null!=i&&s(e,["_query","pageToken"],i)}(t,e),e}(e);return f=T("cachedContents",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function zr(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["nextPageToken"]);null!=o&&s(e,["nextPageToken"],o);const i=r(n,["cachedContents"]);if(null!=i){let l=i;Array.isArray(l)&&(l=l.map(a=>a)),s(e,["cachedContents"],l)}return e}(p),m=new Bn;return Object.assign(m,h),m})}{const u=function Kr(n){const e={},t=r(n,["config"]);return null!=t&&function $r(n,e){const o=r(n,["pageSize"]);void 0!==e&&null!=o&&s(e,["_query","pageSize"],o);const i=r(n,["pageToken"]);void 0!==e&&null!=i&&s(e,["_query","pageToken"],i)}(t,e),e}(e);return f=T("cachedContents",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function Or(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["nextPageToken"]);null!=o&&s(e,["nextPageToken"],o);const i=r(n,["cachedContents"]);if(null!=i){let l=i;Array.isArray(l)&&(l=l.map(a=>a)),s(e,["cachedContents"],l)}return e}(p),m=new Bn;return Object.assign(m,h),m})}})()}}function we(n,e){var t={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&e.indexOf(o)<0&&(t[o]=n[o]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(n);i<o.length;i++)e.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(n,o[i])&&(t[o[i]]=n[o[i]])}return t}function M(n){return this instanceof M?(this.v=n,this):new M(n)}function j(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,o=t.apply(n,e||[]),l=[];return i=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",function a(m){return function(y){return Promise.resolve(y).then(m,p)}}),i[Symbol.asyncIterator]=function(){return this},i;function d(m,y){o[m]&&(i[m]=function(E){return new Promise(function(_,I){l.push([m,E,_,I])>1||f(m,E)})},y&&(i[m]=y(i[m])))}function f(m,y){try{!function c(m){m.value instanceof M?Promise.resolve(m.value.v).then(u,p):h(l[0][2],m)}(o[m](y))}catch(E){h(l[0][3],E)}}function u(m){f("next",m)}function p(m){f("throw",m)}function h(m,y){m(y),l.shift(),l.length&&f(l[0][0],l[0][1])}}function ee(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function lt(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],o=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&o>=n.length&&(n=void 0),{value:n&&n[o++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(l){t[l]=n[l]&&function(a){return new Promise(function(d,f){!function i(l,a,d,f){Promise.resolve(f).then(function(c){l({value:c,done:d})},a)}(d,f,(a=n[l](a)).done,a.value)})}}}function rs(n){var e;if(null==n.candidates||0===n.candidates.length)return!1;const t=null===(e=n.candidates[0])||void 0===e?void 0:e.content;return void 0!==t&&at(t)}function at(n){if(void 0===n.parts||0===n.parts.length)return!1;for(const e of n.parts)if(void 0===e||0===Object.keys(e).length)return!1;return!0}function ut(n){if(void 0===n||0===n.length)return[];const e=[],t=n.length;let o=0;for(;o<t;)if("user"===n[o].role)e.push(n[o]),o++;else{const i=[];let l=!0;for(;o<t&&"model"===n[o].role;)i.push(n[o]),l&&!at(n[o])&&(l=!1),o++;l?e.push(...i):e.pop()}return e}"function"==typeof SuppressedError&&SuppressedError;class ls{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new as(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class as{constructor(e,t,o,i={},l=[]){this.apiClient=e,this.modelsModule=t,this.model=o,this.config=i,this.history=l,this.sendPromise=Promise.resolve(),function ss(n){if(0!==n.length)for(const e of n)if("user"!==e.role&&"model"!==e.role)throw new Error(`Role must be user or model, but got ${e.role}.`)}(l)}sendMessage(e){var t=this;return(0,g.A)(function*(){var o;yield t.sendPromise;const i=J(e.message),l=t.modelsModule.generateContent({model:t.model,contents:t.getHistory(!0).concat(i),config:null!==(o=e.config)&&void 0!==o?o:t.config});return t.sendPromise=(0,g.A)(function*(){var a,d,f;const c=yield l,u=null===(d=null===(a=c.candidates)||void 0===a?void 0:a[0])||void 0===d?void 0:d.content,p=c.automaticFunctionCallingHistory,h=t.getHistory(!0).length;let m=[];null!=p&&(m=null!==(f=p.slice(h))&&void 0!==f?f:[]),t.recordHistory(i,u?[u]:[],m)})(),yield t.sendPromise.catch(()=>{t.sendPromise=Promise.resolve()}),l})()}sendMessageStream(e){var t=this;return(0,g.A)(function*(){var o;yield t.sendPromise;const i=J(e.message),l=t.modelsModule.generateContentStream({model:t.model,contents:t.getHistory(!0).concat(i),config:null!==(o=e.config)&&void 0!==o?o:t.config});t.sendPromise=l.then(()=>{}).catch(()=>{});const a=yield l;return t.processStreamResponse(a,i)})()}getHistory(e=!1){const t=e?ut(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return j(this,arguments,function*(){var i,l,a,f,c;const u=[];try{for(var m,p=!0,h=ee(e);!(i=(m=yield M(h.next())).done);p=!0){p=!1;const y=m.value;if(rs(y)){const E=null===(c=null===(f=y.candidates)||void 0===f?void 0:f[0])||void 0===c?void 0:c.content;void 0!==E&&u.push(E)}yield yield M(y)}}catch(y){l={error:y}}finally{try{!p&&!i&&(a=h.return)&&(yield M(a.call(h)))}finally{if(l)throw l.error}}this.recordHistory(t,u)})}recordHistory(e,t,o){let i=[];t.length>0&&t.every(l=>void 0!==l.role)?i=t:i.push({role:"model",parts:[]}),o&&o.length>0?this.history.push(...ut(o)):this.history.push(e),this.history.push(...i)}}class xe extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,xe.prototype)}}class ys extends S{constructor(e){var t;super(),t=this,this.apiClient=e,this.list=(0,g.A)(function*(o={}){return new pe(fe.PAGED_ITEM_FILES,i=>t.listInternal(i),yield t.listInternal(o),o)})}upload(e){var t=this;return(0,g.A)(function*(){if(t.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return t.apiClient.uploadFile(e.file,e.config).then(o=>o)})()}download(e){var t=this;return(0,g.A)(function*(){yield t.apiClient.downloadFile(e)})()}listInternal(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=function hs(n){const e={},t=r(n,["config"]);return null!=t&&function ms(n,e){const o=r(n,["pageSize"]);void 0!==e&&null!=o&&s(e,["_query","pageSize"],o);const i=r(n,["pageToken"]);void 0!==e&&null!=i&&s(e,["_query","pageToken"],i)}(t,e),e}(e);return a=T("files",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:c.headers},p})),l.then(c=>{const u=function gs(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["nextPageToken"]);null!=o&&s(e,["nextPageToken"],o);const i=r(n,["files"]);if(null!=i){let l=i;Array.isArray(l)&&(l=l.map(a=>a)),s(e,["files"],l)}return e}(c),p=new Ci;return Object.assign(p,u),p})}})()}createInternal(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=function us(n){const e={},t=r(n,["file"]);return null!=t&&s(e,["file"],t),e}(e);return a=T("upload/v1beta/files",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json()),l.then(c=>{const u=function ds(n){const e={},t=r(n,["sdkHttpResponse"]);return null!=t&&s(e,["sdkHttpResponse"],t),e}(c),p=new Ii;return Object.assign(p,u),p})}})()}get(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=function ps(n){const e={},t=r(n,["name"]);return null!=t&&s(e,["_url","file"],Zn(t)),e}(e);return a=T("files/{file}",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json()),l.then(c=>c)}})()}delete(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=function fs(n){const e={},t=r(n,["name"]);return null!=t&&s(e,["_url","file"],Zn(t)),e}(e);return a=T("files/{file}",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:c.headers},p})),l.then(c=>{const u=function cs(n){const e={},t=r(n,["sdkHttpResponse"]);return null!=t&&s(e,["sdkHttpResponse"],t),e}(c),p=new vi;return Object.assign(p,u),p})}})()}}function De(n){const e={},t=r(n,["data"]);if(null!=t&&s(e,["data"],t),void 0!==r(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const o=r(n,["mimeType"]);return null!=o&&s(e,["mimeType"],o),e}function Ss(n,e){const o=r(n,["generationConfig"]);void 0!==e&&null!=o&&s(e,["setup","generationConfig"],o);const i=r(n,["responseModalities"]);void 0!==e&&null!=i&&s(e,["setup","generationConfig","responseModalities"],i);const l=r(n,["temperature"]);void 0!==e&&null!=l&&s(e,["setup","generationConfig","temperature"],l);const a=r(n,["topP"]);void 0!==e&&null!=a&&s(e,["setup","generationConfig","topP"],a);const d=r(n,["topK"]);void 0!==e&&null!=d&&s(e,["setup","generationConfig","topK"],d);const f=r(n,["maxOutputTokens"]);void 0!==e&&null!=f&&s(e,["setup","generationConfig","maxOutputTokens"],f);const c=r(n,["mediaResolution"]);void 0!==e&&null!=c&&s(e,["setup","generationConfig","mediaResolution"],c);const u=r(n,["seed"]);void 0!==e&&null!=u&&s(e,["setup","generationConfig","seed"],u);const p=r(n,["speechConfig"]);void 0!==e&&null!=p&&s(e,["setup","generationConfig","speechConfig"],en(p));const h=r(n,["thinkingConfig"]);void 0!==e&&null!=h&&s(e,["setup","generationConfig","thinkingConfig"],h);const m=r(n,["enableAffectiveDialog"]);void 0!==e&&null!=m&&s(e,["setup","generationConfig","enableAffectiveDialog"],m);const y=r(n,["systemInstruction"]);void 0!==e&&null!=y&&s(e,["setup","systemInstruction"],function _s(n){const e={},t=r(n,["parts"]);if(null!=t){let i=t;Array.isArray(i)&&(i=i.map(l=>function Ls(n){const e={},t=r(n,["mediaResolution"]);null!=t&&s(e,["mediaResolution"],t);const o=r(n,["codeExecutionResult"]);null!=o&&s(e,["codeExecutionResult"],o);const i=r(n,["executableCode"]);null!=i&&s(e,["executableCode"],i);const l=r(n,["fileData"]);null!=l&&s(e,["fileData"],function Ts(n){const e={};if(void 0!==r(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const t=r(n,["fileUri"]);null!=t&&s(e,["fileUri"],t);const o=r(n,["mimeType"]);return null!=o&&s(e,["mimeType"],o),e}(l));const a=r(n,["functionCall"]);null!=a&&s(e,["functionCall"],function Es(n){const e={},t=r(n,["id"]);null!=t&&s(e,["id"],t);const o=r(n,["args"]);null!=o&&s(e,["args"],o);const i=r(n,["name"]);if(null!=i&&s(e,["name"],i),void 0!==r(n,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==r(n,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return e}(a));const d=r(n,["functionResponse"]);null!=d&&s(e,["functionResponse"],d);const f=r(n,["inlineData"]);null!=f&&s(e,["inlineData"],De(f));const c=r(n,["text"]);null!=c&&s(e,["text"],c);const u=r(n,["thought"]);null!=u&&s(e,["thought"],u);const p=r(n,["thoughtSignature"]);null!=p&&s(e,["thoughtSignature"],p);const h=r(n,["videoMetadata"]);return null!=h&&s(e,["videoMetadata"],h),e}(l))),s(e,["parts"],i)}const o=r(n,["role"]);return null!=o&&s(e,["role"],o),e}(J(y)));const E=r(n,["tools"]);if(void 0!==e&&null!=E){let R=ye(E);Array.isArray(R)&&(R=R.map(U=>function Fs(n){const e={};if(void 0!==r(n,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const t=r(n,["computerUse"]);null!=t&&s(e,["computerUse"],t);const o=r(n,["fileSearch"]);null!=o&&s(e,["fileSearch"],o);const i=r(n,["codeExecution"]);if(null!=i&&s(e,["codeExecution"],i),void 0!==r(n,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=r(n,["functionDeclarations"]);if(null!=l){let u=l;Array.isArray(u)&&(u=u.map(p=>p)),s(e,["functionDeclarations"],u)}const a=r(n,["googleMaps"]);null!=a&&s(e,["googleMaps"],function vs(n){const e={};if(void 0!==r(n,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const t=r(n,["enableWidget"]);return null!=t&&s(e,["enableWidget"],t),e}(a));const d=r(n,["googleSearch"]);null!=d&&s(e,["googleSearch"],function As(n){const e={};if(void 0!==r(n,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==r(n,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=r(n,["timeRangeFilter"]);return null!=t&&s(e,["timeRangeFilter"],t),e}(d));const f=r(n,["googleSearchRetrieval"]);null!=f&&s(e,["googleSearchRetrieval"],f);const c=r(n,["urlContext"]);return null!=c&&s(e,["urlContext"],c),e}(ge(U)))),s(e,["setup","tools"],R)}const _=r(n,["sessionResumption"]);void 0!==e&&null!=_&&s(e,["setup","sessionResumption"],function ks(n){const e={},t=r(n,["handle"]);if(null!=t&&s(e,["handle"],t),void 0!==r(n,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return e}(_));const I=r(n,["inputAudioTranscription"]);void 0!==e&&null!=I&&s(e,["setup","inputAudioTranscription"],I);const C=r(n,["outputAudioTranscription"]);void 0!==e&&null!=C&&s(e,["setup","outputAudioTranscription"],C);const v=r(n,["realtimeInputConfig"]);void 0!==e&&null!=v&&s(e,["setup","realtimeInputConfig"],v);const A=r(n,["contextWindowCompression"]);void 0!==e&&null!=A&&s(e,["setup","contextWindowCompression"],A);const P=r(n,["proactivity"]);if(void 0!==e&&null!=P&&s(e,["setup","proactivity"],P),void 0!==r(n,["explicitVadSignal"]))throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return{}}function xs(n){const e={},t=r(n,["media"]);if(null!=t){let c=$n(t);Array.isArray(c)&&(c=c.map(u=>De(u))),s(e,["mediaChunks"],c)}const o=r(n,["audio"]);null!=o&&s(e,["audio"],De(Kn(o)));const i=r(n,["audioStreamEnd"]);null!=i&&s(e,["audioStreamEnd"],i);const l=r(n,["video"]);null!=l&&s(e,["video"],De(Wn(l)));const a=r(n,["text"]);null!=a&&s(e,["text"],a);const d=r(n,["activityStart"]);null!=d&&s(e,["activityStart"],d);const f=r(n,["activityEnd"]);return null!=f&&s(e,["activityEnd"],f),e}function Ds(n){const e={},t=r(n,["media"]);if(null!=t){let c=$n(t);Array.isArray(c)&&(c=c.map(u=>u)),s(e,["mediaChunks"],c)}const o=r(n,["audio"]);null!=o&&s(e,["audio"],Kn(o));const i=r(n,["audioStreamEnd"]);null!=i&&s(e,["audioStreamEnd"],i);const l=r(n,["video"]);null!=l&&s(e,["video"],Wn(l));const a=r(n,["text"]);null!=a&&s(e,["text"],a);const d=r(n,["activityStart"]);null!=d&&s(e,["activityStart"],d);const f=r(n,["activityEnd"]);return null!=f&&s(e,["activityEnd"],f),e}function Ue(n){const e={},t=r(n,["parts"]);if(null!=t){let i=t;Array.isArray(i)&&(i=i.map(l=>function ea(n){const e={},t=r(n,["mediaResolution"]);null!=t&&s(e,["mediaResolution"],t);const o=r(n,["codeExecutionResult"]);null!=o&&s(e,["codeExecutionResult"],o);const i=r(n,["executableCode"]);null!=i&&s(e,["executableCode"],i);const l=r(n,["fileData"]);null!=l&&s(e,["fileData"],function pl(n){const e={};if(void 0!==r(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const t=r(n,["fileUri"]);null!=t&&s(e,["fileUri"],t);const o=r(n,["mimeType"]);return null!=o&&s(e,["mimeType"],o),e}(l));const a=r(n,["functionCall"]);null!=a&&s(e,["functionCall"],function ml(n){const e={},t=r(n,["id"]);null!=t&&s(e,["id"],t);const o=r(n,["args"]);null!=o&&s(e,["args"],o);const i=r(n,["name"]);if(null!=i&&s(e,["name"],i),void 0!==r(n,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==r(n,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return e}(a));const d=r(n,["functionResponse"]);null!=d&&s(e,["functionResponse"],d);const f=r(n,["inlineData"]);null!=f&&s(e,["inlineData"],function qs(n){const e={},t=r(n,["data"]);if(null!=t&&s(e,["data"],t),void 0!==r(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const o=r(n,["mimeType"]);return null!=o&&s(e,["mimeType"],o),e}(f));const c=r(n,["text"]);null!=c&&s(e,["text"],c);const u=r(n,["thought"]);null!=u&&s(e,["thought"],u);const p=r(n,["thoughtSignature"]);null!=p&&s(e,["thoughtSignature"],p);const h=r(n,["videoMetadata"]);return null!=h&&s(e,["videoMetadata"],h),e}(l))),s(e,["parts"],i)}const o=r(n,["role"]);return null!=o&&s(e,["role"],o),e}function dt(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["_url","model"],L(n,o));const i=r(e,["contents"]);if(null!=i){let a=Q(i);Array.isArray(a)&&(a=a.map(d=>Ue(d))),s(t,["contents"],a)}const l=r(e,["config"]);return null!=l&&s(t,["generationConfig"],function yl(n,e,t){const o={},i=r(e,["systemInstruction"]);void 0!==t&&null!=i&&s(t,["systemInstruction"],Ue(J(i)));const l=r(e,["temperature"]);null!=l&&s(o,["temperature"],l);const a=r(e,["topP"]);null!=a&&s(o,["topP"],a);const d=r(e,["topK"]);null!=d&&s(o,["topK"],d);const f=r(e,["candidateCount"]);null!=f&&s(o,["candidateCount"],f);const c=r(e,["maxOutputTokens"]);null!=c&&s(o,["maxOutputTokens"],c);const u=r(e,["stopSequences"]);null!=u&&s(o,["stopSequences"],u);const p=r(e,["responseLogprobs"]);null!=p&&s(o,["responseLogprobs"],p);const h=r(e,["logprobs"]);null!=h&&s(o,["logprobs"],h);const m=r(e,["presencePenalty"]);null!=m&&s(o,["presencePenalty"],m);const y=r(e,["frequencyPenalty"]);null!=y&&s(o,["frequencyPenalty"],y);const E=r(e,["seed"]);null!=E&&s(o,["seed"],E);const _=r(e,["responseMimeType"]);null!=_&&s(o,["responseMimeType"],_);const I=r(e,["responseSchema"]);null!=I&&s(o,["responseSchema"],Ze(I));const C=r(e,["responseJsonSchema"]);if(null!=C&&s(o,["responseJsonSchema"],C),void 0!==r(e,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==r(e,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const v=r(e,["safetySettings"]);if(void 0!==t&&null!=v){let G=v;Array.isArray(G)&&(G=G.map(ie=>function la(n){const e={},t=r(n,["category"]);if(null!=t&&s(e,["category"],t),void 0!==r(n,["method"]))throw new Error("method parameter is not supported in Gemini API.");const o=r(n,["threshold"]);return null!=o&&s(e,["threshold"],o),e}(ie))),s(t,["safetySettings"],G)}const A=r(e,["tools"]);if(void 0!==t&&null!=A){let G=ye(A);Array.isArray(G)&&(G=G.map(ie=>function ma(n){const e={};if(void 0!==r(n,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const t=r(n,["computerUse"]);null!=t&&s(e,["computerUse"],t);const o=r(n,["fileSearch"]);null!=o&&s(e,["fileSearch"],o);const i=r(n,["codeExecution"]);if(null!=i&&s(e,["codeExecution"],i),void 0!==r(n,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=r(n,["functionDeclarations"]);if(null!=l){let u=l;Array.isArray(u)&&(u=u.map(p=>p)),s(e,["functionDeclarations"],u)}const a=r(n,["googleMaps"]);null!=a&&s(e,["googleMaps"],function bl(n){const e={};if(void 0!==r(n,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const t=r(n,["enableWidget"]);return null!=t&&s(e,["enableWidget"],t),e}(a));const d=r(n,["googleSearch"]);null!=d&&s(e,["googleSearch"],function Jl(n){const e={};if(void 0!==r(n,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==r(n,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=r(n,["timeRangeFilter"]);return null!=t&&s(e,["timeRangeFilter"],t),e}(d));const f=r(n,["googleSearchRetrieval"]);null!=f&&s(e,["googleSearchRetrieval"],f);const c=r(n,["urlContext"]);return null!=c&&s(e,["urlContext"],c),e}(ge(ie)))),s(t,["tools"],G)}const P=r(e,["toolConfig"]);if(void 0!==t&&null!=P&&s(t,["toolConfig"],function pa(n){const e={},t=r(n,["retrievalConfig"]);null!=t&&s(e,["retrievalConfig"],t);const o=r(n,["functionCallingConfig"]);return null!=o&&s(e,["functionCallingConfig"],function hl(n){const e={},t=r(n,["allowedFunctionNames"]);null!=t&&s(e,["allowedFunctionNames"],t);const o=r(n,["mode"]);if(null!=o&&s(e,["mode"],o),void 0!==r(n,["streamFunctionCallArguments"]))throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}(o)),e}(P)),void 0!==r(e,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const R=r(e,["cachedContent"]);void 0!==t&&null!=R&&s(t,["cachedContent"],re(n,R));const U=r(e,["responseModalities"]);null!=U&&s(o,["responseModalities"],U);const F=r(e,["mediaResolution"]);null!=F&&s(o,["mediaResolution"],F);const H=r(e,["speechConfig"]);if(null!=H&&s(o,["speechConfig"],je(H)),void 0!==r(e,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=r(e,["thinkingConfig"]);null!=N&&s(o,["thinkingConfig"],N);const D=r(e,["imageConfig"]);null!=D&&s(o,["imageConfig"],function $l(n){const e={},t=r(n,["aspectRatio"]);null!=t&&s(e,["aspectRatio"],t);const o=r(n,["imageSize"]);if(null!=o&&s(e,["imageSize"],o),void 0!==r(n,["personGeneration"]))throw new Error("personGeneration parameter is not supported in Gemini API.");if(void 0!==r(n,["outputMimeType"]))throw new Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==r(n,["outputCompressionQuality"]))throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}(D));const Y=r(e,["enableEnhancedCivicAnswers"]);return null!=Y&&s(o,["enableEnhancedCivicAnswers"],Y),o}(n,l,t)),t}function ft(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["_url","model"],L(n,o));const i=r(e,["contents"]);if(null!=i){let a=Q(i);Array.isArray(a)&&(a=a.map(d=>d)),s(t,["contents"],a)}const l=r(e,["config"]);return null!=l&&s(t,["generationConfig"],function _l(n,e,t){const o={},i=r(e,["systemInstruction"]);void 0!==t&&null!=i&&s(t,["systemInstruction"],J(i));const l=r(e,["temperature"]);null!=l&&s(o,["temperature"],l);const a=r(e,["topP"]);null!=a&&s(o,["topP"],a);const d=r(e,["topK"]);null!=d&&s(o,["topK"],d);const f=r(e,["candidateCount"]);null!=f&&s(o,["candidateCount"],f);const c=r(e,["maxOutputTokens"]);null!=c&&s(o,["maxOutputTokens"],c);const u=r(e,["stopSequences"]);null!=u&&s(o,["stopSequences"],u);const p=r(e,["responseLogprobs"]);null!=p&&s(o,["responseLogprobs"],p);const h=r(e,["logprobs"]);null!=h&&s(o,["logprobs"],h);const m=r(e,["presencePenalty"]);null!=m&&s(o,["presencePenalty"],m);const y=r(e,["frequencyPenalty"]);null!=y&&s(o,["frequencyPenalty"],y);const E=r(e,["seed"]);null!=E&&s(o,["seed"],E);const _=r(e,["responseMimeType"]);null!=_&&s(o,["responseMimeType"],_);const I=r(e,["responseSchema"]);null!=I&&s(o,["responseSchema"],Ze(I));const C=r(e,["responseJsonSchema"]);null!=C&&s(o,["responseJsonSchema"],C);const v=r(e,["routingConfig"]);null!=v&&s(o,["routingConfig"],v);const A=r(e,["modelSelectionConfig"]);null!=A&&s(o,["modelConfig"],A);const P=r(e,["safetySettings"]);if(void 0!==t&&null!=P){let se=P;Array.isArray(se)&&(se=se.map(Pn=>Pn)),s(t,["safetySettings"],se)}const R=r(e,["tools"]);if(void 0!==t&&null!=R){let se=ye(R);Array.isArray(se)&&(se=se.map(Pn=>yt(ge(Pn)))),s(t,["tools"],se)}const U=r(e,["toolConfig"]);void 0!==t&&null!=U&&s(t,["toolConfig"],U);const F=r(e,["labels"]);void 0!==t&&null!=F&&s(t,["labels"],F);const H=r(e,["cachedContent"]);void 0!==t&&null!=H&&s(t,["cachedContent"],re(n,H));const N=r(e,["responseModalities"]);null!=N&&s(o,["responseModalities"],N);const D=r(e,["mediaResolution"]);null!=D&&s(o,["mediaResolution"],D);const Y=r(e,["speechConfig"]);null!=Y&&s(o,["speechConfig"],je(Y));const G=r(e,["audioTimestamp"]);null!=G&&s(o,["audioTimestamp"],G);const ie=r(e,["thinkingConfig"]);null!=ie&&s(o,["thinkingConfig"],ie);const ro=r(e,["imageConfig"]);if(null!=ro&&s(o,["imageConfig"],function Wl(n){const e={},t=r(n,["aspectRatio"]);null!=t&&s(e,["aspectRatio"],t);const o=r(n,["imageSize"]);null!=o&&s(e,["imageSize"],o);const i=r(n,["personGeneration"]);null!=i&&s(e,["personGeneration"],i);const l=r(n,["outputMimeType"]);null!=l&&s(e,["imageOutputOptions","mimeType"],l);const a=r(n,["outputCompressionQuality"]);return null!=a&&s(e,["imageOutputOptions","compressionQuality"],a),e}(ro)),void 0!==r(e,["enableEnhancedCivicAnswers"]))throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return o}(n,l,t)),t}function ct(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["candidates"]);if(null!=o){let f=o;Array.isArray(f)&&(f=f.map(c=>function Hs(n){const e={},t=r(n,["content"]);null!=t&&s(e,["content"],t);const o=r(n,["citationMetadata"]);null!=o&&s(e,["citationMetadata"],function Bs(n){const e={},t=r(n,["citationSources"]);if(null!=t){let o=t;Array.isArray(o)&&(o=o.map(i=>i)),s(e,["citations"],o)}return e}(o));const i=r(n,["tokenCount"]);null!=i&&s(e,["tokenCount"],i);const l=r(n,["finishReason"]);null!=l&&s(e,["finishReason"],l);const a=r(n,["avgLogprobs"]);null!=a&&s(e,["avgLogprobs"],a);const d=r(n,["groundingMetadata"]);null!=d&&s(e,["groundingMetadata"],d);const f=r(n,["index"]);null!=f&&s(e,["index"],f);const c=r(n,["logprobsResult"]);null!=c&&s(e,["logprobsResult"],c);const u=r(n,["safetyRatings"]);if(null!=u){let h=u;Array.isArray(h)&&(h=h.map(m=>m)),s(e,["safetyRatings"],h)}const p=r(n,["urlContextMetadata"]);return null!=p&&s(e,["urlContextMetadata"],p),e}(c))),s(e,["candidates"],f)}const i=r(n,["modelVersion"]);null!=i&&s(e,["modelVersion"],i);const l=r(n,["promptFeedback"]);null!=l&&s(e,["promptFeedback"],l);const a=r(n,["responseId"]);null!=a&&s(e,["responseId"],a);const d=r(n,["usageMetadata"]);return null!=d&&s(e,["usageMetadata"],d),e}function pt(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["candidates"]);if(null!=o){let c=o;Array.isArray(c)&&(c=c.map(u=>u)),s(e,["candidates"],c)}const i=r(n,["createTime"]);null!=i&&s(e,["createTime"],i);const l=r(n,["modelVersion"]);null!=l&&s(e,["modelVersion"],l);const a=r(n,["promptFeedback"]);null!=a&&s(e,["promptFeedback"],a);const d=r(n,["responseId"]);null!=d&&s(e,["responseId"],d);const f=r(n,["usageMetadata"]);return null!=f&&s(e,["usageMetadata"],f),e}function Nl(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["_url","model"],L(n,o));const i=r(e,["prompt"]);null!=i&&s(t,["instances[0]","prompt"],i);const l=r(e,["image"]);null!=l&&s(t,["instances[0]","image"],ke(l));const a=r(e,["video"]);null!=a&&s(t,["instances[0]","video"],_t(a));const d=r(e,["source"]);null!=d&&function Ul(n,e){const o=r(n,["prompt"]);void 0!==e&&null!=o&&s(e,["instances[0]","prompt"],o);const i=r(n,["image"]);void 0!==e&&null!=i&&s(e,["instances[0]","image"],ke(i));const l=r(n,["video"]);void 0!==e&&null!=l&&s(e,["instances[0]","video"],_t(l))}(d,t);const f=r(e,["config"]);return null!=f&&function Sl(n,e){const o=r(n,["numberOfVideos"]);if(void 0!==e&&null!=o&&s(e,["parameters","sampleCount"],o),void 0!==r(n,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==r(n,["fps"]))throw new Error("fps parameter is not supported in Gemini API.");const i=r(n,["durationSeconds"]);if(void 0!==e&&null!=i&&s(e,["parameters","durationSeconds"],i),void 0!==r(n,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const l=r(n,["aspectRatio"]);void 0!==e&&null!=l&&s(e,["parameters","aspectRatio"],l);const a=r(n,["resolution"]);void 0!==e&&null!=a&&s(e,["parameters","resolution"],a);const d=r(n,["personGeneration"]);if(void 0!==e&&null!=d&&s(e,["parameters","personGeneration"],d),void 0!==r(n,["pubsubTopic"]))throw new Error("pubsubTopic parameter is not supported in Gemini API.");const f=r(n,["negativePrompt"]);void 0!==e&&null!=f&&s(e,["parameters","negativePrompt"],f);const c=r(n,["enhancePrompt"]);if(void 0!==e&&null!=c&&s(e,["parameters","enhancePrompt"],c),void 0!==r(n,["generateAudio"]))throw new Error("generateAudio parameter is not supported in Gemini API.");const u=r(n,["lastFrame"]);void 0!==e&&null!=u&&s(e,["instances[0]","lastFrame"],ke(u));const p=r(n,["referenceImages"]);if(void 0!==e&&null!=p){let h=p;Array.isArray(h)&&(h=h.map(m=>function Pa(n){const e={},t=r(n,["image"]);null!=t&&s(e,["image"],ke(t));const o=r(n,["referenceType"]);return null!=o&&s(e,["referenceType"],o),e}(m))),s(e,["instances[0]","referenceImages"],h)}if(void 0!==r(n,["mask"]))throw new Error("mask parameter is not supported in Gemini API.");if(void 0!==r(n,["compressionQuality"]))throw new Error("compressionQuality parameter is not supported in Gemini API.");return{}}(f,t),t}function wl(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["_url","model"],L(n,o));const i=r(e,["prompt"]);null!=i&&s(t,["instances[0]","prompt"],i);const l=r(e,["image"]);null!=l&&s(t,["instances[0]","image"],ne(l));const a=r(e,["video"]);null!=a&&s(t,["instances[0]","video"],Tt(a));const d=r(e,["source"]);null!=d&&function Ll(n,e){const o=r(n,["prompt"]);void 0!==e&&null!=o&&s(e,["instances[0]","prompt"],o);const i=r(n,["image"]);void 0!==e&&null!=i&&s(e,["instances[0]","image"],ne(i));const l=r(n,["video"]);void 0!==e&&null!=l&&s(e,["instances[0]","video"],Tt(l))}(d,t);const f=r(e,["config"]);return null!=f&&function Rl(n,e){const o=r(n,["numberOfVideos"]);void 0!==e&&null!=o&&s(e,["parameters","sampleCount"],o);const i=r(n,["outputGcsUri"]);void 0!==e&&null!=i&&s(e,["parameters","storageUri"],i);const l=r(n,["fps"]);void 0!==e&&null!=l&&s(e,["parameters","fps"],l);const a=r(n,["durationSeconds"]);void 0!==e&&null!=a&&s(e,["parameters","durationSeconds"],a);const d=r(n,["seed"]);void 0!==e&&null!=d&&s(e,["parameters","seed"],d);const f=r(n,["aspectRatio"]);void 0!==e&&null!=f&&s(e,["parameters","aspectRatio"],f);const c=r(n,["resolution"]);void 0!==e&&null!=c&&s(e,["parameters","resolution"],c);const u=r(n,["personGeneration"]);void 0!==e&&null!=u&&s(e,["parameters","personGeneration"],u);const p=r(n,["pubsubTopic"]);void 0!==e&&null!=p&&s(e,["parameters","pubsubTopic"],p);const h=r(n,["negativePrompt"]);void 0!==e&&null!=h&&s(e,["parameters","negativePrompt"],h);const m=r(n,["enhancePrompt"]);void 0!==e&&null!=m&&s(e,["parameters","enhancePrompt"],m);const y=r(n,["generateAudio"]);void 0!==e&&null!=y&&s(e,["parameters","generateAudio"],y);const E=r(n,["lastFrame"]);void 0!==e&&null!=E&&s(e,["instances[0]","lastFrame"],ne(E));const _=r(n,["referenceImages"]);if(void 0!==e&&null!=_){let v=_;Array.isArray(v)&&(v=v.map(A=>function Ma(n){const e={},t=r(n,["image"]);null!=t&&s(e,["image"],ne(t));const o=r(n,["referenceType"]);return null!=o&&s(e,["referenceType"],o),e}(A))),s(e,["instances[0]","referenceImages"],v)}const I=r(n,["mask"]);void 0!==e&&null!=I&&s(e,["instances[0]","mask"],function Ra(n){const e={},t=r(n,["image"]);null!=t&&s(e,["_self"],ne(t));const o=r(n,["maskMode"]);return null!=o&&s(e,["maskMode"],o),e}(I));const C=r(n,["compressionQuality"]);return void 0!==e&&null!=C&&s(e,["parameters","compressionQuality"],C),{}}(f,t),t}function Le(n){const e={},t=r(n,["_self"]);null!=t&&s(e,["image"],mt(t));const o=r(n,["raiFilteredReason"]);null!=o&&s(e,["raiFilteredReason"],o);const i=r(n,["_self"]);null!=i&&s(e,["safetyAttributes"],gt(i));const l=r(n,["prompt"]);return null!=l&&s(e,["enhancedPrompt"],l),e}function mt(n){const e={},t=r(n,["gcsUri"]);null!=t&&s(e,["gcsUri"],t);const o=r(n,["bytesBase64Encoded"]);null!=o&&s(e,["imageBytes"],de(o));const i=r(n,["mimeType"]);return null!=i&&s(e,["mimeType"],i),e}function ke(n){const e={};if(void 0!==r(n,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");const t=r(n,["imageBytes"]);null!=t&&s(e,["bytesBase64Encoded"],de(t));const o=r(n,["mimeType"]);return null!=o&&s(e,["mimeType"],o),e}function ne(n){const e={},t=r(n,["gcsUri"]);null!=t&&s(e,["gcsUri"],t);const o=r(n,["imageBytes"]);null!=o&&s(e,["bytesBase64Encoded"],de(o));const i=r(n,["mimeType"]);return null!=i&&s(e,["mimeType"],i),e}function tn(n){const e={},t=r(n,["name"]);null!=t&&s(e,["name"],t);const o=r(n,["displayName"]);null!=o&&s(e,["displayName"],o);const i=r(n,["description"]);null!=i&&s(e,["description"],i);const l=r(n,["version"]);null!=l&&s(e,["version"],l);const a=r(n,["_self"]);null!=a&&s(e,["tunedModelInfo"],function ha(n){const e={},t=r(n,["baseModel"]);null!=t&&s(e,["baseModel"],t);const o=r(n,["createTime"]);null!=o&&s(e,["createTime"],o);const i=r(n,["updateTime"]);return null!=i&&s(e,["updateTime"],i),e}(a));const d=r(n,["inputTokenLimit"]);null!=d&&s(e,["inputTokenLimit"],d);const f=r(n,["outputTokenLimit"]);null!=f&&s(e,["outputTokenLimit"],f);const c=r(n,["supportedGenerationMethods"]);null!=c&&s(e,["supportedActions"],c);const u=r(n,["temperature"]);null!=u&&s(e,["temperature"],u);const p=r(n,["maxTemperature"]);null!=p&&s(e,["maxTemperature"],p);const h=r(n,["topP"]);null!=h&&s(e,["topP"],h);const m=r(n,["topK"]);null!=m&&s(e,["topK"],m);const y=r(n,["thinking"]);return null!=y&&s(e,["thinking"],y),e}function on(n){const e={},t=r(n,["name"]);null!=t&&s(e,["name"],t);const o=r(n,["displayName"]);null!=o&&s(e,["displayName"],o);const i=r(n,["description"]);null!=i&&s(e,["description"],i);const l=r(n,["versionId"]);null!=l&&s(e,["version"],l);const a=r(n,["deployedModels"]);if(null!=a){let p=a;Array.isArray(p)&&(p=p.map(h=>function cl(n){const e={},t=r(n,["endpoint"]);null!=t&&s(e,["name"],t);const o=r(n,["deployedModelId"]);return null!=o&&s(e,["deployedModelId"],o),e}(h))),s(e,["endpoints"],p)}const d=r(n,["labels"]);null!=d&&s(e,["labels"],d);const f=r(n,["_self"]);null!=f&&s(e,["tunedModelInfo"],function ga(n){const e={},t=r(n,["labels","google-vertex-llm-tuning-base-model-id"]);null!=t&&s(e,["baseModel"],t);const o=r(n,["createTime"]);null!=o&&s(e,["createTime"],o);const i=r(n,["updateTime"]);return null!=i&&s(e,["updateTime"],i),e}(f));const c=r(n,["defaultCheckpointId"]);null!=c&&s(e,["defaultCheckpointId"],c);const u=r(n,["checkpoints"]);if(null!=u){let p=u;Array.isArray(p)&&(p=p.map(h=>h)),s(e,["checkpoints"],p)}return e}function ht(n){const e={},t=r(n,["safetyAttributes","categories"]);null!=t&&s(e,["categories"],t);const o=r(n,["safetyAttributes","scores"]);null!=o&&s(e,["scores"],o);const i=r(n,["contentType"]);return null!=i&&s(e,["contentType"],i),e}function gt(n){const e={},t=r(n,["safetyAttributes","categories"]);null!=t&&s(e,["categories"],t);const o=r(n,["safetyAttributes","scores"]);null!=o&&s(e,["scores"],o);const i=r(n,["contentType"]);return null!=i&&s(e,["contentType"],i),e}function yt(n){const e={},t=r(n,["retrieval"]);null!=t&&s(e,["retrieval"],t);const o=r(n,["computerUse"]);if(null!=o&&s(e,["computerUse"],o),void 0!==r(n,["fileSearch"]))throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=r(n,["codeExecution"]);null!=i&&s(e,["codeExecution"],i);const l=r(n,["enterpriseWebSearch"]);null!=l&&s(e,["enterpriseWebSearch"],l);const a=r(n,["functionDeclarations"]);if(null!=a){let p=a;Array.isArray(p)&&(p=p.map(h=>function gl(n){const e={},t=r(n,["description"]);null!=t&&s(e,["description"],t);const o=r(n,["name"]);null!=o&&s(e,["name"],o);const i=r(n,["parameters"]);null!=i&&s(e,["parameters"],i);const l=r(n,["parametersJsonSchema"]);null!=l&&s(e,["parametersJsonSchema"],l);const a=r(n,["response"]);null!=a&&s(e,["response"],a);const d=r(n,["responseJsonSchema"]);if(null!=d&&s(e,["responseJsonSchema"],d),void 0!==r(n,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");return e}(h))),s(e,["functionDeclarations"],p)}const d=r(n,["googleMaps"]);null!=d&&s(e,["googleMaps"],d);const f=r(n,["googleSearch"]);null!=f&&s(e,["googleSearch"],f);const c=r(n,["googleSearchRetrieval"]);null!=c&&s(e,["googleSearchRetrieval"],c);const u=r(n,["urlContext"]);return null!=u&&s(e,["urlContext"],u),e}function _t(n){const e={},t=r(n,["uri"]);null!=t&&s(e,["uri"],t);const o=r(n,["videoBytes"]);null!=o&&s(e,["encodedVideo"],de(o));const i=r(n,["mimeType"]);return null!=i&&s(e,["encoding"],i),e}function Tt(n){const e={},t=r(n,["uri"]);null!=t&&s(e,["gcsUri"],t);const o=r(n,["videoBytes"]);null!=o&&s(e,["bytesBase64Encoded"],de(o));const i=r(n,["mimeType"]);return null!=i&&s(e,["mimeType"],i),e}function Et(n,e){const o=r(n,["mimeType"]);void 0!==e&&null!=o&&s(e,["mimeType"],o);const i=r(n,["displayName"]);void 0!==e&&null!=i&&s(e,["displayName"],i);const l=r(n,["customMetadata"]);if(void 0!==e&&null!=l){let d=l;Array.isArray(d)&&(d=d.map(f=>f)),s(e,["customMetadata"],d)}const a=r(n,["chunkingConfig"]);return void 0!==e&&null!=a&&s(e,["chunkingConfig"],a),{}}const rn="x-goog-api-client";class za{constructor(e){var t,o;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=null!==(t=this.clientOptions.apiVersion)&&void 0!==t?t:"v1beta1",i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=null!==(o=this.clientOptions.apiVersion)&&void 0!==o?o:"v1beta",i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:(this.clientOptions.project=void 0,this.clientOptions.location=void 0)}isVertexAI(){var e;return null!==(e=this.clientOptions.vertexai)&&void 0!==e&&e}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getAuthHeaders(){var e=this;return(0,g.A)(function*(){const t=new Headers;return yield e.clientOptions.auth.addAuthHeaders(t),t})()}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||void 0===e.baseUrl||void 0===e.apiVersion)throw new Error("HTTP options are not correctly set.");const o=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&""!==e.apiVersion&&o.push(e.apiVersion),o.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol="http:"==t.protocol?"ws":"wss",t.toString()}setBaseUrl(e){if(!this.clientOptions.httpOptions)throw new Error("HTTP options are not correctly set.");this.clientOptions.httpOptions.baseUrl=e}constructUrl(e,t,o){const i=[this.getRequestUrlInternal(t)];return o&&i.push(this.getBaseResourcePath()),""!==e&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||"GET"===e.httpMethod&&e.path.startsWith("publishers/google/models"))}request(e){var t=this;return(0,g.A)(function*(){let o=t.clientOptions.httpOptions;e.httpOptions&&(o=t.patchHttpOptions(t.clientOptions.httpOptions,e.httpOptions));const i=t.shouldPrependVertexProjectPath(e),l=t.constructUrl(e.path,o,i);if(e.queryParams)for(const[d,f]of Object.entries(e.queryParams))l.searchParams.append(d,String(f));let a={};if("GET"===e.httpMethod){if(e.body&&"{}"!==e.body)throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=yield t.includeExtraHttpOptionsToRequestInit(a,o,l.toString(),e.abortSignal),t.unaryApiCall(l,a,e.httpMethod)})()}patchHttpOptions(e,t){const o=JSON.parse(JSON.stringify(e));for(const[i,l]of Object.entries(t))"object"==typeof l?o[i]=Object.assign(Object.assign({},o[i]),l):void 0!==l&&(o[i]=l);return o}requestStream(e){var t=this;return(0,g.A)(function*(){let o=t.clientOptions.httpOptions;e.httpOptions&&(o=t.patchHttpOptions(t.clientOptions.httpOptions,e.httpOptions));const i=t.shouldPrependVertexProjectPath(e),l=t.constructUrl(e.path,o,i);(!l.searchParams.has("alt")||"sse"!==l.searchParams.get("alt"))&&l.searchParams.set("alt","sse");let a={};return a.body=e.body,a=yield t.includeExtraHttpOptionsToRequestInit(a,o,l.toString(),e.abortSignal),t.streamApiCall(l,a,e.httpMethod)})()}includeExtraHttpOptionsToRequestInit(e,t,o,i){var l=this;return(0,g.A)(function*(){if(t&&t.timeout||i){const a=new AbortController,d=a.signal;if(t.timeout&&t?.timeout>0){const f=setTimeout(()=>a.abort(),t.timeout);f&&"function"==typeof f.unref&&f.unref()}i&&i.addEventListener("abort",()=>{a.abort()}),e.signal=d}return t&&null!==t.extraBody&&function Xa(n,e){if(!e||0===Object.keys(e).length)return;if(n.body instanceof Blob)return void console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");let t={};if("string"==typeof n.body&&n.body.length>0)try{const l=JSON.parse(n.body);if("object"!=typeof l||null===l||Array.isArray(l))return void console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");t=l}catch{return void console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.")}const i=function o(l,a){const d=Object.assign({},l);for(const f in a)if(Object.prototype.hasOwnProperty.call(a,f)){const c=a[f],u=d[f];c&&"object"==typeof c&&!Array.isArray(c)&&u&&"object"==typeof u&&!Array.isArray(u)?d[f]=o(u,c):(u&&c&&typeof u!=typeof c&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${f}". Original type: ${typeof u}, New type: ${typeof c}. Overwriting.`),d[f]=c)}return d}(t,e);n.body=JSON.stringify(i)}(e,t.extraBody),e.headers=yield l.getHeadersInternal(t,o),e})()}unaryApiCall(e,t,o){var i=this;return(0,g.A)(function*(){return i.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:o})).then(function(){var l=(0,g.A)(function*(a){return yield Ct(a),new Ye(a)});return function(a){return l.apply(this,arguments)}}()).catch(l=>{throw l instanceof Error?l:new Error(JSON.stringify(l))})})()}streamApiCall(e,t,o){var i=this;return(0,g.A)(function*(){return i.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:o})).then(function(){var l=(0,g.A)(function*(a){return yield Ct(a),i.processStreamResponse(a)});return function(a){return l.apply(this,arguments)}}()).catch(l=>{throw l instanceof Error?l:new Error(JSON.stringify(l))})})()}processStreamResponse(e){return j(this,arguments,function*(){var o;const i=null===(o=e?.body)||void 0===o?void 0:o.getReader(),l=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let a="";const d="data:",f=["\n\n","\r\r","\r\n\r\n"];for(;;){const{done:c,value:u}=yield M(i.read());if(c){if(a.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const p=l.decode(u,{stream:!0});try{const y=JSON.parse(p);if("error"in y){const E=JSON.parse(JSON.stringify(y.error)),I=E.code,C=`got status: ${E.status}. ${JSON.stringify(y)}`;if(I>=400&&I<600)throw new xe({message:C,status:I})}}catch(y){if("ApiError"===y.name)throw y}a+=p;let h=-1,m=0;for(;;){h=-1,m=0;for(const _ of f){const I=a.indexOf(_);-1!==I&&(-1===h||I<h)&&(h=I,m=_.length)}if(-1===h)break;const y=a.substring(0,h);a=a.substring(h+m);const E=y.trim();if(E.startsWith(d)){const _=E.substring(d.length).trim();try{const I=new Response(_,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield M(new Ye(I))}catch(I){throw new Error(`exception parsing stream chunk ${_}. ${I}`)}}}}}finally{i.releaseLock()}})}apiCall(e,t){return(0,g.A)(function*(){return fetch(e,t).catch(o=>{throw new Error(`exception ${o} sending request`)})})()}getDefaultHeaders(){const e={},t="google-genai-sdk/1.35.0 "+this.clientOptions.userAgentExtra;return e["User-Agent"]=t,e[rn]=t,e["Content-Type"]="application/json",e}getHeadersInternal(e,t){var o=this;return(0,g.A)(function*(){const i=new Headers;if(e&&e.headers){for(const[l,a]of Object.entries(e.headers))i.append(l,a);e.timeout&&e.timeout>0&&i.append("X-Server-Timeout",String(Math.ceil(e.timeout/1e3)))}return yield o.clientOptions.auth.addAuthHeaders(i,t),i})()}getFileName(e){var t;let o="";return"string"==typeof e&&(o=e.replace(/[/\\]+$/,""),o=null!==(t=o.split(/[/\\]/).pop())&&void 0!==t?t:""),o}uploadFile(e,t){var o=this;return(0,g.A)(function*(){var i;const l={};null!=t&&(l.mimeType=t.mimeType,l.name=t.name,l.displayName=t.displayName),l.name&&!l.name.startsWith("files/")&&(l.name=`files/${l.name}`);const a=o.clientOptions.uploader,d=yield a.stat(e);l.sizeBytes=String(d.size);const f=null!==(i=t?.mimeType)&&void 0!==i?i:d.type;if(void 0===f||""===f)throw new Error("Can not determine mimeType. Please provide mimeType in the config.");l.mimeType=f;const c={file:l},u=o.getFileName(e),p=T("upload/v1beta/files",c._url),h=yield o.fetchUploadUrl(p,l.sizeBytes,l.mimeType,u,c,t?.httpOptions);return a.upload(e,h,o)})()}uploadFileToFileSearchStore(e,t,o){var i=this;return(0,g.A)(function*(){var l;const a=i.clientOptions.uploader,d=yield a.stat(t),f=String(d.size),c=null!==(l=o?.mimeType)&&void 0!==l?l:d.type;if(void 0===c||""===c)throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const u=`upload/v1beta/${e}:uploadToFileSearchStore`,p=i.getFileName(t),h={};null!=o&&Et(o,h);const m=yield i.fetchUploadUrl(u,f,c,p,h,o?.httpOptions);return a.uploadToFileSearchStore(t,m,i)})()}downloadFile(e){var t=this;return(0,g.A)(function*(){yield t.clientOptions.downloader.download(e,t)})()}fetchUploadUrl(e,t,o,i,l,a){var d=this;return(0,g.A)(function*(){var f;let c={};c=a||{apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${o}`},i?{"X-Goog-Upload-File-Name":i}:{})};const u=yield d.request({path:e,body:JSON.stringify(l),httpMethod:"POST",httpOptions:c});if(!u||!u?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const p=null===(f=u?.headers)||void 0===f?void 0:f["x-goog-upload-url"];if(void 0===p)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return p})()}}function Ct(n){return sn.apply(this,arguments)}function sn(){return(sn=(0,g.A)(function*(n){var e;if(void 0===n)throw new Error("response is undefined");if(!n.ok){const t=n.status;let o;o=null!==(e=n.headers.get("content-type"))&&void 0!==e&&e.includes("application/json")?yield n.json():{error:{message:yield n.text(),code:n.status,status:n.statusText}};const i=JSON.stringify(o);throw t>=400&&t<600?new xe({message:i,status:t}):new Error(i)}})).apply(this,arguments)}function vt(n){for(const e of n)if(Za(e)||"object"==typeof e&&"inputSchema"in e)return!0;return false}function At(n){var e;const t=null!==(e=n[rn])&&void 0!==e?e:"";n[rn]=(t+" mcp_used/unknown").trimStart()}function Za(n){return null!==n&&"object"==typeof n&&n instanceof Ae}function ja(n){return j(this,arguments,function*(t,o=100){let i,l=0;for(;l<o;){const a=yield M(t.listTools({cursor:i}));for(const d of a.tools)yield yield M(d),l++;if(!a.nextCursor)break;i=a.nextCursor}})}class Ae{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Ae(e,t)}initialize(){var e=this;return(0,g.A)(function*(){var t,o,i;if(e.mcpTools.length>0)return;const a={},d=[];for(const p of e.mcpClients)try{for(var u,f=!0,c=(o=void 0,ee(ja(p)));!(t=(u=yield c.next()).done);f=!0){f=!1;const h=u.value;d.push(h);const m=h.name;if(a[m])throw new Error(`Duplicate function name ${m} found in MCP tools. Please ensure function names are unique.`);a[m]=p}}catch(h){o={error:h}}finally{try{!f&&!t&&(i=c.return)&&(yield i.call(c))}finally{if(o)throw o.error}}e.mcpTools=d,e.functionNameToMcpClient=a})()}tool(){var e=this;return(0,g.A)(function*(){return yield e.initialize(),function Ui(n,e={}){const t=[],o=new Set;for(const i of n){const l=i.name;if(o.has(l))throw new Error(`Duplicate function name ${l} found in MCP tools. Please ensure function names are unique.`);o.add(l);const a=Di(i,e);a.functionDeclarations&&t.push(...a.functionDeclarations)}return{functionDeclarations:t}}(e.mcpTools,e.config)})()}callTool(e){var t=this;return(0,g.A)(function*(){yield t.initialize();const o=[];for(const i of e)if(i.name in t.functionNameToMcpClient){const l=t.functionNameToMcpClient[i.name];let a;t.config.timeout&&(a={timeout:t.config.timeout});const d=yield l.callTool({name:i.name,arguments:i.args},void 0,a);o.push({functionResponse:{name:i.name,response:d.isError?{error:d}:d}})}return o})()}}function ln(){return(ln=(0,g.A)(function*(n,e,t){const o=new Si;let i;i=t.data instanceof Blob?JSON.parse(yield t.data.text()):JSON.parse(t.data),Object.assign(o,i),e(o)})).apply(this,arguments)}class tu{constructor(e,t,o){this.apiClient=e,this.auth=t,this.webSocketFactory=o}connect(e){var t=this;return(0,g.A)(function*(){var o,i;if(t.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const l=t.apiClient.getWebsocketBaseUrl(),a=t.apiClient.getApiVersion(),d=function ru(n){const e=new Headers;for(const[t,o]of Object.entries(n))e.append(t,o);return e}(t.apiClient.getDefaultHeaders()),c=`${l}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${t.apiClient.getApiKey()}`;let u=()=>{};const p=new Promise(A=>{u=A}),h=e.callbacks,y=t.apiClient,E={onopen:function(){u({})},onmessage:A=>{!function nu(n,e,t){ln.apply(this,arguments)}(y,h.onmessage,A)},onerror:null!==(o=h?.onerror)&&void 0!==o?o:function(A){},onclose:null!==(i=h?.onclose)&&void 0!==i?i:function(A){}},_=t.webSocketFactory.create(c,function iu(n){const e={};return n.forEach((t,o)=>{e[o]=t}),e}(d),E);_.connect(),yield p;const v={setup:{model:L(t.apiClient,e.model)}};return _.send(JSON.stringify(v)),new ou(_,t.apiClient)})()}}class ou{constructor(e,t){this.conn=e,this.apiClient=t}setWeightedPrompts(e){var t=this;return(0,g.A)(function*(){if(!e.weightedPrompts||0===Object.keys(e.weightedPrompts).length)throw new Error("Weighted prompts must be set and contain at least one entry.");const o=function ws(n){const e={},t=r(n,["weightedPrompts"]);if(null!=t){let o=t;Array.isArray(o)&&(o=o.map(i=>i)),s(e,["weightedPrompts"],o)}return e}(e);t.conn.send(JSON.stringify({clientContent:o}))})()}setMusicGenerationConfig(e){var t=this;return(0,g.A)(function*(){e.musicGenerationConfig||(e.musicGenerationConfig={});const o=function Ns(n){const e={},t=r(n,["musicGenerationConfig"]);return null!=t&&s(e,["musicGenerationConfig"],t),e}(e);t.conn.send(JSON.stringify(o))})()}sendPlaybackControl(e){this.conn.send(JSON.stringify({playbackControl:e}))}play(){this.sendPlaybackControl(Ie.PLAY)}pause(){this.sendPlaybackControl(Ie.PAUSE)}stop(){this.sendPlaybackControl(Ie.STOP)}resetContext(){this.sendPlaybackControl(Ie.RESET_CONTEXT)}close(){this.conn.close()}}function an(){return(an=(0,g.A)(function*(n,e,t){const o=new Ai;let i;i=t.data instanceof Blob?yield t.data.text():t.data instanceof ArrayBuffer?(new TextDecoder).decode(t.data):t.data;const l=JSON.parse(i);if(n.isVertexAI()){const a=function Us(n){const e={},t=r(n,["setupComplete"]);null!=t&&s(e,["setupComplete"],t);const o=r(n,["serverContent"]);null!=o&&s(e,["serverContent"],o);const i=r(n,["toolCall"]);null!=i&&s(e,["toolCall"],i);const l=r(n,["toolCallCancellation"]);null!=l&&s(e,["toolCallCancellation"],l);const a=r(n,["usageMetadata"]);null!=a&&s(e,["usageMetadata"],function Vs(n){const e={},t=r(n,["promptTokenCount"]);null!=t&&s(e,["promptTokenCount"],t);const o=r(n,["cachedContentTokenCount"]);null!=o&&s(e,["cachedContentTokenCount"],o);const i=r(n,["candidatesTokenCount"]);null!=i&&s(e,["responseTokenCount"],i);const l=r(n,["toolUsePromptTokenCount"]);null!=l&&s(e,["toolUsePromptTokenCount"],l);const a=r(n,["thoughtsTokenCount"]);null!=a&&s(e,["thoughtsTokenCount"],a);const d=r(n,["totalTokenCount"]);null!=d&&s(e,["totalTokenCount"],d);const f=r(n,["promptTokensDetails"]);if(null!=f){let m=f;Array.isArray(m)&&(m=m.map(y=>y)),s(e,["promptTokensDetails"],m)}const c=r(n,["cacheTokensDetails"]);if(null!=c){let m=c;Array.isArray(m)&&(m=m.map(y=>y)),s(e,["cacheTokensDetails"],m)}const u=r(n,["candidatesTokensDetails"]);if(null!=u){let m=u;Array.isArray(m)&&(m=m.map(y=>y)),s(e,["responseTokensDetails"],m)}const p=r(n,["toolUsePromptTokensDetails"]);if(null!=p){let m=p;Array.isArray(m)&&(m=m.map(y=>y)),s(e,["toolUsePromptTokensDetails"],m)}const h=r(n,["trafficType"]);return null!=h&&s(e,["trafficType"],h),e}(a));const d=r(n,["goAway"]);null!=d&&s(e,["goAway"],d);const f=r(n,["sessionResumptionUpdate"]);null!=f&&s(e,["sessionResumptionUpdate"],f);const c=r(n,["voiceActivityDetectionSignal"]);return null!=c&&s(e,["voiceActivityDetectionSignal"],c),e}(l);Object.assign(o,a)}else Object.assign(o,l);e(o)})).apply(this,arguments)}class au{constructor(e,t,o){this.apiClient=e,this.auth=t,this.webSocketFactory=o,this.music=new tu(this.apiClient,this.auth,this.webSocketFactory)}connect(e){var t=this;return(0,g.A)(function*(){var o,i,l,a,d,f;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const c=t.apiClient.getWebsocketBaseUrl(),u=t.apiClient.getApiVersion();let p;const h=t.apiClient.getHeaders();e.config&&e.config.tools&&vt(e.config.tools)&&At(h);const m=function cu(n){const e=new Headers;for(const[t,o]of Object.entries(n))e.append(t,o);return e}(h);if(t.apiClient.isVertexAI())p=`${c}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,yield t.auth.addAuthHeaders(m,p);else{const N=t.apiClient.getApiKey();let D="BidiGenerateContent",Y="key";N?.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),"v1alpha"!==u&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),D="BidiGenerateContentConstrained",Y="access_token"),p=`${c}/ws/google.ai.generativelanguage.${u}.GenerativeService.${D}?${Y}=${N}`}let y=()=>{};const E=new Promise(N=>{y=N}),_=e.callbacks,C=t.apiClient,v={onopen:function(){var N;null===(N=_?.onopen)||void 0===N||N.call(_),y({})},onmessage:N=>{!function lu(n,e,t){an.apply(this,arguments)}(C,_.onmessage,N)},onerror:null!==(o=_?.onerror)&&void 0!==o?o:function(N){},onclose:null!==(i=_?.onclose)&&void 0!==i?i:function(N){}},A=t.webSocketFactory.create(p,function fu(n){const e={};return n.forEach((t,o)=>{e[o]=t}),e}(m),v);A.connect(),yield E;let P=L(t.apiClient,e.model);t.apiClient.isVertexAI()&&P.startsWith("publishers/")&&(P=`projects/${t.apiClient.getProject()}/locations/${t.apiClient.getLocation()}/`+P);let R={};t.apiClient.isVertexAI()&&void 0===(null===(l=e.config)||void 0===l?void 0:l.responseModalities)&&(void 0===e.config?e.config={responseModalities:[Ke.AUDIO]}:e.config.responseModalities=[Ke.AUDIO]),null!==(a=e.config)&&void 0!==a&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const U=null!==(f=null===(d=e.config)||void 0===d?void 0:d.tools)&&void 0!==f?f:[],F=[];for(const N of U)if(t.isCallableTool(N)){const D=N;F.push(yield D.tool())}else F.push(N);F.length>0&&(e.config.tools=F);const H={model:P,config:e.config,callbacks:e.callbacks};return R=t.apiClient.isVertexAI()?function Ms(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["setup","model"],L(n,o));const i=r(e,["config"]);return null!=i&&s(t,["config"],function Rs(n,e){const o=r(n,["generationConfig"]);void 0!==e&&null!=o&&s(e,["setup","generationConfig"],function Is(n){const e={},t=r(n,["modelSelectionConfig"]);null!=t&&s(e,["modelConfig"],t);const o=r(n,["responseJsonSchema"]);null!=o&&s(e,["responseJsonSchema"],o);const i=r(n,["audioTimestamp"]);null!=i&&s(e,["audioTimestamp"],i);const l=r(n,["candidateCount"]);null!=l&&s(e,["candidateCount"],l);const a=r(n,["enableAffectiveDialog"]);null!=a&&s(e,["enableAffectiveDialog"],a);const d=r(n,["frequencyPenalty"]);null!=d&&s(e,["frequencyPenalty"],d);const f=r(n,["logprobs"]);null!=f&&s(e,["logprobs"],f);const c=r(n,["maxOutputTokens"]);null!=c&&s(e,["maxOutputTokens"],c);const u=r(n,["mediaResolution"]);null!=u&&s(e,["mediaResolution"],u);const p=r(n,["presencePenalty"]);null!=p&&s(e,["presencePenalty"],p);const h=r(n,["responseLogprobs"]);null!=h&&s(e,["responseLogprobs"],h);const m=r(n,["responseMimeType"]);null!=m&&s(e,["responseMimeType"],m);const y=r(n,["responseModalities"]);null!=y&&s(e,["responseModalities"],y);const E=r(n,["responseSchema"]);null!=E&&s(e,["responseSchema"],E);const _=r(n,["routingConfig"]);null!=_&&s(e,["routingConfig"],_);const I=r(n,["seed"]);null!=I&&s(e,["seed"],I);const C=r(n,["speechConfig"]);null!=C&&s(e,["speechConfig"],C);const v=r(n,["stopSequences"]);null!=v&&s(e,["stopSequences"],v);const A=r(n,["temperature"]);null!=A&&s(e,["temperature"],A);const P=r(n,["thinkingConfig"]);null!=P&&s(e,["thinkingConfig"],P);const R=r(n,["topK"]);null!=R&&s(e,["topK"],R);const U=r(n,["topP"]);if(null!=U&&s(e,["topP"],U),void 0!==r(n,["enableEnhancedCivicAnswers"]))throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}(o));const i=r(n,["responseModalities"]);void 0!==e&&null!=i&&s(e,["setup","generationConfig","responseModalities"],i);const l=r(n,["temperature"]);void 0!==e&&null!=l&&s(e,["setup","generationConfig","temperature"],l);const a=r(n,["topP"]);void 0!==e&&null!=a&&s(e,["setup","generationConfig","topP"],a);const d=r(n,["topK"]);void 0!==e&&null!=d&&s(e,["setup","generationConfig","topK"],d);const f=r(n,["maxOutputTokens"]);void 0!==e&&null!=f&&s(e,["setup","generationConfig","maxOutputTokens"],f);const c=r(n,["mediaResolution"]);void 0!==e&&null!=c&&s(e,["setup","generationConfig","mediaResolution"],c);const u=r(n,["seed"]);void 0!==e&&null!=u&&s(e,["setup","generationConfig","seed"],u);const p=r(n,["speechConfig"]);void 0!==e&&null!=p&&s(e,["setup","generationConfig","speechConfig"],en(p));const h=r(n,["thinkingConfig"]);void 0!==e&&null!=h&&s(e,["setup","generationConfig","thinkingConfig"],h);const m=r(n,["enableAffectiveDialog"]);void 0!==e&&null!=m&&s(e,["setup","generationConfig","enableAffectiveDialog"],m);const y=r(n,["systemInstruction"]);void 0!==e&&null!=y&&s(e,["setup","systemInstruction"],J(y));const E=r(n,["tools"]);if(void 0!==e&&null!=E){let U=ye(E);Array.isArray(U)&&(U=U.map(F=>function Gs(n){const e={},t=r(n,["retrieval"]);null!=t&&s(e,["retrieval"],t);const o=r(n,["computerUse"]);if(null!=o&&s(e,["computerUse"],o),void 0!==r(n,["fileSearch"]))throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=r(n,["codeExecution"]);null!=i&&s(e,["codeExecution"],i);const l=r(n,["enterpriseWebSearch"]);null!=l&&s(e,["enterpriseWebSearch"],l);const a=r(n,["functionDeclarations"]);if(null!=a){let p=a;Array.isArray(p)&&(p=p.map(h=>function Cs(n){const e={},t=r(n,["description"]);null!=t&&s(e,["description"],t);const o=r(n,["name"]);null!=o&&s(e,["name"],o);const i=r(n,["parameters"]);null!=i&&s(e,["parameters"],i);const l=r(n,["parametersJsonSchema"]);null!=l&&s(e,["parametersJsonSchema"],l);const a=r(n,["response"]);null!=a&&s(e,["response"],a);const d=r(n,["responseJsonSchema"]);if(null!=d&&s(e,["responseJsonSchema"],d),void 0!==r(n,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");return e}(h))),s(e,["functionDeclarations"],p)}const d=r(n,["googleMaps"]);null!=d&&s(e,["googleMaps"],d);const f=r(n,["googleSearch"]);null!=f&&s(e,["googleSearch"],f);const c=r(n,["googleSearchRetrieval"]);null!=c&&s(e,["googleSearchRetrieval"],c);const u=r(n,["urlContext"]);return null!=u&&s(e,["urlContext"],u),e}(ge(F)))),s(e,["setup","tools"],U)}const _=r(n,["sessionResumption"]);void 0!==e&&null!=_&&s(e,["setup","sessionResumption"],_);const I=r(n,["inputAudioTranscription"]);void 0!==e&&null!=I&&s(e,["setup","inputAudioTranscription"],I);const C=r(n,["outputAudioTranscription"]);void 0!==e&&null!=C&&s(e,["setup","outputAudioTranscription"],C);const v=r(n,["realtimeInputConfig"]);void 0!==e&&null!=v&&s(e,["setup","realtimeInputConfig"],v);const A=r(n,["contextWindowCompression"]);void 0!==e&&null!=A&&s(e,["setup","contextWindowCompression"],A);const P=r(n,["proactivity"]);void 0!==e&&null!=P&&s(e,["setup","proactivity"],P);const R=r(n,["explicitVadSignal"]);return void 0!==e&&null!=R&&s(e,["setup","explicitVadSignal"],R),{}}(i,t)),t}(t.apiClient,H):function Ps(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["setup","model"],L(n,o));const i=r(e,["config"]);return null!=i&&s(t,["config"],Ss(i,t)),t}(t.apiClient,H),delete R.config,A.send(JSON.stringify(R)),new du(A,t.apiClient)})()}isCallableTool(e){return"callTool"in e&&"function"==typeof e.callTool}}const uu={turnComplete:!0};class du{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(null!=t.turns){let o=[];try{o=Q(t.turns),e.isVertexAI()||(o=o.map(i=>Ue(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:o,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let o=[];if(null==t.functionResponses)throw new Error("functionResponses is required.");if(o=Array.isArray(t.functionResponses)?t.functionResponses:[t.functionResponses],0===o.length)throw new Error("functionResponses is required.");for(const l of o){if("object"!=typeof l||null===l||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!e.isVertexAI()&&!("id"in l))throw new Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:o}}}sendClientContent(e){e=Object.assign(Object.assign({},uu),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};t=this.apiClient.isVertexAI()?{realtimeInput:Ds(e)}:{realtimeInput:xs(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(null==e.functionResponses)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function Rt(n){var e,t,o;if(null!==(e=n?.automaticFunctionCalling)&&void 0!==e&&e.disable)return!0;let i=!1;for(const a of null!==(t=n?.tools)&&void 0!==t?t:[])if(Te(a)){i=!0;break}if(!i)return!0;const l=null===(o=n?.automaticFunctionCalling)||void 0===o?void 0:o.maximumRemoteCalls;return!!(l&&(l<0||!Number.isInteger(l))||0==l)&&(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",l),!0)}function Te(n){return"callTool"in n&&"function"==typeof n.callTool}function Pt(n){var e;const t=[];return!(null===(e=n?.config)||void 0===e)&&e.tools&&n.config.tools.forEach((o,i)=>{Te(o)||o.functionDeclarations&&o.functionDeclarations.length>0&&t.push(i)}),t}function Mt(n){var e;return!(null!==(e=n?.automaticFunctionCalling)&&void 0!==e&&e.ignoreCallHistory)}class mu extends S{constructor(e){var t;super(),t=this,this.apiClient=e,this.generateContent=function(){var o=(0,g.A)(function*(i){var l,a,d,f,c;const u=yield t.processParamsMaybeAddMcpUsage(i);if(t.maybeMoveToResponseJsonSchem(i),!function pu(n){var e,t,o;return null!==(o=null===(t=null===(e=n.config)||void 0===e?void 0:e.tools)||void 0===t?void 0:t.some(i=>Te(i)))&&void 0!==o&&o}(i)||Rt(i.config))return yield t.generateContentInternal(u);const p=Pt(i);if(p.length>0){const I=p.map(C=>`tools[${C}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${I}.`)}let h,m;const y=Q(u.contents),E=null!==(d=null===(a=null===(l=u.config)||void 0===l?void 0:l.automaticFunctionCalling)||void 0===a?void 0:a.maximumRemoteCalls)&&void 0!==d?d:10;let _=0;for(;_<E&&(h=yield t.generateContentInternal(u),h.functionCalls&&0!==h.functionCalls.length);){const I=h.candidates[0].content,C=[];for(const v of null!==(c=null===(f=i.config)||void 0===f?void 0:f.tools)&&void 0!==c?c:[])if(Te(v)){const P=yield v.callTool(h.functionCalls);C.push(...P)}_++,m={role:"user",parts:C},u.contents=Q(u.contents),u.contents.push(I),u.contents.push(m),Mt(u.config)&&(y.push(I),y.push(m))}return Mt(u.config)&&(h.automaticFunctionCallingHistory=y),h});return function(i){return o.apply(this,arguments)}}(),this.generateContentStream=function(){var o=(0,g.A)(function*(i){var l,a,d,f,c;if(t.maybeMoveToResponseJsonSchem(i),Rt(i.config)){const m=yield t.processParamsMaybeAddMcpUsage(i);return yield t.generateContentStreamInternal(m)}const u=Pt(i);if(u.length>0){const m=u.map(y=>`tools[${y}]`).join(", ");throw new Error(`Incompatible tools found at ${m}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const p=null===(d=null===(a=null===(l=i?.config)||void 0===l?void 0:l.toolConfig)||void 0===a?void 0:a.functionCallingConfig)||void 0===d?void 0:d.streamFunctionCallArguments,h=null===(c=null===(f=i?.config)||void 0===f?void 0:f.automaticFunctionCalling)||void 0===c?void 0:c.disable;if(p&&!h)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return yield t.processAfcStream(i)});return function(i){return o.apply(this,arguments)}}(),this.generateImages=function(){var o=(0,g.A)(function*(i){return yield t.generateImagesInternal(i).then(l=>{var a;let d;const f=[];if(l?.generatedImages)for(const u of l.generatedImages)u&&u?.safetyAttributes&&"Positive Prompt"===(null===(a=u?.safetyAttributes)||void 0===a?void 0:a.contentType)?d=u?.safetyAttributes:f.push(u);let c;return c=d?{generatedImages:f,positivePromptSafetyAttributes:d,sdkHttpResponse:l.sdkHttpResponse}:{generatedImages:f,sdkHttpResponse:l.sdkHttpResponse},c})});return function(i){return o.apply(this,arguments)}}(),this.list=function(){var o=(0,g.A)(function*(i){var l;const f={config:Object.assign(Object.assign({},{queryBase:!0}),i?.config)};if(t.apiClient.isVertexAI()&&!f.config.queryBase){if(null!==(l=f.config)&&void 0!==l&&l.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");f.config.filter="labels.tune-type:*"}return new pe(fe.PAGED_ITEM_MODELS,c=>t.listInternal(c),yield t.listInternal(f),f)});return function(i){return o.apply(this,arguments)}}(),this.editImage=function(){var o=(0,g.A)(function*(i){const l={model:i.model,prompt:i.prompt,referenceImages:[],config:i.config};return i.referenceImages&&i.referenceImages&&(l.referenceImages=i.referenceImages.map(a=>a.toReferenceImageAPI())),yield t.editImageInternal(l)});return function(i){return o.apply(this,arguments)}}(),this.upscaleImage=function(){var o=(0,g.A)(function*(i){let l={numberOfImages:1,mode:"upscale"};i.config&&(l=Object.assign(Object.assign({},l),i.config));const a={model:i.model,image:i.image,upscaleFactor:i.upscaleFactor,config:l};return yield t.upscaleImageInternal(a)});return function(i){return o.apply(this,arguments)}}(),this.generateVideos=function(){var o=(0,g.A)(function*(i){var l,a,d,f,c,u;if((i.prompt||i.image||i.video)&&i.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return t.apiClient.isVertexAI()||(null!==(l=i.video)&&void 0!==l&&l.uri&&null!==(a=i.video)&&void 0!==a&&a.videoBytes?i.video={uri:i.video.uri,mimeType:i.video.mimeType}:!(null===(f=null===(d=i.source)||void 0===d?void 0:d.video)||void 0===f)&&f.uri&&!(null===(u=null===(c=i.source)||void 0===c?void 0:c.video)||void 0===u)&&u.videoBytes&&(i.source.video={uri:i.source.video.uri,mimeType:i.source.video.mimeType})),yield t.generateVideosInternal(i)});return function(i){return o.apply(this,arguments)}}()}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}processParamsMaybeAddMcpUsage(e){var t=this;return(0,g.A)(function*(){var o,i,l;const a=null===(o=e.config)||void 0===o?void 0:o.tools;if(!a)return e;const d=yield Promise.all(a.map(function(){var c=(0,g.A)(function*(u){return Te(u)?yield u.tool():u});return function(u){return c.apply(this,arguments)}}())),f={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:d})};if(f.config.tools=d,e.config&&e.config.tools&&vt(e.config.tools)){const c=null!==(l=null===(i=e.config.httpOptions)||void 0===i?void 0:i.headers)&&void 0!==l?l:{};let u=Object.assign({},c);0===Object.keys(u).length&&(u=t.apiClient.getDefaultHeaders()),At(u),f.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return f})()}initAfcToolsMap(e){return(0,g.A)(function*(){var t,o,i;const l=new Map;for(const a of null!==(o=null===(t=e.config)||void 0===t?void 0:t.tools)&&void 0!==o?o:[])if(Te(a)){const d=a,f=yield d.tool();for(const c of null!==(i=f.functionDeclarations)&&void 0!==i?i:[]){if(!c.name)throw new Error("Function declaration name is required.");if(l.has(c.name))throw new Error(`Duplicate tool declaration name: ${c.name}`);l.set(c.name,d)}}return l})()}processAfcStream(e){var t=this;return(0,g.A)(function*(){var o,i,l;const a=null!==(l=null===(i=null===(o=e.config)||void 0===o?void 0:o.automaticFunctionCalling)||void 0===i?void 0:i.maximumRemoteCalls)&&void 0!==l?l:10;let d=!1,f=0;const c=yield t.initAfcToolsMap(e);return function(u,p,h){return j(this,arguments,function*(){for(var m,y,E,I,C;f<a;){d&&(f++,d=!1);const R=yield M(u.processParamsMaybeAddMcpUsage(h)),U=yield M(u.generateContentStreamInternal(R)),F=[],H=[];try{for(var P,v=!0,A=(y=void 0,ee(U));!(m=(P=yield M(A.next())).done);v=!0){v=!1;const N=P.value;if(yield yield M(N),N.candidates&&null!==(I=N.candidates[0])&&void 0!==I&&I.content){H.push(N.candidates[0].content);for(const D of null!==(C=N.candidates[0].content.parts)&&void 0!==C?C:[])if(f<a&&D.functionCall){if(!D.functionCall.name)throw new Error("Function call name was not returned by the model.");if(!p.has(D.functionCall.name))throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${p.keys()}, mising tool: ${D.functionCall.name}`);{const Y=yield M(p.get(D.functionCall.name).callTool([D.functionCall]));F.push(...Y)}}}}}catch(N){y={error:N}}finally{try{!v&&!m&&(E=A.return)&&(yield M(E.call(A)))}finally{if(y)throw y.error}}if(!(F.length>0))break;{d=!0;const N=new ve;N.candidates=[{content:{role:"user",parts:F}}],yield yield M(N);const D=[];D.push(...H),D.push({role:"user",parts:F});const Y=Q(h.contents).concat(D);h.contents=Y}}})}(t,c,e)})()}generateContentInternal(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=ft(t.apiClient,e);return f=T("{model}:generateContent",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=pt(p),m=new ve;return Object.assign(m,h),m})}{const u=dt(t.apiClient,e);return f=T("{model}:generateContent",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=ct(p),m=new ve;return Object.assign(m,h),m})}})()}generateContentStreamInternal(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=ft(t.apiClient,e);return f=T("{model}:streamGenerateContent?alt=sse",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.requestStream({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}),d.then(function(h){return j(this,arguments,function*(){var m,y,E;try{for(var v,I=!0,C=ee(h);!(m=(v=yield M(C.next())).done);I=!0){I=!1;const A=v.value,P=pt(yield M(A.json()));P.sdkHttpResponse={headers:A.headers};const R=new ve;Object.assign(R,P),yield yield M(R)}}catch(A){y={error:A}}finally{try{!I&&!m&&(E=C.return)&&(yield M(E.call(C)))}finally{if(y)throw y.error}}})})}{const u=dt(t.apiClient,e);return f=T("{model}:streamGenerateContent?alt=sse",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.requestStream({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}),d.then(function(h){return j(this,arguments,function*(){var m,y,E;try{for(var v,I=!0,C=ee(h);!(m=(v=yield M(C.next())).done);I=!0){I=!1;const A=v.value,P=ct(yield M(A.json()));P.sdkHttpResponse={headers:A.headers};const R=new ve;Object.assign(R,P),yield yield M(R)}}catch(A){y={error:A}}finally{try{!I&&!m&&(E=C.return)&&(yield M(E.call(C)))}finally{if(y)throw y.error}}})})}})()}embedContent(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=function ul(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["_url","model"],L(n,o));const i=r(e,["contents"]);if(null!=i){let a=Qe(n,i);Array.isArray(a)&&(a=a.map(d=>d)),s(t,["instances[]","content"],a)}const l=r(e,["config"]);return null!=l&&function ll(n,e){const o=r(n,["taskType"]);void 0!==e&&null!=o&&s(e,["instances[]","task_type"],o);const i=r(n,["title"]);void 0!==e&&null!=i&&s(e,["instances[]","title"],i);const l=r(n,["outputDimensionality"]);void 0!==e&&null!=l&&s(e,["parameters","outputDimensionality"],l);const a=r(n,["mimeType"]);void 0!==e&&null!=a&&s(e,["instances[]","mimeType"],a);const d=r(n,["autoTruncate"]);void 0!==e&&null!=d&&s(e,["parameters","autoTruncate"],d)}(l,t),t}(t.apiClient,e);return f=T("{model}:predict",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function fl(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["predictions[]","embeddings"]);if(null!=o){let l=o;Array.isArray(l)&&(l=l.map(a=>function $s(n){const e={},t=r(n,["values"]);null!=t&&s(e,["values"],t);const o=r(n,["statistics"]);return null!=o&&s(e,["statistics"],function Ws(n){const e={},t=r(n,["truncated"]);null!=t&&s(e,["truncated"],t);const o=r(n,["token_count"]);return null!=o&&s(e,["tokenCount"],o),e}(o)),e}(a))),s(e,["embeddings"],l)}const i=r(n,["metadata"]);return null!=i&&s(e,["metadata"],i),e}(p),m=new Un;return Object.assign(m,h),m})}{const u=function al(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["_url","model"],L(n,o));const i=r(e,["contents"]);if(null!=i){let d=Qe(n,i);Array.isArray(d)&&(d=d.map(f=>f)),s(t,["requests[]","content"],d)}const l=r(e,["config"]);null!=l&&function sl(n,e){const o=r(n,["taskType"]);void 0!==e&&null!=o&&s(e,["requests[]","taskType"],o);const i=r(n,["title"]);void 0!==e&&null!=i&&s(e,["requests[]","title"],i);const l=r(n,["outputDimensionality"]);if(void 0!==e&&null!=l&&s(e,["requests[]","outputDimensionality"],l),void 0!==r(n,["mimeType"]))throw new Error("mimeType parameter is not supported in Gemini API.");if(void 0!==r(n,["autoTruncate"]))throw new Error("autoTruncate parameter is not supported in Gemini API.")}(l,t);const a=r(e,["model"]);return void 0!==a&&s(t,["requests[]","model"],L(n,a)),t}(t.apiClient,e);return f=T("{model}:batchEmbedContents",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function dl(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["embeddings"]);if(null!=o){let l=o;Array.isArray(l)&&(l=l.map(a=>a)),s(e,["embeddings"],l)}const i=r(n,["metadata"]);return null!=i&&s(e,["metadata"],i),e}(p),m=new Un;return Object.assign(m,h),m})}})()}generateImagesInternal(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=function Il(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["_url","model"],L(n,o));const i=r(e,["prompt"]);null!=i&&s(t,["instances[0]","prompt"],i);const l=r(e,["config"]);return null!=l&&function El(n,e){const o=r(n,["outputGcsUri"]);void 0!==e&&null!=o&&s(e,["parameters","storageUri"],o);const i=r(n,["negativePrompt"]);void 0!==e&&null!=i&&s(e,["parameters","negativePrompt"],i);const l=r(n,["numberOfImages"]);void 0!==e&&null!=l&&s(e,["parameters","sampleCount"],l);const a=r(n,["aspectRatio"]);void 0!==e&&null!=a&&s(e,["parameters","aspectRatio"],a);const d=r(n,["guidanceScale"]);void 0!==e&&null!=d&&s(e,["parameters","guidanceScale"],d);const f=r(n,["seed"]);void 0!==e&&null!=f&&s(e,["parameters","seed"],f);const c=r(n,["safetyFilterLevel"]);void 0!==e&&null!=c&&s(e,["parameters","safetySetting"],c);const u=r(n,["personGeneration"]);void 0!==e&&null!=u&&s(e,["parameters","personGeneration"],u);const p=r(n,["includeSafetyAttributes"]);void 0!==e&&null!=p&&s(e,["parameters","includeSafetyAttributes"],p);const h=r(n,["includeRaiReason"]);void 0!==e&&null!=h&&s(e,["parameters","includeRaiReason"],h);const m=r(n,["language"]);void 0!==e&&null!=m&&s(e,["parameters","language"],m);const y=r(n,["outputMimeType"]);void 0!==e&&null!=y&&s(e,["parameters","outputOptions","mimeType"],y);const E=r(n,["outputCompressionQuality"]);void 0!==e&&null!=E&&s(e,["parameters","outputOptions","compressionQuality"],E);const _=r(n,["addWatermark"]);void 0!==e&&null!=_&&s(e,["parameters","addWatermark"],_);const I=r(n,["labels"]);void 0!==e&&null!=I&&s(e,["labels"],I);const C=r(n,["imageSize"]);void 0!==e&&null!=C&&s(e,["parameters","sampleImageSize"],C);const v=r(n,["enhancePrompt"]);void 0!==e&&null!=v&&s(e,["parameters","enhancePrompt"],v)}(l,t),t}(t.apiClient,e);return f=T("{model}:predict",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function Al(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["predictions"]);if(null!=o){let l=o;Array.isArray(l)&&(l=l.map(a=>Le(a))),s(e,["generatedImages"],l)}const i=r(n,["positivePromptSafetyAttributes"]);return null!=i&&s(e,["positivePromptSafetyAttributes"],gt(i)),e}(p),m=new Ln;return Object.assign(m,h),m})}{const u=function Cl(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["_url","model"],L(n,o));const i=r(e,["prompt"]);null!=i&&s(t,["instances[0]","prompt"],i);const l=r(e,["config"]);return null!=l&&function Tl(n,e){if(void 0!==r(n,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==r(n,["negativePrompt"]))throw new Error("negativePrompt parameter is not supported in Gemini API.");const o=r(n,["numberOfImages"]);void 0!==e&&null!=o&&s(e,["parameters","sampleCount"],o);const i=r(n,["aspectRatio"]);void 0!==e&&null!=i&&s(e,["parameters","aspectRatio"],i);const l=r(n,["guidanceScale"]);if(void 0!==e&&null!=l&&s(e,["parameters","guidanceScale"],l),void 0!==r(n,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const a=r(n,["safetyFilterLevel"]);void 0!==e&&null!=a&&s(e,["parameters","safetySetting"],a);const d=r(n,["personGeneration"]);void 0!==e&&null!=d&&s(e,["parameters","personGeneration"],d);const f=r(n,["includeSafetyAttributes"]);void 0!==e&&null!=f&&s(e,["parameters","includeSafetyAttributes"],f);const c=r(n,["includeRaiReason"]);void 0!==e&&null!=c&&s(e,["parameters","includeRaiReason"],c);const u=r(n,["language"]);void 0!==e&&null!=u&&s(e,["parameters","language"],u);const p=r(n,["outputMimeType"]);void 0!==e&&null!=p&&s(e,["parameters","outputOptions","mimeType"],p);const h=r(n,["outputCompressionQuality"]);if(void 0!==e&&null!=h&&s(e,["parameters","outputOptions","compressionQuality"],h),void 0!==r(n,["addWatermark"]))throw new Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==r(n,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const m=r(n,["imageSize"]);if(void 0!==e&&null!=m&&s(e,["parameters","sampleImageSize"],m),void 0!==r(n,["enhancePrompt"]))throw new Error("enhancePrompt parameter is not supported in Gemini API.")}(l,t),t}(t.apiClient,e);return f=T("{model}:predict",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function vl(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["predictions"]);if(null!=o){let l=o;Array.isArray(l)&&(l=l.map(a=>function kl(n){const e={},t=r(n,["_self"]);null!=t&&s(e,["image"],function Kl(n){const e={},t=r(n,["bytesBase64Encoded"]);null!=t&&s(e,["imageBytes"],de(t));const o=r(n,["mimeType"]);return null!=o&&s(e,["mimeType"],o),e}(t));const o=r(n,["raiFilteredReason"]);null!=o&&s(e,["raiFilteredReason"],o);const i=r(n,["_self"]);return null!=i&&s(e,["safetyAttributes"],ht(i)),e}(a))),s(e,["generatedImages"],l)}const i=r(n,["positivePromptSafetyAttributes"]);return null!=i&&s(e,["positivePromptSafetyAttributes"],ht(i)),e}(p),m=new Ln;return Object.assign(m,h),m})}})()}editImageInternal(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI()){const f=function il(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["_url","model"],L(n,o));const i=r(e,["prompt"]);null!=i&&s(t,["instances[0]","prompt"],i);const l=r(e,["referenceImages"]);if(null!=l){let d=l;Array.isArray(d)&&(d=d.map(f=>function sa(n){const e={},t=r(n,["referenceImage"]);null!=t&&s(e,["referenceImage"],ne(t));const o=r(n,["referenceId"]);null!=o&&s(e,["referenceId"],o);const i=r(n,["referenceType"]);null!=i&&s(e,["referenceType"],i);const l=r(n,["maskImageConfig"]);null!=l&&s(e,["maskImageConfig"],function jl(n){const e={},t=r(n,["maskMode"]);null!=t&&s(e,["maskMode"],t);const o=r(n,["segmentationClasses"]);null!=o&&s(e,["maskClasses"],o);const i=r(n,["maskDilation"]);return null!=i&&s(e,["dilation"],i),e}(l));const a=r(n,["controlImageConfig"]);null!=a&&s(e,["controlImageConfig"],function Ks(n){const e={},t=r(n,["controlType"]);null!=t&&s(e,["controlType"],t);const o=r(n,["enableControlImageComputation"]);return null!=o&&s(e,["computeControl"],o),e}(a));const d=r(n,["styleImageConfig"]);null!=d&&s(e,["styleImageConfig"],d);const f=r(n,["subjectImageConfig"]);return null!=f&&s(e,["subjectImageConfig"],f),e}(f))),s(t,["instances[0]","referenceImages"],d)}const a=r(e,["config"]);return null!=a&&function ol(n,e){const o=r(n,["outputGcsUri"]);void 0!==e&&null!=o&&s(e,["parameters","storageUri"],o);const i=r(n,["negativePrompt"]);void 0!==e&&null!=i&&s(e,["parameters","negativePrompt"],i);const l=r(n,["numberOfImages"]);void 0!==e&&null!=l&&s(e,["parameters","sampleCount"],l);const a=r(n,["aspectRatio"]);void 0!==e&&null!=a&&s(e,["parameters","aspectRatio"],a);const d=r(n,["guidanceScale"]);void 0!==e&&null!=d&&s(e,["parameters","guidanceScale"],d);const f=r(n,["seed"]);void 0!==e&&null!=f&&s(e,["parameters","seed"],f);const c=r(n,["safetyFilterLevel"]);void 0!==e&&null!=c&&s(e,["parameters","safetySetting"],c);const u=r(n,["personGeneration"]);void 0!==e&&null!=u&&s(e,["parameters","personGeneration"],u);const p=r(n,["includeSafetyAttributes"]);void 0!==e&&null!=p&&s(e,["parameters","includeSafetyAttributes"],p);const h=r(n,["includeRaiReason"]);void 0!==e&&null!=h&&s(e,["parameters","includeRaiReason"],h);const m=r(n,["language"]);void 0!==e&&null!=m&&s(e,["parameters","language"],m);const y=r(n,["outputMimeType"]);void 0!==e&&null!=y&&s(e,["parameters","outputOptions","mimeType"],y);const E=r(n,["outputCompressionQuality"]);void 0!==e&&null!=E&&s(e,["parameters","outputOptions","compressionQuality"],E);const _=r(n,["addWatermark"]);void 0!==e&&null!=_&&s(e,["parameters","addWatermark"],_);const I=r(n,["labels"]);void 0!==e&&null!=I&&s(e,["labels"],I);const C=r(n,["editMode"]);void 0!==e&&null!=C&&s(e,["parameters","editMode"],C);const v=r(n,["baseSteps"]);void 0!==e&&null!=v&&s(e,["parameters","editConfig","baseSteps"],v)}(a,t),t}(t.apiClient,e);return a=T("{model}:predict",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:c.headers},p})),l.then(c=>{const u=function rl(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["predictions"]);if(null!=o){let i=o;Array.isArray(i)&&(i=i.map(l=>Le(l))),s(e,["generatedImages"],i)}return e}(c),p=new pi;return Object.assign(p,u),p})}throw new Error("This method is only supported by the Vertex AI.")})()}upscaleImageInternal(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI()){const f=function Ia(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["_url","model"],L(n,o));const i=r(e,["image"]);null!=i&&s(t,["instances[0]","image"],ne(i));const l=r(e,["upscaleFactor"]);null!=l&&s(t,["parameters","upscaleConfig","upscaleFactor"],l);const a=r(e,["config"]);return null!=a&&function Ca(n,e){const o=r(n,["outputGcsUri"]);void 0!==e&&null!=o&&s(e,["parameters","storageUri"],o);const i=r(n,["safetyFilterLevel"]);void 0!==e&&null!=i&&s(e,["parameters","safetySetting"],i);const l=r(n,["personGeneration"]);void 0!==e&&null!=l&&s(e,["parameters","personGeneration"],l);const a=r(n,["includeRaiReason"]);void 0!==e&&null!=a&&s(e,["parameters","includeRaiReason"],a);const d=r(n,["outputMimeType"]);void 0!==e&&null!=d&&s(e,["parameters","outputOptions","mimeType"],d);const f=r(n,["outputCompressionQuality"]);void 0!==e&&null!=f&&s(e,["parameters","outputOptions","compressionQuality"],f);const c=r(n,["enhanceInputImage"]);void 0!==e&&null!=c&&s(e,["parameters","upscaleConfig","enhanceInputImage"],c);const u=r(n,["imagePreservationFactor"]);void 0!==e&&null!=u&&s(e,["parameters","upscaleConfig","imagePreservationFactor"],u);const p=r(n,["labels"]);void 0!==e&&null!=p&&s(e,["labels"],p);const h=r(n,["numberOfImages"]);void 0!==e&&null!=h&&s(e,["parameters","sampleCount"],h);const m=r(n,["mode"]);void 0!==e&&null!=m&&s(e,["parameters","mode"],m)}(a,t),t}(t.apiClient,e);return a=T("{model}:predict",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:c.headers},p})),l.then(c=>{const u=function va(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["predictions"]);if(null!=o){let i=o;Array.isArray(i)&&(i=i.map(l=>Le(l))),s(e,["generatedImages"],i)}return e}(c),p=new mi;return Object.assign(p,u),p})}throw new Error("This method is only supported by the Vertex AI.")})()}recontextImage(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI()){const f=function oa(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["_url","model"],L(n,o));const i=r(e,["source"]);null!=i&&function ra(n,e){const o=r(n,["prompt"]);void 0!==e&&null!=o&&s(e,["instances[0]","prompt"],o);const i=r(n,["personImage"]);void 0!==e&&null!=i&&s(e,["instances[0]","personImage","image"],ne(i));const l=r(n,["productImages"]);if(void 0!==e&&null!=l){let a=l;Array.isArray(a)&&(a=a.map(d=>function na(n){const e={},t=r(n,["productImage"]);return null!=t&&s(e,["image"],ne(t)),e}(d))),s(e,["instances[0]","productImages"],a)}}(i,t);const l=r(e,["config"]);return null!=l&&function ta(n,e){const o=r(n,["numberOfImages"]);void 0!==e&&null!=o&&s(e,["parameters","sampleCount"],o);const i=r(n,["baseSteps"]);void 0!==e&&null!=i&&s(e,["parameters","baseSteps"],i);const l=r(n,["outputGcsUri"]);void 0!==e&&null!=l&&s(e,["parameters","storageUri"],l);const a=r(n,["seed"]);void 0!==e&&null!=a&&s(e,["parameters","seed"],a);const d=r(n,["safetyFilterLevel"]);void 0!==e&&null!=d&&s(e,["parameters","safetySetting"],d);const f=r(n,["personGeneration"]);void 0!==e&&null!=f&&s(e,["parameters","personGeneration"],f);const c=r(n,["addWatermark"]);void 0!==e&&null!=c&&s(e,["parameters","addWatermark"],c);const u=r(n,["outputMimeType"]);void 0!==e&&null!=u&&s(e,["parameters","outputOptions","mimeType"],u);const p=r(n,["outputCompressionQuality"]);void 0!==e&&null!=p&&s(e,["parameters","outputOptions","compressionQuality"],p);const h=r(n,["enhancePrompt"]);void 0!==e&&null!=h&&s(e,["parameters","enhancePrompt"],h);const m=r(n,["labels"]);void 0!==e&&null!=m&&s(e,["labels"],m)}(l,t),t}(t.apiClient,e);return a=T("{model}:predict",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json()),l.then(c=>{const u=function ia(n){const e={},t=r(n,["predictions"]);if(null!=t){let o=t;Array.isArray(o)&&(o=o.map(i=>Le(i))),s(e,["generatedImages"],o)}return e}(c),p=new hi;return Object.assign(p,u),p})}throw new Error("This method is only supported by the Vertex AI.")})()}segmentImage(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI()){const f=function da(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["_url","model"],L(n,o));const i=r(e,["source"]);null!=i&&function ca(n,e){const o=r(n,["prompt"]);void 0!==e&&null!=o&&s(e,["instances[0]","prompt"],o);const i=r(n,["image"]);void 0!==e&&null!=i&&s(e,["instances[0]","image"],ne(i));const l=r(n,["scribbleImage"]);void 0!==e&&null!=l&&s(e,["instances[0]","scribble"],function aa(n){const e={},t=r(n,["image"]);return null!=t&&s(e,["image"],ne(t)),e}(l))}(i,t);const l=r(e,["config"]);return null!=l&&function ua(n,e){const o=r(n,["mode"]);void 0!==e&&null!=o&&s(e,["parameters","mode"],o);const i=r(n,["maxPredictions"]);void 0!==e&&null!=i&&s(e,["parameters","maxPredictions"],i);const l=r(n,["confidenceThreshold"]);void 0!==e&&null!=l&&s(e,["parameters","confidenceThreshold"],l);const a=r(n,["maskDilation"]);void 0!==e&&null!=a&&s(e,["parameters","maskDilation"],a);const d=r(n,["binaryColorThreshold"]);void 0!==e&&null!=d&&s(e,["parameters","binaryColorThreshold"],d);const f=r(n,["labels"]);void 0!==e&&null!=f&&s(e,["labels"],f)}(l,t),t}(t.apiClient,e);return a=T("{model}:predict",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json()),l.then(c=>{const u=function fa(n){const e={},t=r(n,["predictions"]);if(null!=t){let o=t;Array.isArray(o)&&(o=o.map(i=>function Fl(n){const e={},t=r(n,["_self"]);null!=t&&s(e,["mask"],mt(t));const o=r(n,["labels"]);if(null!=o){let i=o;Array.isArray(i)&&(i=i.map(l=>l)),s(e,["labels"],i)}return e}(i))),s(e,["generatedMasks"],o)}return e}(c),p=new gi;return Object.assign(p,u),p})}throw new Error("This method is only supported by the Vertex AI.")})()}get(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=function Bl(n,e){const t={},o=r(e,["model"]);return null!=o&&s(t,["_url","name"],L(n,o)),t}(t.apiClient,e);return f=T("{name}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json()),d.then(p=>on(p))}{const u=function Hl(n,e){const t={},o=r(e,["model"]);return null!=o&&s(t,["_url","name"],L(n,o)),t}(t.apiClient,e);return f=T("{name}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json()),d.then(p=>tn(p))}})()}listInternal(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=function Xl(n,e){const t={},o=r(e,["config"]);return null!=o&&function Ol(n,e,t){const i=r(e,["pageSize"]);void 0!==t&&null!=i&&s(t,["_query","pageSize"],i);const l=r(e,["pageToken"]);void 0!==t&&null!=l&&s(t,["_query","pageToken"],l);const a=r(e,["filter"]);void 0!==t&&null!=a&&s(t,["_query","filter"],a);const d=r(e,["queryBase"]);void 0!==t&&null!=d&&s(t,["_url","models_url"],jn(n,d))}(n,o,t),t}(t.apiClient,e);return f=T("{models_url}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function Zl(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["nextPageToken"]);null!=o&&s(e,["nextPageToken"],o);const i=r(n,["_self"]);if(null!=i){let l=et(i);Array.isArray(l)&&(l=l.map(a=>on(a))),s(e,["models"],l)}return e}(p),m=new kn;return Object.assign(m,h),m})}{const u=function zl(n,e){const t={},o=r(e,["config"]);return null!=o&&function Yl(n,e,t){const i=r(e,["pageSize"]);void 0!==t&&null!=i&&s(t,["_query","pageSize"],i);const l=r(e,["pageToken"]);void 0!==t&&null!=l&&s(t,["_query","pageToken"],l);const a=r(e,["filter"]);void 0!==t&&null!=a&&s(t,["_query","filter"],a);const d=r(e,["queryBase"]);void 0!==t&&null!=d&&s(t,["_url","models_url"],jn(n,d))}(n,o,t),t}(t.apiClient,e);return f=T("{models_url}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function Ql(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["nextPageToken"]);null!=o&&s(e,["nextPageToken"],o);const i=r(n,["_self"]);if(null!=i){let l=et(i);Array.isArray(l)&&(l=l.map(a=>tn(a))),s(e,["models"],l)}return e}(p),m=new kn;return Object.assign(m,h),m})}})()}update(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=function Ea(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["_url","model"],L(n,o));const i=r(e,["config"]);return null!=i&&function _a(n,e){const o=r(n,["displayName"]);void 0!==e&&null!=o&&s(e,["displayName"],o);const i=r(n,["description"]);void 0!==e&&null!=i&&s(e,["description"],i);const l=r(n,["defaultCheckpointId"]);void 0!==e&&null!=l&&s(e,["defaultCheckpointId"],l)}(i,t),t}(t.apiClient,e);return f=T("{model}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json()),d.then(p=>on(p))}{const u=function Ta(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["_url","name"],L(n,o));const i=r(e,["config"]);return null!=i&&function ya(n,e){const o=r(n,["displayName"]);void 0!==e&&null!=o&&s(e,["displayName"],o);const i=r(n,["description"]);void 0!==e&&null!=i&&s(e,["description"],i);const l=r(n,["defaultCheckpointId"]);void 0!==e&&null!=l&&s(e,["defaultCheckpointId"],l)}(i,t),t}(t.apiClient,e);return f=T("{name}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json()),d.then(p=>tn(p))}})()}delete(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=function el(n,e){const t={},o=r(e,["model"]);return null!=o&&s(t,["_url","name"],L(n,o)),t}(t.apiClient,e);return f=T("{name}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function tl(n){const e={},t=r(n,["sdkHttpResponse"]);return null!=t&&s(e,["sdkHttpResponse"],t),e}(p),m=new Fn;return Object.assign(m,h),m})}{const u=function js(n,e){const t={},o=r(e,["model"]);return null!=o&&s(t,["_url","name"],L(n,o)),t}(t.apiClient,e);return f=T("{name}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function nl(n){const e={},t=r(n,["sdkHttpResponse"]);return null!=t&&s(e,["sdkHttpResponse"],t),e}(p),m=new Fn;return Object.assign(m,h),m})}})()}countTokens(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=function Xs(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["_url","model"],L(n,o));const i=r(e,["contents"]);if(null!=i){let a=Q(i);Array.isArray(a)&&(a=a.map(d=>d)),s(t,["contents"],a)}const l=r(e,["config"]);return null!=l&&function Os(n,e){const o=r(n,["systemInstruction"]);void 0!==e&&null!=o&&s(e,["systemInstruction"],J(o));const i=r(n,["tools"]);if(void 0!==e&&null!=i){let a=i;Array.isArray(a)&&(a=a.map(d=>yt(d))),s(e,["tools"],a)}const l=r(n,["generationConfig"]);return void 0!==e&&null!=l&&s(e,["generationConfig"],function ql(n){const e={},t=r(n,["modelSelectionConfig"]);null!=t&&s(e,["modelConfig"],t);const o=r(n,["responseJsonSchema"]);null!=o&&s(e,["responseJsonSchema"],o);const i=r(n,["audioTimestamp"]);null!=i&&s(e,["audioTimestamp"],i);const l=r(n,["candidateCount"]);null!=l&&s(e,["candidateCount"],l);const a=r(n,["enableAffectiveDialog"]);null!=a&&s(e,["enableAffectiveDialog"],a);const d=r(n,["frequencyPenalty"]);null!=d&&s(e,["frequencyPenalty"],d);const f=r(n,["logprobs"]);null!=f&&s(e,["logprobs"],f);const c=r(n,["maxOutputTokens"]);null!=c&&s(e,["maxOutputTokens"],c);const u=r(n,["mediaResolution"]);null!=u&&s(e,["mediaResolution"],u);const p=r(n,["presencePenalty"]);null!=p&&s(e,["presencePenalty"],p);const h=r(n,["responseLogprobs"]);null!=h&&s(e,["responseLogprobs"],h);const m=r(n,["responseMimeType"]);null!=m&&s(e,["responseMimeType"],m);const y=r(n,["responseModalities"]);null!=y&&s(e,["responseModalities"],y);const E=r(n,["responseSchema"]);null!=E&&s(e,["responseSchema"],E);const _=r(n,["routingConfig"]);null!=_&&s(e,["routingConfig"],_);const I=r(n,["seed"]);null!=I&&s(e,["seed"],I);const C=r(n,["speechConfig"]);null!=C&&s(e,["speechConfig"],C);const v=r(n,["stopSequences"]);null!=v&&s(e,["stopSequences"],v);const A=r(n,["temperature"]);null!=A&&s(e,["temperature"],A);const P=r(n,["thinkingConfig"]);null!=P&&s(e,["thinkingConfig"],P);const R=r(n,["topK"]);null!=R&&s(e,["topK"],R);const U=r(n,["topP"]);if(null!=U&&s(e,["topP"],U),void 0!==r(n,["enableEnhancedCivicAnswers"]))throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}(l)),{}}(l,t),t}(t.apiClient,e);return f=T("{model}:countTokens",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function Zs(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["totalTokens"]);return null!=o&&s(e,["totalTokens"],o),e}(p),m=new Gn;return Object.assign(m,h),m})}{const u=function zs(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["_url","model"],L(n,o));const i=r(e,["contents"]);if(null!=i){let a=Q(i);Array.isArray(a)&&(a=a.map(d=>Ue(d))),s(t,["contents"],a)}const l=r(e,["config"]);return null!=l&&function Ys(n){if(void 0!==r(n,["systemInstruction"]))throw new Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==r(n,["tools"]))throw new Error("tools parameter is not supported in Gemini API.");if(void 0!==r(n,["generationConfig"]))throw new Error("generationConfig parameter is not supported in Gemini API.")}(l),t}(t.apiClient,e);return f=T("{model}:countTokens",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function Qs(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["totalTokens"]);null!=o&&s(e,["totalTokens"],o);const i=r(n,["cachedContentTokenCount"]);return null!=i&&s(e,["cachedContentTokenCount"],i),e}(p),m=new Gn;return Object.assign(m,h),m})}})()}computeTokens(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI()){const f=function bs(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["_url","model"],L(n,o));const i=r(e,["contents"]);if(null!=i){let l=Q(i);Array.isArray(l)&&(l=l.map(a=>a)),s(t,["contents"],l)}return t}(t.apiClient,e);return a=T("{model}:computeTokens",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:c.headers},p})),l.then(c=>{const u=function Js(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["tokensInfo"]);if(null!=o){let i=o;Array.isArray(i)&&(i=i.map(l=>l)),s(e,["tokensInfo"],i)}return e}(c),p=new yi;return Object.assign(p,u),p})}throw new Error("This method is only supported by the Vertex AI.")})()}generateVideosInternal(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=wl(t.apiClient,e);return f=T("{model}:predictLongRunning",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json()),d.then(p=>{const h=function Ml(n){const e={},t=r(n,["name"]);null!=t&&s(e,["name"],t);const o=r(n,["metadata"]);null!=o&&s(e,["metadata"],o);const i=r(n,["done"]);null!=i&&s(e,["done"],i);const l=r(n,["error"]);null!=l&&s(e,["error"],l);const a=r(n,["response"]);return null!=a&&s(e,["response"],function Dl(n){const e={},t=r(n,["videos"]);if(null!=t){let l=t;Array.isArray(l)&&(l=l.map(a=>function Vl(n){const e={},t=r(n,["_self"]);return null!=t&&s(e,["video"],function Sa(n){const e={},t=r(n,["gcsUri"]);null!=t&&s(e,["uri"],t);const o=r(n,["bytesBase64Encoded"]);null!=o&&s(e,["videoBytes"],de(o));const i=r(n,["mimeType"]);return null!=i&&s(e,["mimeType"],i),e}(t)),e}(a))),s(e,["generatedVideos"],l)}const o=r(n,["raiMediaFilteredCount"]);null!=o&&s(e,["raiMediaFilteredCount"],o);const i=r(n,["raiMediaFilteredReasons"]);return null!=i&&s(e,["raiMediaFilteredReasons"],i),e}(a)),e}(p),m=new Pe;return Object.assign(m,h),m})}{const u=Nl(t.apiClient,e);return f=T("{model}:predictLongRunning",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json()),d.then(p=>{const h=function Pl(n){const e={},t=r(n,["name"]);null!=t&&s(e,["name"],t);const o=r(n,["metadata"]);null!=o&&s(e,["metadata"],o);const i=r(n,["done"]);null!=i&&s(e,["done"],i);const l=r(n,["error"]);null!=l&&s(e,["error"],l);const a=r(n,["response","generateVideoResponse"]);return null!=a&&s(e,["response"],function xl(n){const e={},t=r(n,["generatedSamples"]);if(null!=t){let l=t;Array.isArray(l)&&(l=l.map(a=>function Gl(n){const e={},t=r(n,["video"]);return null!=t&&s(e,["video"],function Aa(n){const e={},t=r(n,["uri"]);null!=t&&s(e,["uri"],t);const o=r(n,["encodedVideo"]);null!=o&&s(e,["videoBytes"],de(o));const i=r(n,["encoding"]);return null!=i&&s(e,["mimeType"],i),e}(t)),e}(a))),s(e,["generatedVideos"],l)}const o=r(n,["raiMediaFilteredCount"]);null!=o&&s(e,["raiMediaFilteredCount"],o);const i=r(n,["raiMediaFilteredReasons"]);return null!=i&&s(e,["raiMediaFilteredReasons"],i),e}(a)),e}(p),m=new Pe;return Object.assign(m,h),m})}})()}}class hu extends S{constructor(e){super(),this.apiClient=e}getVideosOperation(e){var t=this;return(0,g.A)(function*(){const o=e.operation,i=e.config;if(void 0===o.name||""===o.name)throw new Error("Operation name is required.");if(t.apiClient.isVertexAI()){const l=o.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const d=yield t.fetchPredictVideosOperationInternal({operationName:o.name,resourceName:l,config:{httpOptions:a}});return o._fromAPIResponse({apiResponse:d,_isVertexAI:!0})}{const l=yield t.getVideosOperationInternal({operationName:o.name,config:i});return o._fromAPIResponse({apiResponse:l,_isVertexAI:!1})}})()}get(e){var t=this;return(0,g.A)(function*(){const o=e.operation,i=e.config;if(void 0===o.name||""===o.name)throw new Error("Operation name is required.");if(t.apiClient.isVertexAI()){const l=o.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const d=yield t.fetchPredictVideosOperationInternal({operationName:o.name,resourceName:l,config:{httpOptions:a}});return o._fromAPIResponse({apiResponse:d,_isVertexAI:!0})}{const l=yield t.getVideosOperationInternal({operationName:o.name,config:i});return o._fromAPIResponse({apiResponse:l,_isVertexAI:!1})}})()}getVideosOperationInternal(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=function uo(n){const e={},t=r(n,["operationName"]);return null!=t&&s(e,["_url","operationName"],t),e}(e);return f=T("{operationName}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json()),d}{const u=function ao(n){const e={},t=r(n,["operationName"]);return null!=t&&s(e,["_url","operationName"],t),e}(e);return f=T("{operationName}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json()),d}})()}fetchPredictVideosOperationInternal(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI()){const f=function oe(n){const e={},t=r(n,["operationName"]);null!=t&&s(e,["operationName"],t);const o=r(n,["resourceName"]);return null!=o&&s(e,["_url","resourceName"],o),e}(e);return a=T("{resourceName}:fetchPredictOperation",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json()),l}throw new Error("This method is only supported by the Vertex AI.")})()}}function _u(n,e,t){const i=r(e,["expireTime"]);void 0!==t&&null!=i&&s(t,["expireTime"],i);const l=r(e,["newSessionExpireTime"]);void 0!==t&&null!=l&&s(t,["newSessionExpireTime"],l);const a=r(e,["uses"]);void 0!==t&&null!=a&&s(t,["uses"],a);const d=r(e,["liveConnectConstraints"]);void 0!==t&&null!=d&&s(t,["bidiGenerateContentSetup"],function Su(n,e){const t={},o=r(e,["model"]);null!=o&&s(t,["setup","model"],L(n,o));const i=r(e,["config"]);return null!=i&&s(t,["config"],function Au(n,e){const o=r(n,["generationConfig"]);void 0!==e&&null!=o&&s(e,["setup","generationConfig"],o);const i=r(n,["responseModalities"]);void 0!==e&&null!=i&&s(e,["setup","generationConfig","responseModalities"],i);const l=r(n,["temperature"]);void 0!==e&&null!=l&&s(e,["setup","generationConfig","temperature"],l);const a=r(n,["topP"]);void 0!==e&&null!=a&&s(e,["setup","generationConfig","topP"],a);const d=r(n,["topK"]);void 0!==e&&null!=d&&s(e,["setup","generationConfig","topK"],d);const f=r(n,["maxOutputTokens"]);void 0!==e&&null!=f&&s(e,["setup","generationConfig","maxOutputTokens"],f);const c=r(n,["mediaResolution"]);void 0!==e&&null!=c&&s(e,["setup","generationConfig","mediaResolution"],c);const u=r(n,["seed"]);void 0!==e&&null!=u&&s(e,["setup","generationConfig","seed"],u);const p=r(n,["speechConfig"]);void 0!==e&&null!=p&&s(e,["setup","generationConfig","speechConfig"],en(p));const h=r(n,["thinkingConfig"]);void 0!==e&&null!=h&&s(e,["setup","generationConfig","thinkingConfig"],h);const m=r(n,["enableAffectiveDialog"]);void 0!==e&&null!=m&&s(e,["setup","generationConfig","enableAffectiveDialog"],m);const y=r(n,["systemInstruction"]);void 0!==e&&null!=y&&s(e,["setup","systemInstruction"],function yu(n){const e={},t=r(n,["parts"]);if(null!=t){let i=t;Array.isArray(i)&&(i=i.map(l=>function Ru(n){const e={},t=r(n,["mediaResolution"]);null!=t&&s(e,["mediaResolution"],t);const o=r(n,["codeExecutionResult"]);null!=o&&s(e,["codeExecutionResult"],o);const i=r(n,["executableCode"]);null!=i&&s(e,["executableCode"],i);const l=r(n,["fileData"]);null!=l&&s(e,["fileData"],function Eu(n){const e={};if(void 0!==r(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const t=r(n,["fileUri"]);null!=t&&s(e,["fileUri"],t);const o=r(n,["mimeType"]);return null!=o&&s(e,["mimeType"],o),e}(l));const a=r(n,["functionCall"]);null!=a&&s(e,["functionCall"],function Cu(n){const e={},t=r(n,["id"]);null!=t&&s(e,["id"],t);const o=r(n,["args"]);null!=o&&s(e,["args"],o);const i=r(n,["name"]);if(null!=i&&s(e,["name"],i),void 0!==r(n,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==r(n,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return e}(a));const d=r(n,["functionResponse"]);null!=d&&s(e,["functionResponse"],d);const f=r(n,["inlineData"]);null!=f&&s(e,["inlineData"],function gu(n){const e={},t=r(n,["data"]);if(null!=t&&s(e,["data"],t),void 0!==r(n,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const o=r(n,["mimeType"]);return null!=o&&s(e,["mimeType"],o),e}(f));const c=r(n,["text"]);null!=c&&s(e,["text"],c);const u=r(n,["thought"]);null!=u&&s(e,["thought"],u);const p=r(n,["thoughtSignature"]);null!=p&&s(e,["thoughtSignature"],p);const h=r(n,["videoMetadata"]);return null!=h&&s(e,["videoMetadata"],h),e}(l))),s(e,["parts"],i)}const o=r(n,["role"]);return null!=o&&s(e,["role"],o),e}(J(y)));const E=r(n,["tools"]);if(void 0!==e&&null!=E){let R=ye(E);Array.isArray(R)&&(R=R.map(U=>function Mu(n){const e={};if(void 0!==r(n,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const t=r(n,["computerUse"]);null!=t&&s(e,["computerUse"],t);const o=r(n,["fileSearch"]);null!=o&&s(e,["fileSearch"],o);const i=r(n,["codeExecution"]);if(null!=i&&s(e,["codeExecution"],i),void 0!==r(n,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=r(n,["functionDeclarations"]);if(null!=l){let u=l;Array.isArray(u)&&(u=u.map(p=>p)),s(e,["functionDeclarations"],u)}const a=r(n,["googleMaps"]);null!=a&&s(e,["googleMaps"],function Iu(n){const e={};if(void 0!==r(n,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const t=r(n,["enableWidget"]);return null!=t&&s(e,["enableWidget"],t),e}(a));const d=r(n,["googleSearch"]);null!=d&&s(e,["googleSearch"],function vu(n){const e={};if(void 0!==r(n,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==r(n,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=r(n,["timeRangeFilter"]);return null!=t&&s(e,["timeRangeFilter"],t),e}(d));const f=r(n,["googleSearchRetrieval"]);null!=f&&s(e,["googleSearchRetrieval"],f);const c=r(n,["urlContext"]);return null!=c&&s(e,["urlContext"],c),e}(ge(U)))),s(e,["setup","tools"],R)}const _=r(n,["sessionResumption"]);void 0!==e&&null!=_&&s(e,["setup","sessionResumption"],function Pu(n){const e={},t=r(n,["handle"]);if(null!=t&&s(e,["handle"],t),void 0!==r(n,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return e}(_));const I=r(n,["inputAudioTranscription"]);void 0!==e&&null!=I&&s(e,["setup","inputAudioTranscription"],I);const C=r(n,["outputAudioTranscription"]);void 0!==e&&null!=C&&s(e,["setup","outputAudioTranscription"],C);const v=r(n,["realtimeInputConfig"]);void 0!==e&&null!=v&&s(e,["setup","realtimeInputConfig"],v);const A=r(n,["contextWindowCompression"]);void 0!==e&&null!=A&&s(e,["setup","contextWindowCompression"],A);const P=r(n,["proactivity"]);if(void 0!==e&&null!=P&&s(e,["setup","proactivity"],P),void 0!==r(n,["explicitVadSignal"]))throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return{}}(i,t)),t}(n,d));const f=r(e,["lockAdditionalFields"]);return void 0!==t&&null!=f&&s(t,["fieldMask"],f),{}}class xu extends S{constructor(e){super(),this.apiClient=e}create(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const f=function Tu(n,e){const t={},o=r(e,["config"]);return null!=o&&s(t,["config"],_u(n,o,t)),t}(t.apiClient,e);a=T("auth_tokens",f._url),d=f._query,delete f.config,delete f._url,delete f._query;const c=function wu(n,e){let t=null;const o=n.bidiGenerateContentSetup;if("object"==typeof o&&null!==o&&"setup"in o){const l=o.setup;"object"==typeof l&&null!==l?(n.bidiGenerateContentSetup=l,t=l):delete n.bidiGenerateContentSetup}else void 0!==o&&delete n.bidiGenerateContentSetup;const i=n.fieldMask;if(t){const l=function Nu(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const o=n[t];if("object"==typeof o&&null!=o&&Object.keys(o).length>0){const i=Object.keys(o).map(l=>`${t}.${l}`);e.push(...i)}else e.push(t)}return e.join(",")}(t);if(Array.isArray(e?.lockAdditionalFields)&&0===e?.lockAdditionalFields.length)l?n.fieldMask=l:delete n.fieldMask;else if(e?.lockAdditionalFields&&e.lockAdditionalFields.length>0&&null!==i&&Array.isArray(i)&&i.length>0){const a=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let d=[];i.length>0&&(d=i.map(c=>a.includes(c)?`generationConfig.${c}`:c));const f=[];l&&f.push(l),d.length>0&&f.push(...d),f.length>0?n.fieldMask=f.join(","):delete n.fieldMask}else delete n.fieldMask}else null!==i&&Array.isArray(i)&&i.length>0?n.fieldMask=i.join(","):delete n.fieldMask;return n}(f,e.config);return l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(c),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(u=>u.json()),l.then(u=>u)}})()}}class Vu extends S{constructor(e){var t;super(),t=this,this.apiClient=e,this.list=function(){var o=(0,g.A)(function*(i){return new pe(fe.PAGED_ITEM_DOCUMENTS,l=>t.listInternal({parent:i.parent,config:l.config}),yield t.listInternal(i),i)});return function(i){return o.apply(this,arguments)}}()}get(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=function Lu(n){const e={},t=r(n,["name"]);return null!=t&&s(e,["_url","name"],t),e}(e);return a=T("{name}",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json()),l.then(c=>c)}})()}delete(e){var t=this;return(0,g.A)(function*(){var o,i;let l="",a={};if(t.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=function Uu(n){const e={},t=r(n,["name"]);null!=t&&s(e,["_url","name"],t);const o=r(n,["config"]);return null!=o&&function Du(n,e){const o=r(n,["force"]);void 0!==e&&null!=o&&s(e,["_query","force"],o)}(o,e),e}(e);l=T("{name}",d._url),a=d._query,delete d._url,delete d._query,yield t.apiClient.request({path:l,queryParams:a,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal})}})()}listInternal(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=function Fu(n){const e={},t=r(n,["parent"]);null!=t&&s(e,["_url","parent"],t);const o=r(n,["config"]);return null!=o&&function ku(n,e){const o=r(n,["pageSize"]);void 0!==e&&null!=o&&s(e,["_query","pageSize"],o);const i=r(n,["pageToken"]);void 0!==e&&null!=i&&s(e,["_query","pageToken"],i)}(o,e),e}(e);return a=T("{parent}/documents",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json()),l.then(c=>{const u=function Gu(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["nextPageToken"]);null!=o&&s(e,["nextPageToken"],o);const i=r(n,["documents"]);if(null!=i){let l=i;Array.isArray(l)&&(l=l.map(a=>a)),s(e,["documents"],l)}return e}(c),p=new _i;return Object.assign(p,u),p})}})()}}class qu extends S{constructor(e,t=new Vu(e)){var o;super(),o=this,this.apiClient=e,this.documents=t,this.list=(0,g.A)(function*(i={}){return new pe(fe.PAGED_ITEM_FILE_SEARCH_STORES,l=>o.listInternal(l),yield o.listInternal(i),i)})}uploadToFileSearchStore(e){var t=this;return(0,g.A)(function*(){if(t.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return t.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)})()}create(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=function wa(n){const e={},t=r(n,["config"]);return null!=t&&function Na(n,e){const o=r(n,["displayName"]);void 0!==e&&null!=o&&s(e,["displayName"],o)}(t,e),e}(e);return a=T("fileSearchStores",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json()),l.then(c=>c)}})()}get(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=function Ua(n){const e={},t=r(n,["name"]);return null!=t&&s(e,["_url","name"],t),e}(e);return a=T("{name}",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json()),l.then(c=>c)}})()}delete(e){var t=this;return(0,g.A)(function*(){var o,i;let l="",a={};if(t.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=function Da(n){const e={},t=r(n,["name"]);null!=t&&s(e,["_url","name"],t);const o=r(n,["config"]);return null!=o&&function xa(n,e){const o=r(n,["force"]);void 0!==e&&null!=o&&s(e,["_query","force"],o)}(o,e),e}(e);l=T("{name}",d._url),a=d._query,delete d._url,delete d._query,yield t.apiClient.request({path:l,queryParams:a,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal})}})()}listInternal(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=function qa(n){const e={},t=r(n,["config"]);return null!=t&&function Va(n,e){const o=r(n,["pageSize"]);void 0!==e&&null!=o&&s(e,["_query","pageSize"],o);const i=r(n,["pageToken"]);void 0!==e&&null!=i&&s(e,["_query","pageToken"],i)}(t,e),e}(e);return a=T("fileSearchStores",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json()),l.then(c=>{const u=function Ha(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["nextPageToken"]);null!=o&&s(e,["nextPageToken"],o);const i=r(n,["fileSearchStores"]);if(null!=i){let l=i;Array.isArray(l)&&(l=l.map(a=>a)),s(e,["fileSearchStores"],l)}return e}(c),p=new Ti;return Object.assign(p,u),p})}})()}uploadToFileSearchStoreInternal(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=function Ba(n){const e={},t=r(n,["fileSearchStoreName"]);null!=t&&s(e,["_url","file_search_store_name"],t);const o=r(n,["config"]);return null!=o&&Et(o,e),e}(e);return a=T("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json()),l.then(c=>{const u=function ba(n){const e={},t=r(n,["sdkHttpResponse"]);return null!=t&&s(e,["sdkHttpResponse"],t),e}(c),p=new Ei;return Object.assign(p,u),p})}})()}importFile(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=function Fa(n){const e={},t=r(n,["fileSearchStoreName"]);null!=t&&s(e,["_url","file_search_store_name"],t);const o=r(n,["fileName"]);null!=o&&s(e,["fileName"],o);const i=r(n,["config"]);return null!=i&&function La(n,e){const o=r(n,["customMetadata"]);if(void 0!==e&&null!=o){let l=o;Array.isArray(l)&&(l=l.map(a=>a)),s(e,["customMetadata"],l)}const i=r(n,["chunkingConfig"]);void 0!==e&&null!=i&&s(e,["chunkingConfig"],i)}(i,e),e}(e);return a=T("{file_search_store_name}:importFile",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json()),l.then(c=>{const u=function ka(n){const e={},t=r(n,["name"]);null!=t&&s(e,["name"],t);const o=r(n,["metadata"]);null!=o&&s(e,["metadata"],o);const i=r(n,["done"]);null!=i&&s(e,["done"],i);const l=r(n,["error"]);null!=l&&s(e,["error"],l);const a=r(n,["response"]);return null!=a&&s(e,["response"],function Ga(n){const e={},t=r(n,["sdkHttpResponse"]);null!=t&&s(e,["sdkHttpResponse"],t);const o=r(n,["parent"]);null!=o&&s(e,["parent"],o);const i=r(n,["documentName"]);return null!=i&&s(e,["documentName"],i),e}(a)),e}(c),p=new Oe;return Object.assign(p,u),p})}})()}}let Nt=function(){const{crypto:n}=globalThis;if(n?.randomUUID)return Nt=n.randomUUID.bind(n),n.randomUUID();const e=new Uint8Array(1),t=n?()=>n.getRandomValues(e)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,o=>(+o^t()&15>>+o/4).toString(16))};function un(n){return"object"==typeof n&&null!==n&&("name"in n&&"AbortError"===n.name||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const dn=n=>{if(n instanceof Error)return n;if("object"==typeof n&&null!==n){try{if("[object Error]"===Object.prototype.toString.call(n)){const e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};class Z extends Error{}class W extends Z{constructor(e,t,o,i){super(`${W.makeMessage(e,t,o)}`),this.status=e,this.headers=i,this.error=t}static makeMessage(e,t,o){const i=t?.message?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):o;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,t,o,i){if(!e||!i)return new Fe({message:o,cause:dn(t)});const l=t;return 400===e?new xt(e,l,o,i):401===e?new Dt(e,l,o,i):403===e?new Ut(e,l,o,i):404===e?new Lt(e,l,o,i):409===e?new kt(e,l,o,i):422===e?new Ft(e,l,o,i):429===e?new Gt(e,l,o,i):e>=500?new Vt(e,l,o,i):new W(e,l,o,i)}}class fn extends W{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Fe extends W{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class wt extends Fe{constructor({message:e}={}){super({message:e??"Request timed out."})}}class xt extends W{}class Dt extends W{}class Ut extends W{}class Lt extends W{}class kt extends W{}class Ft extends W{}class Gt extends W{}class Vt extends W{}const Bu=/^[a-z][a-z0-9+.-]*:/i;let cn=n=>(cn=Array.isArray,cn(n));const qt=cn,Ee="0.0.1",zu=()=>{var n,e,t,o,i;const l=function Ou(){return typeof Deno<"u"&&null!=Deno.build?"deno":typeof EdgeRuntime<"u"?"edge":"[object process]"===Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)?"node":"unknown"}();if("deno"===l)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ee,"X-Stainless-OS":Bt(Deno.build.os),"X-Stainless-Arch":Ht(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:null!==(e=null===(n=Deno.version)||void 0===n?void 0:n.deno)&&void 0!==e?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ee,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===l)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ee,"X-Stainless-OS":Bt(null!==(t=globalThis.process.platform)&&void 0!==t?t:"unknown"),"X-Stainless-Arch":Ht(null!==(o=globalThis.process.arch)&&void 0!==o?o:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":null!==(i=globalThis.process.version)&&void 0!==i?i:"unknown"};const a=function Xu(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const o=t.exec(navigator.userAgent);if(o)return{browser:e,version:`${o[1]||0}.${o[2]||0}.${o[3]||0}`}}return null}();return a?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ee,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${a.browser}`,"X-Stainless-Runtime-Version":a.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ee,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}},Ht=n=>"x32"===n?"x32":"x86_64"===n||"x64"===n?"x64":"arm"===n?"arm":"aarch64"===n||"arm64"===n?"arm64":n?`other:${n}`:"unknown",Bt=n=>(n=n.toLowerCase()).includes("ios")?"iOS":"android"===n?"Android":"darwin"===n?"MacOS":"win32"===n?"Windows":"freebsd"===n?"FreeBSD":"openbsd"===n?"OpenBSD":"linux"===n?"Linux":n?`Other:${n}`:"Unknown";let Ge;function bt(...n){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function ju(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return bt({start(){},pull:t=>(0,g.A)(function*(){const{done:o,value:i}=yield e.next();o?t.close():t.enqueue(i)})(),cancel:()=>(0,g.A)(function*(){var t;yield null===(t=e.return)||void 0===t?void 0:t.call(e)})()})}function Jt(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{next:()=>(0,g.A)(function*(){try{const t=yield e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}})(),return:()=>(0,g.A)(function*(){const t=e.cancel();return e.releaseLock(),yield t,{done:!0,value:void 0}})(),[Symbol.asyncIterator](){return this}}}function pn(){return(pn=(0,g.A)(function*(n){var e,t;if(null===n||"object"!=typeof n)return;if(n[Symbol.asyncIterator])return void(yield null===(t=(e=n[Symbol.asyncIterator]()).return)||void 0===t?void 0:t.call(e));const o=n.getReader(),i=o.cancel();o.releaseLock(),yield i})).apply(this,arguments)}const nd=({body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),$t=()=>{var n;if(typeof File>"u"){const{process:e}=globalThis,t="string"==typeof(null===(n=e?.versions)||void 0===n?void 0:n.node)&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function mn(n,e,t){return $t(),new File(n,e??"unknown_file",t)}const Wt=n=>null!=n&&"object"==typeof n&&"number"==typeof n.size&&"string"==typeof n.type&&"function"==typeof n.text&&"function"==typeof n.slice&&"function"==typeof n.arrayBuffer;function hn(){return(hn=(0,g.A)(function*(n,e,t){if($t(),(n=>null!=n&&"object"==typeof n&&"string"==typeof n.name&&"number"==typeof n.lastModified&&Wt(n))(n=yield n))return n instanceof File?n:mn([yield n.arrayBuffer()],n.name);if((n=>null!=n&&"object"==typeof n&&"string"==typeof n.url&&"function"==typeof n.blob)(n)){const i=yield n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),mn(yield gn(i),e,t)}const o=yield gn(n);if(e||(e=function td(n){return("object"==typeof n&&null!==n&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}(n)),!t?.type){const i=o.find(l=>"object"==typeof l&&"type"in l&&l.type);"string"==typeof i&&(t=Object.assign(Object.assign({},t),{type:i}))}return mn(o,e,t)})).apply(this,arguments)}function gn(n){return yn.apply(this,arguments)}function yn(){return(yn=(0,g.A)(function*(n){var e,t,o,l;let a=[];if("string"==typeof n||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)a.push(n);else if(Wt(n))a.push(n instanceof Blob?n:yield n.arrayBuffer());else{if(!(n=>null!=n&&"object"==typeof n&&"function"==typeof n[Symbol.asyncIterator])(n)){const u=null===(l=n?.constructor)||void 0===l?void 0:l.name;throw new Error(`Unexpected data type: ${typeof n}${u?`; constructor: ${u}`:""}${function ld(n){return"object"!=typeof n||null===n?"":`; props: [${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}(n)}`)}try{for(var c,d=!0,f=ee(n);!(e=(c=yield f.next()).done);d=!0){d=!1;const u=c.value;a.push(...yield gn(u))}}catch(u){t={error:u}}finally{try{!d&&!e&&(o=f.return)&&(yield o.call(f))}finally{if(t)throw t.error}}}return a})).apply(this,arguments)}let ad=(()=>{class n{constructor(t){this._client=t}}return n._key=[],n})();function Kt(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Yt=Object.freeze(Object.create(null)),Ve=((n=Kt)=>function(t,...o){if(1===t.length)return t[0];let i=!1;const l=[],a=t.reduce((u,p,h)=>{var m,y,E;/[?#]/.test(p)&&(i=!0);const _=o[h];let I=(i?encodeURIComponent:n)(""+_);return h!==o.length&&(null==_||"object"==typeof _&&_.toString===(null===(E=Object.getPrototypeOf(null!==(y=Object.getPrototypeOf(null!==(m=_.hasOwnProperty)&&void 0!==m?m:Yt))&&void 0!==y?y:Yt))||void 0===E?void 0:E.toString))&&(I=_+"",l.push({start:u.length+p.length,length:I.length,error:`Value of type ${Object.prototype.toString.call(_).slice(8,-1)} is not a valid path parameter`})),u+p+(h===o.length?"":I)},""),d=a.split(/[?#]/,1)[0],f=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;let c;for(;null!==(c=f.exec(d));)l.push({start:c.index,length:c[0].length,error:`Value "${c[0]}" can't be safely passed as a path parameter`});if(l.sort((u,p)=>u.start-p.start),l.length>0){let u=0;const p=l.reduce((h,m)=>{const y=" ".repeat(m.start-u),E="^".repeat(m.length);return u=m.start+m.length,h+y+E},"");throw new Z(`Path parameters result in path with invalid segments:\n${l.map(h=>h.error).join("\n")}\n${a}\n${p}`)}return a})(Kt);class Ot extends ad{create(e,t){var o;const{api_version:i=this._client.apiVersion}=e,l=we(e,["api_version"]);if("model"in l&&"agent_config"in l)throw new Z("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in l&&"generation_config"in l)throw new Z("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Ve`/${i}/interactions`,Object.assign(Object.assign({body:l},t),{stream:null!==(o=e.stream)&&void 0!==o&&o}))}delete(e,t={},o){const{api_version:i=this._client.apiVersion}=t??{};return this._client.delete(Ve`/${i}/interactions/${e}`,o)}cancel(e,t={},o){const{api_version:i=this._client.apiVersion}=t??{};return this._client.post(Ve`/${i}/interactions/${e}/cancel`,o)}get(e,t={},o){var i;const l=t??{},{api_version:a=this._client.apiVersion}=l,d=we(l,["api_version"]);return this._client.get(Ve`/${a}/interactions/${e}`,Object.assign(Object.assign({query:d},o),{stream:null!==(i=t?.stream)&&void 0!==i&&i}))}}Ot._key=Object.freeze(["interactions"]);class zt extends Ot{}let qe,He;function _n(n){let e;return(qe??(e=new globalThis.TextEncoder,qe=e.encode.bind(e)))(n)}function Xt(n){let e;return(He??(e=new globalThis.TextDecoder,He=e.decode.bind(e)))(n)}class Be{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(null==e)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?_n(e):e;this.buffer=function ud(n){let e=0;for(const i of n)e+=i.length;const t=new Uint8Array(e);let o=0;for(const i of n)t.set(i,o),o+=i.length;return t}([this.buffer,t]);const o=[];let i;for(;null!=(i=dd(this.buffer,this.carriageReturnIndex));){if(i.carriage&&null==this.carriageReturnIndex){this.carriageReturnIndex=i.index;continue}if(null!=this.carriageReturnIndex&&(i.index!==this.carriageReturnIndex+1||i.carriage)){o.push(Xt(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const a=Xt(this.buffer.subarray(0,null!==this.carriageReturnIndex?i.preceding-1:i.preceding));o.push(a),this.buffer=this.buffer.subarray(i.index),this.carriageReturnIndex=null}return o}flush(){return this.buffer.length?this.decode("\n"):[]}}function dd(n,e){for(let i=e??0;i<n.length;i++){if(10===n[i])return{preceding:i,index:i+1,carriage:!1};if(13===n[i])return{preceding:i,index:i+1,carriage:!0}}return null}function fd(n){for(let o=0;o<n.length-1;o++){if(10===n[o]&&10===n[o+1]||13===n[o]&&13===n[o+1])return o+2;if(13===n[o]&&10===n[o+1]&&o+3<n.length&&13===n[o+2]&&10===n[o+3])return o+4}return-1}Be.NEWLINE_CHARS=new Set(["\n","\r"]),Be.NEWLINE_REGEXP=/\r\n|[\n\r]/g;const be={off:0,error:200,warn:300,info:400,debug:500},Qt=(n,e,t)=>{if(n){if(function $u(n,e){return Object.prototype.hasOwnProperty.call(n,e)}(be,n))return n;K(t).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(be))}`)}};function Se(){}function Je(n,e,t){return!e||be[n]>be[t]?Se:e[n].bind(e)}const cd={error:Se,warn:Se,info:Se,debug:Se};let Zt=new WeakMap;function K(n){var e;const t=n.logger,o=null!==(e=n.logLevel)&&void 0!==e?e:"off";if(!t)return cd;const i=Zt.get(t);if(i&&i[0]===o)return i[1];const l={error:Je("error",t,o),warn:Je("warn",t,o),info:Je("info",t,o),debug:Je("debug",t,o)};return Zt.set(t,[o,l]),l}const me=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,t])=>[e,"x-goog-api-key"===e.toLowerCase()||"authorization"===e.toLowerCase()||"cookie"===e.toLowerCase()||"set-cookie"===e.toLowerCase()?"***":t]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);class Ce{constructor(e,t,o){this.iterator=e,this.controller=t,this.client=o}static fromSSEResponse(e,t,o){let i=!1;const l=o?K(o):console;return new Ce(function a(){return j(this,arguments,function*(){var f,c,u;if(i)throw new Z("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let h=!1;try{try{for(var E,m=!0,y=ee(function pd(n,e){return j(this,arguments,function*(){var o,i,l;if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&"ReactNative"===globalThis.navigator.product?new Z("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Z("Attempted to iterate over a response with no body");const d=new hd,f=new Be,c=Jt(n.body);try{for(var h,u=!0,p=ee(function md(n){return j(this,arguments,function*(){var t,o,i;let a=new Uint8Array;try{for(var c,d=!0,f=ee(n);!(t=(c=yield M(f.next())).done);d=!0){d=!1;const u=c.value;if(null==u)continue;const p=u instanceof ArrayBuffer?new Uint8Array(u):"string"==typeof u?_n(u):u;let m,h=new Uint8Array(a.length+p.length);for(h.set(a),h.set(p,a.length),a=h;-1!==(m=fd(a));)yield yield M(a.slice(0,m)),a=a.slice(m)}}catch(u){o={error:u}}finally{try{!d&&!t&&(i=f.return)&&(yield M(i.call(f)))}finally{if(o)throw o.error}}a.length>0&&(yield yield M(a))})}(c));!(o=(h=yield M(p.next())).done);u=!0){u=!1;const m=h.value;for(const y of f.decode(m)){const E=d.decode(y);E&&(yield yield M(E))}}}catch(m){i={error:m}}finally{try{!u&&!o&&(l=p.return)&&(yield M(l.call(p)))}finally{if(i)throw i.error}}for(const m of f.flush()){const y=d.decode(m);y&&(yield yield M(y))}})}(e,t));!(f=(E=yield M(y.next())).done);m=!0){m=!1;const _=E.value;if(!h){if(_.data.startsWith("[DONE]")){h=!0;continue}try{yield yield M(JSON.parse(_.data))}catch(I){throw l.error("Could not parse message into JSON:",_.data),l.error("From chunk:",_.raw),I}}}}catch(_){c={error:_}}finally{try{!m&&!f&&(u=y.return)&&(yield M(u.call(y)))}finally{if(c)throw c.error}}h=!0}catch(_){if(un(_))return yield M(void 0);throw _}finally{h||t.abort()}})},t,o)}static fromReadableStream(e,t,o){let i=!1;return new Ce(function a(){return j(this,arguments,function*(){var f,c,u;if(i)throw new Z("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let h=!1;try{try{for(var E,m=!0,y=ee(function l(){return j(this,arguments,function*(){var f,c,u;const h=new Be,m=Jt(e);try{for(var _,y=!0,E=ee(m);!(f=(_=yield M(E.next())).done);y=!0){y=!1;const I=_.value;for(const C of h.decode(I))yield yield M(C)}}catch(I){c={error:I}}finally{try{!y&&!f&&(u=E.return)&&(yield M(u.call(E)))}finally{if(c)throw c.error}}for(const I of h.flush())yield yield M(I)})}());!(f=(E=yield M(y.next())).done);m=!0){m=!1;const _=E.value;h||_&&(yield yield M(JSON.parse(_)))}}catch(_){c={error:_}}finally{try{!m&&!f&&(u=y.return)&&(yield M(u.call(y)))}finally{if(c)throw c.error}}h=!0}catch(_){if(un(_))return yield M(void 0);throw _}finally{h||t.abort()}})},t,o)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],o=this.iterator(),i=l=>({next:()=>{if(0===l.length){const a=o.next();e.push(a),t.push(a)}return l.shift()}});return[new Ce(()=>i(e),this.controller,this.client),new Ce(()=>i(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return bt({start:()=>(0,g.A)(function*(){t=e[Symbol.asyncIterator]()})(),pull:o=>(0,g.A)(function*(){try{const{value:i,done:l}=yield t.next();if(l)return o.close();const a=_n(JSON.stringify(i)+"\n");o.enqueue(a)}catch(i){o.error(i)}})(),cancel:()=>(0,g.A)(function*(){var o;yield null===(o=t.return)||void 0===o?void 0:o.call(t)})()})}}class hd{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const l={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],l}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,o,i]=function gd(n,e){const t=n.indexOf(e);return-1!==t?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}(e,":");return i.startsWith(" ")&&(i=i.substring(1)),"event"===t?this.event=i:"data"===t&&this.data.push(i),null}}function yd(n,e){return Tn.apply(this,arguments)}function Tn(){return(Tn=(0,g.A)(function*(n,e){const{response:t,requestLogID:o,retryOfRequestLogID:i,startTime:l}=e,a=yield(0,g.A)(function*(){var d;if(e.options.stream)return K(n).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,n):Ce.fromSSEResponse(t,e.controller,n);if(204===t.status)return null;if(e.options.__binaryResponse)return t;const f=t.headers.get("content-type"),c=null===(d=f?.split(";")[0])||void 0===d?void 0:d.trim();return c?.includes("application/json")||c?.endsWith("+json")?yield t.json():yield t.text()})();return K(n).debug(`[${o}] response parsed`,me({retryOfRequestLogID:i,url:t.url,status:t.status,body:a,durationMs:Date.now()-l})),a})).apply(this,arguments)}class En extends Promise{constructor(e,t,o=yd){super(i=>{i(null)}),this.responsePromise=t,this.parseResponse=o,this.client=e}_thenUnwrap(e){var t=this;return new En(this.client,this.responsePromise,function(){var o=(0,g.A)(function*(i,l){return e(yield t.parseResponse(i,l),l)});return function(i,l){return o.apply(this,arguments)}}())}asResponse(){return this.responsePromise.then(e=>e.response)}withResponse(){var e=this;return(0,g.A)(function*(){const[t,o]=yield Promise.all([e.parse(),e.asResponse()]);return{data:t,response:o}})()}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}const jt=Symbol("brand.privateNullableHeaders");function*_d(n){if(!n)return;if(jt in n){const{values:o,nulls:i}=n;yield*o.entries();for(const l of i)yield[l,null];return}let t,e=!1;n instanceof Headers?t=n.entries():qt(n)?t=n:(e=!0,t=Object.entries(n??{}));for(let o of t){const i=o[0];if("string"!=typeof i)throw new TypeError("expected header name to be a string");const l=qt(o[1])?o[1]:[o[1]];let a=!1;for(const d of l)void 0!==d&&(e&&!a&&(a=!0,yield[i,null]),yield[i,d])}}const Re=n=>{const e=new Headers,t=new Set;for(const o of n){const i=new Set;for(const[l,a]of _d(o)){const d=l.toLowerCase();i.has(d)||(e.delete(l),i.add(d)),null===a?(e.delete(l),t.add(d)):(e.append(l,a),t.delete(d))}}return{[jt]:!0,values:e,nulls:t}},Cn=n=>{var e,t,o,i,l,a;return typeof globalThis.process<"u"?null!==(o=null===(t=null===(e=globalThis.process.env)||void 0===e?void 0:e[n])||void 0===t?void 0:t.trim())&&void 0!==o?o:void 0:typeof globalThis.Deno<"u"?null===(a=null===(l=null===(i=globalThis.Deno.env)||void 0===i?void 0:i.get)||void 0===l?void 0:l.call(i,n))||void 0===a?void 0:a.trim():void 0};let Td=(()=>{class n{constructor(t){var o,i,l,a,d,f,c,{baseURL:u=Cn("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:p=(null!==(o=Cn("GEMINI_API_KEY"))&&void 0!==o?o:null),apiVersion:h="v1beta"}=t,m=we(t,["baseURL","apiKey","apiVersion"]);const y=Object.assign(Object.assign({apiKey:p,apiVersion:h},m),{baseURL:u||"https://generativelanguage.googleapis.com"});this.baseURL=y.baseURL,this.timeout=null!==(i=y.timeout)&&void 0!==i?i:n.DEFAULT_TIMEOUT,this.logger=null!==(l=y.logger)&&void 0!==l?l:console;const E="warn";this.logLevel=E,this.logLevel=null!==(d=null!==(a=Qt(y.logLevel,"ClientOptions.logLevel",this))&&void 0!==a?a:Qt(Cn("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))&&void 0!==d?d:E,this.fetchOptions=y.fetchOptions,this.maxRetries=null!==(f=y.maxRetries)&&void 0!==f?f:2,this.fetch=null!==(c=y.fetch)&&void 0!==c?c:function Zu(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}(),this.encoder=nd,this._options=y,this.apiKey=p,this.apiVersion=h,this.clientAdapter=y.clientAdapter}withOptions(t){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),t))}baseURLOverridden(){return"https://generativelanguage.googleapis.com"!==this.baseURL}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:o}){if(!(t.has("authorization")||t.has("x-goog-api-key")||this.apiKey&&t.get("x-goog-api-key")||o.has("x-goog-api-key")))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}authHeaders(t){var o=this;return(0,g.A)(function*(){const i=Re([t.headers]);if(!i.values.has("authorization")&&!i.values.has("x-goog-api-key")){if(o.apiKey)return Re([{"x-goog-api-key":o.apiKey}]);if(o.clientAdapter.isVertexAI())return Re([yield o.clientAdapter.getAuthHeaders()])}})()}stringifyQuery(t){return Object.entries(t).filter(([o,i])=>typeof i<"u").map(([o,i])=>{if("string"==typeof i||"number"==typeof i||"boolean"==typeof i)return`${encodeURIComponent(o)}=${encodeURIComponent(i)}`;if(null===i)return`${encodeURIComponent(o)}=`;throw new Z(`Cannot stringify type ${typeof i}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Ee}`}defaultIdempotencyKey(){return`stainless-node-retry-${Nt()}`}makeStatusError(t,o,i,l){return W.generate(t,o,i,l)}buildURL(t,o,i){const l=!this.baseURLOverridden()&&i||this.baseURL,a=(n=>Bu.test(n))(t)?new URL(t):new URL(l+(l.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),d=this.defaultQuery();return function Ju(n){if(!n)return!0;for(const e in n)return!1;return!0}(d)||(o=Object.assign(Object.assign({},d),o)),"object"==typeof o&&o&&!Array.isArray(o)&&(a.search=this.stringifyQuery(o)),a.toString()}prepareOptions(t){var o=this;return(0,g.A)(function*(){if(o.clientAdapter&&o.clientAdapter.isVertexAI()&&!t.path.startsWith(`/${o.apiVersion}/projects/`)){const i=t.path.slice(o.apiVersion.length+1);t.path=`/${o.apiVersion}/projects/${o.clientAdapter.getProject()}/locations/${o.clientAdapter.getLocation()}${i}`}})()}prepareRequest(t,o){return(0,g.A)(function*(i,{}){}).apply(this,arguments)}get(t,o){return this.methodRequest("get",t,o)}post(t,o){return this.methodRequest("post",t,o)}patch(t,o){return this.methodRequest("patch",t,o)}put(t,o){return this.methodRequest("put",t,o)}delete(t,o){return this.methodRequest("delete",t,o)}methodRequest(t,o,i){return this.request(Promise.resolve(i).then(l=>Object.assign({method:t,path:o},l)))}request(t,o=null){return new En(this,this.makeRequest(t,o,void 0))}makeRequest(t,o,i){var l=this;return(0,g.A)(function*(){var a,d,f;const c=yield t,u=null!==(a=c.maxRetries)&&void 0!==a?a:l.maxRetries;null==o&&(o=u),yield l.prepareOptions(c);const{req:p,url:h,timeout:m}=yield l.buildRequest(c,{retryCount:u-o});yield l.prepareRequest(p,{url:h,options:c});const y="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),E=void 0===i?"":`, retryOf: ${i}`,_=Date.now();if(K(l).debug(`[${y}] sending request`,me({retryOfRequestLogID:i,method:c.method,url:h,options:c,headers:p.headers})),null!==(d=c.signal)&&void 0!==d&&d.aborted)throw new fn;const I=new AbortController,C=yield l.fetchWithTimeout(h,p,m,I).catch(dn),v=Date.now();if(C instanceof globalThis.Error){const P=`retrying, ${o} attempts remaining`;if(null!==(f=c.signal)&&void 0!==f&&f.aborted)throw new fn;const R=un(C)||/timed? ?out/i.test(String(C)+("cause"in C?String(C.cause):""));if(o)return K(l).info(`[${y}] connection ${R?"timed out":"failed"} - ${P}`),K(l).debug(`[${y}] connection ${R?"timed out":"failed"} (${P})`,me({retryOfRequestLogID:i,url:h,durationMs:v-_,message:C.message})),l.retryRequest(c,o,i??y);throw K(l).info(`[${y}] connection ${R?"timed out":"failed"} - error; no more retries left`),K(l).debug(`[${y}] connection ${R?"timed out":"failed"} (error; no more retries left)`,me({retryOfRequestLogID:i,url:h,durationMs:v-_,message:C.message})),R?new wt:new Fe({cause:C})}const A=`[${y}${E}] ${p.method} ${h} ${C.ok?"succeeded":"failed"} with status ${C.status} in ${v-_}ms`;if(!C.ok){const P=yield l.shouldRetry(C);if(o&&P){const D=`retrying, ${o} attempts remaining`;return yield function ed(n){return pn.apply(this,arguments)}(C.body),K(l).info(`${A} - ${D}`),K(l).debug(`[${y}] response error (${D})`,me({retryOfRequestLogID:i,url:C.url,status:C.status,headers:C.headers,durationMs:v-_})),l.retryRequest(c,o,i??y,C.headers)}const R=P?"error; no more retries left":"error; not retryable";K(l).info(`${A} - ${R}`);const U=yield C.text().catch(D=>dn(D).message),F=(n=>{try{return JSON.parse(n)}catch{return}})(U),H=F?void 0:U;throw K(l).debug(`[${y}] response error (${R})`,me({retryOfRequestLogID:i,url:C.url,status:C.status,headers:C.headers,message:H,durationMs:Date.now()-_})),l.makeStatusError(C.status,F,H,C.headers)}return K(l).info(A),K(l).debug(`[${y}] response start`,me({retryOfRequestLogID:i,url:C.url,status:C.status,headers:C.headers,durationMs:v-_})),{response:C,options:c,controller:I,requestLogID:y,retryOfRequestLogID:i,startTime:_}})()}fetchWithTimeout(t,o,i,l){var a=this;return(0,g.A)(function*(){const d=o||{},{signal:f,method:c}=d,u=we(d,["signal","method"]);f&&f.addEventListener("abort",()=>l.abort());const p=setTimeout(()=>l.abort(),i),h=globalThis.ReadableStream&&u.body instanceof globalThis.ReadableStream||"object"==typeof u.body&&null!==u.body&&Symbol.asyncIterator in u.body,m=Object.assign(Object.assign(Object.assign({signal:l.signal},h?{duplex:"half"}:{}),{method:"GET"}),u);c&&(m.method=c.toUpperCase());try{return yield a.fetch.call(void 0,t,m)}finally{clearTimeout(p)}})()}shouldRetry(t){return(0,g.A)(function*(){const o=t.headers.get("x-should-retry");return"true"===o||"false"!==o&&(408===t.status||409===t.status||429===t.status||t.status>=500)})()}retryRequest(t,o,i,l){var a=this;return(0,g.A)(function*(){var d;let f;const c=l?.get("retry-after-ms");if(c){const p=parseFloat(c);Number.isNaN(p)||(f=p)}const u=l?.get("retry-after");if(u&&!f){const p=parseFloat(u);f=Number.isNaN(p)?Date.parse(u)-Date.now():1e3*p}if(!(f&&0<=f&&f<6e4)){const p=null!==(d=t.maxRetries)&&void 0!==d?d:a.maxRetries;f=a.calculateDefaultRetryTimeoutMillis(o,p)}return yield(n=>new Promise(e=>setTimeout(e,n)))(f),a.makeRequest(t,o-1,i)})()}calculateDefaultRetryTimeoutMillis(t,o){return Math.min(.5*Math.pow(2,o-t),8)*(1-.25*Math.random())*1e3}buildRequest(t){var o=this;return(0,g.A)(function*(i,{retryCount:l=0}={}){var a,d,f;const c=Object.assign({},i),{method:u,path:p,query:h,defaultBaseURL:m}=c,y=o.buildURL(p,h,m);"timeout"in c&&((n,e)=>{if("number"!=typeof e||!Number.isInteger(e))throw new Z(`${n} must be an integer`);if(e<0)throw new Z(`${n} must be a positive integer`)})("timeout",c.timeout),c.timeout=null!==(a=c.timeout)&&void 0!==a?a:o.timeout;const{bodyHeaders:E,body:_}=o.buildBody({options:c}),I=yield o.buildHeaders({options:i,method:u,bodyHeaders:E,retryCount:l});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:u,headers:I},c.signal&&{signal:c.signal}),globalThis.ReadableStream&&_ instanceof globalThis.ReadableStream&&{duplex:"half"}),_&&{body:_}),null!==(d=o.fetchOptions)&&void 0!==d?d:{}),null!==(f=c.fetchOptions)&&void 0!==f?f:{}),url:y,timeout:c.timeout}}).apply(this,arguments)}buildHeaders(t){var o=this;return(0,g.A)(function*({options:i,method:l,bodyHeaders:a,retryCount:d}){let f={};o.idempotencyHeader&&"get"!==l&&(i.idempotencyKey||(i.idempotencyKey=o.defaultIdempotencyKey()),f[o.idempotencyHeader]=i.idempotencyKey);const c=yield o.authHeaders(i);let u=Re([f,Object.assign(Object.assign({Accept:"application/json","User-Agent":o.getUserAgent(),"X-Stainless-Retry-Count":String(d)},i.timeout?{"X-Stainless-Timeout":String(Math.trunc(i.timeout/1e3))}:{}),Ge??(Ge=zu())),o._options.defaultHeaders,a,i.headers,c]);return o.validateHeaders(u),u.values}).apply(this,arguments)}buildBody({options:{body:t,headers:o}}){if(!t)return{bodyHeaders:void 0,body:void 0};const i=Re([o]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||"string"==typeof t&&i.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:"object"==typeof t&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&"function"==typeof t.next)?{bodyHeaders:void 0,body:ju(t)}:this.encoder({body:t,headers:i})}}return n.DEFAULT_TIMEOUT=6e4,n})();class b extends Td{constructor(){super(...arguments),this.interactions=new zt(this)}}function no(n,e){const t={},o=r(n,["sdkHttpResponse"]);null!=o&&s(t,["sdkHttpResponse"],o);const i=r(n,["name"]);null!=i&&s(t,["name"],i);const l=r(n,["state"]);null!=l&&s(t,["state"],Qn(l));const a=r(n,["createTime"]);null!=a&&s(t,["createTime"],a);const d=r(n,["tuningTask","startTime"]);null!=d&&s(t,["startTime"],d);const f=r(n,["tuningTask","completeTime"]);null!=f&&s(t,["endTime"],f);const c=r(n,["updateTime"]);null!=c&&s(t,["updateTime"],c);const u=r(n,["description"]);null!=u&&s(t,["description"],u);const p=r(n,["baseModel"]);null!=p&&s(t,["baseModel"],p);const h=r(n,["_self"]);return null!=h&&s(t,["tunedModel"],function Fd(n){const t={},o=r(n,["name"]);null!=o&&s(t,["model"],o);const i=r(n,["name"]);return null!=i&&s(t,["endpoint"],i),t}(h)),t}function In(n,e){const t={},o=r(n,["sdkHttpResponse"]);null!=o&&s(t,["sdkHttpResponse"],o);const i=r(n,["name"]);null!=i&&s(t,["name"],i);const l=r(n,["state"]);null!=l&&s(t,["state"],Qn(l));const a=r(n,["createTime"]);null!=a&&s(t,["createTime"],a);const d=r(n,["startTime"]);null!=d&&s(t,["startTime"],d);const f=r(n,["endTime"]);null!=f&&s(t,["endTime"],f);const c=r(n,["updateTime"]);null!=c&&s(t,["updateTime"],c);const u=r(n,["error"]);null!=u&&s(t,["error"],u);const p=r(n,["description"]);null!=p&&s(t,["description"],p);const h=r(n,["baseModel"]);null!=h&&s(t,["baseModel"],h);const m=r(n,["tunedModel"]);null!=m&&s(t,["tunedModel"],m);const y=r(n,["preTunedModel"]);null!=y&&s(t,["preTunedModel"],y);const E=r(n,["supervisedTuningSpec"]);null!=E&&s(t,["supervisedTuningSpec"],E);const _=r(n,["preferenceOptimizationSpec"]);null!=_&&s(t,["preferenceOptimizationSpec"],_);const I=r(n,["tuningDataStats"]);null!=I&&s(t,["tuningDataStats"],I);const C=r(n,["encryptionSpec"]);null!=C&&s(t,["encryptionSpec"],C);const v=r(n,["partnerModelTuningSpec"]);null!=v&&s(t,["partnerModelTuningSpec"],v);const A=r(n,["customBaseModel"]);null!=A&&s(t,["customBaseModel"],A);const P=r(n,["experiment"]);null!=P&&s(t,["experiment"],P);const R=r(n,["labels"]);null!=R&&s(t,["labels"],R);const U=r(n,["outputUri"]);null!=U&&s(t,["outputUri"],U);const F=r(n,["pipelineJob"]);null!=F&&s(t,["pipelineJob"],F);const H=r(n,["serviceAccount"]);null!=H&&s(t,["serviceAccount"],H);const N=r(n,["tunedModelDisplayName"]);null!=N&&s(t,["tunedModelDisplayName"],N);const D=r(n,["veoTuningSpec"]);return null!=D&&s(t,["veoTuningSpec"],D),t}function to(n,e){const t={},o=r(n,["gcsUri"]);null!=o&&s(t,["validationDatasetUri"],o);const i=r(n,["vertexDatasetResource"]);return null!=i&&s(t,["validationDatasetUri"],i),t}b.GeminiNextGenAPIClient=b,b.GeminiNextGenAPIClientError=Z,b.APIError=W,b.APIConnectionError=Fe,b.APIConnectionTimeoutError=wt,b.APIUserAbortError=fn,b.NotFoundError=Lt,b.ConflictError=kt,b.RateLimitError=Gt,b.BadRequestError=xt,b.AuthenticationError=Dt,b.InternalServerError=Vt,b.PermissionDeniedError=Ut,b.UnprocessableEntityError=Ft,b.toFile=function sd(n,e,t){return hn.apply(this,arguments)},b.Interactions=zt;class Hd extends S{constructor(e){var t;super(),t=this,this.apiClient=e,this.list=(0,g.A)(function*(o={}){return new pe(fe.PAGED_ITEM_TUNING_JOBS,i=>t.listInternal(i),yield t.listInternal(o),o)}),this.get=function(){var o=(0,g.A)(function*(i){return yield t.getInternal(i)});return function(i){return o.apply(this,arguments)}}(),this.tune=function(){var o=(0,g.A)(function*(i){var l;if(t.apiClient.isVertexAI()){if(i.baseModel.startsWith("projects/")){const a={tunedModelName:i.baseModel};null!==(l=i.config)&&void 0!==l&&l.preTunedModelCheckpointId&&(a.checkpointId=i.config.preTunedModelCheckpointId);const d=Object.assign(Object.assign({},i),{preTunedModel:a});return d.baseModel=void 0,yield t.tuneInternal(d)}{const a=Object.assign({},i);return yield t.tuneInternal(a)}}{const a=Object.assign({},i),d=yield t.tuneMldevInternal(a);let f="";return void 0!==d.metadata&&void 0!==d.metadata.tunedModel?f=d.metadata.tunedModel:void 0!==d.name&&d.name.includes("/operations/")&&(f=d.name.split("/operations/")[0]),{name:f,state:Nn.JOB_STATE_QUEUED}}});return function(i){return o.apply(this,arguments)}}()}getInternal(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=function Nd(n){const t={},o=r(n,["name"]);return null!=o&&s(t,["_url","name"],o),t}(e);return f=T("{name}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>In(p))}{const u=function Md(n){const t={},o=r(n,["name"]);return null!=o&&s(t,["_url","name"],o),t}(e);return f=T("{name}",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>no(p))}})()}listInternal(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=function Ud(n,e){const t={},o=r(n,["config"]);return null!=o&&function xd(n,e){const i=r(n,["pageSize"]);void 0!==e&&null!=i&&s(e,["_query","pageSize"],i);const l=r(n,["pageToken"]);void 0!==e&&null!=l&&s(e,["_query","pageToken"],l);const a=r(n,["filter"]);void 0!==e&&null!=a&&s(e,["_query","filter"],a)}(o,t),t}(e);return f=T("tuningJobs",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function kd(n){const t={},o=r(n,["sdkHttpResponse"]);null!=o&&s(t,["sdkHttpResponse"],o);const i=r(n,["nextPageToken"]);null!=i&&s(t,["nextPageToken"],i);const l=r(n,["tuningJobs"]);if(null!=l){let a=l;Array.isArray(a)&&(a=a.map(d=>In(d))),s(t,["tuningJobs"],a)}return t}(p),m=new Vn;return Object.assign(m,h),m})}{const u=function Dd(n,e){const t={},o=r(n,["config"]);return null!=o&&function wd(n,e){const i=r(n,["pageSize"]);void 0!==e&&null!=i&&s(e,["_query","pageSize"],i);const l=r(n,["pageToken"]);void 0!==e&&null!=l&&s(e,["_query","pageToken"],l);const a=r(n,["filter"]);void 0!==e&&null!=a&&s(e,["_query","filter"],a)}(o,t),t}(e);return f=T("tunedModels",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function Ld(n){const t={},o=r(n,["sdkHttpResponse"]);null!=o&&s(t,["sdkHttpResponse"],o);const i=r(n,["nextPageToken"]);null!=i&&s(t,["nextPageToken"],i);const l=r(n,["tunedModels"]);if(null!=l){let a=l;Array.isArray(a)&&(a=a.map(d=>no(d))),s(t,["tuningJobs"],a)}return t}(p),m=new Vn;return Object.assign(m,h),m})}})()}cancel(e){var t=this;return(0,g.A)(function*(){var o,i,l,a;let d,f="",c={};if(t.apiClient.isVertexAI()){const u=function Cd(n){const t={},o=r(n,["name"]);return null!=o&&s(t,["_url","name"],o),t}(e);return f=T("{name}:cancel",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function vd(n){const t={},o=r(n,["sdkHttpResponse"]);return null!=o&&s(t,["sdkHttpResponse"],o),t}(p),m=new qn;return Object.assign(m,h),m})}{const u=function Ed(n){const t={},o=r(n,["name"]);return null!=o&&s(t,["_url","name"],o),t}(e);return f=T("{name}:cancel",u._url),c=u._query,delete u._url,delete u._query,d=t.apiClient.request({path:f,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:null===(l=e.config)||void 0===l?void 0:l.httpOptions,abortSignal:null===(a=e.config)||void 0===a?void 0:a.abortSignal}).then(p=>p.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:p.headers},m})),d.then(p=>{const h=function Id(n){const t={},o=r(n,["sdkHttpResponse"]);return null!=o&&s(t,["sdkHttpResponse"],o),t}(p),m=new qn;return Object.assign(m,h),m})}})()}tuneInternal(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI()){const f=function Pd(n,e){const t={},o=r(n,["baseModel"]);null!=o&&s(t,["baseModel"],o);const i=r(n,["preTunedModel"]);null!=i&&s(t,["preTunedModel"],i);const l=r(n,["trainingDataset"]);null!=l&&function Vd(n,e,t){let i=r(t,["config","method"]);if(void 0===i&&(i="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===i){const a=r(n,["gcsUri"]);void 0!==e&&null!=a&&s(e,["supervisedTuningSpec","trainingDatasetUri"],a)}else if("PREFERENCE_TUNING"===i){const a=r(n,["gcsUri"]);void 0!==e&&null!=a&&s(e,["preferenceOptimizationSpec","trainingDatasetUri"],a)}let l=r(t,["config","method"]);if(void 0===l&&(l="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===l){const a=r(n,["vertexDatasetResource"]);void 0!==e&&null!=a&&s(e,["supervisedTuningSpec","trainingDatasetUri"],a)}else if("PREFERENCE_TUNING"===l){const a=r(n,["vertexDatasetResource"]);void 0!==e&&null!=a&&s(e,["preferenceOptimizationSpec","trainingDatasetUri"],a)}if(void 0!==r(n,["examples"]))throw new Error("examples parameter is not supported in Vertex AI.")}(l,t,e);const a=r(n,["config"]);return null!=a&&function Sd(n,e,t){let i=r(t,["config","method"]);if(void 0===i&&(i="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===i){const m=r(n,["validationDataset"]);void 0!==e&&null!=m&&s(e,["supervisedTuningSpec"],to(m))}else if("PREFERENCE_TUNING"===i){const m=r(n,["validationDataset"]);void 0!==e&&null!=m&&s(e,["preferenceOptimizationSpec"],to(m))}const l=r(n,["tunedModelDisplayName"]);void 0!==e&&null!=l&&s(e,["tunedModelDisplayName"],l);const a=r(n,["description"]);void 0!==e&&null!=a&&s(e,["description"],a);let d=r(t,["config","method"]);if(void 0===d&&(d="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===d){const m=r(n,["epochCount"]);void 0!==e&&null!=m&&s(e,["supervisedTuningSpec","hyperParameters","epochCount"],m)}else if("PREFERENCE_TUNING"===d){const m=r(n,["epochCount"]);void 0!==e&&null!=m&&s(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],m)}let f=r(t,["config","method"]);if(void 0===f&&(f="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===f){const m=r(n,["learningRateMultiplier"]);void 0!==e&&null!=m&&s(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],m)}else if("PREFERENCE_TUNING"===f){const m=r(n,["learningRateMultiplier"]);void 0!==e&&null!=m&&s(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],m)}let c=r(t,["config","method"]);if(void 0===c&&(c="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===c){const m=r(n,["exportLastCheckpointOnly"]);void 0!==e&&null!=m&&s(e,["supervisedTuningSpec","exportLastCheckpointOnly"],m)}else if("PREFERENCE_TUNING"===c){const m=r(n,["exportLastCheckpointOnly"]);void 0!==e&&null!=m&&s(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],m)}let u=r(t,["config","method"]);if(void 0===u&&(u="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===u){const m=r(n,["adapterSize"]);void 0!==e&&null!=m&&s(e,["supervisedTuningSpec","hyperParameters","adapterSize"],m)}else if("PREFERENCE_TUNING"===u){const m=r(n,["adapterSize"]);void 0!==e&&null!=m&&s(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],m)}if(void 0!==r(n,["batchSize"]))throw new Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==r(n,["learningRate"]))throw new Error("learningRate parameter is not supported in Vertex AI.");const p=r(n,["labels"]);void 0!==e&&null!=p&&s(e,["labels"],p);const h=r(n,["beta"]);void 0!==e&&null!=h&&s(e,["preferenceOptimizationSpec","hyperParameters","beta"],h)}(a,t,e),t}(e,e);return a=T("tuningJobs",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:c.headers},p})),l.then(c=>In(c))}throw new Error("This method is only supported by the Vertex AI.")})()}tuneMldevInternal(e){var t=this;return(0,g.A)(function*(){var o,i;let l,a="",d={};if(t.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=function Rd(n,e){const t={},o=r(n,["baseModel"]);null!=o&&s(t,["baseModel"],o);const i=r(n,["preTunedModel"]);null!=i&&s(t,["preTunedModel"],i);const l=r(n,["trainingDataset"]);null!=l&&function Gd(n){const t={};if(void 0!==r(n,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==r(n,["vertexDatasetResource"]))throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const o=r(n,["examples"]);if(null!=o){let i=o;Array.isArray(i)&&(i=i.map(l=>l)),s(t,["examples","examples"],i)}}(l);const a=r(n,["config"]);return null!=a&&function Ad(n,e){const o={};if(void 0!==r(n,["validationDataset"]))throw new Error("validationDataset parameter is not supported in Gemini API.");const i=r(n,["tunedModelDisplayName"]);if(void 0!==e&&null!=i&&s(e,["displayName"],i),void 0!==r(n,["description"]))throw new Error("description parameter is not supported in Gemini API.");const l=r(n,["epochCount"]);void 0!==e&&null!=l&&s(e,["tuningTask","hyperparameters","epochCount"],l);const a=r(n,["learningRateMultiplier"]);if(null!=a&&s(o,["tuningTask","hyperparameters","learningRateMultiplier"],a),void 0!==r(n,["exportLastCheckpointOnly"]))throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==r(n,["preTunedModelCheckpointId"]))throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(void 0!==r(n,["adapterSize"]))throw new Error("adapterSize parameter is not supported in Gemini API.");const d=r(n,["batchSize"]);void 0!==e&&null!=d&&s(e,["tuningTask","hyperparameters","batchSize"],d);const f=r(n,["learningRate"]);if(void 0!==e&&null!=f&&s(e,["tuningTask","hyperparameters","learningRate"],f),void 0!==r(n,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");if(void 0!==r(n,["beta"]))throw new Error("beta parameter is not supported in Gemini API.")}(a,t),t}(e);return a=T("tunedModels",f._url),d=f._query,delete f._url,delete f._query,l=t.apiClient.request({path:a,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(c=>c.json().then(u=>{const p=u;return p.sdkHttpResponse={headers:c.headers},p})),l.then(c=>function qd(n){const t={},o=r(n,["sdkHttpResponse"]);null!=o&&s(t,["sdkHttpResponse"],o);const i=r(n,["name"]);null!=i&&s(t,["name"],i);const l=r(n,["metadata"]);null!=l&&s(t,["metadata"],l);const a=r(n,["done"]);null!=a&&s(t,["done"],a);const d=r(n,["error"]);return null!=d&&s(t,["error"],d),t}(c))}})()}}class Bd{download(e,t){return(0,g.A)(function*(){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")})()}}const $e="x-goog-upload-status";function vn(){return(vn=(0,g.A)(function*(n,e,t){var o;const i=yield oo(n,e,t),l=yield i?.json();if("final"!==(null===(o=i?.headers)||void 0===o?void 0:o[$e]))throw new Error("Failed to upload file: Upload status is not finalized.");return l.file})).apply(this,arguments)}function An(){return(An=(0,g.A)(function*(n,e,t){var o;const i=yield oo(n,e,t),l=yield i?.json();if("final"!==(null===(o=i?.headers)||void 0===o?void 0:o[$e]))throw new Error("Failed to upload file: Upload status is not finalized.");const a=Mn(l),d=new ze;return Object.assign(d,a),d})).apply(this,arguments)}function oo(n,e,t){return Sn.apply(this,arguments)}function Sn(){return(Sn=(0,g.A)(function*(n,e,t){var o,i;let l=0,a=0,d=new Ye(new Response),f="upload";for(l=n.size;a<l;){const c=Math.min(8388608,l-a),u=n.slice(a,a+c);a+c>=l&&(f+=", finalize");let p=0,h=1e3;for(;p<3&&(d=yield t.request({path:"",body:u,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":String(a),"Content-Length":String(c)}}}),null===(o=d?.headers)||void 0===o||!o[$e]);)p++,yield zd(h),h*=2;if(a+=c,"active"!==(null===(i=d?.headers)||void 0===i?void 0:i[$e]))break;if(l<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return d})).apply(this,arguments)}function Rn(){return(Rn=(0,g.A)(function*(n){return{size:n.size,type:n.type}})).apply(this,arguments)}function zd(n){return new Promise(e=>setTimeout(e,n))}class Xd{upload(e,t,o){return(0,g.A)(function*(){if("string"==typeof e)throw new Error("File path is not supported in browser uploader.");return yield function Kd(n,e,t){return vn.apply(this,arguments)}(e,t,o)})()}uploadToFileSearchStore(e,t,o){return(0,g.A)(function*(){if("string"==typeof e)throw new Error("File path is not supported in browser uploader.");return yield function Yd(n,e,t){return An.apply(this,arguments)}(e,t,o)})()}stat(e){return(0,g.A)(function*(){if("string"==typeof e)throw new Error("File path is not supported in browser uploader.");return yield function Od(n){return Rn.apply(this,arguments)}(e)})()}}class Qd{create(e,t,o){return new Zd(e,t,o)}}class Zd{constructor(e,t,o){this.url=e,this.headers=t,this.callbacks=o}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.close()}}const io="x-goog-api-key";class jd{constructor(e){this.apiKey=e}addAuthHeaders(e,t){var o=this;return(0,g.A)(function*(){if(null===e.get(io)){if(o.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!o.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(io,o.apiKey)}})()}}class nf{get interactions(){if(void 0!==this._interactions)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e?.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const t=new b({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e?.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(null==e.apiKey)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=null!==(t=e.vertexai)&&void 0!==t&&t,this.apiKey=e.apiKey;const o=function x(n,e,t,o){var i,l;if(!n?.baseUrl){const a={geminiUrl:void 0,vertexUrl:void 0};return e?null!==(i=a.vertexUrl)&&void 0!==i?i:t:null!==(l=a.geminiUrl)&&void 0!==l?l:o}return n.baseUrl}(e.httpOptions,e.vertexai,void 0,void 0);o&&(e.httpOptions?e.httpOptions.baseUrl=o:e.httpOptions={baseUrl:o}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const i=new jd(this.apiKey);this.apiClient=new za({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:"gl-node/web",uploader:new Xd,downloader:new Bd}),this.models=new mu(this.apiClient),this.live=new au(this.apiClient,i,new Qd),this.batches=new Rr(this.apiClient),this.chats=new ls(this.models,this.apiClient),this.caches=new is(this.apiClient),this.files=new ys(this.apiClient),this.operations=new hu(this.apiClient),this.authTokens=new xu(this.apiClient),this.tunings=new Hd(this.apiClient),this.fileSearchStores=new qu(this.apiClient)}}},9687(ce,$,w){w.d($,{q:()=>V});var g=w(6129);class q{constructor(k,x=q.now){this.schedulerActionCtor=k,this.now=x}schedule(k,x=0,S){return new this.schedulerActionCtor(this,k).schedule(S,x)}}q.now=g.U.now;class V extends q{constructor(k,x=q.now){super(k,x),this.actions=[],this._active=!1}flush(k){const{actions:x}=this;if(this._active)return void x.push(k);let S;this._active=!0;do{if(S=k.execute(k.state,k.delay))break}while(k=x.shift());if(this._active=!1,S){for(;k=x.shift();)k.unsubscribe();throw S}}}}}]);