"use strict";(self.webpackChunkshell=self.webpackChunkshell||[]).push([[455],{6455(Dg,Hi,W){W.d(Hi,{SmartTablePageComponent:()=>jg});var P=W(9769),Z=W(467),s=W(375),f=W(7705),N=W(7017);let Ee=(()=>{class n{saveState(t,i){try{localStorage.setItem(t,JSON.stringify(i))}catch(o){console.error("Error saving state to localStorage",o)}}loadState(t){try{const i=localStorage.getItem(t);return i?JSON.parse(i):null}catch(i){return console.error("Error loading state from localStorage",i),this.clearState(t),null}}clearState(t){try{localStorage.removeItem(t)}catch(i){console.error("Error clearing state from localStorage",i)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),he=(()=>{class n{persistenceService=(0,s.WQX)(Ee);STORAGE_KEY="smartTableConfig";initialTableConfig={feature:"row_contact",key:"row_contact_default",api:{url:"CONTACT",pathTable:"v1/Master/RowContact/GetAll",pathExport:"v1/Master/RowContact/export",method:"GET",defaultPageSize:12},config:{id:"row-contact-table",title:"Contact Master",dataStrategy:"SYNC",pagingMode:"paginator",infiniteScrollBehavior:"append",paginatorPosition:"bottom",stripedRows:!0,showGridlines:!1,rowHover:!0,globalFilterFields:["organization_name","contact_person","communication_detail","email_id","created_time"],enableColumnChooser:!0,exportConfig:{enabled:!0,options:[{label:"CSV",key:"csv",icon:"pi pi-file"},{label:"Excel",key:"excel",icon:"pi pi-file-excel"},{label:"PDF",key:"pdf",icon:"pi pi-file-pdf"}]},enableRowMenu:!0,enableHeaderActions:!0,enableSavedQueries:!0,enableConfigButton:!0,enableChipFilters:!0,enableMultiSelect:!0,enableFreeze:!0,defaultRows:10,role:"ADMIN",toolbarButtonMode:"iconAndText",toolbarActions:[{label:"Refresh",icon:"pi pi-refresh",key:"refresh"},{label:"Filter",icon:"pi pi-filter",key:"toggle:filter-sidebar"},{label:"Config",icon:"pi pi-cog",key:"toggle:config-sidebar"},{label:"Add Contact",icon:"pi pi-plus",key:"add:contacts"}],sizerConfig:{enabled:!0,defaultDensity:"compact",densities:[{name:"comfortable",rowHeight:60,cssClass:"text-base"},{name:"cozy",rowHeight:50,cssClass:"text-sm"},{name:"compact",rowHeight:36,cssClass:"text-xs"},{name:"ultra-compact",rowHeight:28,cssClass:"text-xs"}],additionalReservedSpace:0},encryptionConfig:{enabled:!0,encryptedFields:["communication_detail","email_id"],secretKey:"my-super-secret-key-for-demo"},cardViewConfig:{cardsPerRow:4},emptyStateConfig:{enabled:!0,imageUrl:"",title:"Your Contact List is Empty",subtitle:"Get started by adding your first contact or importing from another service.",actions:[{label:"Add New Contact",icon:"pi pi-plus",key:"add:contacts",class:"bg-indigo-600 hover:bg-indigo-700 text-white"}],migration:{enabled:!0,title:"Migrate your data from third-party systems",logos:[{src:"https://picsum.photos/seed/zohocrm/120/30",alt:"Zoho CRM"},{src:"https://picsum.photos/seed/quickbooks/150/30",alt:"Quickbooks"},{src:"https://picsum.photos/seed/salesforce/120/30",alt:"Salesforce"}],moreText:"and more",action:{label:"Import Contacts",key:"import:contacts",class:"bg-cyan-500 hover:bg-cyan-600 text-white"}}},footerConfig:{enabled:!0,columns:[{code:"contact_person",aggregation:"count",display:"Total Contacts: {value}"},{code:"annual_revenue",aggregation:"sum",display:"Total Revenue: {value}"}]}},advancedFilters:{enabled:!0,groups:[{name:"System Defined Filters",collapsible:!0,filters:[{code:"annual_revenue",name:"Annual Revenue",type:"numeric",operators:["=","!=",">","<",">=","<=","between","not between"],defaultOperator:">="}]},{name:"Date Filters",collapsible:!0,filters:[{code:"created_time",name:"Created Date",type:"date",dateOperators:["in the last 30 days","this month","this year","today"]}]},{name:"Lead Filters",collapsible:!1,filters:[{code:"lead_source",name:"Lead Source",type:"select",options:["Web","Organic","Referral"]}]}]},columns:[{index:0,name:"Select",code:"select_box",display:"table_cell",columnType:"CHECKBOX",width:"50px",align:"center",sortable:!1,filterable:!1,frozen:!0,showOnColumnChooser:!1},{index:1,name:"Contact Person",code:"contact_person",display:"table_cell",width:"250px",sortable:!0,filterable:!0,frozen:!0,cardHeader:!0,listRow:!0,filterOnCodes:["contact_person","organization_name"],cellTemplate:[{code:"avatar_url",columnType:"IMAGE",imageConfig:{shape:"circle"}},{code:"contact_person",tag:"p",bold:!0},{code:"organization_name",tag:"small"}]},{index:2,name:"Company",code:"organization_name",display:"table_cell",sortable:!0,filterable:!0,width:"200px"},{index:3,name:"Communication",code:"communication_detail",display:"table_cell",width:"150px",sortable:!0,filterable:!0,cardRow:!0,mask:{enabled:!0,unmaskEnabled:!0,visibleStart:0,visibleEnd:4,maskChar:"X"}},{index:4,name:"Email",code:"email_id",display:"table_cell",width:"250px",sortable:!0,filterable:!0,cardHeader1:!0,listRow:!0},{index:5,name:"Annual Revenue",code:"annual_revenue",display:"table_cell",align:"right",sortable:!0,filterable:!0,width:"150px",cardRow:!0,columnType:"numeric"},{index:6,name:"Created",code:"created_time",display:"table_cell",columnType:"DATE",width:"180px",sortable:!0,filterable:!0},{index:7,name:"Lead Source",code:"lead_source",display:"table_cell",sortable:!0,filterable:!0,width:"150px",cardRow:!0,listRow:!0},{index:8,name:"Action",code:"action",display:"table_cell",columnType:"ACTION",width:"120px",align:"center",showOnColumnChooser:!1}],rowActions:[{label:"Edit",icon:"pi pi-pencil",action:"edit",color:"text-blue-500"},{label:"Email",icon:"pi pi-envelope",action:"email",color:"text-gray-500"},{label:"Delete",icon:"pi pi-trash",action:"delete",color:"text-red-500"}],rowMenu:[{label:"Actions",items:[{label:"Edit",icon:"pi pi-pencil",action:"edit",shortcut:"E"},{label:"Duplicate",icon:"pi pi-copy",action:"duplicate"},{label:"Delete",icon:"pi pi-trash",action:"delete",shortcut:"Del"}]},{label:"Communication",items:[{label:"Call",icon:"pi pi-phone",action:"call"},{label:"WhatsApp",icon:"pi pi-whatsapp",action:"whatsapp"},{label:"Email",icon:"pi pi-envelope",action:"email"},{label:"SMS",icon:"pi pi-comment",action:"sms"}]}],headerMenu:[{label:"Bulk Actions",items:[{label:"Delete Selected",icon:"pi pi-trash",action:"delete_selected"}]}],drawerConfig:{width:"400px",position:"right",buttons:[],headerActions:[]}};configSignal=(0,s.vPA)(this.loadConfig());config=this.configSignal.asReadonly();constructor(){(0,s.QZP)(()=>{this.persistenceService.saveState(this.STORAGE_KEY,this.configSignal())})}loadConfig(){return this.persistenceService.loadState(this.STORAGE_KEY)||this.initialTableConfig}updateDataStrategy(t){this.configSignal.update(i=>({...i,config:{...i.config,dataStrategy:t}}))}updateInfiniteScrollBehavior(t){this.configSignal.update(i=>({...i,config:{...i.config,infiniteScrollBehavior:t}}))}updateCardsPerRow(t){this.configSignal.update(i=>({...i,config:{...i.config,cardViewConfig:{...i.config.cardViewConfig,cardsPerRow:t}}}))}updateFullConfig(t){this.configSignal.set(t)}resetToDefaults(){this.configSignal.set(JSON.parse(JSON.stringify(this.initialTableConfig)))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function St(n,r){if(!n)return"";const t=r.visibleStart??0,i=r.visibleEnd??0,o=r.maskChar??"*";if(n.length<=t+i)return n;const a=n.substring(0,t),l=n.substring(n.length-i);return`${a}${o.repeat(Math.max(0,n.length-t-i))}${l}`}function Qe(n,r,t){const i=r.validations?.find(p=>p.code===t),o=r.code===t?r.isRequired:void 0,a=r.code===t?r.emailValidation:void 0,l=r.code===t?r.genericValidation:void 0,c=i?.isRequired||o;if(c){const p=function Yi(n,r){return!r?.status||null!=n&&""!==String(n).trim()?null:{isValid:!1,style:{bgcolor:r.bgcolor,textcolor:r.textcolor,tooltip:r.tooltip}}}(n,c);if(p)return p}const d=i?.emailValidation||a;if(d){const p=function Ui(n,r){const t=String(n||"").trim();if(r.required&&!t)return{isValid:!1,style:{bgcolor:r.bgcolor||"rgba(255, 235, 238, 0.6)",textcolor:r.textcolor,tooltip:r.tooltip||"Email is required."}};if(!t)return null;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t))return{isValid:!1,style:{bgcolor:r.bgcolor||"rgba(255, 240, 210, 0.6)",tooltip:"Invalid email format."}};if(r.blacklist?.includes(t))return{isValid:!1,style:{bgcolor:r.bgcolor||"rgba(255, 235, 238, 0.6)",tooltip:"This email address is blacklisted."}};const o=t.split("@")[1];return r.notAllowedDomains?.includes(o)?{isValid:!1,style:{bgcolor:r.bgcolor||"rgba(255, 235, 238, 0.6)",tooltip:`Emails from the domain '${o}' are not allowed.`}}:r.allowedDomains&&r.allowedDomains.length>0&&!r.allowedDomains.includes(o)?{isValid:!1,style:{bgcolor:r.bgcolor||"rgba(255, 240, 210, 0.6)",tooltip:"Only emails from allowed domains are accepted."}}:null}(n,d);if(p)return p}const u=i?.genericValidation||l;if(u){const p=function Wi(n,r){const t=String(n||"");if(!t)return null;if(void 0!==r.minLength&&t.length<r.minLength)return{isValid:!1,style:{bgcolor:r.bgcolor||"rgba(255, 240, 210, 0.6)",textcolor:r.textcolor,tooltip:r.tooltip||`Must be at least ${r.minLength} characters long.`}};if(void 0!==r.maxLength&&t.length>r.maxLength)return{isValid:!1,style:{bgcolor:r.bgcolor||"rgba(255, 240, 210, 0.6)",textcolor:r.textcolor,tooltip:r.tooltip||`Cannot be more than ${r.maxLength} characters long.`}};if(r.onlyNumbers&&!/^\d+$/.test(t))return{isValid:!1,style:{bgcolor:r.bgcolor||"rgba(255, 240, 210, 0.6)",textcolor:r.textcolor,tooltip:r.tooltip||"Only numbers are allowed."}};if(r.pattern)try{if(!new RegExp(r.pattern).test(t))return{isValid:!1,style:{bgcolor:r.bgcolor||"rgba(255, 240, 210, 0.6)",textcolor:r.textcolor,tooltip:r.tooltip||"The format is invalid."}}}catch(i){console.error("Invalid regex pattern in configuration:",r.pattern,i)}return null}(n,u);if(p)return p}return{isValid:!0,style:null}}var e=W(5547);const Ft=(n,r)=>r.label;function Qi(n,r){1&n&&e.Hgh(0,"hr",1)}function Ji(n,r){if(1&n&&(e.rj2(0,"div",3)(1,"p",5),e.EFF(2),e.eux()()),2&n){const t=e.XpG().$implicit;e.R7$(2),e.JRh(t.label)}}function Zi(n,r){if(1&n&&e.Hgh(0,"i"),2&n){const t=e.XpG().$implicit;e.HbH(t.icon+" w-4 text-center")}}function qi(n,r){1&n&&e.Hgh(0,"span",10)}function Ki(n,r){if(1&n&&(e.rj2(0,"span",11),e.EFF(1),e.eux()),2&n){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.shortcut)}}function eo(n,r){1&n&&e.Hgh(0,"i",12)}function to(n,r){if(1&n&&e.Hgh(0,"i"),2&n){const t=e.XpG().$implicit;e.HbH(t.icon+" w-4 text-center")}}function no(n,r){1&n&&e.Hgh(0,"span",10)}function io(n,r){if(1&n&&(e.rj2(0,"span",11),e.EFF(1),e.eux()),2&n){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.shortcut)}}function oo(n,r){if(1&n){const t=e.RV6();e.rj2(0,"a",7),e.VwU("click",function(){const o=s.eBV(t).$implicit,a=e.XpG(4);return s.Njj(a.onActionClick(o))}),e.rj2(1,"div",8),e.nVh(2,to,1,2,"i",9)(3,no,1,0,"span",10),e.rj2(4,"span"),e.EFF(5),e.eux()(),e.nVh(6,io,2,1,"span",11),e.eux()}if(2&n){const t=r.$implicit,i=e.XpG(4);e.AVh("cursor-pointer",!!t.action&&!i.isItemDisabled(t))("hover:bg-gray-100",!!t.action&&!i.isItemDisabled(t))("dark:hover:bg-gray-700",!!t.action&&!i.isItemDisabled(t))("opacity-50",i.isItemDisabled(t))("cursor-not-allowed",i.isItemDisabled(t)),e.R7$(2),e.vxM(t.icon?2:3),e.R7$(3),e.JRh(t.label),e.R7$(),e.vxM(t.shortcut?6:-1)}}function ro(n,r){if(1&n&&(e.rj2(0,"div",13)(1,"div",2),e.Z7z(2,oo,7,13,"a",14,Ft),e.eux()()),2&n){const t=e.XpG().$implicit;e.R7$(2),e.Dyx(t.items)}}function ao(n,r){if(1&n){const t=e.RV6();e.rj2(0,"div",6),e.VwU("mouseenter",function(){const o=s.eBV(t).$implicit,a=e.XpG(2);return s.Njj(a.handleMouseEnter(o))})("mouseleave",function(){const o=s.eBV(t).$implicit,a=e.XpG(2);return s.Njj(a.handleMouseLeave(o))}),e.rj2(1,"a",7),e.VwU("click",function(){const o=s.eBV(t).$implicit,a=e.XpG(2);return s.Njj(a.onActionClick(o))}),e.rj2(2,"div",8),e.nVh(3,Zi,1,2,"i",9)(4,qi,1,0,"span",10),e.rj2(5,"span"),e.EFF(6),e.eux()(),e.rj2(7,"div",8),e.nVh(8,Ki,2,1,"span",11),e.nVh(9,eo,1,0,"i",12),e.eux()(),e.nVh(10,ro,4,0,"div",13),e.eux()}if(2&n){const t=r.$implicit,i=e.XpG(2);e.R7$(),e.AVh("cursor-pointer",!!t.action&&!i.isItemDisabled(t))("hover:bg-gray-100",!!t.action&&!i.isItemDisabled(t))("dark:hover:bg-gray-700",!!t.action&&!i.isItemDisabled(t))("opacity-50",i.isItemDisabled(t))("cursor-not-allowed",i.isItemDisabled(t)),e.R7$(2),e.vxM(t.icon?3:4),e.R7$(3),e.JRh(t.label),e.R7$(2),e.vxM(t.shortcut?8:-1),e.R7$(),e.vxM(t.items?9:-1),e.R7$(),e.vxM(t.items&&i.openSubMenu()===t.label?10:-1)}}function so(n,r){if(1&n&&(e.nVh(0,Qi,1,0,"hr",1),e.rj2(1,"div",2),e.nVh(2,Ji,3,1,"div",3),e.Z7z(3,ao,11,15,"div",4,Ft),e.eux()),2&n){const t=r.$implicit;e.vxM(0!==r.$index?0:-1),e.R7$(),e.BMQ("aria-labelledby",t.label),e.R7$(),e.vxM("Actions"!==t.label?2:-1),e.R7$(),e.Dyx(t.items)}}let sn=(()=>{class n{menuConfig=f.hFB.required();row=f.hFB.required();position=(0,f.hFB)(null);actionClicked=(0,f.CGW)();openSubMenu=(0,s.vPA)(null);isItemDisabled(t){const i=this.row();switch(t.action){case"call":case"whatsapp":case"sms":return!i.communication_detail;case"email":return!i.email_id;default:return!1}}onActionClick(t){!t.action||this.isItemDisabled(t)||this.actionClicked.emit({action:t.action,row:this.row()})}handleMouseEnter(t){t.items&&this.openSubMenu.set(t.label)}handleMouseLeave(t){t.items&&this.openSubMenu.set(null)}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-row-menu"]],inputs:{menuConfig:[1,"menuConfig"],row:[1,"row"],position:[1,"position"]},outputs:{actionClicked:"actionClicked"},decls:3,vars:14,consts:[[1,"w-56","rounded-md","shadow-lg","bg-white","dark:bg-gray-800","ring-1","ring-black","ring-opacity-5","focus:outline-none","z-20"],[1,"border-gray-200","dark:border-gray-700"],["role","menu","aria-orientation","vertical",1,"py-1"],[1,"px-3","pt-2","pb-1"],[1,"relative"],[1,"text-xs","font-semibold","text-gray-500","dark:text-gray-400","uppercase","tracking-wider"],[1,"relative",3,"mouseenter","mouseleave"],["role","menuitem",1,"flex","items-center","justify-between","px-3","py-2","text-sm","text-gray-700","dark:text-gray-200","transition-colors","duration-150",3,"click"],[1,"flex","items-center","gap-3"],[3,"class"],[1,"w-4"],[1,"text-xs","text-gray-400","dark:text-gray-500"],[1,"pi","pi-chevron-right","text-xs","text-gray-400"],[1,"absolute","left-full","-top-1","ml-1","w-56","rounded-md","shadow-lg","bg-white","dark:bg-gray-800","ring-1","ring-black","ring-opacity-5","focus:outline-none","z-30"],["role","menuitem",1,"flex","items-center","justify-between","px-3","py-2","text-sm","text-gray-700","dark:text-gray-200","transition-colors","duration-150",3,"cursor-pointer","hover:bg-gray-100","dark:hover:bg-gray-700","opacity-50","cursor-not-allowed"]],template:function(i,o){1&i&&(e.rj2(0,"div",0),e.Z7z(1,so,5,3,null,null,Ft),e.eux()),2&i&&(e.xc7("left",o.position()?o.position().x+"px":null)("top",o.position()?o.position().y+"px":null),e.AVh("origin-top-right",!o.position())("absolute",!o.position())("right-0",!o.position())("mt-2",!o.position())("fixed",!!o.position()),e.R7$(),e.Dyx(o.menuConfig()))},dependencies:[P.MD],encapsulation:2,changeDetection:0})}return n})();const ln=(n,r)=>r.label;function lo(n,r){if(1&n&&(e.rj2(0,"div",2)(1,"p",5),e.EFF(2),e.eux()()),2&n){const t=e.XpG().$implicit;e.R7$(2),e.JRh(t.label)}}function co(n,r){if(1&n){const t=e.RV6();e.rj2(0,"a",6),e.VwU("click",function(){const o=s.eBV(t).$implicit,a=e.XpG(2);return s.Njj(a.onActionClick(o.action))}),e.Hgh(1,"i"),e.rj2(2,"span"),e.EFF(3),e.eux()()}if(2&n){const t=r.$implicit;e.R7$(),e.HbH(t.icon),e.R7$(2),e.JRh(t.label)}}function uo(n,r){1&n&&e.Hgh(0,"hr",4)}function po(n,r){if(1&n&&(e.rj2(0,"div",1),e.nVh(1,lo,3,1,"div",2),e.Z7z(2,co,4,3,"a",3,ln),e.eux(),e.nVh(4,uo,1,0,"hr",4)),2&n){const t=r.$implicit,i=r.$index,o=r.$count,a=e.XpG();e.BMQ("aria-labelledby",t.label),e.R7$(),e.vxM(a.menuConfig().length>1?1:-1),e.R7$(),e.Dyx(t.items),e.R7$(2),e.vxM(i!==o-1?4:-1)}}let mo=(()=>{class n{menuConfig=f.hFB.required();actionClicked=(0,f.CGW)();onActionClick(t){this.actionClicked.emit(t)}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-header-menu"]],inputs:{menuConfig:[1,"menuConfig"]},outputs:{actionClicked:"actionClicked"},decls:3,vars:0,consts:[[1,"origin-top-right","absolute","right-0","mt-2","w-48","rounded-md","shadow-lg","bg-white","dark:bg-gray-800","ring-1","ring-black","ring-opacity-5","focus:outline-none","z-20"],["role","menu","aria-orientation","vertical",1,"py-1"],[1,"px-4","py-2"],["href","javascript:void(0)","role","menuitem",1,"flex","items-center","gap-3","px-4","py-2","text-sm","text-gray-700","dark:text-gray-200","hover:bg-gray-100","dark:hover:bg-gray-700","transition-colors","duration-150"],[1,"border-gray-200","dark:border-gray-700"],[1,"text-xs","text-gray-400","uppercase","tracking-wider"],["href","javascript:void(0)","role","menuitem",1,"flex","items-center","gap-3","px-4","py-2","text-sm","text-gray-700","dark:text-gray-200","hover:bg-gray-100","dark:hover:bg-gray-700","transition-colors","duration-150",3,"click"]],template:function(i,o){1&i&&(e.rj2(0,"div",0),e.Z7z(1,po,5,3,null,null,ln),e.eux()),2&i&&(e.R7$(),e.Dyx(o.menuConfig()))},dependencies:[P.MD],encapsulation:2,changeDetection:0})}return n})(),$e=(()=>{class n{elementRef=(0,s.WQX)(e.aKT);clickOutside=new s.bkB;constructor(){(0,s.QZP)(()=>{const t=i=>{this.elementRef.nativeElement.contains(i.target)||this.clickOutside.emit()};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}})}static \u0275fac=function(i){return new(i||n)};static \u0275dir=e.FsC({type:n,selectors:[["","clickOutside",""]],outputs:{clickOutside:"clickOutside"}})}return n})();const go=()=>["S","M","T","W","T","F","S"],_o=(n,r)=>r.date.getTime();function fo(n,r){if(1&n&&(e.j41(0,"div",17),e.EFF(1),e.k0s()),2&n){const t=r.$implicit;e.R7$(),e.JRh(t)}}function ho(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",19)(1,"button",21),e.bIt("click",function(){const o=s.eBV(t).$implicit,a=e.XpG(2);return s.Njj(a.selectDate(o.date))}),e.EFF(2),e.nI1(3,"date"),e.k0s()()}if(2&n){const t=r.$implicit,i=e.XpG(2);e.R7$(),e.AVh("text-gray-400",!t.isCurrentMonth)("dark:text-gray-500",!t.isCurrentMonth)("font-semibold",i.isToday(t.date))("bg-indigo-600",i.isToday(t.date))("text-white",i.isToday(t.date))("hover:bg-gray-200",!i.isDateInRange(t.date))("dark:hover:bg-gray-600",!i.isDateInRange(t.date))("bg-indigo-100",i.isDateInRange(t.date))("dark:bg-indigo-500/30",i.isDateInRange(t.date))("text-indigo-700",i.isDateInRange(t.date))("dark:text-indigo-300",i.isDateInRange(t.date))("rounded-l-full",i.isRangeStart(t.date)&&!!i.rangeEnd())("rounded-r-full",i.isRangeEnd(t.date))("rounded-full",i.isRangeStart(t.date)&&!i.rangeEnd()||i.isRangeStart(t.date)&&i.isRangeEnd(t.date)),e.R7$(),e.SpI(" ",e.i5U(3,29,t.date,"d")," ")}}function bo(n,r){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.nI1(2,"date"),e.nI1(3,"date"),e.k0s()),2&n){const t=e.XpG(2);e.R7$(),e.Lme("",e.i5U(2,2,t.rangeStart(),"shortDate")," - ",e.i5U(3,5,t.rangeEnd(),"shortDate"))}}function yo(n,r){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.nI1(2,"date"),e.k0s()),2&n){const t=e.XpG(2);e.R7$(),e.JRh(e.i5U(2,1,t.rangeStart(),"shortDate"))}}function vo(n,r){1&n&&(e.j41(0,"span"),e.EFF(1,"Select a date or a range"),e.k0s())}function Co(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",6)(1,"div",10)(2,"button",11),e.bIt("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.changeMonth(-1))}),e.nrm(3,"i",12),e.k0s(),e.j41(4,"span",13),e.EFF(5),e.nI1(6,"date"),e.k0s(),e.j41(7,"button",14),e.bIt("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.changeMonth(1))}),e.nrm(8,"i",15),e.k0s()(),e.j41(9,"div",16),e.Z7z(10,fo,2,1,"div",17,e.fX1),e.k0s(),e.j41(12,"div",18),e.Z7z(13,ho,4,32,"div",19,_o),e.k0s(),e.j41(15,"div",20),e.nVh(16,bo,4,8,"span")(17,yo,3,4,"span")(18,vo,2,0,"span"),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(5),e.JRh(e.i5U(6,2,t.currentMonth(),"LLLL yyyy")),e.R7$(5),e.Dyx(e.lJ4(5,go)),e.R7$(3),e.Dyx(t.calendarGrid()),e.R7$(3),e.vxM(t.rangeStart()&&t.rangeEnd()?16:t.rangeStart()?17:18)}}function xo(n,r){if(1&n){const t=e.RV6();e.j41(0,"li",32)(1,"input",34),e.bIt("change",function(){const o=s.eBV(t).$implicit,a=e.XpG(2);return s.Njj(a.toggleValue(o))}),e.k0s(),e.j41(2,"label",35),e.EFF(3),e.k0s()()}if(2&n){const t=r.$implicit,i=e.XpG(2);e.R7$(),e.Y8G("id","filter-val-"+t)("checked",i.selectedValues().has(t)),e.R7$(),e.Y8G("for","filter-val-"+t)("title",t),e.R7$(),e.JRh(t)}}function wo(n,r){1&n&&(e.j41(0,"li",33),e.EFF(1,"No values found."),e.k0s())}function ko(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",2)(1,"div",22)(2,"div",23),e.nrm(3,"i",24),e.k0s(),e.j41(4,"input",25,0),e.bIt("input",function(){s.eBV(t);const o=e.sdS(5),a=e.XpG();return s.Njj(a.searchTerm.set(o.value))}),e.k0s()()(),e.j41(6,"div",26)(7,"div",27)(8,"input",28),e.bIt("change",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.toggleSelectAll())}),e.k0s(),e.j41(9,"label",29),e.EFF(10,"(Select All)"),e.k0s()(),e.nrm(11,"hr",30),e.j41(12,"ul",31),e.Z7z(13,xo,4,5,"li",32,e.fX1),e.nVh(15,wo,2,0,"li",33),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(8),e.Y8G("checked",t.isAllSelected()),e.R7$(5),e.Dyx(t.filteredValues()),e.R7$(2),e.vxM(0===t.filteredValues().length?15:-1)}}let So=(()=>{class n{column=f.hFB.required();data=f.hFB.required();activeFilter=(0,f.hFB)();apply=(0,f.CGW)();close=(0,f.CGW)();searchTerm=(0,s.vPA)("");selectedValues=(0,s.vPA)(new Set);currentMonth=(0,s.vPA)(new Date);rangeStart=(0,s.vPA)(null);rangeEnd=(0,s.vPA)(null);uniqueValues=(0,N.EW)(()=>{const t=this.column().code,i=this.data().map(o=>String(o[t]??"")).filter(o=>""!==o.trim());return[...new Set(i)].sort()});filteredValues=(0,N.EW)(()=>{const t=this.searchTerm().toLowerCase();return t?this.uniqueValues().filter(i=>i.toLowerCase().includes(t)):this.uniqueValues()});isAllSelected=(0,N.EW)(()=>{const t=this.filteredValues();return 0!==t.length&&t.every(i=>this.selectedValues().has(i))});calendarGrid=(0,N.EW)(()=>{const t=this.currentMonth(),i=t.getFullYear(),o=t.getMonth(),a=new Date(i,o,1),l=new Date(i,o+1,0),c=a.getDay(),d=l.getDate(),u=[];for(let g=0;g<c;g++){const m=new Date(a);m.setDate(m.getDate()-(c-g)),u.push({date:m,isCurrentMonth:!1})}for(let g=1;g<=d;g++){const m=new Date(i,o,g);u.push({date:m,isCurrentMonth:!0})}const p=42-u.length;for(let g=1;g<=p;g++){const m=new Date(l);m.setDate(m.getDate()+g),u.push({date:m,isCurrentMonth:!1})}return u});constructor(){(0,s.QZP)(()=>{const t=this.column(),i=this.activeFilter();if("DATE"===t.columnType)!i||"="!==i.operator&&"between"!==i.operator?this.resetDateSelection():(this.rangeStart.set(i.value1?new Date(i.value1+"T00:00:00"):null),this.rangeEnd.set(i.value2?new Date(i.value2+"T00:00:00"):null),i.value1&&this.currentMonth.set(new Date(i.value1+"T00:00:00")));else{const o=this.uniqueValues();if(i&&i.value1){const a=String(i.value1).split(",");this.selectedValues.set(new Set(a))}else this.selectedValues.set(new Set(o))}},{allowSignalWrites:!0})}toggleSelectAll(){const t=this.isAllSelected(),i=this.filteredValues();this.selectedValues.update(o=>{const a=new Set(o);return i.forEach(t?l=>a.delete(l):l=>a.add(l)),a})}toggleValue(t){this.selectedValues.update(i=>{const o=new Set(i);return o.has(t)?o.delete(t):o.add(t),o})}handleApply(){if("DATE"===this.column().columnType){const t=this.rangeStart();let i=this.rangeEnd();if(t&&i&&i<t){const o=t;this.rangeStart.set(i),this.rangeEnd.set(o),i=o}if(t&&i){const o={code:this.column().code,name:this.column().name,type:"date",operator:"between",value1:t.toISOString().split("T")[0],value2:i.toISOString().split("T")[0]};this.apply.emit({filter:o})}else if(t){const o={code:this.column().code,name:this.column().name,type:"date",operator:"=",value1:t.toISOString().split("T")[0]};this.apply.emit({filter:o})}else this.apply.emit({filter:null})}else{const t=Array.from(this.selectedValues()),i=this.uniqueValues();if(0===t.length||t.length===i.length)this.apply.emit({filter:null});else{const o={code:this.column().code,name:this.column().name,type:"select",operator:"=",value1:t.join(",")};this.apply.emit({filter:o})}}}handleClear(){"DATE"===this.column().columnType?this.resetDateSelection():(this.selectedValues.set(new Set),this.searchTerm.set("")),this.apply.emit({filter:null})}handleSort(t){this.apply.emit({sort:{column:this.column().code,direction:t}})}selectDate(t){const i=this.rangeStart(),o=this.rangeEnd();!i||o?(this.rangeStart.set(t),this.rangeEnd.set(null)):this.rangeEnd.set(t)}changeMonth(t){this.currentMonth.update(i=>{const o=new Date(i);return o.setMonth(o.getMonth()+t),o})}isDateInRange(t){const i=this.rangeStart(),o=this.rangeEnd();return!!i&&(o?t>=(i<o?i:o)&&t<=(i<o?o:i):t.getTime()===i.getTime())}isRangeStart(t){return this.rangeStart()?.getTime()===t.getTime()}isRangeEnd(t){return this.rangeEnd()?.getTime()===t.getTime()}isToday(t){const i=new Date;return t.getDate()===i.getDate()&&t.getMonth()===i.getMonth()&&t.getFullYear()===i.getFullYear()}resetDateSelection(){this.rangeStart.set(null),this.rangeEnd.set(null),this.currentMonth.set(new Date)}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-excel-filter"]],inputs:{column:[1,"column"],data:[1,"data"],activeFilter:[1,"activeFilter"]},outputs:{apply:"apply",close:"close"},decls:17,vars:1,consts:[["searchInput",""],[1,"absolute","top-full","right-0","mt-2","w-72","rounded-md","shadow-lg","bg-white","dark:bg-gray-800","ring-1","ring-black","ring-opacity-5","focus:outline-none","z-30","flex","flex-col","max-h-[28rem]",3,"clickOutside","click"],[1,"p-2","border-b","border-gray-200","dark:border-gray-700","flex-shrink-0"],[1,"flex","items-center","gap-2","w-full","px-2","py-1.5","text-sm","rounded-md","text-gray-700","dark:text-gray-200","hover:bg-gray-100","dark:hover:bg-gray-700",3,"click"],[1,"pi","pi-sort-amount-up-alt","w-4","text-center"],[1,"pi","pi-sort-amount-down","w-4","text-center"],[1,"p-3"],[1,"p-2","border-t","border-gray-200","dark:border-gray-700","flex-shrink-0","flex","justify-end","gap-2"],[1,"px-3","py-1.5","text-xs","font-medium","text-gray-700","dark:text-gray-200","bg-white","dark:bg-gray-700","border","border-gray-300","dark:border-gray-600","rounded-md","hover:bg-gray-50","dark:hover:bg-gray-600",3,"click"],[1,"px-3","py-1.5","text-xs","font-medium","text-white","bg-indigo-600","border","border-transparent","rounded-md","hover:bg-indigo-700",3,"click"],[1,"flex","items-center","justify-between","mb-2"],["title","Previous month",1,"p-2","rounded-full","hover:bg-gray-100","dark:hover:bg-gray-700",3,"click"],[1,"pi","pi-chevron-left","text-xs"],[1,"text-sm","font-semibold"],["title","Next month",1,"p-2","rounded-full","hover:bg-gray-100","dark:hover:bg-gray-700",3,"click"],[1,"pi","pi-chevron-right","text-xs"],[1,"grid","grid-cols-7","text-center","text-xs","text-gray-500","dark:text-gray-400"],[1,"w-8","h-8","flex","items-center","justify-center","font-medium"],[1,"grid","grid-cols-7","text-center","text-sm"],[1,"flex","justify-center","items-center"],[1,"mt-3","text-xs","text-center","text-gray-500","dark:text-gray-400"],[1,"w-8","h-8","rounded-full","transition-colors",3,"click"],[1,"relative"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],[1,"pi","pi-search","text-gray-400","text-xs"],["type","search","placeholder","Search values...",1,"block","w-full","pl-8","pr-3","py-1.5","border","border-gray-300","dark:border-gray-600","rounded-md","bg-white","dark:bg-gray-900","text-sm","focus:ring-1","focus:ring-indigo-500","focus:border-indigo-500",3,"input"],[1,"flex-grow","p-2","overflow-y-auto"],[1,"flex","items-center","px-1"],["type","checkbox","id","select-all-filter",1,"h-4","w-4","rounded","border-gray-300","text-indigo-600","focus:ring-indigo-500",3,"change","checked"],["for","select-all-filter",1,"ml-2","text-sm","font-medium","text-gray-900","dark:text-gray-100"],[1,"my-2","border-gray-200","dark:border-gray-700"],[1,"space-y-1"],[1,"flex","items-center","p-1","rounded-md","hover:bg-gray-100","dark:hover:bg-gray-700"],[1,"px-2","py-1","text-sm","text-center","text-gray-500","dark:text-gray-400"],["type","checkbox",1,"h-4","w-4","rounded","border-gray-300","text-indigo-600","focus:ring-indigo-500",3,"change","id","checked"],[1,"ml-2","text-sm","text-gray-700","dark:text-gray-300","truncate",3,"for","title"]],template:function(i,o){1&i&&(e.j41(0,"div",1),e.bIt("clickOutside",function(){return o.close.emit()})("click",function(l){return l.stopPropagation()}),e.j41(1,"div",2)(2,"button",3),e.bIt("click",function(){return o.handleSort("asc")}),e.nrm(3,"i",4),e.j41(4,"span"),e.EFF(5,"Sort Ascending"),e.k0s()(),e.j41(6,"button",3),e.bIt("click",function(){return o.handleSort("desc")}),e.nrm(7,"i",5),e.j41(8,"span"),e.EFF(9,"Sort Descending"),e.k0s()()(),e.nVh(10,Co,19,6,"div",6)(11,ko,16,2),e.j41(12,"div",7)(13,"button",8),e.bIt("click",function(){return o.handleClear()}),e.EFF(14," Clear "),e.k0s(),e.j41(15,"button",9),e.bIt("click",function(){return o.handleApply()}),e.EFF(16," Apply "),e.k0s()()()),2&i&&(e.R7$(10),e.vxM("DATE"===o.column().columnType?10:11))},dependencies:[P.MD,$e,P.vh],encapsulation:2,changeDetection:0})}return n})();const ke=(n,r)=>r.code,Fo=(n,r)=>r.organization_id,To=(n,r)=>r.action;function Mo(n,r){if(1&n){const t=e.RV6();e.j41(0,"input",14),e.bIt("change",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.toggleSelectAll())})("click",function(o){return s.eBV(t),s.Njj(o.stopPropagation())}),e.k0s()}if(2&n){const t=e.XpG(2);e.Y8G("checked",t.isAllSelectedOnPage())}}function jo(n,r){if(1&n){const t=e.RV6();e.j41(0,"app-header-menu",18),e.bIt("actionClicked",function(o){s.eBV(t);const a=e.XpG(3);return s.Njj(a.handleHeaderMenuAction(o))})("clickOutside",function(){s.eBV(t);const o=e.XpG(3);return s.Njj(o.isHeaderMenuOpen.set(!1))}),e.k0s()}if(2&n){const t=e.XpG(3);e.Y8G("menuConfig",t.headerMenuConfig())}}function Ro(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",11)(1,"button",15),e.bIt("click",function(o){s.eBV(t);const a=e.XpG(2);return o.stopPropagation(),s.Njj(a.isHeaderMenuOpen.set(!a.isHeaderMenuOpen()))}),e.nrm(2,"i",16),e.k0s(),e.nVh(3,jo,1,1,"app-header-menu",17),e.k0s()}if(2&n){const t=e.XpG(2);e.R7$(),e.AVh("opacity-50",0===t.selectedIds().size),e.Y8G("disabled",0===t.selectedIds().size),e.R7$(2),e.vxM(t.isHeaderMenuOpen()?3:-1)}}function Vo(n,r){if(1&n&&e.nrm(0,"i",20),2&n){const t=e.XpG(3);e.AVh("pi-sort-amount-up-alt","asc"===t.sortDirection())("pi-sort-amount-down","desc"===t.sortDirection())}}function Do(n,r){if(1&n&&(e.j41(0,"div",12)(1,"span"),e.EFF(2),e.k0s(),e.nVh(3,Vo,1,4,"i",19),e.k0s()),2&n){const t=e.XpG().$implicit,i=e.XpG();e.R7$(2),e.JRh(t.name),e.R7$(),e.vxM(i.sortColumn()===t.code?3:-1)}}function Ao(n,r){if(1&n){const t=e.RV6();e.j41(0,"app-excel-filter",24),e.bIt("apply",function(o){s.eBV(t);const a=e.XpG(2).$implicit,l=e.XpG();return s.Njj(l.handleApplyExcelFilter(o,a.code))})("close",function(){s.eBV(t);const o=e.XpG(3);return s.Njj(o.closeFilterMenu())}),e.k0s()}if(2&n){let t;const i=e.XpG(2).$implicit,o=e.XpG();e.Y8G("column",i)("data",o.data())("activeFilter",null==(t=o.activeFilters())?null:t[i.code])}}function No(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",13)(1,"button",21),e.bIt("click",function(o){s.eBV(t);const a=e.XpG().$implicit,l=e.XpG();return s.Njj(l.openFilterMenu(a,o))}),e.nrm(2,"i",22),e.k0s(),e.nVh(3,Ao,1,3,"app-excel-filter",23),e.k0s()}if(2&n){let t;const i=e.XpG().$implicit,o=e.XpG();e.R7$(),e.AVh("text-indigo-500",null==(t=o.activeFilters())?null:t[i.code]),e.R7$(2),e.vxM(o.openFilterMenuForColumn()===i?3:-1)}}function Eo(n,r){if(1&n){const t=e.RV6();e.j41(0,"th",8),e.bIt("dragover",function(o){s.eBV(t);const a=e.XpG();return s.Njj(a.onDragOver(o))})("drop",function(o){const a=s.eBV(t).$index,l=e.XpG();return s.Njj(l.onDrop(o,a))})("dragend",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.onDragEnd())}),e.j41(1,"div",9),e.bIt("dragstart",function(){const o=s.eBV(t).$index,a=e.XpG();return s.Njj(a.onDragStart(o))})("click",function(){const o=s.eBV(t).$implicit,a=e.XpG();return s.Njj(a.onSort(o.code))})("keydown.enter",function(o){const a=s.eBV(t).$implicit,l=e.XpG();return o.preventDefault(),s.Njj(l.onSort(a.code))})("keydown.space",function(o){const a=s.eBV(t).$implicit,l=e.XpG();return o.preventDefault(),s.Njj(l.onSort(a.code))}),e.nVh(2,Mo,1,1,"input",10)(3,Ro,4,4,"div",11)(4,Do,4,2,"div",12),e.nVh(5,No,4,3,"div",13),e.k0s()()}if(2&n){const t=r.$implicit,i=r.$index,o=r.$count,a=e.XpG();e.xc7("width",t.width)("left",t.frozen?a.columnOffsets()[i]:null),e.AVh("border-r",i===o-1||t.frozen||a.showGridlines())("sticky",t.frozen)("z-30",t.frozen)("bg-gray-100",t.frozen)("opacity-50",a.draggedColumnIndex()===i),e.R7$(),e.AVh("justify-center","center"===t.align)("justify-end","right"===t.align)("justify-between","center"!==t.align&&"right"!==t.align)("cursor-pointer",t.sortable)("cursor-move","CHECKBOX"!==t.columnType&&"ACTION"!==t.columnType&&!t.frozen),e.Y8G("title",t.sortable?a.sortColumn()===t.code?"asc"===a.sortDirection()?"Sort descending":"Sort ascending":"Sort by "+t.name:null),e.BMQ("draggable","CHECKBOX"!==t.columnType&&"ACTION"!==t.columnType&&!t.frozen)("tabindex",t.sortable?0:-1),e.R7$(),e.vxM("CHECKBOX"===t.columnType&&a.enableMultiSelect()?2:"ACTION"===t.columnType&&a.headerMenuConfig()?3:4),e.R7$(3),e.vxM(t.filterable?5:-1)}}function $o(n,r){if(1&n){const t=e.RV6();e.j41(0,"input",30),e.bIt("change",function(){s.eBV(t);const o=e.XpG(3).$implicit,a=e.XpG();return s.Njj(a.toggleRowSelection(o.organization_id))})("click",function(o){return s.eBV(t),s.Njj(o.stopPropagation())}),e.k0s()}if(2&n){const t=e.XpG(3).$implicit,i=e.XpG();e.Y8G("checked",i.selectedIds().has(t.organization_id))}}function Go(n,r){if(1&n&&e.nVh(0,$o,1,1,"input",29),2&n){const t=e.XpG(3);e.vxM(t.enableMultiSelect()?0:-1)}}function Io(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",36),e.bIt("click",function(o){const a=s.eBV(t).$implicit,l=e.XpG(4).$implicit,c=e.XpG();return o.stopPropagation(),s.Njj(c.rowAction.emit({action:a.action,row:l}))}),e.nrm(1,"i"),e.k0s()}if(2&n){const t=r.$implicit;e.HbH(t.color),e.Y8G("title",t.label),e.R7$(),e.HbH(t.icon)}}function Xo(n,r){1&n&&e.Z7z(0,Io,2,5,"button",35,To),2&n&&e.Dyx(r)}function Bo(n,r){if(1&n){const t=e.RV6();e.j41(0,"app-row-menu",37),e.bIt("actionClicked",function(o){s.eBV(t);const a=e.XpG(4);return s.Njj(a.handleRowMenuAction(o))})("clickOutside",function(){s.eBV(t);const o=e.XpG(4);return s.Njj(o.closeRowMenu())}),e.k0s()}if(2&n){const t=e.XpG(3).$implicit,i=e.XpG();e.Y8G("menuConfig",i.rowMenuConfig())("row",t)("position",i.contextMenuPosition())}}function zo(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",28)(1,"div",31),e.nVh(2,Xo,2,0),e.k0s(),e.j41(3,"button",32),e.bIt("click",function(o){s.eBV(t);const a=e.XpG(2).$implicit,l=e.XpG();return s.Njj(l.toggleRowMenu(o,a.organization_id))}),e.nrm(4,"i",33),e.k0s(),e.nVh(5,Bo,1,3,"app-row-menu",34),e.k0s()}if(2&n){let t;const i=e.XpG(2),o=i.$implicit,a=i.$index,l=e.XpG();e.R7$(),e.AVh("opacity-100",l.keyboardActiveRowIndex()===a),e.R7$(),e.vxM((t=l.rowActions())?2:-1,t),e.R7$(),e.AVh("opacity-100",l.keyboardActiveRowIndex()===a),e.R7$(2),e.vxM(l.openMenuRowId()===o.organization_id?5:-1)}}function Oo(n,r){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.nI1(2,"date"),e.k0s()),2&n){const t=e.XpG().$implicit,i=e.XpG().$implicit;e.R7$(),e.JRh(e.i5U(2,1,i[t.code],"mediumDate"))}}function Po(n,r){if(1&n&&(e.j41(0,"span",39),e.EFF(1),e.k0s(),e.j41(2,"span",40),e.EFF(3),e.k0s()),2&n){const t=e.XpG(4).$implicit;e.R7$(),e.JRh(t.contact_person),e.R7$(2),e.SpI("(",t.organization_name,")")}}function Lo(n,r){if(1&n&&e.nrm(0,"img",41),2&n){const t=e.XpG(2).$implicit,i=e.XpG(5).$implicit;e.Y8G("src",i[t.code],e.B4B)}}function Ho(n,r){if(1&n&&(e.j41(0,"div",42)(1,"span",43),e.EFF(2),e.k0s()()),2&n){const t=e.XpG(7).$implicit;e.R7$(2),e.JRh((null==t.contact_person?null:t.contact_person[0])||"A")}}function Uo(n,r){if(1&n&&e.nVh(0,Lo,1,1,"img",41)(1,Ho,3,1,"div",42),2&n){const t=e.XpG().$implicit,i=e.XpG(5).$implicit;e.vxM(i[t.code]?0:1)}}function Wo(n,r){1&n&&e.nVh(0,Uo,2,1),2&n&&e.vxM("IMAGE"===r.$implicit.columnType?0:-1)}function Yo(n,r){if(1&n&&(e.j41(0,"p",39),e.EFF(1),e.k0s()),2&n){e.XpG();const t=e.r8f(0),i=e.XpG().$implicit;e.AVh("font-bold",i.bold),e.R7$(),e.JRh(t)}}function Qo(n,r){if(1&n&&(e.j41(0,"small",47),e.EFF(1),e.k0s()),2&n){e.XpG();const t=e.r8f(0),i=e.XpG().$implicit;e.AVh("font-bold",i.bold),e.R7$(),e.JRh(t)}}function Jo(n,r){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&n){e.XpG();const t=e.r8f(0),i=e.XpG().$implicit;e.AVh("font-bold",i.bold),e.R7$(),e.JRh(t)}}function Zo(n,r){if(1&n&&(e.SS7(0),e.nVh(1,Yo,2,3,"p",44)(2,Qo,2,3,"small",45)(3,Jo,2,3,"span",46)),2&n){let t;const i=e.XpG().$implicit,o=e.XpG(5).$implicit;e.bH3(o[i.code]),e.R7$(),e.vxM("p"===(t=i.tag||"span")?1:"small"===t?2:"span"===t?3:-1)}}function qo(n,r){1&n&&e.nVh(0,Zo,4,2),2&n&&e.vxM("IMAGE"!==r.$implicit.columnType?0:-1)}function Ko(n,r){if(1&n&&(e.j41(0,"div",38),e.Z7z(1,Wo,1,1,null,null,ke),e.j41(3,"div"),e.Z7z(4,qo,1,1,null,null,ke),e.k0s()()),2&n){const t=e.XpG(3).$implicit;e.R7$(),e.Dyx(t.cellTemplate),e.R7$(3),e.Dyx(t.cellTemplate)}}function er(n,r){if(1&n&&e.nVh(0,Po,4,2)(1,Ko,6,0,"div",38),2&n){const t=e.XpG(4);e.vxM("ultra-compact"===t.density()?0:1)}}function tr(n,r){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2).$implicit,i=e.XpG().$implicit;e.R7$(),e.JRh(i[t.code])}}function nr(n,r){if(1&n&&e.nVh(0,er,2,1)(1,tr,2,1,"span"),2&n){const t=e.XpG().$implicit;e.vxM(t.cellTemplate?0:1)}}function ir(n,r){if(1&n&&(e.j41(0,"td",27),e.nVh(1,Go,1,1)(2,zo,6,6,"div",28)(3,Oo,3,4,"span")(4,nr,2,1),e.k0s()),2&n){let t;const i=r.$implicit,o=r.$index,a=r.$count,l=e.XpG().$implicit,c=e.r8f(0),d=e.XpG();e.HbH(d.densityClass()),e.xc7("left",i.frozen?d.columnOffsets()[o]:null),e.AVh("font-bold",c)("!text-sm",c&&("compact"===d.density()||"ultra-compact"===d.density()))("!text-base",c&&"cozy"===d.density())("!text-lg",c&&"comfortable"===d.density())("border-r",o===a-1||i.frozen||d.showGridlines())("sticky",i.frozen)("z-10",i.frozen)("bg-white",i.frozen&&!d.selectedIds().has(l.organization_id))("group-hover:bg-gray-100",i.frozen&&d.rowHover()&&!d.selectedIds().has(l.organization_id))("bg-transparent",c)("text-center","center"===i.align)("text-right","right"===i.align)("text-left","center"!==i.align&&"right"!==i.align),e.R7$(),e.vxM("CHECKBOX"===(t=i.columnType)?1:"ACTION"===t?2:"DATE"===t?3:4)}}function or(n,r){if(1&n){const t=e.RV6();e.SS7(0),e.j41(1,"tr",25),e.bIt("click",function(){const o=s.eBV(t).$implicit,a=e.XpG();return s.Njj(a.onRowClick(o))})("contextmenu",function(o){const a=s.eBV(t).$implicit,l=e.XpG();return s.Njj(l.onRowContextMenu(o,a))}),e.Z7z(2,ir,5,31,"td",26,ke),e.k0s()}if(2&n){const t=r.$implicit,i=r.$index,o=e.XpG(),a=e.bH3(o.selectedIds().has(t.organization_id)||o.keyboardActiveRowIndex()===i);e.R7$(),e.AVh("odd:bg-gray-50",o.stripedRows()&&!a)("hover:bg-gray-100",o.rowHover()&&!a)("z-10",a)("border-y-2",a)("border-y-indigo-400",a)("-my-px",a),e.Y8G("id","table-item-"+t.organization_id),e.R7$(),e.Dyx(o.columns())}}function rr(n,r){if(1&n&&(e.j41(0,"td",49),e.EFF(1,"\xa0"),e.k0s()),2&n){const t=r.$index,i=r.$count,o=e.XpG(2);e.HbH(o.densityClass()),e.AVh("border-r",t===i-1||o.showGridlines())}}function ar(n,r){if(1&n&&(e.j41(0,"tr",6),e.Z7z(1,rr,2,4,"td",48,ke),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Dyx(t.columns())}}function sr(n,r){if(1&n&&e.nrm(0,"div",52),2&n){const t=e.XpG().$implicit,i=e.XpG();e.Y8G("innerHTML",i[t.code],e.npT)}}function lr(n,r){1&n&&(e.j41(0,"span"),e.EFF(1,"\xa0"),e.k0s())}function cr(n,r){if(1&n&&(e.j41(0,"td",51),e.nVh(1,sr,1,1,"div",52)(2,lr,2,0,"span"),e.k0s()),2&n){const t=r.$implicit,i=r.$index,o=r.$count,a=e.XpG(),l=e.XpG();e.xc7("left",t.frozen?l.columnOffsets()[i]:null),e.AVh("border-r",i===o-1||t.frozen||l.showGridlines())("sticky",t.frozen)("z-10",t.frozen)("bg-gray-100",t.frozen)("text-center","center"===t.align)("text-right","right"===t.align)("text-left","center"!==t.align&&"right"!==t.align),e.R7$(),e.vxM(a[t.code]?1:2)}}function dr(n,r){if(1&n&&(e.j41(0,"tfoot",7)(1,"tr"),e.Z7z(2,cr,3,17,"td",50,ke),e.k0s()()),2&n){const t=e.XpG();e.R7$(2),e.Dyx(t.columns())}}let ur=(()=>{class n{columns=f.hFB.required();data=f.hFB.required();sortColumn=f.hFB.required();sortDirection=f.hFB.required();density=(0,f.hFB)("cozy");densityClass=(0,f.hFB)("");rowMenuConfig=f.hFB.required();rowActions=(0,f.hFB)();headerMenuConfig=(0,f.hFB)();selectedIds=(0,f.hFB)(new Set);enableMultiSelect=(0,f.hFB)(!1);customTemplate=(0,f.hFB)(null);loading=(0,f.hFB)(!1);keyboardActiveRowIndex=(0,f.hFB)(null);pageSize=(0,f.hFB)(10);isInfiniteScroll=(0,f.hFB)(!1);activeFilters=(0,f.hFB)();stripedRows=(0,f.hFB)(!0);showGridlines=(0,f.hFB)(!1);rowHover=(0,f.hFB)(!0);footerConfig=(0,f.hFB)();sortChange=(0,f.CGW)();rowAction=(0,f.CGW)();headerAction=(0,f.CGW)();selectionChange=(0,f.CGW)();columnReorder=(0,f.CGW)();rowClicked=(0,f.CGW)();filterChange=(0,f.CGW)();draggedColumnIndex=(0,s.vPA)(null);dragOverIndex=(0,s.vPA)(null);unmaskedCells=(0,s.vPA)(new Set);openMenuRowId=(0,s.vPA)(null);isHeaderMenuOpen=(0,s.vPA)(!1);contextMenuPosition=(0,s.vPA)(null);openFilterMenuForColumn=(0,s.vPA)(null);isAllSelectedOnPage=(0,N.EW)(()=>{const t=this.data().map(i=>i.organization_id);return 0!==t.length&&t.every(i=>this.selectedIds().has(i))});emptyRows=(0,N.EW)(()=>{const t=this.pageSize(),i=this.data().length;return this.isInfiniteScroll()||i>=t?[]:Array(t-i).fill(0)});columnOffsets=(0,N.EW)(()=>{const t=this.columns(),i=new Array(t.length).fill(null);let o=0;for(let a=0;a<t.length;a++){const l=t[a];l.frozen&&(i[a]=`${o}px`,o+=l.width?parseInt(l.width,10):150)}return i});footerData=(0,N.EW)(()=>{const t=this.footerConfig(),i=this.data();if(!t||!t.enabled||!t.columns||0===i.length)return null;const o={},a=i.length,l={};for(const c of t.columns)l[c.code]||(l[c.code]=[]),l[c.code].push(c);for(const c in l){const d=l[c];let u=0,p=0;if(d.some(b=>"sum"===b.aggregation||"avg"===b.aggregation))for(const b of i){const S=Number(b[c]);isNaN(S)||(u+=S,p++)}const m=[];for(const b of d){let V,S=0;switch(b.aggregation){case"count":S=a;break;case"sum":S=u;break;case"avg":S=p>0?u/p:0}V="sum"===b.aggregation||"avg"===b.aggregation?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(S):new Intl.NumberFormat("en-US").format(S),m.push(b.display.replace("{value}",V))}o[c]=m.join("<br>")}return o});onSort(t){if(!this.columns().find(o=>o.code===t)?.sortable)return;let i="asc";this.sortColumn()===t&&"asc"===this.sortDirection()&&(i="desc"),this.sortChange.emit({column:t,direction:i})}onRowClick(t){this.rowClicked.emit(t)}handleApplyExcelFilter(t,i){t.sort&&this.sortChange.emit(t.sort),Object.prototype.hasOwnProperty.call(t,"filter")&&this.filterChange.emit({code:i,filter:t.filter??null}),this.closeFilterMenu()}toggleRowSelection(t){const i=new Set(this.selectedIds());i.has(t)?i.delete(t):i.add(t),this.selectionChange.emit(i)}toggleSelectAll(){const t=this.isAllSelectedOnPage(),i=new Set(this.selectedIds());this.data().map(a=>a.organization_id).forEach(t?a=>i.delete(a):a=>i.add(a)),this.selectionChange.emit(i)}onRowContextMenu(t,i){this.selectedIds().has(i.organization_id)||this.selectionChange.emit(new Set([i.organization_id])),t.preventDefault(),this.openMenuRowId.set(i.organization_id),this.contextMenuPosition.set({x:t.clientX,y:t.clientY})}toggleRowMenu(t,i){t.stopPropagation(),this.contextMenuPosition.set(null),this.openMenuRowId.update(o=>o===i?null:i)}openFilterMenu(t,i){i.stopPropagation(),this.openFilterMenuForColumn.set(t)}closeFilterMenu(){this.openFilterMenuForColumn.set(null)}closeRowMenu(){this.openMenuRowId.set(null),this.contextMenuPosition.set(null)}handleRowMenuAction(t){this.rowAction.emit(t),this.closeRowMenu()}handleHeaderMenuAction(t){this.headerAction.emit({action:t,selectedIds:Array.from(this.selectedIds())}),this.isHeaderMenuOpen.set(!1)}onDragStart(t){const i=this.columns()[t].columnType;"CHECKBOX"===i||"ACTION"===i||this.draggedColumnIndex.set(t)}onDragOver(t){t.preventDefault()}onDragEnter(t){null!==this.draggedColumnIndex()&&this.draggedColumnIndex()!==t&&this.dragOverIndex.set(t)}onDragLeave(){this.dragOverIndex.set(null)}onDrop(t,i){t.preventDefault();const o=this.draggedColumnIndex(),a=this.columns()[i];if("CHECKBOX"===a.columnType||"ACTION"===a.columnType)return this.draggedColumnIndex.set(null),void this.dragOverIndex.set(null);if(null===o||o===i)return this.draggedColumnIndex.set(null),void this.dragOverIndex.set(null);const l=[...this.columns()],c=l.splice(o,1)[0];l.splice(i,0,c),this.columnReorder.emit(l),this.draggedColumnIndex.set(null),this.dragOverIndex.set(null)}onDragEnd(){this.draggedColumnIndex.set(null),this.dragOverIndex.set(null)}isUnmasked(t,i){const o=`${t}-${i}`;return this.unmaskedCells().has(o)}toggleMask(t,i){const o=`${t}-${i}`;this.unmaskedCells.update(a=>{const l=new Set(a);return l.has(o)?l.delete(o):l.add(o),l})}maskString(t,i){return St(t,{visibleStart:i.visibleStart,visibleEnd:i.visibleEnd,maskChar:i.maskChar})}getCellValidation(t,i){const o=Qe(t[i.code],i,i.code);if(!o.isValid)return o;if(i.validations)for(const a of i.validations){const l=Qe(t[a.code],i,a.code);if(!l.isValid)return l}return{isValid:!0,style:null}}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-table-view"]],inputs:{columns:[1,"columns"],data:[1,"data"],sortColumn:[1,"sortColumn"],sortDirection:[1,"sortDirection"],density:[1,"density"],densityClass:[1,"densityClass"],rowMenuConfig:[1,"rowMenuConfig"],rowActions:[1,"rowActions"],headerMenuConfig:[1,"headerMenuConfig"],selectedIds:[1,"selectedIds"],enableMultiSelect:[1,"enableMultiSelect"],customTemplate:[1,"customTemplate"],loading:[1,"loading"],keyboardActiveRowIndex:[1,"keyboardActiveRowIndex"],pageSize:[1,"pageSize"],isInfiniteScroll:[1,"isInfiniteScroll"],activeFilters:[1,"activeFilters"],stripedRows:[1,"stripedRows"],showGridlines:[1,"showGridlines"],rowHover:[1,"rowHover"],footerConfig:[1,"footerConfig"]},outputs:{sortChange:"sortChange",rowAction:"rowAction",headerAction:"headerAction",selectionChange:"selectionChange",columnReorder:"columnReorder",rowClicked:"rowClicked",filterChange:"filterChange"},decls:12,vars:1,consts:[[1,"h-full","overflow-auto","border-x","border-b","border-gray-300"],[1,"min-w-full","border-collapse","bg-white"],[1,"sticky","top-0","z-20","bg-gray-100"],["scope","col",1,"p-2","border-b","border-t","border-l","border-gray-300","font-semibold","text-gray-600","transition-all","duration-150","relative","text-xs",3,"width","left","border-r","sticky","z-30","bg-gray-100","opacity-50"],[1,""],[1,"transition-colors","duration-150","cursor-pointer","relative","group","border-b","border-gray-200",3,"id","odd:bg-gray-50","hover:bg-gray-100","z-10","border-y-2","border-y-indigo-400","-my-px"],[1,"border-b","border-gray-200"],[1,"sticky","bottom-0","z-20","bg-gray-100"],["scope","col",1,"p-2","border-b","border-t","border-l","border-gray-300","font-semibold","text-gray-600","transition-all","duration-150","relative","text-xs",3,"dragover","drop","dragend"],[1,"flex","items-center","gap-2","p-1","rounded-md","focus:outline-none","focus:ring-2","focus:ring-indigo-500","focus:ring-offset-1",3,"dragstart","click","keydown.enter","keydown.space","title"],["type","checkbox","title","Select all on page",1,"h-4","w-4","rounded","border-gray-300","text-indigo-600","focus:ring-indigo-500",3,"checked"],[1,"relative","mx-auto"],[1,"flex","items-center"],[1,"relative"],["type","checkbox","title","Select all on page",1,"h-4","w-4","rounded","border-gray-300","text-indigo-600","focus:ring-indigo-500",3,"change","click","checked"],["title","Bulk actions",1,"p-1","rounded-full","hover:bg-gray-200",3,"click","disabled"],[1,"pi","pi-ellipsis-v"],[3,"menuConfig"],[3,"actionClicked","clickOutside","menuConfig"],[1,"pi","ml-2","text-xs",3,"pi-sort-amount-up-alt","pi-sort-amount-down"],[1,"pi","ml-2","text-xs"],["title","Filter column",1,"p-1","rounded-full","hover:bg-gray-200",3,"click"],[1,"pi","pi-filter"],[3,"column","data","activeFilter"],[3,"apply","close","column","data","activeFilter"],[1,"transition-colors","duration-150","cursor-pointer","relative","group","border-b","border-gray-200",3,"click","contextmenu","id"],[1,"whitespace-nowrap","p-1.5","border-l","border-gray-200","transition-all","duration-150",3,"class","font-bold","!text-sm","!text-base","!text-lg","border-r","sticky","z-10","left","bg-white","group-hover:bg-gray-100","bg-transparent","text-center","text-right","text-left"],[1,"whitespace-nowrap","p-1.5","border-l","border-gray-200","transition-all","duration-150"],[1,"flex","justify-center","items-center","gap-1","relative"],["type","checkbox",1,"h-4","w-4","rounded","border-gray-300","text-indigo-600","focus:ring-indigo-500",3,"checked"],["type","checkbox",1,"h-4","w-4","rounded","border-gray-300","text-indigo-600","focus:ring-indigo-500",3,"change","click","checked"],[1,"flex","items-center","gap-1","transition-opacity","opacity-0","group-hover:opacity-100","focus-within:opacity-100"],["title","More actions",1,"p-1.5","rounded-full","transition-opacity","opacity-0","group-hover:opacity-100","focus-within:opacity-100","hover:bg-gray-200",3,"click"],[1,"pi","pi-ellipsis-v","text-xs"],[3,"menuConfig","row","position"],[1,"p-1.5","rounded-full",3,"class","title"],[1,"p-1.5","rounded-full",3,"click","title"],[3,"actionClicked","clickOutside","menuConfig","row","position"],[1,"flex","items-center","gap-2"],[1,"font-semibold","text-gray-800"],[1,"text-gray-500","ml-1"],["alt","Avatar",1,"h-6","w-6","object-cover","flex-shrink-0","rounded-full",3,"src"],[1,"h-6","w-6","bg-gray-200","flex","items-center","justify-center","flex-shrink-0","rounded-full"],[1,"text-xs","font-semibold","text-gray-500"],[1,"font-semibold","text-gray-800",3,"font-bold"],[1,"text-gray-500",3,"font-bold"],[3,"font-bold"],[1,"text-gray-500"],[1,"whitespace-nowrap","p-1.5","border-l","border-gray-200",3,"border-r","class"],[1,"whitespace-nowrap","p-1.5","border-l","border-gray-200"],[1,"p-2","border-t","border-l","border-gray-300","font-semibold","text-gray-700","text-xs",3,"left","border-r","sticky","z-10","bg-gray-100","text-center","text-right","text-left"],[1,"p-2","border-t","border-l","border-gray-300","font-semibold","text-gray-700","text-xs"],[3,"innerHTML"]],template:function(i,o){if(1&i&&(e.j41(0,"div",0)(1,"table",1)(2,"thead",2)(3,"tr"),e.Z7z(4,Eo,6,29,"th",3,ke),e.k0s()(),e.j41(6,"tbody",4),e.Z7z(7,or,4,14,"tr",5,Fo),e.Z7z(9,ar,3,0,"tr",6,e.Vm6),e.k0s(),e.nVh(11,dr,4,0,"tfoot",7),e.k0s()()),2&i){let a;e.R7$(4),e.Dyx(o.columns()),e.R7$(3),e.Dyx(o.data()),e.R7$(2),e.Dyx(o.emptyRows()),e.R7$(2),e.vxM((a=(null==(a=o.footerConfig())?null:a.enabled)&&o.footerData())?11:-1,a)}},dependencies:[P.MD,sn,mo,$e,So,P.vh],encapsulation:2,changeDetection:0})}return n})();var pr=W(345);let cn=(()=>{class n{template=f.hFB.required();data=f.hFB.required();sanitizer=(0,s.WQX)(pr.up);sanitizedHtml=(0,N.EW)(()=>{let t=this.template();const i=this.data();return t&&i?(t=t.replace(/\{\{(.*?)\}\}/g,(o,a)=>{const l=a.trim(),c=i[l];return null!=c?String(c):""}),this.sanitizer.bypassSecurityTrustHtml(t)):this.sanitizer.bypassSecurityTrustHtml("")});static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-dynamic-item"]],inputs:{template:[1,"template"],data:[1,"data"]},decls:1,vars:1,consts:[[3,"innerHTML"]],template:function(i,o){1&i&&e.Hgh(0,"div",0),2&i&&e.Avn("innerHTML",o.sanitizedHtml(),e.npT)},encapsulation:2,changeDetection:0})}return n})();const mr=(n,r)=>r.organization_id,gr=(n,r)=>r.code,_r=(n,r)=>r.action;function fr(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",3),e.bIt("click",function(){s.eBV(t);const o=e.XpG().$implicit,a=e.XpG();return s.Njj(a.onCardClick(o))})("contextmenu",function(o){s.eBV(t);const a=e.XpG().$implicit,l=e.XpG();return s.Njj(l.onCardContextMenu(o,a))}),e.nrm(1,"app-dynamic-item",4),e.k0s()}if(2&n){const t=e.XpG(),i=t.$implicit,o=t.$index,a=e.XpG();e.AVh("cursor-pointer",a.enableMultiSelect())("border-transparent",!a.selectedIds().has(i.organization_id))("border-indigo-500",a.selectedIds().has(i.organization_id))("ring-2",a.selectedIds().has(i.organization_id)||a.keyboardActiveRowIndex()===o)("ring-indigo-500",a.selectedIds().has(i.organization_id)||a.keyboardActiveRowIndex()===o),e.Y8G("id","card-item-"+i.organization_id),e.R7$(),e.Y8G("template",r)("data",i)}}function hr(n,r){if(1&n&&e.nrm(0,"img",17),2&n){const t=e.XpG(2).$implicit,i=e.XpG();e.AVh("h-10","compact"!==i.density())("w-10","compact"!==i.density())("h-9","compact"===i.density())("w-9","compact"===i.density()),e.Y8G("src",t.avatar_url,e.B4B)}}function br(n,r){if(1&n&&(e.j41(0,"div",18)(1,"span",19),e.EFF(2),e.k0s()()),2&n){const t=e.XpG(2).$implicit,i=e.XpG();e.AVh("h-10","compact"!==i.density())("w-10","compact"!==i.density())("h-9","compact"===i.density())("w-9","compact"===i.density()),e.R7$(),e.AVh("text-base","compact"!==i.density())("text-sm","compact"===i.density()),e.R7$(),e.JRh((null==t.contact_person?null:t.contact_person[0])||"A")}}function yr(n,r){if(1&n){const t=e.RV6();e.j41(0,"app-row-menu",23),e.bIt("actionClicked",function(o){s.eBV(t);const a=e.XpG(4);return s.Njj(a.handleRowMenuAction(o))})("clickOutside",function(){s.eBV(t);const o=e.XpG(4);return s.Njj(o.closeRowMenu())}),e.k0s()}if(2&n){const t=e.XpG(3).$implicit,i=e.XpG();e.Y8G("menuConfig",i.rowMenuConfig())("row",t)("position",i.contextMenuPosition())}}function vr(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",13)(1,"button",20),e.bIt("click",function(o){s.eBV(t);const a=e.XpG(2).$implicit,l=e.XpG();return s.Njj(l.toggleRowMenu(o,a.organization_id))}),e.nrm(2,"i",21),e.k0s(),e.nVh(3,yr,1,3,"app-row-menu",22),e.k0s()}if(2&n){const t=e.XpG(2).$implicit,i=e.XpG();e.R7$(3),e.vxM(i.openMenuRowId()===t.organization_id?3:-1)}}function Cr(n,r){if(1&n&&e.EFF(0),2&n){const t=e.XpG().$implicit,i=e.XpG(2).$implicit,o=e.XpG();e.SpI(" ",o.maskString(i[t.code],t.mask)," ")}}function xr(n,r){if(1&n&&e.EFF(0),2&n){const t=e.XpG().$implicit,i=e.XpG(2).$implicit;e.SpI(" ",i[t.code]||"N/A"," ")}}function wr(n,r){if(1&n&&(e.j41(0,"div",24)(1,"dt",25),e.EFF(2),e.k0s(),e.j41(3,"dd",26),e.nVh(4,Cr,1,1)(5,xr,1,1),e.k0s()()),2&n){const t=r.$implicit,i=e.XpG(2).$implicit,o=e.XpG(),a=o.getFieldValidationState(i,t);e.HbH(o.densityClass()),e.xc7("background-color",a.isValid||null==a.style?null:a.style.bgcolor),e.Y8G("title",a.isValid?"":null==a.style?null:a.style.tooltip),e.R7$(2),e.JRh(t.name),e.R7$(2),e.vxM(null!=t.mask&&t.mask.enabled?4:5)}}function kr(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",30),e.bIt("click",function(o){const a=s.eBV(t).$implicit,l=e.XpG(4).$implicit,c=e.XpG();return o.stopPropagation(),s.Njj(c.rowAction.emit({action:a.action,row:l}))}),e.nrm(1,"i"),e.k0s()}if(2&n){const t=r.$implicit;e.HbH(t.color),e.Y8G("title",t.label),e.R7$(),e.HbH(t.icon)}}function Sr(n,r){1&n&&e.Z7z(0,kr,2,5,"button",29,_r),2&n&&e.Dyx(r)}function Fr(n,r){if(1&n&&(e.j41(0,"footer",27)(1,"div",28),e.nVh(2,Sr,2,0),e.k0s()()),2&n){let t;const i=e.XpG(3);e.AVh("p-2","compact"!==i.density())("p-1","compact"===i.density()),e.R7$(2),e.vxM((t=i.rowActions())?2:-1,t)}}function Tr(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",5),e.bIt("contextmenu",function(o){s.eBV(t);const a=e.XpG().$implicit,l=e.XpG();return s.Njj(l.onCardContextMenu(o,a))}),e.j41(1,"header",6)(2,"div",7),e.nVh(3,hr,1,9,"img",8)(4,br,3,13,"div",9),e.j41(5,"div",10)(6,"h3",11),e.EFF(7),e.k0s(),e.j41(8,"p",12),e.EFF(9),e.k0s()()(),e.nVh(10,vr,4,1,"div",13),e.k0s(),e.j41(11,"div",14),e.bIt("click",function(){s.eBV(t);const o=e.XpG().$implicit,a=e.XpG();return s.Njj(a.handleCardBodyClick(o))}),e.j41(12,"dl"),e.Z7z(13,wr,6,7,"div",15,gr),e.k0s()(),e.nVh(15,Fr,3,5,"footer",16),e.k0s()}if(2&n){const t=e.XpG(),i=t.$implicit,o=t.$index,a=e.XpG();e.AVh("border-gray-200",!a.selectedIds().has(i.organization_id))("hover:shadow-xl",!a.selectedIds().has(i.organization_id))("bg-slate-50",a.selectedIds().has(i.organization_id))("border-slate-500",a.selectedIds().has(i.organization_id))("ring-2",a.keyboardActiveRowIndex()===o)("ring-offset-2",a.keyboardActiveRowIndex()===o)("ring-slate-500",a.keyboardActiveRowIndex()===o),e.Y8G("id","card-item-"+i.organization_id),e.R7$(),e.AVh("p-4","compact"!==a.density())("p-3","compact"===a.density()),e.R7$(2),e.vxM(i.avatar_url?3:4),e.R7$(3),e.AVh("text-base","comfortable"===a.density())("text-sm","cozy"===a.density()||"compact"===a.density()),e.R7$(),e.JRh(i.contact_person),e.R7$(),e.HbH(a.densityClass()),e.R7$(),e.SpI(" ",i.organization_name||"N/A"," "),e.R7$(),e.vxM(a.rowMenuConfig()?10:-1),e.R7$(),e.AVh("p-4","compact"!==a.density())("p-3","compact"===a.density()),e.R7$(),e.AVh("space-y-3","comfortable"===a.density())("space-y-2","comfortable"!==a.density()),e.R7$(),e.Dyx(a.cardRowColumns()),e.R7$(2),e.vxM(a.rowActions()&&a.rowActions().length>0?15:-1)}}function Mr(n,r){if(1&n&&e.nVh(0,fr,2,13,"div",1)(1,Tr,16,38,"div",2),2&n){let t;const i=e.XpG();e.vxM((t=i.customTemplate())?0:1,t)}}let jr=(()=>{class n{columns=f.hFB.required();data=f.hFB.required();density=(0,f.hFB)("cozy");densityClass=(0,f.hFB)("");selectedIds=(0,f.hFB)(new Set);enableMultiSelect=(0,f.hFB)(!1);rowMenuConfig=(0,f.hFB)();rowActions=(0,f.hFB)();cardViewConfig=(0,f.hFB)();customTemplate=(0,f.hFB)(null);keyboardActiveRowIndex=(0,f.hFB)(null);selectionChange=(0,f.CGW)();rowAction=(0,f.CGW)();rowClicked=(0,f.CGW)();openMenuRowId=(0,s.vPA)(null);contextMenuPosition=(0,s.vPA)(null);cardHeaderColumn=(0,N.EW)(()=>this.columns().find(t=>t.cardHeader));cardHeader1Column=(0,N.EW)(()=>this.columns().find(t=>t.cardHeader1));cardRowColumns=(0,N.EW)(()=>this.columns().filter(t=>t.cardRow));imageColumn=(0,N.EW)(()=>this.columns().find(t=>"IMAGE"===t.columnType));gridClasses=(0,N.EW)(()=>{switch(this.cardViewConfig()?.cardsPerRow??4){case 1:return"grid-cols-1";case 2:return"grid-cols-1 sm:grid-cols-2";case 3:return"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3";case 4:default:return"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4";case 5:return"grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-5";case 6:return"grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6"}});onCardClick(t){this.rowClicked.emit(t)}onCardContextMenu(t,i){t.preventDefault(),this.openMenuRowId.set(i.organization_id),this.contextMenuPosition.set({x:t.clientX,y:t.clientY})}handleCardBodyClick(t){this.rowClicked.emit(t),this.enableMultiSelect()&&this.toggleSelection(t.organization_id)}toggleSelection(t){if(!this.enableMultiSelect())return;const i=new Set(this.selectedIds());i.has(t)?i.delete(t):i.add(t),this.selectionChange.emit(i)}getFieldValidationState(t,i){return Qe(t[i.code],i,i.code)}maskString(t,i){return St(t,{visibleStart:i.visibleStart,visibleEnd:i.visibleEnd,maskChar:i.maskChar})}formatPhoneNumber(t){return t?t.replace(/\D/g,""):""}toggleRowMenu(t,i){if(t.stopPropagation(),this.openMenuRowId()===i)return this.openMenuRowId.set(null),void this.contextMenuPosition.set(null);const a=t.currentTarget.getBoundingClientRect();let c=a.right-224;c<0&&(c=a.left),this.contextMenuPosition.set({x:c,y:a.bottom+4}),this.openMenuRowId.set(i)}closeRowMenu(){this.openMenuRowId.set(null),this.contextMenuPosition.set(null)}handleRowMenuAction(t){this.rowAction.emit(t),this.closeRowMenu()}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-card-view"]],inputs:{columns:[1,"columns"],data:[1,"data"],density:[1,"density"],densityClass:[1,"densityClass"],selectedIds:[1,"selectedIds"],enableMultiSelect:[1,"enableMultiSelect"],rowMenuConfig:[1,"rowMenuConfig"],rowActions:[1,"rowActions"],cardViewConfig:[1,"cardViewConfig"],customTemplate:[1,"customTemplate"],keyboardActiveRowIndex:[1,"keyboardActiveRowIndex"]},outputs:{selectionChange:"selectionChange",rowAction:"rowAction",rowClicked:"rowClicked"},decls:3,vars:8,consts:[[1,"grid"],[1,"border-2","rounded-lg","transition-all","duration-200","h-full",3,"id","cursor-pointer","border-transparent","border-indigo-500","ring-2","ring-indigo-500"],[1,"border","rounded-lg","bg-white","overflow-hidden","transition-all","duration-200","flex","flex-col","relative","group",3,"id","border-gray-200","hover:shadow-xl","bg-slate-50","border-slate-500","ring-2","ring-offset-2","ring-slate-500"],[1,"border-2","rounded-lg","transition-all","duration-200","h-full",3,"click","contextmenu","id"],[3,"template","data"],[1,"border","rounded-lg","bg-white","overflow-hidden","transition-all","duration-200","flex","flex-col","relative","group",3,"contextmenu","id"],[1,"flex","justify-between","items-start","gap-4","border-b","border-gray-200","bg-gray-50"],[1,"flex","items-center","gap-4","min-w-0"],["alt","Avatar",1,"rounded-full","object-cover","flex-shrink-0",3,"src","h-10","w-10","h-9","w-9"],[1,"bg-gray-200","dark:bg-gray-700","flex","items-center","justify-center","rounded-full","object-cover","flex-shrink-0",3,"h-10","w-10","h-9","w-9"],[1,"min-w-0"],[1,"font-bold","text-gray-900","truncate"],[1,"text-gray-600","truncate"],[1,"relative","flex-shrink-0"],[1,"flex-grow","cursor-pointer",3,"click"],[1,"grid","grid-cols-3","gap-2","p-1","-m-1","rounded-md","transition-colors","duration-150",3,"class","background-color","title"],[1,"border-t","border-gray-200","bg-gray-50","flex","items-center","justify-start",3,"p-2","p-1"],["alt","Avatar",1,"rounded-full","object-cover","flex-shrink-0",3,"src"],[1,"bg-gray-200","dark:bg-gray-700","flex","items-center","justify-center","rounded-full","object-cover","flex-shrink-0"],[1,"font-semibold","text-gray-500","dark:text-gray-400"],["title","More actions",1,"p-1","rounded-full","text-gray-500","hover:text-gray-700","hover:bg-gray-200",3,"click"],[1,"pi","pi-ellipsis-v"],[3,"menuConfig","row","position"],[3,"actionClicked","clickOutside","menuConfig","row","position"],[1,"grid","grid-cols-3","gap-2","p-1","-m-1","rounded-md","transition-colors","duration-150",3,"title"],[1,"text-gray-500","font-medium","col-span-1"],[1,"text-gray-800","truncate","col-span-2"],[1,"border-t","border-gray-200","bg-gray-50","flex","items-center","justify-start"],[1,"flex","items-center","gap-1"],[1,"p-1.5","rounded-full","text-sm","hover:bg-gray-200",3,"class","title"],[1,"p-1.5","rounded-full","text-sm","hover:bg-gray-200",3,"click","title"]],template:function(i,o){1&i&&(e.j41(0,"div",0),e.Z7z(1,Mr,2,1,null,null,mr),e.k0s()),2&i&&(e.HbH(o.gridClasses()),e.AVh("gap-6","comfortable"===o.density())("gap-4","cozy"===o.density())("gap-3","compact"===o.density()),e.R7$(),e.Dyx(o.data()))},dependencies:[P.MD,sn,$e,cn],encapsulation:2,changeDetection:0})}return n})();const Rr=(n,r)=>r.organization_id;function Vr(n,r){if(1&n&&(e.j41(0,"div",6),e.nrm(1,"app-dynamic-item",7),e.k0s()),2&n){const t=e.XpG().$implicit,i=e.XpG();e.AVh("border-transparent",!i.selectedIds().has(t.organization_id))("border-indigo-500",i.selectedIds().has(t.organization_id)),e.R7$(),e.Y8G("template",r)("data",t)}}function Dr(n,r){if(1&n&&e.nrm(0,"img",18),2&n){const t=e.XpG(),i=e.XpG(2).$implicit,o=e.XpG();e.AVh("h-10","compact"!==o.density())("w-10","compact"!==o.density())("mr-4","compact"!==o.density())("h-8","compact"===o.density())("w-8","compact"===o.density())("mr-3","compact"===o.density()),e.Y8G("src",i[t.code],e.B4B)}}function Ar(n,r){if(1&n&&(e.j41(0,"div",19)(1,"span",20),e.EFF(2),e.k0s()()),2&n){const t=e.XpG(3).$implicit,i=e.XpG();e.AVh("h-10","compact"!==i.density())("w-10","compact"!==i.density())("mr-4","compact"!==i.density())("h-8","compact"===i.density())("w-8","compact"===i.density())("mr-3","compact"===i.density()),e.R7$(),e.AVh("text-sm","compact"!==i.density())("text-xs","compact"===i.density()),e.R7$(),e.JRh((null==t.contact_person?null:t.contact_person[0])||"A")}}function Nr(n,r){if(1&n&&e.nVh(0,Dr,1,13,"img",16)(1,Ar,3,17,"div",17),2&n){const t=e.XpG(2).$implicit;e.vxM(t[r.code]?0:1)}}function Er(n,r){if(1&n&&(e.j41(0,"p",21),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2).$implicit,i=e.XpG();e.AVh("text-md","comfortable"===i.density())("text-sm","cozy"===i.density())("text-xs","compact"===i.density()||"ultra-compact"===i.density()),e.R7$(),e.JRh(t[r.code])}}function $r(n,r){if(1&n&&e.EFF(0),2&n){e.XpG();const t=e.r8f(0),i=e.XpG(2).$implicit,o=e.XpG();e.SpI(" ",o.maskString(i[t.code],t.mask)," ")}}function Gr(n,r){if(1&n&&e.EFF(0),2&n){e.XpG();const t=e.r8f(0),i=e.XpG(2).$implicit;e.SpI(" ",i[t.code]||"N/A"," ")}}function Ir(n,r){if(1&n&&(e.SS7(0),e.j41(1,"p",22),e.nVh(2,$r,1,1)(3,Gr,1,1),e.k0s()),2&n){const t=e.XpG(2).$implicit,i=e.XpG(),o=e.bH3(i.rowColumns()[0]),a=i.getFieldValidationState(t,o);e.R7$(),e.xc7("background-color",a.isValid||null==a.style?null:a.style.bgcolor),e.Y8G("title",a.isValid?"":null==a.style?null:a.style.tooltip),e.R7$(),e.vxM(null!=o.mask&&o.mask.enabled?2:3)}}function Xr(n,r){if(1&n&&e.EFF(0),2&n){e.XpG();const t=e.r8f(0),i=e.XpG(2).$implicit,o=e.XpG();e.SpI(" ",o.maskString(i[t.code],t.mask)," ")}}function Br(n,r){if(1&n&&e.EFF(0),2&n){e.XpG();const t=e.r8f(0),i=e.XpG(2).$implicit;e.SpI(" ",i[t.code]||"N/A"," ")}}function zr(n,r){if(1&n&&(e.SS7(0),e.j41(1,"span",23),e.nVh(2,Xr,1,1)(3,Br,1,1),e.k0s()),2&n){const t=e.XpG(2).$implicit,i=e.XpG(),o=e.bH3(i.rowColumns()[1]),a=i.getFieldValidationState(t,o);e.R7$(),e.HbH(i.densityClass()),e.xc7("background-color",a.isValid||null==a.style?null:a.style.bgcolor),e.Y8G("title",a.isValid?"":null==a.style?null:a.style.tooltip),e.R7$(),e.vxM(null!=o.mask&&o.mask.enabled?2:3)}}function Or(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",8),e.nVh(1,Nr,2,1),e.j41(2,"div",9),e.nVh(3,Er,2,7,"p",10),e.nVh(4,Ir,4,5,"p",11),e.k0s(),e.j41(5,"div",12),e.nVh(6,zr,4,7,"span",13),e.k0s(),e.j41(7,"button",14),e.bIt("click",function(o){return s.eBV(t),s.Njj(o.stopPropagation())}),e.nrm(8,"i",15),e.k0s()()}if(2&n){let t,i;const o=e.XpG(2);e.AVh("p-4","comfortable"===o.density())("p-3","cozy"===o.density())("p-2","compact"===o.density())("p-1","ultra-compact"===o.density()),e.R7$(),e.vxM((t="ultra-compact"!==o.density()&&o.imageColumn())?1:-1,t),e.R7$(),e.HbH(o.densityClass()),e.R7$(),e.vxM((i=o.headerColumn())?3:-1,i),e.R7$(),e.vxM(o.rowColumns().length>0?4:-1),e.R7$(),e.AVh("ml-4","compact"!==o.density())("ml-2","compact"===o.density()),e.R7$(),e.vxM(o.rowColumns().length>1?6:-1),e.R7$(),e.AVh("ml-4","compact"!==o.density())("ml-2","compact"===o.density())}}function Pr(n,r){if(1&n){const t=e.RV6();e.j41(0,"li",3),e.bIt("click",function(){const o=s.eBV(t).$implicit,a=e.XpG();return s.Njj(a.onItemClick(o))}),e.nVh(1,Vr,2,6,"div",4)(2,Or,9,22,"div",5),e.k0s()}if(2&n){let t;const i=r.$implicit,o=r.$index,a=e.XpG();e.AVh("cursor-pointer",!0)("hover:bg-gray-200/50",!a.selectedIds().has(i.organization_id))("bg-slate-50",a.selectedIds().has(i.organization_id))("ring-2",a.keyboardActiveRowIndex()===o)("ring-offset-2",a.keyboardActiveRowIndex()===o)("ring-slate-500",a.keyboardActiveRowIndex()===o),e.Y8G("id","list-item-"+i.organization_id),e.R7$(),e.vxM((t=a.customTemplate())?1:2,t)}}let Lr=(()=>{class n{columns=f.hFB.required();data=f.hFB.required();density=(0,f.hFB)("cozy");densityClass=(0,f.hFB)("");selectedIds=(0,f.hFB)(new Set);enableMultiSelect=(0,f.hFB)(!1);customTemplate=(0,f.hFB)(null);keyboardActiveRowIndex=(0,f.hFB)(null);selectionChange=(0,f.CGW)();rowClicked=(0,f.CGW)();headerColumn=(0,N.EW)(()=>this.columns().find(t=>t.cardHeader));rowColumns=(0,N.EW)(()=>this.columns().filter(t=>t.listRow));imageColumn=(0,N.EW)(()=>this.columns().find(t=>"IMAGE"===t.columnType));onItemClick(t){this.rowClicked.emit(t),this.enableMultiSelect()&&this.toggleSelection(t.organization_id)}toggleSelection(t){if(!this.enableMultiSelect())return;const i=new Set(this.selectedIds());i.has(t)?i.delete(t):i.add(t),this.selectionChange.emit(i)}getFieldValidationState(t,i){return Qe(t[i.code],i,i.code)}maskString(t,i){return St(t,{visibleStart:i.visibleStart,visibleEnd:i.visibleEnd,maskChar:i.maskChar})}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-list-view"]],inputs:{columns:[1,"columns"],data:[1,"data"],density:[1,"density"],densityClass:[1,"densityClass"],selectedIds:[1,"selectedIds"],enableMultiSelect:[1,"enableMultiSelect"],customTemplate:[1,"customTemplate"],keyboardActiveRowIndex:[1,"keyboardActiveRowIndex"]},outputs:{selectionChange:"selectionChange",rowClicked:"rowClicked"},decls:4,vars:0,consts:[[1,"border","border-gray-200","rounded-lg"],[1,"divide-y","divide-gray-200"],[1,"transition-colors","duration-150","relative",3,"id","cursor-pointer","hover:bg-gray-200/50","bg-slate-50","ring-2","ring-offset-2","ring-slate-500"],[1,"transition-colors","duration-150","relative",3,"click","id"],[1,"border-2","rounded-lg",3,"border-transparent","border-indigo-500"],[1,"flex","items-center","justify-between",3,"p-4","p-3","p-2","p-1"],[1,"border-2","rounded-lg"],[3,"template","data"],[1,"flex","items-center","justify-between"],[1,"flex-1","min-w-0"],[1,"font-semibold","text-indigo-600","truncate",3,"text-md","text-sm","text-xs"],[1,"text-gray-500","truncate","p-1","-ml-1","rounded-md",3,"background-color","title"],[1,"inline-flex","items-center","text-base","font-semibold","text-gray-900"],[1,"text-gray-600","p-1","rounded-md",3,"class","background-color","title"],["title","View Details",1,"text-gray-500","hover:text-gray-700",3,"click"],[1,"pi","pi-chevron-right"],["alt","Avatar",1,"rounded-full","object-cover","flex-shrink-0",3,"src","h-10","w-10","mr-4","h-8","w-8","mr-3"],[1,"bg-gray-200","flex","items-center","justify-center","rounded-full","object-cover","flex-shrink-0",3,"h-10","w-10","mr-4","h-8","w-8","mr-3"],["alt","Avatar",1,"rounded-full","object-cover","flex-shrink-0",3,"src"],[1,"bg-gray-200","flex","items-center","justify-center","rounded-full","object-cover","flex-shrink-0"],[1,"font-semibold","text-gray-500"],[1,"font-semibold","text-indigo-600","truncate"],[1,"text-gray-500","truncate","p-1","-ml-1","rounded-md",3,"title"],[1,"text-gray-600","p-1","rounded-md",3,"title"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"ul",1),e.Z7z(2,Pr,3,14,"li",2,Rr),e.k0s()()),2&i&&(e.R7$(2),e.Dyx(o.data()))},dependencies:[P.MD,cn],encapsulation:2,changeDetection:0})}return n})();function Hr(n,r){let t;if(void 0===r)for(const i of n)null!=i&&(t<i||void 0===t&&i>=i)&&(t=i);else{let i=-1;for(let o of n)null!=(o=r(o,++i,n))&&(t<o||void 0===t&&o>=o)&&(t=o)}return t}function Ur(n){return n}function Wr(n){return"translate("+n+",0)"}function Yr(n){return"translate(0,"+n+")"}function Qr(n){return r=>+n(r)}function Jr(n,r){return r=Math.max(0,n.bandwidth()-2*r)/2,n.round()&&(r=Math.round(r)),t=>+n(t)+r}function Zr(){return!this.__axis}function qe(n,r){var t=[],i=null,o=null,a=6,l=6,c=3,d=typeof window<"u"&&window.devicePixelRatio>1?0:.5,u=1===n||4===n?-1:1,p=4===n||2===n?"x":"y",g=1===n||3===n?Wr:Yr;function m(b){var S=i??(r.ticks?r.ticks.apply(r,t):r.domain()),V=o??(r.tickFormat?r.tickFormat.apply(r,t):Ur),y=Math.max(a,0)+c,h=r.range(),x=+h[0]+d,C=+h[h.length-1]+d,j=(r.bandwidth?Jr:Qr)(r.copy(),d),k=b.selection?b.selection():b,E=k.selectAll(".domain").data([null]),z=k.selectAll(".tick").data(S,r).order(),O=z.exit(),H=z.enter().append("g").attr("class","tick"),G=z.select("line"),T=z.select("text");E=E.merge(E.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),z=z.merge(H),G=G.merge(H.append("line").attr("stroke","currentColor").attr(p+"2",u*a)),T=T.merge(H.append("text").attr("fill","currentColor").attr(p,u*y).attr("dy",1===n?"0em":3===n?"0.71em":"0.32em")),b!==k&&(E=E.transition(b),z=z.transition(b),G=G.transition(b),T=T.transition(b),O=O.transition(b).attr("opacity",1e-6).attr("transform",function(L){return isFinite(L=j(L))?g(L+d):this.getAttribute("transform")}),H.attr("opacity",1e-6).attr("transform",function(L){var B=this.parentNode.__axis;return g((B&&isFinite(B=B(L))?B:j(L))+d)})),O.remove(),E.attr("d",4===n||2===n?l?"M"+u*l+","+x+"H"+d+"V"+C+"H"+u*l:"M"+d+","+x+"V"+C:l?"M"+x+","+u*l+"V"+d+"H"+C+"V"+u*l:"M"+x+","+d+"H"+C),z.attr("opacity",1).attr("transform",function(L){return g(j(L)+d)}),G.attr(p+"2",u*a),T.attr(p,u*y).text(V),k.filter(Zr).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===n?"start":4===n?"end":"middle"),k.each(function(){this.__axis=j})}return m.scale=function(b){return arguments.length?(r=b,m):r},m.ticks=function(){return t=Array.from(arguments),m},m.tickArguments=function(b){return arguments.length?(t=null==b?[]:Array.from(b),m):t.slice()},m.tickValues=function(b){return arguments.length?(i=null==b?null:Array.from(b),m):i&&i.slice()},m.tickFormat=function(b){return arguments.length?(o=b,m):o},m.tickSize=function(b){return arguments.length?(a=l=+b,m):a},m.tickSizeInner=function(b){return arguments.length?(a=+b,m):a},m.tickSizeOuter=function(b){return arguments.length?(l=+b,m):l},m.tickPadding=function(b){return arguments.length?(c=+b,m):c},m.offset=function(b){return arguments.length?(d=+b,m):d},m}function ea(){}function Mt(n){return null==n?ea:function(){return this.querySelector(n)}}function ia(){return[]}function un(n){return null==n?ia:function(){return this.querySelectorAll(n)}}function pn(n){return function(){return this.matches(n)}}function mn(n){return function(r){return r.matches(n)}}var aa=Array.prototype.find;function la(){return this.firstElementChild}var da=Array.prototype.filter;function ua(){return Array.from(this.children)}function gn(n){return new Array(n.length)}function Ke(n,r){this.ownerDocument=n.ownerDocument,this.namespaceURI=n.namespaceURI,this._next=null,this._parent=n,this.__data__=r}function ha(n,r,t,i,o,a){for(var c,l=0,d=r.length,u=a.length;l<u;++l)(c=r[l])?(c.__data__=a[l],i[l]=c):t[l]=new Ke(n,a[l]);for(;l<d;++l)(c=r[l])&&(o[l]=c)}function ba(n,r,t,i,o,a,l){var c,d,b,u=new Map,p=r.length,g=a.length,m=new Array(p);for(c=0;c<p;++c)(d=r[c])&&(m[c]=b=l.call(d,d.__data__,c,r)+"",u.has(b)?o[c]=d:u.set(b,d));for(c=0;c<g;++c)b=l.call(n,a[c],c,a)+"",(d=u.get(b))?(i[c]=d,d.__data__=a[c],u.delete(b)):t[c]=new Ke(n,a[c]);for(c=0;c<p;++c)(d=r[c])&&u.get(m[c])===d&&(o[c]=d)}function ya(n){return n.__data__}function Ca(n){return"object"==typeof n&&"length"in n?n:Array.from(n)}function Ta(n,r){return n<r?-1:n>r?1:n>=r?0:NaN}Ke.prototype={constructor:Ke,appendChild:function(n){return this._parent.insertBefore(n,this._next)},insertBefore:function(n,r){return this._parent.insertBefore(n,r)},querySelector:function(n){return this._parent.querySelector(n)},querySelectorAll:function(n){return this._parent.querySelectorAll(n)}};var jt="http://www.w3.org/1999/xhtml";const _n={svg:"http://www.w3.org/2000/svg",xhtml:jt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function et(n){var r=n+="",t=r.indexOf(":");return t>=0&&"xmlns"!==(r=n.slice(0,t))&&(n=n.slice(t+1)),_n.hasOwnProperty(r)?{space:_n[r],local:n}:n}function Na(n){return function(){this.removeAttribute(n)}}function Ea(n){return function(){this.removeAttributeNS(n.space,n.local)}}function $a(n,r){return function(){this.setAttribute(n,r)}}function Ga(n,r){return function(){this.setAttributeNS(n.space,n.local,r)}}function Ia(n,r){return function(){var t=r.apply(this,arguments);null==t?this.removeAttribute(n):this.setAttribute(n,t)}}function Xa(n,r){return function(){var t=r.apply(this,arguments);null==t?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,t)}}function fn(n){return n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView}function za(n){return function(){this.style.removeProperty(n)}}function Oa(n,r,t){return function(){this.style.setProperty(n,r,t)}}function Pa(n,r,t){return function(){var i=r.apply(this,arguments);null==i?this.style.removeProperty(n):this.style.setProperty(n,i,t)}}function Se(n,r){return n.style.getPropertyValue(r)||fn(n).getComputedStyle(n,null).getPropertyValue(r)}function Ha(n){return function(){delete this[n]}}function Ua(n,r){return function(){this[n]=r}}function Wa(n,r){return function(){var t=r.apply(this,arguments);null==t?delete this[n]:this[n]=t}}function hn(n){return n.trim().split(/^|\s+/)}function Rt(n){return n.classList||new bn(n)}function bn(n){this._node=n,this._names=hn(n.getAttribute("class")||"")}function yn(n,r){for(var t=Rt(n),i=-1,o=r.length;++i<o;)t.add(r[i])}function vn(n,r){for(var t=Rt(n),i=-1,o=r.length;++i<o;)t.remove(r[i])}function Qa(n){return function(){yn(this,n)}}function Ja(n){return function(){vn(this,n)}}function Za(n,r){return function(){(r.apply(this,arguments)?yn:vn)(this,n)}}function Ka(){this.textContent=""}function es(n){return function(){this.textContent=n}}function ts(n){return function(){var r=n.apply(this,arguments);this.textContent=r??""}}function is(){this.innerHTML=""}function os(n){return function(){this.innerHTML=n}}function rs(n){return function(){var r=n.apply(this,arguments);this.innerHTML=r??""}}function ss(){this.nextSibling&&this.parentNode.appendChild(this)}function cs(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function us(n){return function(){var r=this.ownerDocument,t=this.namespaceURI;return t===jt&&r.documentElement.namespaceURI===jt?r.createElement(n):r.createElementNS(t,n)}}function ps(n){return function(){return this.ownerDocument.createElementNS(n.space,n.local)}}function Cn(n){var r=et(n);return(r.local?ps:us)(r)}function gs(){return null}function fs(){var n=this.parentNode;n&&n.removeChild(this)}function bs(){var n=this.cloneNode(!1),r=this.parentNode;return r?r.insertBefore(n,this.nextSibling):n}function ys(){var n=this.cloneNode(!0),r=this.parentNode;return r?r.insertBefore(n,this.nextSibling):n}function ks(n){return function(){var r=this.__on;if(r){for(var a,t=0,i=-1,o=r.length;t<o;++t)a=r[t],n.type&&a.type!==n.type||a.name!==n.name?r[++i]=a:this.removeEventListener(a.type,a.listener,a.options);++i?r.length=i:delete this.__on}}}function Ss(n,r,t){return function(){var o,i=this.__on,a=function xs(n){return function(r){n.call(this,r,this.__data__)}}(r);if(i)for(var l=0,c=i.length;l<c;++l)if((o=i[l]).type===n.type&&o.name===n.name)return this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=a,o.options=t),void(o.value=r);this.addEventListener(n.type,a,t),o={type:n.type,name:n.name,value:r,listener:a,options:t},i?i.push(o):this.__on=[o]}}function xn(n,r,t){var i=fn(n),o=i.CustomEvent;"function"==typeof o?o=new o(r,t):(o=i.document.createEvent("Event"),t?(o.initEvent(r,t.bubbles,t.cancelable),o.detail=t.detail):o.initEvent(r,!1,!1)),n.dispatchEvent(o)}function Ts(n,r){return function(){return xn(this,n,r)}}function Ms(n,r){return function(){return xn(this,n,r.apply(this,arguments))}}bn.prototype={add:function(n){this._names.indexOf(n)<0&&(this._names.push(n),this._node.setAttribute("class",this._names.join(" ")))},remove:function(n){var r=this._names.indexOf(n);r>=0&&(this._names.splice(r,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(n){return this._names.indexOf(n)>=0}};var wn=[null];function ae(n,r){this._groups=n,this._parents=r}function kn(){return new ae([[document.documentElement]],wn)}ae.prototype=kn.prototype={constructor:ae,select:function ta(n){"function"!=typeof n&&(n=Mt(n));for(var r=this._groups,t=r.length,i=new Array(t),o=0;o<t;++o)for(var d,u,a=r[o],l=a.length,c=i[o]=new Array(l),p=0;p<l;++p)(d=a[p])&&(u=n.call(d,d.__data__,p,a))&&("__data__"in d&&(u.__data__=d.__data__),c[p]=u);return new ae(i,this._parents)},selectAll:function ra(n){n="function"==typeof n?function oa(n){return function(){return function na(n){return null==n?[]:Array.isArray(n)?n:Array.from(n)}(n.apply(this,arguments))}}(n):un(n);for(var r=this._groups,t=r.length,i=[],o=[],a=0;a<t;++a)for(var d,l=r[a],c=l.length,u=0;u<c;++u)(d=l[u])&&(i.push(n.call(d,d.__data__,u,l)),o.push(d));return new ae(i,o)},selectChild:function ca(n){return this.select(null==n?la:function sa(n){return function(){return aa.call(this.children,n)}}("function"==typeof n?n:mn(n)))},selectChildren:function ma(n){return this.selectAll(null==n?ua:function pa(n){return function(){return da.call(this.children,n)}}("function"==typeof n?n:mn(n)))},filter:function ga(n){"function"!=typeof n&&(n=pn(n));for(var r=this._groups,t=r.length,i=new Array(t),o=0;o<t;++o)for(var d,a=r[o],l=a.length,c=i[o]=[],u=0;u<l;++u)(d=a[u])&&n.call(d,d.__data__,u,a)&&c.push(d);return new ae(i,this._parents)},data:function va(n,r){if(!arguments.length)return Array.from(this,ya);var t=r?ba:ha,i=this._parents,o=this._groups;"function"!=typeof n&&(n=function fa(n){return function(){return n}}(n));for(var a=o.length,l=new Array(a),c=new Array(a),d=new Array(a),u=0;u<a;++u){var p=i[u],g=o[u],m=g.length,b=Ca(n.call(p,p&&p.__data__,u,i)),S=b.length,V=c[u]=new Array(S),y=l[u]=new Array(S);t(p,g,V,y,d[u]=new Array(m),b,r);for(var j,k,x=0,C=0;x<S;++x)if(j=V[x]){for(x>=C&&(C=x+1);!(k=y[C])&&++C<S;);j._next=k||null}}return(l=new ae(l,i))._enter=c,l._exit=d,l},enter:function _a(){return new ae(this._enter||this._groups.map(gn),this._parents)},exit:function xa(){return new ae(this._exit||this._groups.map(gn),this._parents)},join:function wa(n,r,t){var i=this.enter(),o=this,a=this.exit();return"function"==typeof n?(i=n(i))&&(i=i.selection()):i=i.append(n+""),null!=r&&(o=r(o))&&(o=o.selection()),null==t?a.remove():t(a),i&&o?i.merge(o).order():o},merge:function ka(n){for(var r=n.selection?n.selection():n,t=this._groups,i=r._groups,o=t.length,l=Math.min(o,i.length),c=new Array(o),d=0;d<l;++d)for(var b,u=t[d],p=i[d],g=u.length,m=c[d]=new Array(g),S=0;S<g;++S)(b=u[S]||p[S])&&(m[S]=b);for(;d<o;++d)c[d]=t[d];return new ae(c,this._parents)},selection:function Vs(){return this},order:function Sa(){for(var n=this._groups,r=-1,t=n.length;++r<t;)for(var l,i=n[r],o=i.length-1,a=i[o];--o>=0;)(l=i[o])&&(a&&4^l.compareDocumentPosition(a)&&a.parentNode.insertBefore(l,a),a=l);return this},sort:function Fa(n){function r(g,m){return g&&m?n(g.__data__,m.__data__):!g-!m}n||(n=Ta);for(var t=this._groups,i=t.length,o=new Array(i),a=0;a<i;++a){for(var u,l=t[a],c=l.length,d=o[a]=new Array(c),p=0;p<c;++p)(u=l[p])&&(d[p]=u);d.sort(r)}return new ae(o,this._parents).order()},call:function Ma(){var n=arguments[0];return arguments[0]=this,n.apply(null,arguments),this},nodes:function ja(){return Array.from(this)},node:function Ra(){for(var n=this._groups,r=0,t=n.length;r<t;++r)for(var i=n[r],o=0,a=i.length;o<a;++o){var l=i[o];if(l)return l}return null},size:function Va(){let n=0;for(const r of this)++n;return n},empty:function Da(){return!this.node()},each:function Aa(n){for(var r=this._groups,t=0,i=r.length;t<i;++t)for(var c,o=r[t],a=0,l=o.length;a<l;++a)(c=o[a])&&n.call(c,c.__data__,a,o);return this},attr:function Ba(n,r){var t=et(n);if(arguments.length<2){var i=this.node();return t.local?i.getAttributeNS(t.space,t.local):i.getAttribute(t)}return this.each((null==r?t.local?Ea:Na:"function"==typeof r?t.local?Xa:Ia:t.local?Ga:$a)(t,r))},style:function La(n,r,t){return arguments.length>1?this.each((null==r?za:"function"==typeof r?Pa:Oa)(n,r,t??"")):Se(this.node(),n)},property:function Ya(n,r){return arguments.length>1?this.each((null==r?Ha:"function"==typeof r?Wa:Ua)(n,r)):this.node()[n]},classed:function qa(n,r){var t=hn(n+"");if(arguments.length<2){for(var i=Rt(this.node()),o=-1,a=t.length;++o<a;)if(!i.contains(t[o]))return!1;return!0}return this.each(("function"==typeof r?Za:r?Qa:Ja)(t,r))},text:function ns(n){return arguments.length?this.each(null==n?Ka:("function"==typeof n?ts:es)(n)):this.node().textContent},html:function as(n){return arguments.length?this.each(null==n?is:("function"==typeof n?rs:os)(n)):this.node().innerHTML},raise:function ls(){return this.each(ss)},lower:function ds(){return this.each(cs)},append:function ms(n){var r="function"==typeof n?n:Cn(n);return this.select(function(){return this.appendChild(r.apply(this,arguments))})},insert:function _s(n,r){var t="function"==typeof n?n:Cn(n),i=null==r?gs:"function"==typeof r?r:Mt(r);return this.select(function(){return this.insertBefore(t.apply(this,arguments),i.apply(this,arguments)||null)})},remove:function hs(){return this.each(fs)},clone:function vs(n){return this.select(n?ys:bs)},datum:function Cs(n){return arguments.length?this.property("__data__",n):this.node().__data__},on:function Fs(n,r,t){var o,l,i=function ws(n){return n.trim().split(/^|\s+/).map(function(r){var t="",i=r.indexOf(".");return i>=0&&(t=r.slice(i+1),r=r.slice(0,i)),{type:r,name:t}})}(n+""),a=i.length;if(!(arguments.length<2)){for(c=r?Ss:ks,o=0;o<a;++o)this.each(c(i[o],r,t));return this}var c=this.node().__on;if(c)for(var p,d=0,u=c.length;d<u;++d)for(o=0,p=c[d];o<a;++o)if((l=i[o]).type===p.type&&l.name===p.name)return p.value},dispatch:function js(n,r){return this.each(("function"==typeof r?Ms:Ts)(n,r))},[Symbol.iterator]:function*Rs(){for(var n=this._groups,r=0,t=n.length;r<t;++r)for(var l,i=n[r],o=0,a=i.length;o<a;++o)(l=i[o])&&(yield l)}};const Ie=kn;var Ds={value:()=>{}};function Sn(){for(var i,n=0,r=arguments.length,t={};n<r;++n){if(!(i=arguments[n]+"")||i in t||/[\s.]/.test(i))throw new Error("illegal type: "+i);t[i]=[]}return new tt(t)}function tt(n){this._=n}function Ns(n,r){for(var o,t=0,i=n.length;t<i;++t)if((o=n[t]).name===r)return o.value}function Fn(n,r,t){for(var i=0,o=n.length;i<o;++i)if(n[i].name===r){n[i]=Ds,n=n.slice(0,i).concat(n.slice(i+1));break}return null!=t&&n.push({name:r,value:t}),n}tt.prototype=Sn.prototype={constructor:tt,on:function(n,r){var o,t=this._,i=function As(n,r){return n.trim().split(/^|\s+/).map(function(t){var i="",o=t.indexOf(".");if(o>=0&&(i=t.slice(o+1),t=t.slice(0,o)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:i}})}(n+"",t),a=-1,l=i.length;if(!(arguments.length<2)){if(null!=r&&"function"!=typeof r)throw new Error("invalid callback: "+r);for(;++a<l;)if(o=(n=i[a]).type)t[o]=Fn(t[o],n.name,r);else if(null==r)for(o in t)t[o]=Fn(t[o],n.name,null);return this}for(;++a<l;)if((o=(n=i[a]).type)&&(o=Ns(t[o],n.name)))return o},copy:function(){var n={},r=this._;for(var t in r)n[t]=r[t].slice();return new tt(n)},call:function(n,r){if((o=arguments.length-2)>0)for(var o,a,t=new Array(o),i=0;i<o;++i)t[i]=arguments[i+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(i=0,o=(a=this._[n]).length;i<o;++i)a[i].value.apply(r,t)},apply:function(n,r,t){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var i=this._[n],o=0,a=i.length;o<a;++o)i[o].value.apply(r,t)}};const Es=Sn;var nt,ze,Fe=0,Xe=0,Be=0,it=0,ye=0,ot=0,Oe="object"==typeof performance&&performance.now?performance:Date,Mn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function Vt(){return ye||(Mn($s),ye=Oe.now()+ot)}function $s(){ye=0}function rt(){this._call=this._time=this._next=null}function jn(n,r,t){var i=new rt;return i.restart(n,r,t),i}function Rn(){ye=(it=Oe.now())+ot,Fe=Xe=0;try{!function Gs(){Vt(),++Fe;for(var r,n=nt;n;)(r=ye-n._time)>=0&&n._call.call(void 0,r),n=n._next;--Fe}()}finally{Fe=0,function Xs(){for(var n,t,r=nt,i=1/0;r;)r._call?(i>r._time&&(i=r._time),n=r,r=r._next):(t=r._next,r._next=null,r=n?n._next=t:nt=t);ze=n,Dt(i)}(),ye=0}}function Is(){var n=Oe.now(),r=n-it;r>1e3&&(ot-=r,it=n)}function Dt(n){Fe||(Xe&&(Xe=clearTimeout(Xe)),n-ye>24?(n<1/0&&(Xe=setTimeout(Rn,n-Oe.now()-ot)),Be&&(Be=clearInterval(Be))):(Be||(it=Oe.now(),Be=setInterval(Is,1e3)),Fe=1,Mn(Rn)))}function Vn(n,r,t){var i=new rt;return i.restart(o=>{i.stop(),n(o+r)},r=null==r?0:+r,t),i}rt.prototype=jn.prototype={constructor:rt,restart:function(n,r,t){if("function"!=typeof n)throw new TypeError("callback is not a function");t=(null==t?Vt():+t)+(null==r?0:+r),!this._next&&ze!==this&&(ze?ze._next=this:nt=this,ze=this),this._call=n,this._time=t,Dt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Dt())}};var Bs=Es("start","end","cancel","interrupt"),zs=[];function lt(n,r,t,i,o,a){var l=n.__transition;if(l){if(t in l)return}else n.__transition={};!function Os(n,r,t){var o,i=n.__transition;function l(u){var p,g,m,b;if(1!==t.state)return d();for(p in i)if((b=i[p]).name===t.name){if(3===b.state)return Vn(l);4===b.state?(b.state=6,b.timer.stop(),b.on.call("interrupt",n,n.__data__,b.index,b.group),delete i[p]):+p<r&&(b.state=6,b.timer.stop(),b.on.call("cancel",n,n.__data__,b.index,b.group),delete i[p])}if(Vn(function(){3===t.state&&(t.state=4,t.timer.restart(c,t.delay,t.time),c(u))}),t.state=2,t.on.call("start",n,n.__data__,t.index,t.group),2===t.state){for(t.state=3,o=new Array(m=t.tween.length),p=0,g=-1;p<m;++p)(b=t.tween[p].value.call(n,n.__data__,t.index,t.group))&&(o[++g]=b);o.length=g+1}}function c(u){for(var p=u<t.duration?t.ease.call(null,u/t.duration):(t.timer.restart(d),t.state=5,1),g=-1,m=o.length;++g<m;)o[g].call(n,p);5===t.state&&(t.on.call("end",n,n.__data__,t.index,t.group),d())}function d(){for(var u in t.state=6,t.timer.stop(),delete i[r],i)return;delete n.__transition}i[r]=t,t.timer=jn(function a(u){t.state=1,t.timer.restart(l,t.delay,t.time),t.delay<=u&&l(u-t.delay)},0,t.time)}(n,t,{name:r,index:i,group:o,on:Bs,tween:zs,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function Et(n,r){var t=le(n,r);if(t.state>0)throw new Error("too late; already scheduled");return t}function ue(n,r){var t=le(n,r);if(t.state>3)throw new Error("too late; already running");return t}function le(n,r){var t=n.__transition;if(!t||!(t=t[r]))throw new Error("transition not found");return t}function ce(n,r){return n=+n,r=+r,function(t){return n*(1-t)+r*t}}var ct,En=180/Math.PI,$t={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function $n(n,r,t,i,o,a){var l,c,d;return(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l),(d=n*t+r*i)&&(t-=n*d,i-=r*d),(c=Math.sqrt(t*t+i*i))&&(t/=c,i/=c,d/=c),n*i<r*t&&(n=-n,r=-r,d=-d,l=-l),{translateX:o,translateY:a,rotate:Math.atan2(r,n)*En,skewX:Math.atan(d)*En,scaleX:l,scaleY:c}}function Gn(n,r,t,i){function o(u){return u.length?u.pop()+" ":""}return function(u,p){var g=[],m=[];return u=n(u),p=n(p),function a(u,p,g,m,b,S){if(u!==g||p!==m){var V=b.push("translate(",null,r,null,t);S.push({i:V-4,x:ce(u,g)},{i:V-2,x:ce(p,m)})}else(g||m)&&b.push("translate("+g+r+m+t)}(u.translateX,u.translateY,p.translateX,p.translateY,g,m),function l(u,p,g,m){u!==p?(u-p>180?p+=360:p-u>180&&(u+=360),m.push({i:g.push(o(g)+"rotate(",null,i)-2,x:ce(u,p)})):p&&g.push(o(g)+"rotate("+p+i)}(u.rotate,p.rotate,g,m),function c(u,p,g,m){u!==p?m.push({i:g.push(o(g)+"skewX(",null,i)-2,x:ce(u,p)}):p&&g.push(o(g)+"skewX("+p+i)}(u.skewX,p.skewX,g,m),function d(u,p,g,m,b,S){if(u!==g||p!==m){var V=b.push(o(b)+"scale(",null,",",null,")");S.push({i:V-4,x:ce(u,g)},{i:V-2,x:ce(p,m)})}else(1!==g||1!==m)&&b.push(o(b)+"scale("+g+","+m+")")}(u.scaleX,u.scaleY,p.scaleX,p.scaleY,g,m),u=p=null,function(b){for(var y,S=-1,V=m.length;++S<V;)g[(y=m[S]).i]=y.x(b);return g.join("")}}}var Ws=Gn(function Hs(n){const r=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(n+"");return r.isIdentity?$t:$n(r.a,r.b,r.c,r.d,r.e,r.f)},"px, ","px)","deg)"),Ys=Gn(function Us(n){return null!=n&&(ct||(ct=document.createElementNS("http://www.w3.org/2000/svg","g")),ct.setAttribute("transform",n),n=ct.transform.baseVal.consolidate())?$n((n=n.matrix).a,n.b,n.c,n.d,n.e,n.f):$t},", ",")",")");function Qs(n,r){var t,i;return function(){var o=ue(this,n),a=o.tween;if(a!==t)for(var l=0,c=(i=t=a).length;l<c;++l)if(i[l].name===r){(i=i.slice()).splice(l,1);break}o.tween=i}}function Js(n,r,t){var i,o;if("function"!=typeof t)throw new Error;return function(){var a=ue(this,n),l=a.tween;if(l!==i){o=(i=l).slice();for(var c={name:r,value:t},d=0,u=o.length;d<u;++d)if(o[d].name===r){o[d]=c;break}d===u&&o.push(c)}a.tween=o}}function Gt(n,r,t){var i=n._id;return n.each(function(){var o=ue(this,i);(o.value||(o.value={}))[r]=t.apply(this,arguments)}),function(o){return le(o,i).value[r]}}function It(n,r,t){n.prototype=r.prototype=t,t.constructor=n}function In(n,r){var t=Object.create(n.prototype);for(var i in r)t[i]=r[i];return t}function Pe(){}var dt=1/.7,Te="\\s*([+-]?\\d+)\\s*",He="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",pe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",qs=/^#([0-9a-f]{3,8})$/,Ks=new RegExp(`^rgb\\(${Te},${Te},${Te}\\)$`),el=new RegExp(`^rgb\\(${pe},${pe},${pe}\\)$`),tl=new RegExp(`^rgba\\(${Te},${Te},${Te},${He}\\)$`),nl=new RegExp(`^rgba\\(${pe},${pe},${pe},${He}\\)$`),il=new RegExp(`^hsl\\(${He},${pe},${pe}\\)$`),ol=new RegExp(`^hsla\\(${He},${pe},${pe},${He}\\)$`),Xn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Bn(){return this.rgb().formatHex()}function zn(){return this.rgb().formatRgb()}function ve(n){var r,t;return n=(n+"").trim().toLowerCase(),(r=qs.exec(n))?(t=r[1].length,r=parseInt(r[1],16),6===t?On(r):3===t?new ie(r>>8&15|r>>4&240,r>>4&15|240&r,(15&r)<<4|15&r,1):8===t?ut(r>>24&255,r>>16&255,r>>8&255,(255&r)/255):4===t?ut(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|240&r,((15&r)<<4|15&r)/255):null):(r=Ks.exec(n))?new ie(r[1],r[2],r[3],1):(r=el.exec(n))?new ie(255*r[1]/100,255*r[2]/100,255*r[3]/100,1):(r=tl.exec(n))?ut(r[1],r[2],r[3],r[4]):(r=nl.exec(n))?ut(255*r[1]/100,255*r[2]/100,255*r[3]/100,r[4]):(r=il.exec(n))?Hn(r[1],r[2]/100,r[3]/100,1):(r=ol.exec(n))?Hn(r[1],r[2]/100,r[3]/100,r[4]):Xn.hasOwnProperty(n)?On(Xn[n]):"transparent"===n?new ie(NaN,NaN,NaN,0):null}function On(n){return new ie(n>>16&255,n>>8&255,255&n,1)}function ut(n,r,t,i){return i<=0&&(n=r=t=NaN),new ie(n,r,t,i)}function pt(n,r,t,i){return 1===arguments.length?function sl(n){return n instanceof Pe||(n=ve(n)),n?new ie((n=n.rgb()).r,n.g,n.b,n.opacity):new ie}(n):new ie(n,r,t,i??1)}function ie(n,r,t,i){this.r=+n,this.g=+r,this.b=+t,this.opacity=+i}function Pn(){return`#${xe(this.r)}${xe(this.g)}${xe(this.b)}`}function Ln(){const n=mt(this.opacity);return`${1===n?"rgb(":"rgba("}${Ce(this.r)}, ${Ce(this.g)}, ${Ce(this.b)}${1===n?")":`, ${n})`}`}function mt(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function Ce(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function xe(n){return((n=Ce(n))<16?"0":"")+n.toString(16)}function Hn(n,r,t,i){return i<=0?n=r=t=NaN:t<=0||t>=1?n=r=NaN:r<=0&&(n=NaN),new de(n,r,t,i)}function Un(n){if(n instanceof de)return new de(n.h,n.s,n.l,n.opacity);if(n instanceof Pe||(n=ve(n)),!n)return new de;if(n instanceof de)return n;var r=(n=n.rgb()).r/255,t=n.g/255,i=n.b/255,o=Math.min(r,t,i),a=Math.max(r,t,i),l=NaN,c=a-o,d=(a+o)/2;return c?(l=r===a?(t-i)/c+6*(t<i):t===a?(i-r)/c+2:(r-t)/c+4,c/=d<.5?a+o:2-a-o,l*=60):c=d>0&&d<1?0:l,new de(l,c,d,n.opacity)}function de(n,r,t,i){this.h=+n,this.s=+r,this.l=+t,this.opacity=+i}function Wn(n){return(n=(n||0)%360)<0?n+360:n}function gt(n){return Math.max(0,Math.min(1,n||0))}function Xt(n,r,t){return 255*(n<60?r+(t-r)*n/60:n<180?t:n<240?r+(t-r)*(240-n)/60:r)}function Yn(n,r,t,i,o){var a=n*n,l=a*n;return((1-3*n+3*a-l)*r+(4-6*a+3*l)*t+(1+3*n+3*a-3*l)*i+l*o)/6}It(Pe,ve,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:Bn,formatHex:Bn,formatHex8:function rl(){return this.rgb().formatHex8()},formatHsl:function al(){return Un(this).formatHsl()},formatRgb:zn,toString:zn}),It(ie,pt,In(Pe,{brighter(n){return n=null==n?dt:Math.pow(dt,n),new ie(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=null==n?.7:Math.pow(.7,n),new ie(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new ie(Ce(this.r),Ce(this.g),Ce(this.b),mt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Pn,formatHex:Pn,formatHex8:function ll(){return`#${xe(this.r)}${xe(this.g)}${xe(this.b)}${xe(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Ln,toString:Ln})),It(de,function cl(n,r,t,i){return 1===arguments.length?Un(n):new de(n,r,t,i??1)},In(Pe,{brighter(n){return n=null==n?dt:Math.pow(dt,n),new de(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=null==n?.7:Math.pow(.7,n),new de(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+360*(this.h<0),r=isNaN(n)||isNaN(this.s)?0:this.s,t=this.l,i=t+(t<.5?t:1-t)*r,o=2*t-i;return new ie(Xt(n>=240?n-240:n+120,o,i),Xt(n,o,i),Xt(n<120?n+240:n-120,o,i),this.opacity)},clamp(){return new de(Wn(this.h),gt(this.s),gt(this.l),mt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=mt(this.opacity);return`${1===n?"hsl(":"hsla("}${Wn(this.h)}, ${100*gt(this.s)}%, ${100*gt(this.l)}%${1===n?")":`, ${n})`}`}}));const Bt=n=>()=>n;function Jn(n,r){var t=r-n;return t?function Qn(n,r){return function(t){return n+t*r}}(n,t):Bt(isNaN(n)?r:n)}const _t=function n(r){var t=function ml(n){return 1==(n=+n)?Jn:function(r,t){return t-r?function pl(n,r,t){return n=Math.pow(n,t),r=Math.pow(r,t)-n,t=1/t,function(i){return Math.pow(n+i*r,t)}}(r,t,n):Bt(isNaN(r)?t:r)}}(r);function i(o,a){var l=t((o=pt(o)).r,(a=pt(a)).r),c=t(o.g,a.g),d=t(o.b,a.b),u=Jn(o.opacity,a.opacity);return function(p){return o.r=l(p),o.g=c(p),o.b=d(p),o.opacity=u(p),o+""}}return i.gamma=n,i}(1);function Zn(n){return function(r){var l,c,t=r.length,i=new Array(t),o=new Array(t),a=new Array(t);for(l=0;l<t;++l)c=pt(r[l]),i[l]=c.r||0,o[l]=c.g||0,a[l]=c.b||0;return i=n(i),o=n(o),a=n(a),c.opacity=1,function(d){return c.r=i(d),c.g=o(d),c.b=a(d),c+""}}}Zn(function dl(n){var r=n.length-1;return function(t){var i=t<=0?t=0:t>=1?(t=1,r-1):Math.floor(t*r),o=n[i],a=n[i+1];return Yn((t-i/r)*r,i>0?n[i-1]:2*o-a,o,a,i<r-1?n[i+2]:2*a-o)}}),Zn(function ul(n){var r=n.length;return function(t){var i=Math.floor(((t%=1)<0?++t:t)*r);return Yn((t-i/r)*r,n[(i+r-1)%r],n[i%r],n[(i+1)%r],n[(i+2)%r])}});var zt=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ot=new RegExp(zt.source,"g");function qn(n,r){var i,o,a,t=zt.lastIndex=Ot.lastIndex=0,l=-1,c=[],d=[];for(n+="",r+="";(i=zt.exec(n))&&(o=Ot.exec(r));)(a=o.index)>t&&(a=r.slice(t,a),c[l]?c[l]+=a:c[++l]=a),(i=i[0])===(o=o[0])?c[l]?c[l]+=o:c[++l]=o:(c[++l]=null,d.push({i:l,x:ce(i,o)})),t=Ot.lastIndex;return t<r.length&&(a=r.slice(t),c[l]?c[l]+=a:c[++l]=a),c.length<2?d[0]?function _l(n){return function(r){return n(r)+""}}(d[0].x):function gl(n){return function(){return n}}(r):(r=d.length,function(u){for(var g,p=0;p<r;++p)c[(g=d[p]).i]=g.x(u);return c.join("")})}function Kn(n,r){var t;return("number"==typeof r?ce:r instanceof ve?_t:(t=ve(r))?(r=t,_t):qn)(n,r)}function fl(n){return function(){this.removeAttribute(n)}}function hl(n){return function(){this.removeAttributeNS(n.space,n.local)}}function bl(n,r,t){var i,a,o=t+"";return function(){var l=this.getAttribute(n);return l===o?null:l===i?a:a=r(i=l,t)}}function yl(n,r,t){var i,a,o=t+"";return function(){var l=this.getAttributeNS(n.space,n.local);return l===o?null:l===i?a:a=r(i=l,t)}}function vl(n,r,t){var i,o,a;return function(){var l,d,c=t(this);return null==c?void this.removeAttribute(n):(l=this.getAttribute(n))===(d=c+"")?null:l===i&&d===o?a:(o=d,a=r(i=l,c))}}function Cl(n,r,t){var i,o,a;return function(){var l,d,c=t(this);return null==c?void this.removeAttributeNS(n.space,n.local):(l=this.getAttributeNS(n.space,n.local))===(d=c+"")?null:l===i&&d===o?a:(o=d,a=r(i=l,c))}}function Sl(n,r){var t,i;function o(){var a=r.apply(this,arguments);return a!==i&&(t=(i=a)&&function kl(n,r){return function(t){this.setAttributeNS(n.space,n.local,r.call(this,t))}}(n,a)),t}return o._value=r,o}function Fl(n,r){var t,i;function o(){var a=r.apply(this,arguments);return a!==i&&(t=(i=a)&&function wl(n,r){return function(t){this.setAttribute(n,r.call(this,t))}}(n,a)),t}return o._value=r,o}function Ml(n,r){return function(){Et(this,n).delay=+r.apply(this,arguments)}}function jl(n,r){return r=+r,function(){Et(this,n).delay=r}}function Vl(n,r){return function(){ue(this,n).duration=+r.apply(this,arguments)}}function Dl(n,r){return r=+r,function(){ue(this,n).duration=r}}var Wl=Ie.prototype.constructor;function ei(n){return function(){this.style.removeProperty(n)}}var uc=0;function ge(n,r,t,i){this._groups=n,this._parents=r,this._name=t,this._id=i}function ti(){return++uc}var _e=Ie.prototype;ge.prototype=function pc(n){return Ie().transition(n)}.prototype={constructor:ge,select:function Hl(n){var r=this._name,t=this._id;"function"!=typeof n&&(n=Mt(n));for(var i=this._groups,o=i.length,a=new Array(o),l=0;l<o;++l)for(var p,g,c=i[l],d=c.length,u=a[l]=new Array(d),m=0;m<d;++m)(p=c[m])&&(g=n.call(p,p.__data__,m,c))&&("__data__"in p&&(g.__data__=p.__data__),u[m]=g,lt(u[m],r,t,m,u,le(p,t)));return new ge(a,this._parents,r,t)},selectAll:function Ul(n){var r=this._name,t=this._id;"function"!=typeof n&&(n=un(n));for(var i=this._groups,o=i.length,a=[],l=[],c=0;c<o;++c)for(var p,d=i[c],u=d.length,g=0;g<u;++g)if(p=d[g]){for(var b,m=n.call(p,p.__data__,g,d),S=le(p,t),V=0,y=m.length;V<y;++V)(b=m[V])&&lt(b,r,t,V,m,S);a.push(m),l.push(p)}return new ge(a,l,r,t)},selectChild:_e.selectChild,selectChildren:_e.selectChildren,filter:function Il(n){"function"!=typeof n&&(n=pn(n));for(var r=this._groups,t=r.length,i=new Array(t),o=0;o<t;++o)for(var d,a=r[o],l=a.length,c=i[o]=[],u=0;u<l;++u)(d=a[u])&&n.call(d,d.__data__,u,a)&&c.push(d);return new ge(i,this._parents,this._name,this._id)},merge:function Xl(n){if(n._id!==this._id)throw new Error;for(var r=this._groups,t=n._groups,i=r.length,a=Math.min(i,t.length),l=new Array(i),c=0;c<a;++c)for(var m,d=r[c],u=t[c],p=d.length,g=l[c]=new Array(p),b=0;b<p;++b)(m=d[b]||u[b])&&(g[b]=m);for(;c<i;++c)l[c]=r[c];return new ge(l,this._parents,this._name,this._id)},selection:function Yl(){return new Wl(this._groups,this._parents)},transition:function cc(){for(var n=this._name,r=this._id,t=ti(),i=this._groups,o=i.length,a=0;a<o;++a)for(var d,l=i[a],c=l.length,u=0;u<c;++u)if(d=l[u]){var p=le(d,r);lt(d,n,t,u,l,{time:p.time+p.delay+p.duration,delay:0,duration:p.duration,ease:p.ease})}return new ge(i,this._parents,n,t)},call:_e.call,nodes:_e.nodes,node:_e.node,size:_e.size,empty:_e.empty,each:_e.each,on:function Ol(n,r){var t=this._id;return arguments.length<2?le(this.node(),t).on.on(n):this.each(function zl(n,r,t){var i,o,a=function Bl(n){return(n+"").trim().split(/^|\s+/).every(function(r){var t=r.indexOf(".");return t>=0&&(r=r.slice(0,t)),!r||"start"===r})}(r)?Et:ue;return function(){var l=a(this,n),c=l.on;c!==i&&(o=(i=c).copy()).on(r,t),l.on=o}}(t,n,r))},attr:function xl(n,r){var t=et(n),i="transform"===t?Ys:Kn;return this.attrTween(n,"function"==typeof r?(t.local?Cl:vl)(t,i,Gt(this,"attr."+n,r)):null==r?(t.local?hl:fl)(t):(t.local?yl:bl)(t,i,r))},attrTween:function Tl(n,r){var t="attr."+n;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(null==r)return this.tween(t,null);if("function"!=typeof r)throw new Error;var i=et(n);return this.tween(t,(i.local?Sl:Fl)(i,r))},style:function Kl(n,r,t){var i="transform"==(n+="")?Ws:Kn;return null==r?this.styleTween(n,function Ql(n,r){var t,i,o;return function(){var a=Se(this,n),l=(this.style.removeProperty(n),Se(this,n));return a===l?null:a===t&&l===i?o:o=r(t=a,i=l)}}(n,i)).on("end.style."+n,ei(n)):"function"==typeof r?this.styleTween(n,function Zl(n,r,t){var i,o,a;return function(){var l=Se(this,n),c=t(this),d=c+"";return null==c&&(this.style.removeProperty(n),d=c=Se(this,n)),l===d?null:l===i&&d===o?a:(o=d,a=r(i=l,c))}}(n,i,Gt(this,"style."+n,r))).each(function ql(n,r){var t,i,o,c,a="style."+r,l="end."+a;return function(){var d=ue(this,n),u=d.on,p=null==d.value[a]?c||(c=ei(r)):void 0;(u!==t||o!==p)&&(i=(t=u).copy()).on(l,o=p),d.on=i}}(this._id,n)):this.styleTween(n,function Jl(n,r,t){var i,a,o=t+"";return function(){var l=Se(this,n);return l===o?null:l===i?a:a=r(i=l,t)}}(n,i,r),t).on("end.style."+n,null)},styleTween:function nc(n,r,t){var i="style."+(n+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==r)return this.tween(i,null);if("function"!=typeof r)throw new Error;return this.tween(i,function tc(n,r,t){var i,o;function a(){var l=r.apply(this,arguments);return l!==o&&(i=(o=l)&&function ec(n,r,t){return function(i){this.style.setProperty(n,r.call(this,i),t)}}(n,l,t)),i}return a._value=r,a}(n,r,t??""))},text:function rc(n){return this.tween("text","function"==typeof n?function oc(n){return function(){var r=n(this);this.textContent=r??""}}(Gt(this,"text",n)):function ic(n){return function(){this.textContent=n}}(null==n?"":n+""))},textTween:function lc(n){var r="text";if(arguments.length<1)return(r=this.tween(r))&&r._value;if(null==n)return this.tween(r,null);if("function"!=typeof n)throw new Error;return this.tween(r,function sc(n){var r,t;function i(){var o=n.apply(this,arguments);return o!==t&&(r=(t=o)&&function ac(n){return function(r){this.textContent=n.call(this,r)}}(o)),r}return i._value=n,i}(n))},remove:function Ll(){return this.on("end.remove",function Pl(n){return function(){var r=this.parentNode;for(var t in this.__transition)if(+t!==n)return;r&&r.removeChild(this)}}(this._id))},tween:function Zs(n,r){var t=this._id;if(n+="",arguments.length<2){for(var l,i=le(this.node(),t).tween,o=0,a=i.length;o<a;++o)if((l=i[o]).name===n)return l.value;return null}return this.each((null==r?Qs:Js)(t,n,r))},delay:function Rl(n){var r=this._id;return arguments.length?this.each(("function"==typeof n?Ml:jl)(r,n)):le(this.node(),r).delay},duration:function Al(n){var r=this._id;return arguments.length?this.each(("function"==typeof n?Vl:Dl)(r,n)):le(this.node(),r).duration},ease:function El(n){var r=this._id;return arguments.length?this.each(function Nl(n,r){if("function"!=typeof r)throw new Error;return function(){ue(this,n).ease=r}}(r,n)):le(this.node(),r).ease},easeVarying:function Gl(n){if("function"!=typeof n)throw new Error;return this.each(function $l(n,r){return function(){var t=r.apply(this,arguments);if("function"!=typeof t)throw new Error;ue(this,n).ease=t}}(this._id,n))},end:function dc(){var n,r,t=this,i=t._id,o=t.size();return new Promise(function(a,l){var c={value:l},d={value:function(){0===--o&&a()}};t.each(function(){var u=ue(this,i),p=u.on;p!==n&&((r=(n=p).copy())._.cancel.push(c),r._.interrupt.push(c),r._.end.push(d)),u.on=r}),0===o&&a()})},[Symbol.iterator]:_e[Symbol.iterator]};var gc={time:null,delay:0,duration:250,ease:function mc(n){return((n*=2)<=1?n*n*n:(n-=2)*n*n+2)/2}};function _c(n,r){for(var t;!(t=n.__transition)||!(t=t[r]);)if(!(n=n.parentNode))throw new Error(`transition ${r} not found`);return t}Ie.prototype.interrupt=function Ls(n){return this.each(function(){!function Ps(n,r){var i,o,l,t=n.__transition,a=!0;if(t){for(l in r=null==r?null:r+"",t)(i=t[l]).name===r?(o=i.state>2&&i.state<5,i.state=6,i.timer.stop(),i.on.call(o?"interrupt":"cancel",n,n.__data__,i.index,i.group),delete t[l]):a=!1;a&&delete n.__transition}}(this,n)})},Ie.prototype.transition=function fc(n){var r,t;n instanceof ge?(r=n._id,n=n._name):(r=ti(),(t=gc).time=Vt(),n=null==n?null:n+"");for(var i=this._groups,o=i.length,a=0;a<o;++a)for(var d,l=i[a],c=l.length,u=0;u<c;++u)(d=l[u])&&lt(d,n,r,u,l,t||_c(d,r));return new ge(i,this._parents,n,r)};Math;function Ue(n){return{type:n}}function Wt(n,r){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(r).domain(n)}return this}["w","e"].map(Ue),["n","s"].map(Ue),["n","w","e","s","nw","ne","sw","se"].map(Ue);class si extends Map{constructor(r,t=di){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=r)for(const[i,o]of r)this.set(i,o)}get(r){return super.get(Yt(this,r))}has(r){return super.has(Yt(this,r))}set(r,t){return super.set(function li({_intern:n,_key:r},t){const i=r(t);return n.has(i)?n.get(i):(n.set(i,t),t)}(this,r),t)}delete(r){return super.delete(function ci({_intern:n,_key:r},t){const i=r(t);return n.has(i)&&(t=n.get(i),n.delete(i)),t}(this,r))}}function Yt({_intern:n,_key:r},t){const i=r(t);return n.has(i)?n.get(i):t}function di(n){return null!==n&&"object"==typeof n?n.valueOf():n}Set;const ui=Symbol("implicit");function pi(){var n=new si,r=[],t=[],i=ui;function o(a){let l=n.get(a);if(void 0===l){if(i!==ui)return i;n.set(a,l=r.push(a)-1)}return t[l%t.length]}return o.domain=function(a){if(!arguments.length)return r.slice();r=[],n=new si;for(const l of a)n.has(l)||n.set(l,r.push(l)-1);return o},o.range=function(a){return arguments.length?(t=Array.from(a),o):t.slice()},o.unknown=function(a){return arguments.length?(i=a,o):i},o.copy=function(){return pi(r,t).unknown(i)},Wt.apply(o,arguments),o}function Qt(){var a,l,n=pi().unknown(void 0),r=n.domain,t=n.range,i=0,o=1,c=!1,d=0,u=0,p=.5;function g(){var m=r().length,b=o<i,S=b?o:i,V=b?i:o;a=(V-S)/Math.max(1,m-d+2*u),c&&(a=Math.floor(a)),S+=(V-S-a*(m-d))*p,l=a*(1-d),c&&(S=Math.round(S),l=Math.round(l));var y=function kc(n,r,t){n=+n,r=+r,t=(o=arguments.length)<2?(r=n,n=0,1):o<3?1:+t;for(var i=-1,o=0|Math.max(0,Math.ceil((r-n)/t)),a=new Array(o);++i<o;)a[i]=n+i*t;return a}(m).map(function(h){return S+a*h});return t(b?y.reverse():y)}return delete n.unknown,n.domain=function(m){return arguments.length?(r(m),g()):r()},n.range=function(m){return arguments.length?([i,o]=m,i=+i,o=+o,g()):[i,o]},n.rangeRound=function(m){return[i,o]=m,i=+i,o=+o,c=!0,g()},n.bandwidth=function(){return l},n.step=function(){return a},n.round=function(m){return arguments.length?(c=!!m,g()):c},n.padding=function(m){return arguments.length?(d=Math.min(1,u=+m),g()):d},n.paddingInner=function(m){return arguments.length?(d=Math.min(1,m),g()):d},n.paddingOuter=function(m){return arguments.length?(u=+m,g()):u},n.align=function(m){return arguments.length?(p=Math.max(0,Math.min(1,m)),g()):p},n.copy=function(){return Qt(r(),[i,o]).round(c).paddingInner(d).paddingOuter(u).align(p)},Wt.apply(g(),arguments)}const Sc=Math.sqrt(50),Fc=Math.sqrt(10),Tc=Math.sqrt(2);function bt(n,r,t){const i=(r-n)/Math.max(0,t),o=Math.floor(Math.log10(i)),a=i/Math.pow(10,o),l=a>=Sc?10:a>=Fc?5:a>=Tc?2:1;let c,d,u;return o<0?(u=Math.pow(10,-o)/l,c=Math.round(n*u),d=Math.round(r*u),c/u<n&&++c,d/u>r&&--d,u=-u):(u=Math.pow(10,o)*l,c=Math.round(n/u),d=Math.round(r/u),c*u<n&&++c,d*u>r&&--d),d<c&&.5<=t&&t<2?bt(n,r,2*t):[c,d,u]}function Jt(n,r,t){return bt(n=+n,r=+r,t=+t)[2]}function yt(n,r){return null==n||null==r?NaN:n<r?-1:n>r?1:n>=r?0:NaN}function Rc(n,r){return null==n||null==r?NaN:r<n?-1:r>n?1:r>=n?0:NaN}function gi(n){let r,t,i;function o(c,d,u=0,p=c.length){if(u<p){if(0!==r(d,d))return p;do{const g=u+p>>>1;t(c[g],d)<0?u=g+1:p=g}while(u<p)}return u}return 2!==n.length?(r=yt,t=(c,d)=>yt(n(c),d),i=(c,d)=>n(c)-d):(r=n===yt||n===Rc?n:Vc,t=n,i=n),{left:o,center:function l(c,d,u=0,p=c.length){const g=o(c,d,u,p-1);return g>u&&i(c[g-1],d)>-i(c[g],d)?g-1:g},right:function a(c,d,u=0,p=c.length){if(u<p){if(0!==r(d,d))return p;do{const g=u+p>>>1;t(c[g],d)<=0?u=g+1:p=g}while(u<p)}return u}}}function Vc(){return 0}const Ac=gi(yt).right,Nc=(gi(function Dc(n){return null===n?NaN:+n}),Ac);function fi(n,r){var l,t=r?r.length:0,i=n?Math.min(t,n.length):0,o=new Array(i),a=new Array(t);for(l=0;l<i;++l)o[l]=Zt(n[l],r[l]);for(;l<t;++l)a[l]=r[l];return function(c){for(l=0;l<i;++l)a[l]=o[l](c);return a}}function Ec(n,r){var t=new Date;return n=+n,r=+r,function(i){return t.setTime(n*(1-i)+r*i),t}}function $c(n,r){var o,t={},i={};for(o in(null===n||"object"!=typeof n)&&(n={}),(null===r||"object"!=typeof r)&&(r={}),r)o in n?t[o]=Zt(n[o],r[o]):i[o]=r[o];return function(a){for(o in t)i[o]=t[o](a);return i}}function Gc(n,r){r||(r=[]);var o,t=n?Math.min(r.length,n.length):0,i=r.slice();return function(a){for(o=0;o<t;++o)i[o]=n[o]*(1-a)+r[o]*a;return i}}function Zt(n,r){var i,t=typeof r;return null==r||"boolean"===t?Bt(r):("number"===t?ce:"string"===t?(i=ve(r))?(r=i,_t):qn:r instanceof ve?_t:r instanceof Date?Ec:function Ic(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}(r)?Gc:Array.isArray(r)?fi:"function"!=typeof r.valueOf&&"function"!=typeof r.toString||isNaN(r)?$c:ce)(n,r)}function Xc(n,r){return n=+n,r=+r,function(t){return Math.round(n*(1-t)+r*t)}}function zc(n){return+n}var hi=[0,1];function Re(n){return n}function qt(n,r){return(r-=n=+n)?function(t){return(t-n)/r}:function Bc(n){return function(){return n}}(isNaN(r)?NaN:.5)}function Pc(n,r,t){var i=n[0],o=n[1],a=r[0],l=r[1];return o<i?(i=qt(o,i),a=t(l,a)):(i=qt(i,o),a=t(a,l)),function(c){return a(i(c))}}function Lc(n,r,t){var i=Math.min(n.length,r.length)-1,o=new Array(i),a=new Array(i),l=-1;for(n[i]<n[0]&&(n=n.slice().reverse(),r=r.slice().reverse());++l<i;)o[l]=qt(n[l],n[l+1]),a[l]=t(r[l],r[l+1]);return function(c){var d=Nc(n,c,1,i)-1;return a[d](o[d](c))}}var bi,Yc=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function vt(n){if(!(r=Yc.exec(n)))throw new Error("invalid format: "+n);var r;return new Kt({fill:r[1],align:r[2],sign:r[3],symbol:r[4],zero:r[5],width:r[6],comma:r[7],precision:r[8]&&r[8].slice(1),trim:r[9],type:r[10]})}function Kt(n){this.fill=void 0===n.fill?" ":n.fill+"",this.align=void 0===n.align?">":n.align+"",this.sign=void 0===n.sign?"-":n.sign+"",this.symbol=void 0===n.symbol?"":n.symbol+"",this.zero=!!n.zero,this.width=void 0===n.width?void 0:+n.width,this.comma=!!n.comma,this.precision=void 0===n.precision?void 0:+n.precision,this.trim=!!n.trim,this.type=void 0===n.type?"":n.type+""}function Ct(n,r){if((t=(n=r?n.toExponential(r-1):n.toExponential()).indexOf("e"))<0)return null;var t,i=n.slice(0,t);return[i.length>1?i[0]+i.slice(2):i,+n.slice(t+1)]}function Ve(n){return(n=Ct(Math.abs(n)))?n[1]:NaN}function yi(n,r){var t=Ct(n,r);if(!t)return n+"";var i=t[0],o=t[1];return o<0?"0."+new Array(-o).join("0")+i:i.length>o+1?i.slice(0,o+1)+"."+i.slice(o+1):i+new Array(o-i.length+2).join("0")}vt.prototype=Kt.prototype,Kt.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const vi={"%":(n,r)=>(100*n).toFixed(r),b:n=>Math.round(n).toString(2),c:n=>n+"",d:function Qc(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)},e:(n,r)=>n.toExponential(r),f:(n,r)=>n.toFixed(r),g:(n,r)=>n.toPrecision(r),o:n=>Math.round(n).toString(8),p:(n,r)=>yi(100*n,r),r:yi,s:function ed(n,r){var t=Ct(n,r);if(!t)return n+"";var i=t[0],o=t[1],a=o-(bi=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,l=i.length;return a===l?i:a>l?i+new Array(a-l+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+Ct(n,Math.max(0,r+a-1))[0]},X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function Ci(n){return n}var xt,ki,Si,xi=Array.prototype.map,wi=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function ad(n){var r=n.domain;return n.ticks=function(t){var i=r();return function Mc(n,r,t){if(!((t=+t)>0))return[];if((n=+n)===(r=+r))return[n];const i=r<n,[o,a,l]=i?bt(r,n,t):bt(n,r,t);if(!(a>=o))return[];const c=a-o+1,d=new Array(c);if(i)if(l<0)for(let u=0;u<c;++u)d[u]=(a-u)/-l;else for(let u=0;u<c;++u)d[u]=(a-u)*l;else if(l<0)for(let u=0;u<c;++u)d[u]=(o+u)/-l;else for(let u=0;u<c;++u)d[u]=(o+u)*l;return d}(i[0],i[i.length-1],t??10)},n.tickFormat=function(t,i){var o=r();return function rd(n,r,t,i){var a,o=function jc(n,r,t){t=+t;const i=(r=+r)<(n=+n),o=i?Jt(r,n,t):Jt(n,r,t);return(i?-1:1)*(o<0?1/-o:o)}(n,r,t);switch((i=vt(i??",f")).type){case"s":var l=Math.max(Math.abs(n),Math.abs(r));return null==i.precision&&!isNaN(a=function Jc(n,r){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Ve(r)/3)))-Ve(Math.abs(n)))}(o,l))&&(i.precision=a),Si(i,l);case"":case"e":case"g":case"p":case"r":null==i.precision&&!isNaN(a=function id(n,r){return n=Math.abs(n),r=Math.abs(r)-n,Math.max(0,Ve(r)-Ve(n))+1}(o,Math.max(Math.abs(n),Math.abs(r))))&&(i.precision=a-("e"===i.type));break;case"f":case"%":null==i.precision&&!isNaN(a=function od(n){return Math.max(0,-Ve(Math.abs(n)))}(o))&&(i.precision=a-2*("%"===i.type))}return ki(i)}(o[0],o[o.length-1],t??10,i)},n.nice=function(t){null==t&&(t=10);var d,u,i=r(),o=0,a=i.length-1,l=i[o],c=i[a],p=10;for(c<l&&(u=l,l=c,c=u,u=o,o=a,a=u);p-- >0;){if((u=Jt(l,c,t))===d)return i[o]=l,i[a]=c,r(i);if(u>0)l=Math.floor(l/u)*u,c=Math.ceil(c/u)*u;else{if(!(u<0))break;l=Math.ceil(l*u)/u,c=Math.floor(c*u)/u}d=u}return n},n}function Fi(){var n=function Wc(){return function Uc(){var i,o,a,c,d,u,n=hi,r=hi,t=Zt,l=Re;function p(){var m=Math.min(n.length,r.length);return l!==Re&&(l=function Oc(n,r){var t;return n>r&&(t=n,n=r,r=t),function(i){return Math.max(n,Math.min(r,i))}}(n[0],n[m-1])),c=m>2?Lc:Pc,d=u=null,g}function g(m){return null==m||isNaN(m=+m)?a:(d||(d=c(n.map(i),r,t)))(i(l(m)))}return g.invert=function(m){return l(o((u||(u=c(r,n.map(i),ce)))(m)))},g.domain=function(m){return arguments.length?(n=Array.from(m,zc),p()):n.slice()},g.range=function(m){return arguments.length?(r=Array.from(m),p()):r.slice()},g.rangeRound=function(m){return r=Array.from(m),t=Xc,p()},g.clamp=function(m){return arguments.length?(l=!!m||Re,p()):l!==Re},g.interpolate=function(m){return arguments.length?(t=m,p()):t},g.unknown=function(m){return arguments.length?(a=m,g):a},function(m,b){return i=m,o=b,p()}}()(Re,Re)}();return n.copy=function(){return function Hc(n,r){return r.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}(n,Fi())},Wt.apply(n,arguments),ad(n)}function Ti(n){return"string"==typeof n?new ae([[document.querySelector(n)]],[document.documentElement]):new ae([[n]],wn)}function De(n,r,t){this.k=n,this.x=r,this.y=t}!function nd(n){xt=function td(n){var r=void 0===n.grouping||void 0===n.thousands?Ci:function Zc(n,r){return function(t,i){for(var o=t.length,a=[],l=0,c=n[0],d=0;o>0&&c>0&&(d+c+1>i&&(c=Math.max(1,i-d)),a.push(t.substring(o-=c,o+c)),!((d+=c+1)>i));)c=n[l=(l+1)%n.length];return a.reverse().join(r)}}(xi.call(n.grouping,Number),n.thousands+""),t=void 0===n.currency?"":n.currency[0]+"",i=void 0===n.currency?"":n.currency[1]+"",o=void 0===n.decimal?".":n.decimal+"",a=void 0===n.numerals?Ci:function qc(n){return function(r){return r.replace(/[0-9]/g,function(t){return n[+t]})}}(xi.call(n.numerals,String)),l=void 0===n.percent?"%":n.percent+"",c=void 0===n.minus?"\u2212":n.minus+"",d=void 0===n.nan?"NaN":n.nan+"";function u(g){var m=(g=vt(g)).fill,b=g.align,S=g.sign,V=g.symbol,y=g.zero,h=g.width,x=g.comma,C=g.precision,j=g.trim,k=g.type;"n"===k?(x=!0,k="g"):vi[k]||(void 0===C&&(C=12),j=!0,k="g"),(y||"0"===m&&"="===b)&&(y=!0,m="0",b="=");var E="$"===V?t:"#"===V&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",z="$"===V?i:/[%p]/.test(k)?l:"",O=vi[k],H=/[defgprs%]/.test(k);function G(T){var _,F,v,L=E,B=z;if("c"===k)B=O(T)+B,T="";else{var w=(T=+T)<0||1/T<0;if(T=isNaN(T)?d:O(Math.abs(T),C),j&&(T=function Kc(n){e:for(var o,r=n.length,t=1,i=-1;t<r;++t)switch(n[t]){case".":i=o=t;break;case"0":0===i&&(i=t),o=t;break;default:if(!+n[t])break e;i>0&&(i=0)}return i>0?n.slice(0,i)+n.slice(o+1):n}(T)),w&&0==+T&&"+"!==S&&(w=!1),L=(w?"("===S?S:c:"-"===S||"("===S?"":S)+L,B=("s"===k?wi[8+bi/3]:"")+B+(w&&"("===S?")":""),H)for(_=-1,F=T.length;++_<F;)if(48>(v=T.charCodeAt(_))||v>57){B=(46===v?o+T.slice(_+1):T.slice(_))+B,T=T.slice(0,_);break}}x&&!y&&(T=r(T,1/0));var D=L.length+T.length+B.length,M=D<h?new Array(h-D+1).join(m):"";switch(x&&y&&(T=r(M+T,M.length?h-B.length:1/0),M=""),b){case"<":T=L+T+B+M;break;case"=":T=L+M+T+B;break;case"^":T=M.slice(0,D=M.length>>1)+L+T+B+M.slice(D);break;default:T=M+L+T+B}return a(T)}return C=void 0===C?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,C)):Math.max(0,Math.min(20,C)),G.toString=function(){return g+""},G}return{format:u,formatPrefix:function p(g,m){var b=u(((g=vt(g)).type="f",g)),S=3*Math.max(-8,Math.min(8,Math.floor(Ve(m)/3))),V=Math.pow(10,-S),y=wi[8+S/3];return function(h){return b(V*h)+y}}}}(n),ki=xt.format,Si=xt.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]}),De.prototype={constructor:De,scale:function(n){return 1===n?this:new De(this.k*n,this.x,this.y)},translate:function(n,r){return 0===n&0===r?this:new De(this.k,this.x+this.k*n,this.y+this.k*r)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new De(1,0,0);let gd=(()=>{class n{el=(0,s.WQX)(e.aKT);data=(0,f.hFB)();constructor(){(0,s.QZP)(()=>{const t=this.data();t&&t.length>0&&this.createChart(t)})}createChart(t){Ti(this.el.nativeElement).select("svg").remove();const i=this.el.nativeElement,a=i.clientWidth-40-20,l=310,c=Ti(i).append("svg").attr("width",a+40+20).attr("height",400).append("g").attr("transform","translate(40,20)"),d=Qt().range([0,a]).domain(t.map(p=>p.label)).padding(.2);c.append("g").attr("transform","translate(0,310)").call(function qr(n){return qe(3,n)}(d)).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end").style("fill","#9ca3af");const u=Fi().domain([0,Hr(t,p=>p.value)??0]).range([l,0]);c.append("g").call(function Kr(n){return qe(4,n)}(u)).selectAll("text").style("fill","#9ca3af"),c.selectAll("mybar").data(t).enter().append("rect").attr("x",p=>d(p.label)).attr("y",p=>u(p.value)).attr("width",d.bandwidth()).attr("height",p=>l-u(p.value)).attr("fill","#4f46e5")}static \u0275fac=function(i){return new(i||n)};static \u0275dir=e.FsC({type:n,selectors:[["","appD3BarChart",""]],inputs:{data:[1,"data"]}})}return n})();var R=W(7006);let Ae=(()=>{class n{ai;constructor(){const t=typeof process<"u"&&process.env?.API_KEY?process.env.API_KEY:"";this.ai=new R.M4({apiKey:t})}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),_d=(()=>{class n{ai=(0,s.WQX)(Ae).ai;generateBiDashboard(t,i){var o=this;return(0,Z.A)(function*(){const l=`You are a business intelligence analyst. Analyze the following JSON contact data and generate a JSON object for a dashboard. The data fields are: ${i.map(u=>u.name).join(", ")}.\n    The JSON object must contain three properties: 'kpis', 'charts', and 'insights'.\n    1. 'kpis': An array of 2-3 key performance indicators. Each KPI object should have a 'title' (e.g., "Total Revenue") and a 'value' (e.g., "$1.2M").\n    2. 'charts': An array containing one chart object. This object must have 'type' set to 'bar', a 'title' (e.g., "Contacts by Lead Source"), and 'data' which is an array of objects, each with a 'label' and 'value'. Choose the most relevant categorical field for the chart.\n    3. 'insights': An array of 2-3 brief, actionable insights in plain text.\n    Data: \n\n${JSON.stringify(t,null,2)}`,d=(yield o.ai.models.generateContent({model:"gemini-2.5-flash",contents:l,config:{responseMimeType:"application/json",responseSchema:{type:R.ZU.OBJECT,properties:{kpis:{type:R.ZU.ARRAY,items:{type:R.ZU.OBJECT,properties:{title:{type:R.ZU.STRING},value:{type:R.ZU.STRING},change:{type:R.ZU.STRING,nullable:!0}},required:["title","value"]}},charts:{type:R.ZU.ARRAY,items:{type:R.ZU.OBJECT,properties:{type:{type:R.ZU.STRING},title:{type:R.ZU.STRING},data:{type:R.ZU.ARRAY,items:{type:R.ZU.OBJECT,properties:{label:{type:R.ZU.STRING},value:{type:R.ZU.NUMBER}},required:["label","value"]}}},required:["type","title","data"]}},insights:{type:R.ZU.ARRAY,items:{type:R.ZU.STRING}}},required:["kpis","charts","insights"]}}})).text.trim();return JSON.parse(d)})()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const fd=()=>[1,2,3],hd=(n,r)=>r.title;function bd(n,r){1&n&&(e.j41(0,"div",4),e.nrm(1,"div",13)(2,"div",14),e.k0s())}function yd(n,r){1&n&&(e.j41(0,"div",0)(1,"div",3),e.Z7z(2,bd,3,0,"div",4,e.fX1),e.k0s(),e.j41(4,"div",5)(5,"div",6),e.nrm(6,"div",7)(7,"div",8),e.k0s(),e.j41(8,"div",4),e.nrm(9,"div",9),e.j41(10,"div",10),e.nrm(11,"div",11)(12,"div",12)(13,"div",11),e.k0s()()()()),2&n&&(e.R7$(2),e.Dyx(e.lJ4(0,fd)))}function vd(n,r){if(1&n&&(e.j41(0,"div",1),e.nrm(1,"i",15),e.j41(2,"h3",16),e.EFF(3,"Error"),e.k0s(),e.j41(4,"p"),e.EFF(5),e.k0s()()),2&n){const t=e.XpG();e.R7$(5),e.JRh(t.error())}}function Cd(n,r){if(1&n&&(e.j41(0,"div",17)(1,"h3",21),e.EFF(2),e.k0s(),e.j41(3,"p",22),e.EFF(4),e.k0s()()),2&n){const t=r.$implicit;e.R7$(2),e.JRh(t.title),e.R7$(2),e.JRh(t.value)}}function xd(n,r){if(1&n&&(e.j41(0,"div",18)(1,"h3",19),e.EFF(2),e.k0s(),e.nrm(3,"div",23),e.k0s()),2&n){const i=e.XpG().charts[0];e.R7$(2),e.JRh(i.title),e.R7$(),e.Y8G("data",i.data)}}function wd(n,r){if(1&n&&(e.j41(0,"li",20)(1,"div",24),e.nrm(2,"i",25),e.k0s(),e.j41(3,"p",26),e.EFF(4),e.k0s()()),2&n){const t=r.$implicit;e.R7$(4),e.JRh(t)}}function kd(n,r){if(1&n&&(e.j41(0,"div",2)(1,"div",3),e.Z7z(2,Cd,5,2,"div",17,hd),e.k0s(),e.j41(4,"div",5),e.nVh(5,xd,4,2,"div",18),e.j41(6,"div",17)(7,"h3",19),e.EFF(8,"AI Insights"),e.k0s(),e.j41(9,"ul",10),e.Z7z(10,wd,5,1,"li",20,e.fX1),e.k0s()()()()),2&n){const t=r;e.R7$(2),e.Dyx(t.kpis),e.R7$(3),e.vxM(t.charts.length>0?5:-1),e.R7$(5),e.Dyx(t.insights)}}let Sd=(()=>{class n{data=f.hFB.required();columns=f.hFB.required();aiDashboardService=(0,s.WQX)(_d);isLoading=(0,s.vPA)(!0);dashboardContent=(0,s.vPA)(null);error=(0,s.vPA)(null);constructor(){var t=this;(0,s.QZP)(function(){var i=(0,Z.A)(function*(o){const a=t.data(),l=t.columns();if(a.length>0){t.isLoading.set(!0),t.error.set(null);try{const c=yield t.aiDashboardService.generateBiDashboard(a,l);t.dashboardContent.set(c)}catch(c){console.error("Failed to generate BI dashboard:",c),t.error.set("Could not load AI-powered dashboard. Please try again.")}finally{t.isLoading.set(!1)}}});return function(o){return i.apply(this,arguments)}}())}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-bi-view"]],inputs:{data:[1,"data"],columns:[1,"columns"]},decls:3,vars:1,consts:[[1,"space-y-8","animate-pulse"],[1,"flex","flex-col","items-center","justify-center","h-full","text-center","text-gray-500","dark:text-gray-400"],[1,"space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],[1,"bg-white","dark:bg-gray-800","p-6","rounded-lg","shadow"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6"],[1,"lg:col-span-2","bg-white","dark:bg-gray-800","p-6","rounded-lg","shadow"],[1,"h-6","bg-gray-300","dark:bg-gray-600","rounded","w-1/4","mb-6"],[1,"h-72","bg-gray-300","dark:bg-gray-600","rounded"],[1,"h-6","bg-gray-300","dark:bg-gray-600","rounded","w-1/3","mb-6"],[1,"space-y-4"],[1,"h-4","bg-gray-300","dark:bg-gray-600","rounded","w-full"],[1,"h-4","bg-gray-300","dark:bg-gray-600","rounded","w-5/6"],[1,"h-4","bg-gray-300","dark:bg-gray-600","rounded","w-1/3","mb-4"],[1,"h-8","bg-gray-300","dark:bg-gray-600","rounded","w-1/2"],[1,"pi","pi-exclamation-triangle","text-5xl","text-red-500","mb-4"],[1,"text-xl","font-semibold","mb-2"],[1,"bg-white","dark:bg-gray-800","p-6","rounded-lg","shadow-md","border","border-gray-200","dark:border-gray-700"],[1,"lg:col-span-2","bg-white","dark:bg-gray-800","p-6","rounded-lg","shadow-md","border","border-gray-200","dark:border-gray-700"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","mb-4"],[1,"flex","items-start"],[1,"text-sm","font-medium","text-gray-500","dark:text-gray-400","truncate"],[1,"mt-1","text-3xl","font-semibold","tracking-tight","text-gray-900","dark:text-white"],["appD3BarChart","",3,"data"],[1,"flex-shrink-0"],[1,"pi","pi-check-circle","text-green-500","mt-1"],[1,"ml-3","text-sm","text-gray-600","dark:text-gray-300"]],template:function(i,o){if(1&i&&e.nVh(0,yd,14,1,"div",0)(1,vd,6,1,"div",1)(2,kd,12,1,"div",2),2&i){let a;e.vxM(o.isLoading()?0:o.error()?1:(a=o.dashboardContent())?2:-1,a)}},dependencies:[P.MD,gd],encapsulation:2,changeDetection:0})}return n})(),ji=(()=>{class n{ai=(0,s.WQX)(Ae).ai;generateNarration(t,i){var o=this;return(0,Z.A)(function*(){const l=`You are a data analyst. Based on the following JSON data representing contacts, provide a concise narrative summary. The data has the following columns: ${i.map(d=>d.name).join(", ")}. Highlight key trends, such as distribution of contacts or any notable patterns in annual revenue. Keep the summary to 3-4 sentences. Data: \n\n${JSON.stringify(t,null,2)}`;return(yield o.ai.models.generateContent({model:"gemini-2.5-flash",contents:l})).text})()}suggestInsights(t,i){var o=this;return(0,Z.A)(function*(){const l=`You are a business intelligence analyst. Analyze this JSON contact data and suggest 3 key insights or important metrics a user should focus on. Present them as a bulleted list using markdown. The available data fields are: ${i.map(d=>d.name).join(", ")}. For example, suggest looking at the average revenue or which lead source is most common. Data: \n\n${JSON.stringify(t,null,2)}`;return(yield o.ai.models.generateContent({model:"gemini-2.5-flash",contents:l})).text})()}getQuickMetrics(t,i){var o=this;return(0,Z.A)(function*(){const l=`You are a data analyst. Based on the following JSON contact data, identify the most insightful categorical column (like 'Lead Source', 'Country', or 'City') to perform a 'group by' and 'count' operation on. Then, provide the counts for each category in that column, ordered from highest to lowest count. Present the result in a clear, human-readable format with a title and use markdown for formatting. The available data fields are: ${i.map(d=>d.name).join(", ")}. Data: \n\n${JSON.stringify(t,null,2)}`;return(yield o.ai.models.generateContent({model:"gemini-2.5-flash",contents:l})).text})()}summarizeCalendarDay(t){var i=this;return(0,Z.A)(function*(){const o=`You are a helpful assistant. Summarize the following list of contacts that were created on a specific day. Mention the total number of new contacts and highlight any notable names or companies if there are fewer than 5 contacts. Keep the summary to 1-2 sentences. Data:\n\n${JSON.stringify(t.map(l=>({name:l.contact_person,company:l.organization_name})),null,2)}`;return(yield i.ai.models.generateContent({model:"gemini-2.5-flash",contents:o})).text})()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Fd=()=>["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Td=(n,r)=>r.date,Md=(n,r)=>r.organization_id;function jd(n,r){if(1&n&&(e.rj2(0,"div",14),e.EFF(1),e.eux()),2&n){const t=r.$implicit;e.R7$(),e.JRh(t)}}function Rd(n,r){if(1&n&&(e.rj2(0,"div",19)(1,"span",20),e.EFF(2),e.eux()()),2&n){const t=e.XpG().$implicit;e.R7$(2),e.SpI(" ",t.contacts.length," ")}}function Vd(n,r){if(1&n){const t=e.RV6();e.rj2(0,"div",17),e.VwU("click",function(){const o=s.eBV(t).$implicit,a=e.XpG();return s.Njj(a.selectDay(o))}),e.rj2(1,"time",18),e.nI1(2,"date"),e.EFF(3),e.nI1(4,"date"),e.eux(),e.nVh(5,Rd,3,1,"div",19),e.eux()}if(2&n){const t=r.$implicit,i=e.XpG();e.AVh("cursor-pointer",t.contacts.length>0)("hover:bg-slate-50",t.contacts.length>0)("bg-gray-50",!t.isCurrentMonth),e.R7$(),e.AVh("text-gray-400",!t.isCurrentMonth)("text-white",i.isToday(t.date))("bg-slate-900",i.isToday(t.date))("font-semibold",i.isToday(t.date)),e.Avn("dateTime",e.i5U(2,17,t.date,"yyyy-MM-dd")),e.R7$(2),e.SpI(" ",e.i5U(4,20,t.date,"d")," "),e.R7$(2),e.vxM(t.contacts.length>0?5:-1)}}function Dd(n,r){1&n&&e.Hgh(0,"div",30)}function Ad(n,r){if(1&n&&(e.rj2(0,"p",31),e.EFF(1),e.eux()),2&n){const t=e.XpG(2);e.R7$(),e.JRh(t.aiSummary())}}function Nd(n,r){if(1&n&&(e.rj2(0,"li",34),e.Hgh(1,"img",35),e.rj2(2,"div")(3,"p",36),e.EFF(4),e.eux(),e.rj2(5,"p",37),e.EFF(6),e.eux()()()),2&n){const t=r.$implicit;e.R7$(),e.Avn("src",t.avatar_url,e.B4B),e.R7$(3),e.JRh(t.contact_person),e.R7$(2),e.JRh(t.organization_name)}}function Ed(n,r){if(1&n){const t=e.RV6();e.rj2(0,"div",21),e.VwU("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.selectedDay.set(null))}),e.rj2(1,"div",22),e.VwU("click",function(o){return s.eBV(t),s.Njj(o.stopPropagation())}),e.rj2(2,"header",1)(3,"h3",23),e.EFF(4),e.nI1(5,"date"),e.eux(),e.rj2(6,"button",24),e.VwU("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.selectedDay.set(null))}),e.Hgh(7,"i",25),e.eux()(),e.rj2(8,"div",26)(9,"div",27)(10,"h4",28),e.Hgh(11,"i",29),e.EFF(12,"AI Summary"),e.eux(),e.nVh(13,Dd,1,0,"div",30)(14,Ad,2,1,"p",31),e.eux(),e.rj2(15,"h4",32),e.EFF(16),e.eux(),e.rj2(17,"ul",33),e.Z7z(18,Nd,7,3,"li",34,Md),e.eux()()()()}if(2&n){const t=r,i=e.XpG();e.R7$(4),e.SpI("Activity for ",e.i5U(5,3,t.date,"longDate")),e.R7$(9),e.vxM(i.isSummaryLoading()?13:14),e.R7$(3),e.SpI("New Contacts (",t.contacts.length,")"),e.R7$(2),e.Dyx(t.contacts)}}let $d=(()=>{class n{data=f.hFB.required();columns=f.hFB.required();config=f.hFB.required();aiSummaryService=(0,s.WQX)(ji);currentDate=(0,s.vPA)(new Date);selectedDay=(0,s.vPA)(null);aiSummary=(0,s.vPA)(null);isSummaryLoading=(0,s.vPA)(!1);dateFieldName=(0,N.EW)(()=>{const t=this.config().dateFieldCode,i=this.columns().find(o=>o.code===t);return i?i.name:this.config().dateFieldCode});contactsByDate=(0,N.EW)(()=>{const t=new Map,i=this.config().dateFieldCode;for(const o of this.data()){const a=o[i];if(a&&"string"==typeof a){const l=new Date(a).toISOString().split("T")[0];t.has(l)||t.set(l,[]),t.get(l).push(o)}}return t});calendarGrid=(0,N.EW)(()=>{const t=this.currentDate(),i=t.getFullYear(),o=t.getMonth(),a=new Date(i,o,1),l=new Date(i,o+1,0),c=a.getDay(),d=l.getDate(),u=[];for(let g=0;g<c;g++){const m=new Date(a);m.setDate(m.getDate()-(c-g)),u.push({date:m,isCurrentMonth:!1,contacts:this.getContactsForDate(m)})}for(let g=1;g<=d;g++){const m=new Date(i,o,g);u.push({date:m,isCurrentMonth:!0,contacts:this.getContactsForDate(m)})}const p=42-u.length;for(let g=1;g<=p;g++){const m=new Date(l);m.setDate(m.getDate()+g),u.push({date:m,isCurrentMonth:!1,contacts:this.getContactsForDate(m)})}return u});getContactsForDate(t){const i=t.toISOString().split("T")[0];return this.contactsByDate().get(i)||[]}selectDay(t){var i=this;return(0,Z.A)(function*(){if(0!==t.contacts.length){i.selectedDay.set(t),i.isSummaryLoading.set(!0),i.aiSummary.set(null);try{const o=yield i.aiSummaryService.summarizeCalendarDay(t.contacts);i.aiSummary.set(o)}catch(o){console.error("Failed to get AI summary",o),i.aiSummary.set("Could not generate summary.")}finally{i.isSummaryLoading.set(!1)}}else i.selectedDay.set(null)})()}changeMonth(t){this.currentDate.update(i=>{const o=new Date(i);return o.setMonth(o.getMonth()+t),o})}goToToday(){this.currentDate.set(new Date)}isToday(t){const i=new Date;return t.getDate()===i.getDate()&&t.getMonth()===i.getMonth()&&t.getFullYear()===i.getFullYear()}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-calendar-view"]],inputs:{data:[1,"data"],columns:[1,"columns"],config:[1,"config"]},decls:24,vars:7,consts:[[1,"bg-white","rounded-lg","shadow-md","border","border-gray-200","h-full","flex","flex-col"],[1,"flex","items-center","justify-between","p-4","border-b","border-gray-200"],[1,"flex","items-center","gap-4"],[1,"px-4","py-2","text-sm","font-medium","border","rounded-md","hover:bg-gray-100",3,"click"],[1,"flex","items-center","gap-2"],["title","Previous month",1,"p-2","rounded-full","hover:bg-gray-100",3,"click"],[1,"pi","pi-chevron-left"],["title","Next month",1,"p-2","rounded-full","hover:bg-gray-100",3,"click"],[1,"pi","pi-chevron-right"],[1,"text-lg","font-semibold","text-center"],[1,"w-48","text-right"],[1,"text-sm","font-medium","text-gray-700"],[1,"font-semibold","text-indigo-600"],[1,"grid","grid-cols-7","flex-grow"],[1,"text-center","font-medium","text-xs","text-gray-500","py-2","border-b","border-r","border-gray-200"],[1,"border-b","border-r","border-gray-200","p-2","flex","flex-col","transition-colors",3,"cursor-pointer","hover:bg-slate-50","bg-gray-50"],[1,"fixed","inset-0","bg-gray-900/60","flex","items-center","justify-center","z-50"],[1,"border-b","border-r","border-gray-200","p-2","flex","flex-col","transition-colors",3,"click"],[1,"h-6","w-6","flex","items-center","justify-center","rounded-full","text-sm",3,"dateTime"],[1,"mt-2","text-center"],[1,"inline-flex","items-center","justify-center","h-6","w-6","text-xs","font-semibold","rounded-full","bg-blue-100","text-blue-800"],[1,"fixed","inset-0","bg-gray-900/60","flex","items-center","justify-center","z-50",3,"click"],[1,"bg-white","rounded-lg","shadow-xl","w-full","max-w-lg","m-4",3,"click"],[1,"text-lg","font-semibold"],[1,"p-2","rounded-full","hover:bg-gray-100",3,"click"],[1,"pi","pi-times"],[1,"p-6"],[1,"bg-gray-50","p-4","rounded-lg","mb-4"],[1,"font-semibold","text-sm","mb-2","flex","items-center"],[1,"pi","pi-sparkles","text-indigo-500","mr-2"],[1,"h-4","bg-gray-300","rounded","w-full","animate-pulse"],[1,"text-sm","text-gray-700"],[1,"font-semibold","text-sm","mb-2"],[1,"divide-y","divide-gray-200","max-h-60","overflow-y-auto"],[1,"py-2","flex","items-center","gap-3"],["alt","Avatar",1,"h-8","w-8","rounded-full","object-cover",3,"src"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-xs","text-gray-500"]],template:function(i,o){if(1&i&&(e.rj2(0,"div",0)(1,"header",1)(2,"div",2)(3,"button",3),e.VwU("click",function(){return o.goToToday()}),e.EFF(4,"Today"),e.eux(),e.rj2(5,"div",4)(6,"button",5),e.VwU("click",function(){return o.changeMonth(-1)}),e.Hgh(7,"i",6),e.eux(),e.rj2(8,"button",7),e.VwU("click",function(){return o.changeMonth(1)}),e.Hgh(9,"i",8),e.eux()()(),e.rj2(10,"h2",9),e.EFF(11),e.nI1(12,"date"),e.eux(),e.rj2(13,"div",10)(14,"p",11),e.EFF(15," Field: "),e.rj2(16,"span",12),e.EFF(17),e.eux()()()(),e.rj2(18,"div",13),e.Z7z(19,jd,2,1,"div",14,e.fX1),e.Z7z(21,Vd,6,23,"div",15,Td),e.eux()(),e.nVh(23,Ed,20,6,"div",16)),2&i){let a;e.R7$(11),e.JRh(e.i5U(12,3,o.currentDate(),"LLLL yyyy")),e.R7$(6),e.SpI(" ",o.dateFieldName()," "),e.R7$(2),e.Dyx(e.lJ4(6,Fd)),e.R7$(2),e.Dyx(o.calendarGrid()),e.R7$(2),e.vxM((a=o.selectedDay())?23:-1,a)}},dependencies:[P.MD,P.vh],encapsulation:2,changeDetection:0})}return n})();function Gd(n,r){if(1&n&&(e.rj2(0,"div",2),e.Hgh(1,"span",18),e.rj2(2,"span",19),e.EFF(3),e.eux()()),2&n){const t=r;e.Avn("title","Connection is "+t.text),e.R7$(),e.HbH(t.class),e.R7$(2),e.JRh(t.text)}}function Id(n,r){1&n&&(e.rj2(0,"div",3),e.Hgh(1,"i",20),e.rj2(2,"span",7),e.EFF(3),e.eux()()),2&n&&(e.Avn("title","Current Data Strategy"),e.R7$(3),e.JRh(r))}function Xd(n,r){1&n&&(e.rj2(0,"span",22),e.EFF(1,"Syncing..."),e.eux())}function Bd(n,r){if(1&n&&(e.rj2(0,"span",23),e.EFF(1),e.eux()),2&n){const t=e.XpG(2);e.Avn("title",t.fullSyncTime()),e.R7$(),e.SpI("Last sync: ",t.relativeSyncTime())}}function zd(n,r){if(1&n&&(e.rj2(0,"div",4),e.Hgh(1,"i",21),e.nVh(2,Xd,2,0,"span",22)(3,Bd,2,2,"span",23),e.eux()),2&n){const t=e.XpG();e.R7$(2),e.vxM(t.isSyncing()?2:3)}}function Od(n,r){if(1&n&&(e.rj2(0,"option",11),e.EFF(1),e.eux()),2&n){const t=r.$implicit,i=e.XpG();e.Avn("value",t)("selected",t===i.pageSize()),e.R7$(),e.JRh(t)}}function Pd(n,r){1&n&&(e.rj2(0,"span",27),e.EFF(1,"..."),e.eux())}function Ld(n,r){if(1&n){const t=e.RV6();e.rj2(0,"button",29),e.VwU("click",function(){s.eBV(t);const o=e.XpG().$implicit,a=e.XpG(2);return s.Njj(a.goToPage(o))}),e.EFF(1),e.eux()}if(2&n){const t=e.XpG().$implicit,i=e.XpG(2);e.AVh("bg-slate-900",t===i.currentPage())("text-white",t===i.currentPage())("border-slate-900",t===i.currentPage()),e.Avn("title","Go to page "+t),e.R7$(),e.SpI(" ",t," ")}}function Hd(n,r){1&n&&e.nVh(0,Pd,2,0,"span",27)(1,Ld,2,8,"button",28),2&n&&e.vxM("..."===r.$implicit?0:1)}function Ud(n,r){if(1&n){const t=e.RV6();e.rj2(0,"button",24),e.VwU("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.previousPage())}),e.EFF(1," Previous "),e.eux(),e.rj2(2,"div",25),e.Z7z(3,Hd,2,1,null,null,e.Vm6),e.eux(),e.rj2(5,"button",26),e.VwU("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.nextPage())}),e.EFF(6," Next "),e.eux()}if(2&n){const t=e.XpG();e.Avn("disabled",1===t.currentPage()),e.R7$(3),e.Dyx(t.pages()),e.R7$(2),e.Avn("disabled",t.currentPage()===t.totalPages())}}function Wd(n,r){1&n&&e.Hgh(0,"div",15)}let Yd=(()=>{class n{currentPage=f.hFB.required();pageSize=f.hFB.required();totalRecords=f.hFB.required();pageSizeOptions=(0,f.hFB)([12,20,50,100]);infiniteScroll=(0,f.hFB)(!1);infiniteScrollBehavior=(0,f.hFB)("append");currentRecordCount=(0,f.hFB)(0);autoSizingEnabled=(0,f.hFB)(!1);dataStrategy=(0,f.hFB)();connectionStatus=(0,f.hFB)();lastSyncTime=(0,f.hFB)();isSyncing=(0,f.hFB)();pageChange=(0,f.CGW)();pageSizeChange=(0,f.CGW)();autoSizingToggle=(0,f.CGW)();chatbotToggle=(0,f.CGW)();isAppendMode=(0,N.EW)(()=>this.infiniteScroll()&&"append"===this.infiniteScrollBehavior());totalPages=(0,N.EW)(()=>Math.ceil(this.totalRecords()/this.pageSize()));recordRangeStart=(0,N.EW)(()=>this.isAppendMode()?this.totalRecords()>0?1:0:(this.currentPage()-1)*this.pageSize()+1);recordRangeEnd=(0,N.EW)(()=>this.isAppendMode()?this.currentRecordCount():Math.min(this.currentPage()*this.pageSize(),this.totalRecords()));pages=(0,N.EW)(()=>{const t=this.totalPages(),i=this.currentPage(),a=[];for(let l=Math.max(2,i-2);l<=Math.min(t-1,i+2);l++)a.push(l);return i-2>2&&a.unshift("..."),i+2<t-1&&a.push("..."),a.unshift(1),t>1&&a.push(t),a});relativeSyncTime=(0,N.EW)(()=>{const t=this.lastSyncTime();if(!t)return"never";const i=(new Date).getTime(),o=Math.round((i-t)/1e3);if(o<2)return"just now";if(o<60)return`${o}s ago`;const a=Math.round(o/60);if(a<60)return`${a}m ago`;const l=Math.round(a/60);return l<24?`${l}h ago`:new Date(t).toLocaleDateString()});fullSyncTime=(0,N.EW)(()=>{const t=this.lastSyncTime();return t?new Date(t).toLocaleString():""});goToPage(t){"number"==typeof t&&t>=1&&t<=this.totalPages()&&this.pageChange.emit(t)}nextPage(){this.currentPage()<this.totalPages()&&this.goToPage(this.currentPage()+1)}previousPage(){this.currentPage()>1&&this.goToPage(this.currentPage()-1)}onPageSizeChange(t){const i=parseInt(t.target.value,10);this.pageSizeChange.emit(i)}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-paginator"]],inputs:{currentPage:[1,"currentPage"],pageSize:[1,"pageSize"],totalRecords:[1,"totalRecords"],pageSizeOptions:[1,"pageSizeOptions"],infiniteScroll:[1,"infiniteScroll"],infiniteScrollBehavior:[1,"infiniteScrollBehavior"],currentRecordCount:[1,"currentRecordCount"],autoSizingEnabled:[1,"autoSizingEnabled"],dataStrategy:[1,"dataStrategy"],connectionStatus:[1,"connectionStatus"],lastSyncTime:[1,"lastSyncTime"],isSyncing:[1,"isSyncing"]},outputs:{pageChange:"pageChange",pageSizeChange:"pageSizeChange",autoSizingToggle:"autoSizingToggle",chatbotToggle:"chatbotToggle"},decls:30,vars:18,consts:[["aria-label","Pagination",1,"flex","items-center","justify-between","border-t","border-gray-200","px-4","py-3","sm:px-6"],[1,"flex","items-center","gap-4"],[1,"flex","items-center","gap-2","text-xs",3,"title"],[1,"flex","items-center","gap-1.5","text-xs","text-gray-600",3,"title"],[1,"flex","items-center","gap-1.5","text-xs","text-gray-600"],[1,"block","h-6","w-px","bg-gray-300"],[1,"text-sm","text-gray-700"],[1,"font-medium"],[1,"flex","items-center","text-sm","text-gray-700"],["for","pageSize",1,"mr-2"],["id","pageSize","title","Select number of rows per page",1,"px-2","py-1","border","border-gray-300","rounded-md","bg-white","focus:outline-none","focus:ring-1","focus:ring-indigo-500","focus:border-indigo-500",3,"change"],[3,"value","selected"],[1,"px-4","py-2","rounded-md","border","transition-colors","text-sm",3,"click","title"],[1,"pi","pi-arrows-alt"],[1,"flex-1","flex","justify-between","items-center","sm:justify-end","gap-3"],[1,"flex-1"],["title","Open AI Assistant",1,"flex-shrink-0","flex","items-center","justify-center","h-8","w-8","rounded-full","bg-indigo-600","text-white","shadow-md","hover:bg-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500","transition-transform","hover:scale-110",3,"click"],[1,"pi","pi-comments","text-lg"],[1,"h-2.5","w-2.5","rounded-full"],[1,"text-gray-600"],[1,"pi","pi-database"],[1,"pi","pi-history"],[1,"font-medium","animate-pulse"],[3,"title"],["title","Go to previous page",1,"relative","inline-flex","items-center","px-4","py-2","border","border-gray-300","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","items-center"],["title","Go to next page",1,"relative","inline-flex","items-center","px-4","py-2","border","border-gray-300","text-sm","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"relative","inline-flex","items-center","px-4","py-2","border","border-transparent","text-sm","font-medium","text-gray-700"],[1,"relative","inline-flex","items-center","px-4","py-2","border","border-gray-300","bg-white","text-sm","font-medium","text-gray-500","hover:bg-gray-50",3,"title","bg-slate-900","text-white","border-slate-900"],[1,"relative","inline-flex","items-center","px-4","py-2","border","border-gray-300","bg-white","text-sm","font-medium","text-gray-500","hover:bg-gray-50",3,"click","title"]],template:function(i,o){if(1&i&&(e.rj2(0,"nav",0)(1,"div",1),e.nVh(2,Gd,4,4,"div",2),e.nVh(3,Id,4,2,"div",3),e.nVh(4,zd,4,1,"div",4),e.Hgh(5,"div",5),e.rj2(6,"p",6),e.EFF(7," Showing "),e.rj2(8,"span",7),e.EFF(9),e.eux(),e.EFF(10," to "),e.rj2(11,"span",7),e.EFF(12),e.eux(),e.EFF(13," of "),e.rj2(14,"span",7),e.EFF(15),e.eux(),e.EFF(16," results "),e.eux(),e.rj2(17,"div",8)(18,"label",9),e.EFF(19,"Rows:"),e.eux(),e.rj2(20,"select",10),e.VwU("change",function(l){return o.onPageSizeChange(l)}),e.Z7z(21,Od,2,3,"option",11,e.fX1),e.eux()(),e.rj2(23,"button",12),e.VwU("click",function(){return o.autoSizingToggle.emit()}),e.Hgh(24,"i",13),e.eux()(),e.rj2(25,"div",14),e.nVh(26,Ud,7,2)(27,Wd,1,0,"div",15),e.rj2(28,"button",16),e.VwU("click",function(){return o.chatbotToggle.emit()}),e.Hgh(29,"i",17),e.eux()()()),2&i){let a,l;e.R7$(2),e.vxM((a=o.connectionStatus())?2:-1,a),e.R7$(),e.vxM((l=o.dataStrategy())?3:-1,l),e.R7$(),e.vxM("SYNC"===o.dataStrategy()?4:-1),e.R7$(5),e.JRh(o.recordRangeStart()),e.R7$(3),e.JRh(o.recordRangeEnd()),e.R7$(3),e.JRh(o.totalRecords()),e.R7$(6),e.Dyx(o.pageSizeOptions()),e.R7$(2),e.AVh("bg-slate-900",o.autoSizingEnabled())("text-white",o.autoSizingEnabled())("bg-white",!o.autoSizingEnabled())("border-gray-300",!o.autoSizingEnabled())("hover:bg-gray-100",!o.autoSizingEnabled()),e.Avn("title",o.autoSizingEnabled()?"Disable Auto Page Sizing":"Enable Auto Page Sizing"),e.R7$(3),e.vxM(o.infiniteScroll()?27:26)}},dependencies:[P.MD],encapsulation:2,changeDetection:0})}return n})();const Qd=(n,r)=>r.code;function Jd(n,r){if(1&n){const t=e.RV6();e.rj2(0,"li",7),e.VwU("dragstart",function(){const o=s.eBV(t).$index,a=e.XpG();return s.Njj(a.onDragStart(o))})("dragover",function(o){s.eBV(t);const a=e.XpG();return s.Njj(a.onDragOver(o))})("drop",function(o){const a=s.eBV(t).$index,l=e.XpG();return s.Njj(l.onDrop(o,a))})("dragend",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.onDragEnd())}),e.rj2(1,"input",8),e.VwU("change",function(o){const a=s.eBV(t).$implicit,l=e.XpG();return s.Njj(l.onVisibilityChange(a,o))}),e.eux(),e.rj2(2,"span",9),e.EFF(3),e.eux(),e.Hgh(4,"i",10),e.eux()}if(2&n){const t=r.$implicit,i=r.$index,o=e.XpG();e.AVh("opacity-50",o.draggedColumnIndex()===i),e.R7$(),e.Avn("checked",o.isColumnVisible(t.code)),e.R7$(2),e.JRh(t.name)}}let Zd=(()=>{class n{allColumns=f.hFB.required();visibleColumns=f.hFB.required();visibilityChange=(0,f.CGW)();orderChange=(0,f.CGW)();draggedColumnIndex=(0,s.vPA)(null);isColumnVisible(t){return this.visibleColumns().some(i=>i.code===t)}onVisibilityChange(t,i){i.preventDefault(),this.visibilityChange.emit(t)}onDragStart(t){this.draggedColumnIndex.set(t)}onDragOver(t){t.preventDefault()}onDrop(t,i){t.preventDefault();const o=this.draggedColumnIndex();if(null===o||o===i)return void this.draggedColumnIndex.set(null);const a=[...this.allColumns()],[l]=a.splice(o,1);a.splice(i,0,l),this.orderChange.emit(a),this.draggedColumnIndex.set(null)}onDragEnd(){this.draggedColumnIndex.set(null)}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-column-chooser"]],inputs:{allColumns:[1,"allColumns"],visibleColumns:[1,"visibleColumns"]},outputs:{visibilityChange:"visibilityChange",orderChange:"orderChange"},decls:10,vars:0,consts:[[1,"origin-top-right","absolute","right-0","mt-2","w-64","rounded-md","shadow-lg","bg-white","dark:bg-gray-800","ring-1","ring-black","ring-opacity-5","focus:outline-none","z-10"],[1,"py-1"],[1,"px-4","py-2"],[1,"text-xs","text-gray-400","uppercase","tracking-wider"],[1,"text-xs","text-gray-400"],[1,"space-y-1"],["draggable","true",1,"flex","items-center","px-4","py-2","text-sm","text-gray-700","dark:text-gray-200","hover:bg-gray-100","dark:hover:bg-gray-700","transition-colors","duration-150",3,"opacity-50"],["draggable","true",1,"flex","items-center","px-4","py-2","text-sm","text-gray-700","dark:text-gray-200","hover:bg-gray-100","dark:hover:bg-gray-700","transition-colors","duration-150",3,"dragstart","dragover","drop","dragend"],["type","checkbox",1,"h-4","w-4","rounded","border-gray-300","text-indigo-600","focus:ring-indigo-500",3,"change","checked"],[1,"ml-3"],["title","Drag to reorder",1,"pi","pi-bars","ml-auto","cursor-move","text-gray-400"]],template:function(i,o){1&i&&(e.rj2(0,"div",0)(1,"div",1)(2,"div",2)(3,"p",3),e.EFF(4,"Show/Hide Columns"),e.eux(),e.rj2(5,"p",4),e.EFF(6,"Drag to reorder"),e.eux()(),e.rj2(7,"ul",5),e.Z7z(8,Jd,5,4,"li",6,Qd),e.eux()()()),2&i&&(e.R7$(8),e.Dyx(o.allColumns()))},dependencies:[P.MD],encapsulation:2,changeDetection:0})}return n})();const qd=(n,r)=>r.name,Kd=(n,r)=>r.code;function eu(n,r){if(1&n){const t=e.RV6();e.j41(0,"li",29),e.bIt("click",function(){const o=s.eBV(t).$implicit,a=e.XpG(4).$implicit,l=e.XpG(2);return s.Njj(l.updateFilterOperator(a.code,o))}),e.EFF(1),e.k0s()}if(2&n){const t=r.$implicit;e.R7$(),e.JRh(t)}}function tu(n,r){if(1&n){const t=e.RV6();e.j41(0,"ul",27),e.bIt("clickOutside",function(){s.eBV(t);const o=e.XpG(5);return s.Njj(o.closeAllDropdowns())}),e.Z7z(1,eu,2,1,"li",28,e.fX1),e.k0s()}if(2&n){const t=e.XpG(3).$implicit;e.R7$(),e.Dyx(t.operators)}}function nu(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",20)(1,"span",30),e.EFF(2,"and"),e.k0s(),e.j41(3,"input",31),e.bIt("input",function(o){s.eBV(t);const a=e.XpG(3).$implicit,l=e.XpG(2);return s.Njj(l.updateFilterValue(a.code,"value2",o))}),e.k0s()()}if(2&n){e.XpG(3);const t=e.r8f(0);e.R7$(3),e.Y8G("value",t.value2||"")}}function iu(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",20)(1,"div",22)(2,"button",23),e.bIt("click",function(){s.eBV(t);const o=e.XpG(2).$implicit,a=e.XpG(2);return s.Njj(a.toggleDropdown(o.code))}),e.j41(3,"span"),e.EFF(4),e.k0s(),e.nrm(5,"i",24),e.k0s(),e.nVh(6,tu,3,0,"ul",25),e.k0s(),e.j41(7,"input",26),e.bIt("input",function(o){s.eBV(t);const a=e.XpG(2).$implicit,l=e.XpG(2);return s.Njj(l.updateFilterValue(a.code,"value1",o))}),e.k0s()(),e.nVh(8,nu,4,1,"div",20)}if(2&n){const t=e.XpG(2).$implicit,i=e.r8f(0),o=e.XpG(2);e.R7$(4),e.JRh(i.operator),e.R7$(2),e.vxM(o.isDropdownOpen(t.code)?6:-1),e.R7$(),e.Y8G("value",i.value1),e.R7$(),e.vxM("between"===i.operator||"not between"===i.operator?8:-1)}}function ou(n,r){if(1&n){const t=e.RV6();e.j41(0,"li",29),e.bIt("click",function(){const o=s.eBV(t).$implicit,a=e.XpG(4).$implicit,l=e.XpG(2);return s.Njj(l.updateFilterOperator(a.code,o))}),e.EFF(1),e.k0s()}if(2&n){const t=r.$implicit;e.R7$(),e.JRh(t)}}function ru(n,r){if(1&n){const t=e.RV6();e.j41(0,"ul",27),e.bIt("clickOutside",function(){s.eBV(t);const o=e.XpG(5);return s.Njj(o.closeAllDropdowns())}),e.Z7z(1,ou,2,1,"li",28,e.fX1),e.k0s()}if(2&n){const t=e.XpG(3).$implicit;e.R7$(),e.Dyx(t.dateOperators)}}function au(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",20)(1,"div",32)(2,"button",23),e.bIt("click",function(){s.eBV(t);const o=e.XpG(2).$implicit,a=e.XpG(2);return s.Njj(a.toggleDropdown(o.code))}),e.j41(3,"span"),e.EFF(4),e.k0s(),e.nrm(5,"i",24),e.k0s(),e.nVh(6,ru,3,0,"ul",25),e.k0s()()}if(2&n){const t=e.XpG(2).$implicit,i=e.r8f(0),o=e.XpG(2);e.R7$(4),e.JRh(i.operator),e.R7$(2),e.vxM(o.isDropdownOpen(t.code)?6:-1)}}function su(n,r){if(1&n&&(e.j41(0,"option",35),e.EFF(1),e.k0s()),2&n){const t=r.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t)}}function lu(n,r){if(1&n){const t=e.RV6();e.j41(0,"select",33),e.bIt("change",function(o){s.eBV(t);const a=e.XpG(2).$implicit,l=e.XpG(2);return s.Njj(l.updateFilterValue(a.code,"value1",o))}),e.j41(1,"option",34),e.EFF(2,"Select..."),e.k0s(),e.Z7z(3,su,2,2,"option",35,e.fX1),e.k0s()}if(2&n){const t=e.XpG(2).$implicit,i=e.r8f(0);e.Y8G("value",i.value1),e.R7$(3),e.Dyx(t.options)}}function cu(n,r){if(1&n&&(e.j41(0,"div",19),e.nVh(1,iu,9,4),e.nVh(2,au,7,2,"div",20),e.nVh(3,lu,5,1,"select",21),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.vxM("text"===t.type||"numeric"===t.type?1:-1),e.R7$(),e.vxM("date"===t.type?2:-1),e.R7$(),e.vxM("select"===t.type?3:-1)}}function du(n,r){if(1&n){const t=e.RV6();e.SS7(0),e.j41(1,"li")(2,"div",16)(3,"input",17),e.bIt("change",function(o){const a=s.eBV(t).$implicit,l=e.XpG(2);return s.Njj(l.toggleFilter(a,o))}),e.k0s(),e.j41(4,"label",18),e.EFF(5),e.k0s()(),e.nVh(6,cu,4,3,"div",19),e.k0s()}if(2&n){const t=r.$implicit,i=e.bH3(e.XpG(2).localActiveFilters()[t.code]);e.R7$(3),e.Y8G("id",t.code)("checked",!!i),e.R7$(),e.Y8G("for",t.code),e.R7$(),e.JRh(t.name),e.R7$(),e.vxM(i?6:-1)}}function uu(n,r){if(1&n&&(e.j41(0,"div",10)(1,"h3",14),e.EFF(2),e.k0s(),e.j41(3,"ul",15),e.Z7z(4,du,7,6,"li",null,Kd),e.k0s()()),2&n){const t=r.$implicit;e.R7$(2),e.JRh(t.name),e.R7$(2),e.Dyx(t.filters)}}let pu=(()=>{class n{isOpen=f.hFB.required();config=f.hFB.required();activeFilters=f.hFB.required();close=(0,f.CGW)();apply=(0,f.CGW)();localActiveFilters=(0,s.vPA)({});openDropdowns=(0,s.vPA)(new Set);constructor(){(0,s.QZP)(()=>{this.isOpen()&&this.localActiveFilters.set(JSON.parse(JSON.stringify(this.activeFilters())))})}toggleFilter(t,i){const o=i.target.checked,a={...this.localActiveFilters()};o?a[t.code]||(a[t.code]={code:t.code,name:t.name,type:t.type,operator:t.defaultOperator||(t.operators?t.operators[0]:t.dateOperators?t.dateOperators[0]:"="),value1:t.value||"",value2:t.value2}):delete a[t.code],this.localActiveFilters.set(a)}updateFilterValue(t,i,o){const a=o.target.value;this.localActiveFilters.update(l=>(l[t]&&(l[t][i]=a),{...l}))}updateFilterOperator(t,i){this.localActiveFilters.update(o=>(o[t]&&(o[t].operator=i),{...o})),this.toggleDropdown(t)}applyFilters(){this.apply.emit(this.localActiveFilters())}clearFilters(){this.localActiveFilters.set({}),this.apply.emit({})}toggleDropdown(t){this.openDropdowns.update(i=>{const o=new Set(i);return o.has(t)?o.delete(t):o.add(t),o})}closeAllDropdowns(){this.openDropdowns.set(new Set)}isDropdownOpen(t){return this.openDropdowns().has(t)}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-filter-sidebar"]],inputs:{isOpen:[1,"isOpen"],config:[1,"config"],activeFilters:[1,"activeFilters"]},outputs:{close:"close",apply:"apply"},decls:18,vars:4,consts:[[1,"fixed","top-0","right-0","h-full","w-96","bg-white","shadow-2xl","z-40","transform","transition-transform","duration-300","ease-in-out","flex","flex-col"],[1,"flex","items-center","justify-between","p-4","border-b","border-gray-200","flex-shrink-0"],[1,"text-lg","font-semibold","text-gray-800"],["title","Close Filters",1,"text-gray-500","hover:text-gray-700",3,"click"],[1,"pi","pi-times","text-xl"],[1,"flex-grow","p-4","overflow-y-auto","custom-scrollbar"],[1,"relative","mb-4"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],[1,"pi","pi-search","text-gray-400"],["type","search","placeholder","Search",1,"w-full","pl-10","pr-4","py-2","text-sm","border","border-gray-300","rounded-md","bg-white","focus:ring-indigo-500","focus:border-indigo-500"],[1,"mb-6"],[1,"flex","items-center","justify-end","p-4","border-t","border-gray-200","flex-shrink-0","space-x-3"],[1,"px-4","py-2","text-sm","font-medium","text-gray-700","bg-white","border","border-gray-300","rounded-md","hover:bg-gray-50",3,"click"],[1,"px-4","py-2","text-sm","font-medium","text-white","bg-slate-900","border","border-transparent","rounded-md","hover:bg-slate-800","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-slate-500",3,"click"],[1,"text-sm","font-semibold","uppercase","text-gray-500","mb-2"],[1,"space-y-2"],[1,"flex","items-center"],["type","checkbox",1,"h-4","w-4","rounded","border-gray-300","text-indigo-600","focus:ring-indigo-500","bg-white",3,"change","id","checked"],[1,"ml-3","text-sm","text-gray-700",3,"for"],[1,"mt-2","pl-7","space-y-2"],[1,"flex","items-center","gap-2"],[1,"w-full","px-2","py-1.5","text-xs","border","border-gray-300","rounded-md","bg-white","focus:ring-indigo-500","focus:border-indigo-500",3,"value"],[1,"relative","w-28"],[1,"flex","items-center","justify-between","w-full","px-2","py-1.5","text-xs","text-left","bg-white","border","border-gray-300","rounded-md",3,"click"],[1,"pi","pi-chevron-down","text-xs"],[1,"absolute","z-10","w-full","mt-1","bg-white","border","border-gray-300","rounded-md","shadow-lg","max-h-48","overflow-auto"],["type","text","placeholder","Type here",1,"flex-1","w-full","px-2","py-1.5","text-xs","border","border-gray-300","rounded-md","bg-white",3,"input","value"],[1,"absolute","z-10","w-full","mt-1","bg-white","border","border-gray-300","rounded-md","shadow-lg","max-h-48","overflow-auto",3,"clickOutside"],[1,"px-2","py-1.5","text-xs","hover:bg-indigo-50","cursor-pointer"],[1,"px-2","py-1.5","text-xs","hover:bg-indigo-50","cursor-pointer",3,"click"],[1,"text-xs","w-28","text-center"],["type","text","placeholder","Type here",1,"flex-1","w-full","px-2","py-1.5","text-xs","border","border-gray-300","dark:border-gray-600","rounded-md","bg-white","dark:bg-gray-700",3,"input","value"],[1,"relative","w-full"],[1,"w-full","px-2","py-1.5","text-xs","border","border-gray-300","rounded-md","bg-white","focus:ring-indigo-500","focus:border-indigo-500",3,"change","value"],["value",""],[3,"value"]],template:function(i,o){1&i&&(e.j41(0,"aside",0)(1,"header",1)(2,"h2",2),e.EFF(3,"Filter By"),e.k0s(),e.j41(4,"button",3),e.bIt("click",function(){return o.close.emit()}),e.nrm(5,"i",4),e.k0s()(),e.j41(6,"div",5)(7,"div",6)(8,"div",7),e.nrm(9,"i",8),e.k0s(),e.nrm(10,"input",9),e.k0s(),e.Z7z(11,uu,6,1,"div",10,qd),e.k0s(),e.j41(13,"footer",11)(14,"button",12),e.bIt("click",function(){return o.clearFilters()}),e.EFF(15," Clear "),e.k0s(),e.j41(16,"button",13),e.bIt("click",function(){return o.applyFilters()}),e.EFF(17," Apply "),e.k0s()()()),2&i&&(e.AVh("translate-x-0",o.isOpen())("translate-x-full",!o.isOpen()),e.R7$(11),e.Dyx(o.config().groups))},dependencies:[P.MD,$e],styles:[".custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px;height:6px}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#4b5563;border-radius:3px}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#6b7280}"],changeDetection:0})}return n})(),mu=(()=>{class n{el=(0,s.WQX)(e.aKT);editor;isInternalChange=!1;value=(0,f.hFB)("");valueChange=(0,f.CGW)();constructor(){(0,s.QZP)(()=>{const t=this.value();if(this.editor&&!this.isInternalChange&&this.editor.getValue()!==t){const i=this.editor.getCursor();this.editor.setValue(t),this.editor.setCursor(i)}})}ngAfterViewInit(){this.editor=CodeMirror(this.el.nativeElement,{value:this.value(),mode:{name:"javascript",json:!0},theme:"material-darker",lineNumbers:!0,autoCloseBrackets:!0,matchBrackets:!0}),this.editor.on("change",t=>{const i=t.getValue();this.isInternalChange=!0,this.valueChange.emit(i),setTimeout(()=>this.isInternalChange=!1,0)})}ngOnDestroy(){if(this.editor){const t=this.editor.getWrapperElement();t.parentNode?.removeChild(t),this.editor=null}}static \u0275fac=function(i){return new(i||n)};static \u0275dir=e.FsC({type:n,selectors:[["","appJsonEditor",""]],inputs:{value:[1,"value"]},outputs:{valueChange:"valueChange"}})}return n})();var se=W(9417),Ri=W(152),Vi=W(3294),Di=W(1413),gu=W(6977);function _u(n,r){if(1&n&&(e.j41(0,"option",7),e.EFF(1),e.k0s()),2&n){const t=r.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t)}}function fu(n,r){if(1&n&&(e.j41(0,"option",7),e.EFF(1),e.k0s()),2&n){const t=r.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t)}}function hu(n,r){if(1&n&&(e.j41(0,"option",7),e.EFF(1),e.k0s()),2&n){const t=r.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t)}}function bu(n,r){if(1&n&&(e.j41(0,"div")(1,"label",34),e.EFF(2,"Infinite Scroll Behavior"),e.k0s(),e.j41(3,"select",35),e.Z7z(4,hu,2,2,"option",7,e.fX1),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(4),e.Dyx(t.infiniteScrollBehaviors)}}function yu(n,r){if(1&n&&(e.j41(0,"option",12),e.EFF(1),e.k0s()),2&n){const t=r.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t)}}function vu(n,r){if(1&n&&(e.j41(0,"option",7),e.EFF(1),e.k0s()),2&n){const t=r.$implicit;e.Y8G("value",t),e.R7$(),e.JRh("iconAndText"===t?"Icon & Text":"Icon Only")}}function Cu(n,r){if(1&n&&(e.j41(0,"form",0)(1,"div",1)(2,"h3",2),e.EFF(3,"General"),e.k0s(),e.j41(4,"div")(5,"label",3),e.EFF(6,"Table Title"),e.k0s(),e.nrm(7,"input",4),e.k0s()(),e.j41(8,"div",1)(9,"h3",2),e.EFF(10,"Data & Paging"),e.k0s(),e.j41(11,"div")(12,"label",5),e.EFF(13,"Data Strategy"),e.k0s(),e.j41(14,"select",6),e.Z7z(15,_u,2,2,"option",7,e.fX1),e.k0s()(),e.j41(17,"div")(18,"label",8),e.EFF(19,"Paging Mode"),e.k0s(),e.j41(20,"select",9),e.Z7z(21,fu,2,2,"option",7,e.fX1),e.k0s()(),e.nVh(23,bu,6,0,"div"),e.k0s(),e.j41(24,"div",1)(25,"h3",2),e.EFF(26,"Appearance"),e.k0s(),e.j41(27,"div")(28,"label",10),e.EFF(29,"Paginator Position"),e.k0s(),e.j41(30,"select",11),e.Z7z(31,yu,2,2,"option",12,e.fX1),e.k0s()(),e.j41(33,"div")(34,"label",13),e.EFF(35,"Toolbar Button Style"),e.k0s(),e.j41(36,"select",14),e.Z7z(37,vu,2,2,"option",7,e.fX1),e.k0s()(),e.j41(39,"div",15)(40,"span",16),e.EFF(41,"Striped Rows (Table View)"),e.k0s(),e.j41(42,"label",17),e.nrm(43,"input",18)(44,"div",19),e.k0s()(),e.j41(45,"div",15)(46,"span",16),e.EFF(47,"Show Grid Lines (Table View)"),e.k0s(),e.j41(48,"label",17),e.nrm(49,"input",20)(50,"div",19),e.k0s()(),e.j41(51,"div",15)(52,"span",16),e.EFF(53,"Enable Row Hover Effect"),e.k0s(),e.j41(54,"label",17),e.nrm(55,"input",21)(56,"div",19),e.k0s()(),e.j41(57,"div",15)(58,"span",16),e.EFF(59,"Enable Table Footer"),e.k0s(),e.j41(60,"label",17),e.nrm(61,"input",22)(62,"div",19),e.k0s()()(),e.j41(63,"div",1)(64,"h3",2),e.EFF(65,"Card View"),e.k0s(),e.j41(66,"div")(67,"label",23),e.EFF(68),e.k0s(),e.nrm(69,"input",24),e.k0s()(),e.j41(70,"div",1)(71,"h3",2),e.EFF(72,"Features"),e.k0s(),e.j41(73,"div",15)(74,"span",16),e.EFF(75,"Enable Column Chooser"),e.k0s(),e.j41(76,"label",17),e.nrm(77,"input",25)(78,"div",19),e.k0s()(),e.j41(79,"div",15)(80,"span",16),e.EFF(81,"Enable Export"),e.k0s(),e.j41(82,"label",17),e.nrm(83,"input",26)(84,"div",19),e.k0s()(),e.j41(85,"div",15)(86,"span",16),e.EFF(87,"Enable Multi-Select"),e.k0s(),e.j41(88,"label",17),e.nrm(89,"input",27)(90,"div",19),e.k0s()(),e.j41(91,"div",15)(92,"span",16),e.EFF(93,"Enable Config Button in Toolbar"),e.k0s(),e.j41(94,"label",17),e.nrm(95,"input",28)(96,"div",19),e.k0s()(),e.j41(97,"div",15)(98,"span",16),e.EFF(99,"Enable Row Menu (3-dot)"),e.k0s(),e.j41(100,"label",17),e.nrm(101,"input",29)(102,"div",19),e.k0s()(),e.j41(103,"div",15)(104,"span",16),e.EFF(105,"Enable Bulk Header Actions"),e.k0s(),e.j41(106,"label",17),e.nrm(107,"input",30)(108,"div",19),e.k0s()(),e.j41(109,"div",15)(110,"span",16),e.EFF(111,"Enable Saved Queries"),e.k0s(),e.j41(112,"label",17),e.nrm(113,"input",31)(114,"div",19),e.k0s()(),e.j41(115,"div",15)(116,"span",16),e.EFF(117,"Enable Summary Chips"),e.k0s(),e.j41(118,"label",17),e.nrm(119,"input",32)(120,"div",19),e.k0s()(),e.j41(121,"div",15)(122,"span",16),e.EFF(123,"Enable Column Freezing"),e.k0s(),e.j41(124,"label",17),e.nrm(125,"input",33)(126,"div",19),e.k0s()()()()),2&n){let t,i;const o=e.XpG();e.Y8G("formGroup",o.form),e.R7$(15),e.Dyx(o.dataStrategies),e.R7$(6),e.Dyx(o.pagingModes),e.R7$(2),e.vxM("infinite"===(null==(t=o.form.get("pagingMode"))?null:t.value)?23:-1),e.R7$(8),e.Dyx(o.paginatorPositions),e.R7$(6),e.Dyx(o.toolbarButtonModes),e.R7$(31),e.SpI("Cards Per Row (large screens): ",null==(i=o.form.get("cardsPerRow"))?null:i.value)}}let xu=(()=>{class n{config=f.hFB.required();configChange=(0,f.CGW)();fb=(0,s.WQX)(se.ok);form;destroy$=new Di.B;dataStrategies=["SYNC","ONLINE_FIRST","OFFLINE_FIRST","HYBRID"];pagingModes=["paginator","infinite"];infiniteScrollBehaviors=["append","replace"];paginatorPositions=["top","bottom","both"];toolbarButtonModes=["iconAndText","iconOnly"];constructor(){this.form=this.fb.group({title:[""],dataStrategy:[""],pagingMode:[""],infiniteScrollBehavior:[""],paginatorPosition:[""],stripedRows:[!1],showGridlines:[!1],rowHover:[!1],enableColumnChooser:[!1],enableExport:[!1],enableMultiSelect:[!1],enableConfigButton:[!1],cardsPerRow:[4],enableFooter:[!1],enableRowMenu:[!1],enableHeaderActions:[!1],enableSavedQueries:[!1],enableChipFilters:[!1],enableFreeze:[!1],toolbarButtonMode:["iconAndText"]}),(0,s.QZP)(()=>{const t=this.config();t&&this.form.patchValue({title:t.config.title,dataStrategy:t.config.dataStrategy,pagingMode:t.config.pagingMode,infiniteScrollBehavior:t.config.infiniteScrollBehavior,paginatorPosition:t.config.paginatorPosition??"bottom",stripedRows:t.config.stripedRows??!0,showGridlines:t.config.showGridlines??!1,rowHover:t.config.rowHover??!0,enableColumnChooser:t.config.enableColumnChooser,enableExport:t.config.exportConfig?.enabled??!1,enableMultiSelect:t.config.enableMultiSelect??!1,enableConfigButton:t.config.enableConfigButton,cardsPerRow:t.config.cardViewConfig?.cardsPerRow??4,enableFooter:t.config.footerConfig?.enabled??!1,enableRowMenu:t.config.enableRowMenu,enableHeaderActions:t.config.enableHeaderActions,enableSavedQueries:t.config.enableSavedQueries,enableChipFilters:t.config.enableChipFilters??!1,enableFreeze:t.config.enableFreeze??!1,toolbarButtonMode:t.config.toolbarButtonMode??"iconAndText"},{emitEvent:!1})}),this.form.valueChanges.pipe((0,Ri.B)(200),(0,Vi.F)(this.isEqual),(0,gu.Q)(this.destroy$)).subscribe(t=>{const i=this.config();if(i){const o=JSON.parse(JSON.stringify(i));o.config.title=t.title,o.config.dataStrategy=t.dataStrategy,o.config.pagingMode=t.pagingMode,o.config.infiniteScrollBehavior=t.infiniteScrollBehavior,o.config.paginatorPosition=t.paginatorPosition,o.config.stripedRows=t.stripedRows,o.config.showGridlines=t.showGridlines,o.config.rowHover=t.rowHover,o.config.enableColumnChooser=t.enableColumnChooser,o.config.exportConfig?o.config.exportConfig.enabled=t.enableExport:o.config.exportConfig={enabled:t.enableExport,options:[{label:"CSV",key:"csv",icon:"pi pi-file"},{label:"Excel",key:"excel",icon:"pi pi-file-excel"},{label:"PDF",key:"pdf",icon:"pi pi-file-pdf"}]},o.config.enableMultiSelect=t.enableMultiSelect,o.config.enableConfigButton=t.enableConfigButton,o.config.cardViewConfig||(o.config.cardViewConfig={cardsPerRow:4}),o.config.cardViewConfig.cardsPerRow=Number(t.cardsPerRow),o.config.footerConfig?o.config.footerConfig.enabled=t.enableFooter:o.config.footerConfig={enabled:t.enableFooter,columns:[{code:"contact_person_composite",aggregation:"count",display:"Total: {value}"},{code:"annual_revenue",aggregation:"sum",display:"Sum: {value}"}]},o.config.enableRowMenu=t.enableRowMenu,o.config.enableHeaderActions=t.enableHeaderActions,o.config.enableSavedQueries=t.enableSavedQueries,o.config.enableChipFilters=t.enableChipFilters,o.config.enableFreeze=t.enableFreeze,o.config.toolbarButtonMode=t.toolbarButtonMode,this.configChange.emit(o)}})}isEqual(t,i){return JSON.stringify(t)===JSON.stringify(i)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-config-form"]],inputs:{config:[1,"config"]},outputs:{configChange:"configChange"},decls:1,vars:1,consts:[[1,"space-y-6",3,"formGroup"],[1,"space-y-4","p-4","border","border-gray-200","dark:border-gray-700","rounded-lg"],[1,"text-base","font-semibold","leading-6","text-gray-900","dark:text-white"],["for","title",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["type","text","id","title","formControlName","title",1,"mt-1","block","w-full","text-sm","rounded-md","border-gray-300","shadow-sm","focus:border-indigo-500","focus:ring-indigo-500","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400"],["for","dataStrategy",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","dataStrategy","formControlName","dataStrategy",1,"mt-1","block","w-full","text-sm","rounded-md","border-gray-300","shadow-sm","focus:border-indigo-500","focus:ring-indigo-500","dark:bg-gray-700","dark:border-gray-600"],[3,"value"],["for","pagingMode",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","pagingMode","formControlName","pagingMode",1,"mt-1","block","w-full","text-sm","rounded-md","border-gray-300","shadow-sm","focus:border-indigo-500","focus:ring-indigo-500","dark:bg-gray-700","dark:border-gray-600"],["for","paginatorPosition",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","paginatorPosition","formControlName","paginatorPosition",1,"mt-1","block","w-full","text-sm","rounded-md","border-gray-300","shadow-sm","focus:border-indigo-500","focus:ring-indigo-500","dark:bg-gray-700","dark:border-gray-600"],[1,"capitalize",3,"value"],["for","toolbarButtonMode",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","toolbarButtonMode","formControlName","toolbarButtonMode",1,"mt-1","block","w-full","text-sm","rounded-md","border-gray-300","shadow-sm","focus:border-indigo-500","focus:ring-indigo-500","dark:bg-gray-700","dark:border-gray-600"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-gray-700","dark:text-gray-300"],[1,"relative","inline-flex","items-center","cursor-pointer"],["type","checkbox","formControlName","stripedRows",1,"sr-only","peer"],[1,"w-11","h-6","bg-gray-200","peer-focus:outline-none","peer-focus:ring-4","peer-focus:ring-indigo-300","dark:peer-focus:ring-indigo-800","rounded-full","peer","dark:bg-gray-700","peer-checked:after:translate-x-full","peer-checked:after:border-white","after:content-['']","after:absolute","after:top-[2px]","after:left-[2px]","after:bg-white","after:border-gray-300","after:border","after:rounded-full","after:h-5","after:w-5","after:transition-all","dark:border-gray-600","peer-checked:bg-indigo-600"],["type","checkbox","formControlName","showGridlines",1,"sr-only","peer"],["type","checkbox","formControlName","rowHover",1,"sr-only","peer"],["type","checkbox","formControlName","enableFooter",1,"sr-only","peer"],["for","cardsPerRow",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["type","range","id","cardsPerRow","formControlName","cardsPerRow","min","1","max","6",1,"mt-1","block","w-full","h-2","bg-gray-200","rounded-lg","appearance-none","cursor-pointer","dark:bg-gray-700"],["type","checkbox","formControlName","enableColumnChooser",1,"sr-only","peer"],["type","checkbox","formControlName","enableExport",1,"sr-only","peer"],["type","checkbox","formControlName","enableMultiSelect",1,"sr-only","peer"],["type","checkbox","formControlName","enableConfigButton",1,"sr-only","peer"],["type","checkbox","formControlName","enableRowMenu",1,"sr-only","peer"],["type","checkbox","formControlName","enableHeaderActions",1,"sr-only","peer"],["type","checkbox","formControlName","enableSavedQueries",1,"sr-only","peer"],["type","checkbox","formControlName","enableChipFilters",1,"sr-only","peer"],["type","checkbox","formControlName","enableFreeze",1,"sr-only","peer"],["for","infiniteScrollBehavior",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","infiniteScrollBehavior","formControlName","infiniteScrollBehavior",1,"mt-1","block","w-full","text-sm","rounded-md","border-gray-300","shadow-sm","focus:border-indigo-500","focus:ring-indigo-500","dark:bg-gray-700","dark:border-gray-600"]],template:function(i,o){1&i&&e.nVh(0,Cu,127,3,"form",0),2&i&&e.vxM(o.form?0:-1)},dependencies:[P.MD,se.X1,se.qT,se.xH,se.y7,se.me,se.MR,se.Zm,se.wz,se.BC,se.cb,se.j4,se.JD],encapsulation:2,changeDetection:0})}return n})();function wu(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",16),e.bIt("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.copyToClipboard())}),e.nrm(1,"i",17),e.EFF(2),e.k0s()}if(2&n){const t=e.XpG();e.R7$(),e.AVh("pi-copy",!t.copySuccess())("pi-check",t.copySuccess()),e.R7$(),e.SpI(" ",t.copySuccess()?"Copied!":"Copy JSON"," ")}}function ku(n,r){if(1&n&&(e.j41(0,"div",19)(1,"p",20),e.EFF(2,"Error parsing JSON"),e.k0s(),e.j41(3,"pre",21),e.EFF(4),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(4),e.JRh(t.parseError())}}function Su(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",11)(1,"div",18),e.bIt("valueChange",function(o){s.eBV(t);const a=e.XpG();return s.Njj(a.onJsonConfigChange(o))}),e.k0s(),e.nVh(2,ku,5,1,"div",19),e.k0s()}if(2&n){const t=e.XpG();e.R7$(),e.Y8G("value",t.configString()),e.R7$(),e.vxM(t.parseError()?2:-1)}}function Fu(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",12)(1,"app-config-form",22),e.bIt("configChange",function(o){s.eBV(t);const a=e.XpG();return s.Njj(a.onFormConfigChange(o))}),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(),e.Y8G("config",t.currentConfig())}}let Tu=(()=>{class n{isOpen=f.hFB.required();config=f.hFB.required();close=(0,f.CGW)();save=(0,f.CGW)();resetToDefaults=(0,f.CGW)();viewMode=(0,s.vPA)("ui");currentConfig=(0,s.vPA)(null);configString=(0,N.EW)(()=>{const t=this.currentConfig();return t?JSON.stringify(t,null,2):""});parseError=(0,s.vPA)(null);copySuccess=(0,s.vPA)(!1);initialConfig=null;constructor(){(0,s.QZP)(()=>{if(this.isOpen()){const t=this.config();this.initialConfig=t,this.currentConfig.set(JSON.parse(JSON.stringify(t))),this.parseError.set(null),this.viewMode.set("ui")}})}onJsonConfigChange(t){try{const i=JSON.parse(t);this.currentConfig.set(i),this.parseError.set(null)}catch(i){this.parseError.set(`Invalid JSON: ${i.message}`)}}onFormConfigChange(t){this.currentConfig.set(t),this.parseError.set(null)}handleSave(){if(this.parseError())return;const t=this.currentConfig();t&&this.save.emit(t)}handleRevertChanges(){this.initialConfig&&(this.currentConfig.set(JSON.parse(JSON.stringify(this.initialConfig))),this.parseError.set(null))}handleRestoreDefaults(){confirm("Are you sure you want to restore factory defaults? This will overwrite your current configuration.")&&(this.resetToDefaults.emit(),this.close.emit())}copyToClipboard(){const t=this.configString();navigator.clipboard.writeText(t).then(()=>{this.copySuccess.set(!0),setTimeout(()=>this.copySuccess.set(!1),2e3)})}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-config-sidebar"]],inputs:{isOpen:[1,"isOpen"],config:[1,"config"]},outputs:{close:"close",save:"save",resetToDefaults:"resetToDefaults"},decls:25,vars:31,consts:[[1,"fixed","top-0","right-0","h-full","w-[50vw]","bg-white","shadow-2xl","z-40","transform","transition-transform","duration-300","ease-in-out","flex","flex-col"],[1,"flex","items-center","justify-between","p-4","border-b","border-gray-200","flex-shrink-0"],[1,"text-lg","font-semibold","text-gray-800"],[1,"flex","items-center","gap-2"],[1,"text-xs","text-red-600","hover:text-red-800","underline","mr-2",3,"click"],["title","Close Configuration",1,"text-gray-500","hover:text-gray-700",3,"click"],[1,"pi","pi-times","text-xl"],[1,"px-4","border-b","border-gray-200","flex-shrink-0","flex","justify-between","items-center"],[1,"-mb-px","flex","space-x-6"],[1,"whitespace-nowrap","py-3","px-1","border-b-2","font-medium","text-sm","transition-colors",3,"click"],[1,"text-xs","flex","items-center","gap-1","text-indigo-600","hover:text-indigo-800","transition-colors"],[1,"flex-grow","p-4","flex","flex-col","min-h-0"],[1,"flex-grow","p-4","overflow-y-auto","custom-scrollbar"],[1,"flex","items-center","justify-end","p-4","border-t","border-gray-200","flex-shrink-0","space-x-3"],[1,"px-4","py-2","text-sm","font-medium","text-gray-700","bg-white","border","border-gray-300","rounded-md","hover:bg-gray-50",3,"click"],[1,"px-4","py-2","text-sm","font-medium","text-white","bg-slate-900","border","border-transparent","rounded-md","hover:bg-slate-800","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-slate-500","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"text-xs","flex","items-center","gap-1","text-indigo-600","hover:text-indigo-800","transition-colors",3,"click"],[1,"pi"],["appJsonEditor","",1,"w-full","flex-grow","font-mono","text-sm","border","border-gray-600","rounded-md","overflow-hidden","config-editor-wrapper","flex","flex-col",3,"valueChange","value"],[1,"mt-2","p-3","bg-red-100","dark:bg-red-900/50","border","border-red-400","dark:border-red-600","text-red-700","dark:text-red-300","rounded-md","text-sm","flex-shrink-0"],[1,"font-bold"],[1,"whitespace-pre-wrap","mt-1"],[3,"configChange","config"]],template:function(i,o){1&i&&(e.j41(0,"aside",0)(1,"header",1)(2,"h2",2),e.EFF(3,"Table Configuration"),e.k0s(),e.j41(4,"div",3)(5,"button",4),e.bIt("click",function(){return o.handleRestoreDefaults()}),e.EFF(6," Restore Factory Defaults "),e.k0s(),e.j41(7,"button",5),e.bIt("click",function(){return o.close.emit()}),e.nrm(8,"i",6),e.k0s()()(),e.j41(9,"div",7)(10,"nav",8)(11,"button",9),e.bIt("click",function(){return o.viewMode.set("ui")}),e.EFF(12," UI Editor "),e.k0s(),e.j41(13,"button",9),e.bIt("click",function(){return o.viewMode.set("json")}),e.EFF(14," JSON Editor "),e.k0s()(),e.nVh(15,wu,3,5,"button",10),e.k0s(),e.nVh(16,Su,3,2,"div",11)(17,Fu,2,1,"div",12),e.j41(18,"footer",13)(19,"button",14),e.bIt("click",function(){return o.handleRevertChanges()}),e.EFF(20," Reset Changes "),e.k0s(),e.j41(21,"button",14),e.bIt("click",function(){return o.close.emit()}),e.EFF(22," Cancel "),e.k0s(),e.j41(23,"button",15),e.bIt("click",function(){return o.handleSave()}),e.EFF(24," Save and Apply "),e.k0s()()()),2&i&&(e.AVh("translate-x-0",o.isOpen())("translate-x-full",!o.isOpen()),e.R7$(11),e.AVh("border-indigo-500","ui"===o.viewMode())("text-indigo-600","ui"===o.viewMode())("border-transparent","ui"!==o.viewMode())("text-gray-500","ui"!==o.viewMode())("hover:text-gray-700","ui"!==o.viewMode())("hover:border-gray-300","ui"!==o.viewMode()),e.R7$(2),e.AVh("border-indigo-500","json"===o.viewMode())("text-indigo-600","json"===o.viewMode())("border-transparent","json"!==o.viewMode())("text-gray-500","json"!==o.viewMode())("hover:text-gray-700","json"!==o.viewMode())("hover:border-gray-300","json"!==o.viewMode()),e.R7$(2),e.vxM("json"===o.viewMode()?15:-1),e.R7$(),e.vxM("json"===o.viewMode()?16:17),e.R7$(7),e.Y8G("disabled",!!o.parseError()))},dependencies:[P.MD,mu,xu],styles:[".config-editor-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px;height:6px}.config-editor-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.config-editor-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#4b5563;border-radius:3px}.config-editor-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#6b7280}.config-editor-wrapper[_ngcontent-%COMP%]   .CodeMirror[_ngcontent-%COMP%]{flex-grow:1;font-size:14px;height:auto}"],changeDetection:0})}return n})();function Mu(n){switch(n){case"=":return"EXACT";case"!=":return"NOT_EQUAL";case">":return"GREATER_THAN";case">=":return"GREATER_THAN_OR_EQUAL";case"<":return"LESS_THAN";case"<=":return"LESS_THAN_OR_EQUAL";case"between":return"BETWEEN";case"not between":return"NOT_BETWEEN";default:return"CONTAINS"}}function wt(n,r,t,i,o,a,l){const c=[];o&&c.push({parameter_name:"GLOBAL_SEARCH",parameter_code:"GS",parameter_value:o,conditional_operator:"AND",wildcard_operator:"CONTAINS"});for(const u in a){const p=a[u];p&&void 0!==p.value1&&""!==p.value1&&c.push({parameter_name:p.name,parameter_code:p.code,parameter_value:`${p.value1}${p.value2?","+p.value2:""}`,conditional_operator:"AND",wildcard_operator:Mu(p.operator)})}const d=[];return t&&d.push({coloum_id:t,short_type:i}),{page_number:n,page_size:r,search_filters:c,sort_column:d}}const Ai=(n,r)=>r.code;function ju(n,r){1&n&&(e.rj2(0,"th",3),e.Hgh(1,"div",4),e.eux())}function Ru(n,r){1&n&&e.Hgh(0,"div",6)}function Vu(n,r){1&n&&e.Hgh(0,"div",7)}function Du(n,r){1&n&&(e.rj2(0,"div",8),e.Hgh(1,"div",10)(2,"div",11),e.eux())}function Au(n,r){1&n&&e.Hgh(0,"div",9)}function Nu(n,r){if(1&n&&(e.rj2(0,"td",5),e.nVh(1,Ru,1,0,"div",6)(2,Vu,1,0,"div",7)(3,Du,3,0,"div",8)(4,Au,1,0,"div",9),e.eux()),2&n){const t=r.$implicit;e.R7$(),e.vxM("IMAGE"===t.columnType?1:"CHECKBOX"===t.columnType?2:t.cellTemplate&&t.cellTemplate.length>0?3:4)}}function Eu(n,r){if(1&n&&(e.rj2(0,"tr"),e.Z7z(1,Nu,5,1,"td",5,Ai),e.eux()),2&n){const t=e.XpG();e.R7$(),e.Dyx(t.columns())}}let $u=(()=>{class n{columns=f.hFB.required();rows=(0,f.hFB)(10);skeletonRows=(0,N.EW)(()=>Array(this.rows()).fill(0));static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-table-skeleton-loader"]],inputs:{columns:[1,"columns"],rows:[1,"rows"]},decls:9,vars:0,consts:[[1,"overflow-x-auto","border","border-gray-200","dark:border-gray-700","rounded-lg"],[1,"min-w-full","border-collapse"],[1,"bg-gray-50","dark:bg-gray-800/20"],["scope","col",1,"px-6","py-3","border-b","border-gray-200","dark:border-gray-700","text-left"],[1,"h-4","bg-gray-300","dark:bg-gray-600","rounded","w-3/4","animate-pulse"],[1,"px-6","py-4","whitespace-nowrap","border-t","border-gray-200","dark:border-gray-700"],[1,"h-10","w-10","bg-gray-300","dark:bg-gray-600","rounded-full","animate-pulse"],[1,"h-4","w-4","bg-gray-300","dark:bg-gray-600","rounded","animate-pulse"],[1,"space-y-2"],[1,"h-4","bg-gray-300","dark:bg-gray-600","rounded","w-full","animate-pulse"],[1,"h-4","bg-gray-300","dark:bg-gray-600","rounded","w-5/6","animate-pulse"],[1,"h-3","bg-gray-300","dark:bg-gray-600","rounded","w-3/4","animate-pulse"]],template:function(i,o){1&i&&(e.rj2(0,"div",0)(1,"table",1)(2,"thead",2)(3,"tr"),e.Z7z(4,ju,2,0,"th",3,Ai),e.eux()(),e.rj2(6,"tbody"),e.Z7z(7,Eu,3,0,"tr",null,e.Vm6),e.eux()()()),2&i&&(e.R7$(4),e.Dyx(o.columns()),e.R7$(3),e.Dyx(o.skeletonRows()))},dependencies:[P.MD],encapsulation:2,changeDetection:0})}return n})();function Gu(n,r){1&n&&(e.rj2(0,"div",1)(1,"div",2)(2,"div",3),e.Hgh(3,"div",4),e.rj2(4,"div",5),e.Hgh(5,"div",6)(6,"div",7),e.eux()(),e.rj2(7,"div",8),e.Hgh(8,"div",9)(9,"div",10),e.eux()()())}let Iu=(()=>{class n{count=(0,f.hFB)(8);skeletonItems=(0,N.EW)(()=>Array(this.count()).fill(0).map((t,i)=>i));static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-card-skeleton-loader"]],inputs:{count:[1,"count"]},decls:3,vars:0,consts:[[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","gap-6","animate-pulse"],[1,"border","border-gray-200","dark:border-gray-700","rounded-lg","overflow-hidden"],[1,"p-5"],[1,"flex","items-center","gap-4"],[1,"h-12","w-12","bg-gray-300","dark:bg-gray-600","rounded-full"],[1,"flex-1","space-y-2"],[1,"h-4","bg-gray-300","dark:bg-gray-600","rounded","w-3/4"],[1,"h-3","bg-gray-300","dark:bg-gray-600","rounded","w-1/2"],[1,"space-y-4","mt-6"],[1,"h-3","bg-gray-300","dark:bg-gray-600","rounded","w-full"],[1,"h-3","bg-gray-300","dark:bg-gray-600","rounded","w-5/6"]],template:function(i,o){1&i&&(e.rj2(0,"div",0),e.Z7z(1,Gu,10,0,"div",1,e.fX1),e.eux()),2&i&&(e.R7$(),e.Dyx(o.skeletonItems()))},dependencies:[P.MD],encapsulation:2,changeDetection:0})}return n})();function Xu(n,r){1&n&&(e.rj2(0,"li",2)(1,"div",3),e.Hgh(2,"div",4),e.rj2(3,"div",5),e.Hgh(4,"div",6)(5,"div",7),e.eux(),e.Hgh(6,"div",8),e.eux()())}let Bu=(()=>{class n{count=(0,f.hFB)(10);skeletonItems=(0,N.EW)(()=>Array(this.count()).fill(0).map((t,i)=>i));static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-list-skeleton-loader"]],inputs:{count:[1,"count"]},decls:4,vars:0,consts:[[1,"border","border-gray-200","dark:border-gray-700","rounded-lg"],[1,"divide-y","divide-gray-200","dark:divide-gray-700"],[1,"p-4","animate-pulse"],[1,"flex","items-center"],[1,"h-10","w-10","bg-gray-300","dark:bg-gray-600","rounded-full","mr-4","flex-shrink-0"],[1,"flex-1","min-w-0","space-y-2"],[1,"h-4","bg-gray-300","dark:bg-gray-600","rounded","w-2/5"],[1,"h-3","bg-gray-300","dark:bg-gray-600","rounded","w-3/5"],[1,"ml-4","h-4","bg-gray-300","dark:bg-gray-600","rounded","w-1/6"]],template:function(i,o){1&i&&(e.rj2(0,"div",0)(1,"ul",1),e.Z7z(2,Xu,7,0,"li",2,e.fX1),e.eux()()),2&i&&(e.R7$(2),e.Dyx(o.skeletonItems()))},dependencies:[P.MD],encapsulation:2,changeDetection:0})}return n})();function Ni(n,r,t=0){if(!n||r<=0)return 10;const o=Math.floor((n.clientHeight-t)/r);return Math.max(1,o)}var en=W(8141),tn=W(9437),me=W(7673),zu=W(1655);function Y(n,r){return new Date(n.getTime()+Math.random()*(r.getTime()-n.getTime())).toISOString()}function Q(n,r){return new Date(n.getTime()+Math.random()*(r.getTime()-n.getTime())).toISOString()}let Ei=(()=>{class n{configService=(0,s.WQX)(he);mockData=[{organization_id:1,organization_name:"Innovate Inc.",contact_person:"Alice Johnson",communication_detail:"5550101123",email_id:"alice.j@innovate.com",avatar_url:"https://picsum.photos/seed/1/40/40",annual_revenue:5e6,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Web"},{organization_id:2,organization_name:"Solutions Corp.",contact_person:"Bob Smith",communication_detail:"5550102456",email_id:"bob.s@solutions.com",avatar_url:"https://picsum.photos/seed/2/40/40",annual_revenue:72e5,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Organic"},{organization_id:3,organization_name:"Quantum Systems",contact_person:"Charlie Brown",communication_detail:"5550103789",email_id:"charlie.b@quantum.com",avatar_url:"https://picsum.photos/seed/3/40/40",annual_revenue:12e6,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Referral"},{organization_id:4,organization_name:"Apex Enterprises",contact_person:"Diana Prince",communication_detail:"5550104101",email_id:"diana.p@apex.com",avatar_url:"https://picsum.photos/seed/4/40/40",annual_revenue:35e5,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Web"},{organization_id:5,organization_name:"Stellar Tech",contact_person:"Ethan Hunt",communication_detail:"5550105112",email_id:"ethan.h@stellar.com",avatar_url:"https://picsum.photos/seed/5/40/40",annual_revenue:98e5,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Web"},{organization_id:6,organization_name:"Fusion Dynamics",contact_person:"Fiona Glenanne",communication_detail:"5550106131",email_id:"fiona.g@fusion.com",avatar_url:"https://picsum.photos/seed/6/40/40",annual_revenue:21e5,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Organic"},{organization_id:7,organization_name:"Synergy Group",contact_person:"George Costanza",communication_detail:"5550107141",email_id:"george.c@synergy.com",avatar_url:"https://picsum.photos/seed/7/40/40",annual_revenue:83e5,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Referral"},{organization_id:8,organization_name:"Pioneer Labs",contact_person:"Hannah Abbott",communication_detail:"5550108151",email_id:"hannah.a@pioneer.com",avatar_url:"https://picsum.photos/seed/8/40/40",annual_revenue:45e5,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Web"},{organization_id:9,organization_name:"Vertex Innovations",contact_person:"Ian Malcolm",communication_detail:"5550109161",email_id:"ian.m@vertex.com",avatar_url:"https://picsum.photos/seed/9/40/40",annual_revenue:61e5,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Organic"},{organization_id:10,organization_name:"Horizon Solutions",contact_person:"Jane Doe",communication_detail:"5550110171",email_id:"jane.d@horizon.com",avatar_url:"https://picsum.photos/seed/10/40/40",annual_revenue:15e6,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Referral"},{organization_id:11,organization_name:"Global Connect",contact_person:"Kara Danvers",communication_detail:"5550111181",email_id:"kara.d@global.com",avatar_url:"https://picsum.photos/seed/11/40/40",annual_revenue:112e5,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Web"},{organization_id:12,organization_name:"Nexus Platforms",contact_person:"Leo Fitz",communication_detail:"5550112191",email_id:"leo.f@nexus.com",avatar_url:"https://picsum.photos/seed/12/40/40",annual_revenue:78e5,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Organic"},{organization_id:13,organization_name:"Momentum Works",contact_person:"Monica Geller",communication_detail:"5550113202",email_id:"monica.g@momentum.com",avatar_url:"https://picsum.photos/seed/13/40/40",annual_revenue:49e5,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Referral"},{organization_id:14,organization_name:"Omega Industries",contact_person:"Ned Stark",communication_detail:"5550114212",email_id:"ned.s@omega.com",avatar_url:"https://picsum.photos/seed/14/40/40",annual_revenue:25e6,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Web"},{organization_id:15,organization_name:"Zenith Tech",contact_person:"Oscar Martinez",communication_detail:"5550115222",email_id:"oscar.m@zenith.com",avatar_url:"https://picsum.photos/seed/15/40/40",annual_revenue:33e5,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Organic"},{organization_id:16,organization_name:"Apex Solutions",contact_person:"Pam Beesly",communication_detail:"5550116232",email_id:"pam.b@apex.com",avatar_url:"https://picsum.photos/seed/16/40/40",annual_revenue:56e5,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Referral"},{organization_id:17,organization_name:"Quantum Dynamics",contact_person:"Quinn Fabray",communication_detail:"5550117242",email_id:"quinn.f@quantum.com",avatar_url:"https://picsum.photos/seed/17/40/40",annual_revenue:135e5,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Web"},{organization_id:18,organization_name:"Stellar Innovations",contact_person:"Rachel Green",communication_detail:"5550118252",email_id:"rachel.g@stellar.com",avatar_url:"https://picsum.photos/seed/18/40/40",annual_revenue:88e5,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Organic"},{organization_id:19,organization_name:"Fusion Solutions",contact_person:"Sam Winchester",communication_detail:"5550119262",email_id:"sam.w@fusion.com",avatar_url:"https://picsum.photos/seed/19/40/40",annual_revenue:18e5,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Referral"},{organization_id:20,organization_name:"Synergy Systems",contact_person:"Ted Mosby",communication_detail:"5550120272",email_id:"ted.m@synergy.com",avatar_url:"https://picsum.photos/seed/20/40/40",annual_revenue:67e5,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Web"},{organization_id:21,organization_name:"Pioneer Enterprises",contact_person:"Uma Thurman",communication_detail:"5550121282",email_id:"uma.t@pioneer.com",avatar_url:"https://picsum.photos/seed/21/40/40",annual_revenue:41e5,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Organic"},{organization_id:22,organization_name:"Vertex Corp.",contact_person:"Victor Vance",communication_detail:"5550122292",email_id:"victor.v@vertex.com",avatar_url:"https://picsum.photos/seed/22/40/40",annual_revenue:73e5,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Referral"},{organization_id:23,organization_name:"Horizon Labs",contact_person:"Walter White",communication_detail:"5550123303",email_id:"walter.w@horizon.com",avatar_url:"https://picsum.photos/seed/23/40/40",annual_revenue:17e6,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:"Web"},...Array.from({length:5e3},(t,i)=>({organization_id:24+i,organization_name:`Test Corp ${i+1}`,contact_person:`Person ${i+1}`,communication_detail:`55502${(i+1).toString().padStart(5,"0")}`,email_id:`person.${i+1}@test.com`,avatar_url:`https://picsum.photos/seed/${24+i}/40/40`,annual_revenue:Math.floor(1e7*Math.random())+1e5,created_time:Y(new Date(2023,10,1),new Date),last_activity_date:Q(new Date(2024,0,1),new Date),lead_source:["Web","Organic","Referral"][i%3]}))];getData(t){let i=[...this.mockData];const o=this.configService.config().config.globalFilterFields;if(t.search_filters.length>0&&(i=i.filter(p=>t.search_filters.every(g=>{if(!g.parameter_code||!g.parameter_value)return!0;const m=g.parameter_value.toLowerCase();if("GS"===g.parameter_code){const V=this.configService.config().columns.filter(j=>"DATE"===j.columnType).map(j=>j.code),y=m.split(" to ");let h=!1,x=null,C=null;if(2===y.length){const j=new Date(y[0].trim()),k=new Date(y[1].trim());!isNaN(j.getTime())&&!isNaN(k.getTime())&&(h=!0,x=j,C=k,C.setHours(23,59,59,999))}return o&&o.length>0?o.some(j=>{const k=p[j];if(!k)return!1;if(V.includes(j)){const E=new Date(k);return!isNaN(E.getTime())&&(h?E>=x&&E<=C:String(k).toLowerCase().includes(m))}return String(k).toLowerCase().includes(m)}):String(p.organization_name||"").toLowerCase().includes(m)||String(p.contact_person||"").toLowerCase().includes(m)||String(p.communication_detail||"").toLowerCase().includes(m)||String(p.email_id||"").toLowerCase().includes(m)||String(p.created_time||"").toLowerCase().includes(m)}if("DATE"===this.configService.config().columns.find(V=>V.code===g.parameter_code)?.columnType){const V=p[g.parameter_code];if(!V)return!1;const y=new Date(V);if(isNaN(y.getTime()))return!1;if(y.setUTCHours(0,0,0,0),"BETWEEN"===g.wildcard_operator){if(!g.parameter_value.includes(","))return!1;const[h,x]=g.parameter_value.split(","),C=new Date(h+"T00:00:00Z"),j=new Date(x+"T00:00:00Z");return!isNaN(C.getTime())&&!isNaN(j.getTime())&&(j.setUTCHours(23,59,59,999),y>=C&&y<=j)}if("EXACT"===g.wildcard_operator){const h=new Date(g.parameter_value+"T00:00:00Z");return!isNaN(h.getTime())&&y.getTime()===h.getTime()}return!1}const S=String(p[g.parameter_code]||"").toLowerCase();return m.includes(",")?m.split(",").includes(S):S.includes(m)}))),t.sort_column.length>0){const p=t.sort_column[0];i.sort((g,m)=>{const b=g[p.coloum_id],S=m[p.coloum_id];return b<S?"asc"===p.short_type?-1:1:b>S?"asc"===p.short_type?1:-1:0})}const a=i.length,l=Number(t.page_number),c=Number(t.page_size),d=(l-1)*c,u=i.slice(d,d+c);return(0,me.of)({data:u,total_records:a}).pipe((0,zu.c)(500))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var $i=W(6648),Ou=W(6354),Pu=W(4096);let Lu=(()=>{class n extends Pu.Ay{contacts;constructor(){super(`${(0,s.WQX)(he).config().feature}_DB`),this.version(2).stores({contacts:"++organization_id, organization_name, contact_person, communication_detail, email_id, annual_revenue, created_time, lead_source"})}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var nn=W(1471);let Hu=(()=>{class n{configService=(0,s.WQX)(he);config=this.configService.config().config;isEnabled(){return this.config.encryptionConfig?.enabled??!1}getSecretKey(){return this.config.encryptionConfig?.secretKey||"default-secret"}getEncryptedFields(){return this.config.encryptionConfig?.encryptedFields||[]}encryptRecord(t){if(!this.isEnabled())return t;const i={...t},o=this.getEncryptedFields(),a=this.getSecretKey();for(const l of o)i[l]&&(i[l]=nn.AES.encrypt(i[l],a).toString());return i}decryptRecord(t){if(!this.isEnabled())return t;const i={...t},o=this.getEncryptedFields(),a=this.getSecretKey();for(const l of o)if(i[l])try{const c=nn.AES.decrypt(i[l],a);i[l]=c.toString(nn.enc.Utf8)}catch(c){console.error(`Failed to decrypt field '${l}' for record ID ${t.organization_id}. It might not be encrypted.`,c)}return i}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Gi=(()=>{class n{db=(0,s.WQX)(Lu);encryptionService=(0,s.WQX)(Hu);configService=(0,s.WQX)(he);bulkUpsert(t){const i=t.map(o=>this.encryptionService.encryptRecord(o));return(0,$i.H)(this.db.contacts.bulkPut(i)).pipe((0,Ou.T)(()=>{}))}getData(t){const{page_number:i,page_size:o,sort_column:a,search_filters:l}=t,c=this.configService.config().config.globalFilterFields;let d;if(a.length>0&&a[0].coloum_id){const{coloum_id:V,short_type:y}=a[0];d=this.db.contacts.orderBy(V),"desc"===y&&(d=d.reverse())}else d=this.db.contacts.toCollection();l.length>0&&(d=d.filter(V=>{const y=this.encryptionService.decryptRecord(V);return l.every(h=>{if(!h.parameter_code||!h.parameter_value)return!0;const x=h.parameter_value.toLowerCase();if("GS"===h.parameter_code){const k=this.configService.config().columns.filter(G=>"DATE"===G.columnType).map(G=>G.code),E=x.split(" to ");let z=!1,O=null,H=null;if(2===E.length){const G=new Date(E[0].trim()),T=new Date(E[1].trim());!isNaN(G.getTime())&&!isNaN(T.getTime())&&(z=!0,O=G,H=T,H.setHours(23,59,59,999))}return c&&c.length>0?c.some(G=>{const T=y[G];if(!T)return!1;if(k.includes(G)){const L=new Date(T);return!isNaN(L.getTime())&&(z?L>=O&&L<=H:String(T).toLowerCase().includes(x))}return String(T).toLowerCase().includes(x)}):String(y.organization_name||"").toLowerCase().includes(x)||String(y.contact_person||"").toLowerCase().includes(x)||String(y.communication_detail||"").toLowerCase().includes(x)||String(y.email_id||"").toLowerCase().includes(x)||String(y.created_time||"").toLowerCase().includes(x)}if("DATE"===this.configService.config().columns.find(k=>k.code===h.parameter_code)?.columnType){const k=y[h.parameter_code];if(!k)return!1;const E=new Date(k);if(isNaN(E.getTime()))return!1;if(E.setUTCHours(0,0,0,0),"BETWEEN"===h.wildcard_operator){if(!h.parameter_value.includes(","))return!1;const[z,O]=h.parameter_value.split(","),H=new Date(z+"T00:00:00Z"),G=new Date(O+"T00:00:00Z");return!isNaN(H.getTime())&&!isNaN(G.getTime())&&(G.setUTCHours(23,59,59,999),E>=H&&E<=G)}if("EXACT"===h.wildcard_operator){const z=new Date(h.parameter_value+"T00:00:00Z");return!isNaN(z.getTime())&&E.getTime()===z.getTime()}return!1}const j=String(y[h.parameter_code]||"").toLowerCase();return x.includes(",")?x.split(",").includes(j):j.includes(x)})}));const u=d.count(),p=Number(i),g=Number(o),b=d.offset((p-1)*g).limit(g).toArray(),S=Promise.all([u,b]).then(([V,y])=>({data:y.map(x=>this.encryptionService.decryptRecord(x)),total_records:V}));return(0,$i.H)(S)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),on=(()=>{class n{status=(0,s.vPA)("Connecting");setOnline(){this.status.set("Online")}setConnecting(){this.status.set("Connecting")}setOffline(){this.status.set("Offline")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Uu=(()=>{class n{configService=(0,s.WQX)(he);onlineDataService=(0,s.WQX)(Ei);offlineDataService=(0,s.WQX)(Gi);connectionStatusService=(0,s.WQX)(on);getData(t){const i=this.configService.config().config.dataStrategy;switch(i){case"ONLINE_FIRST":return console.log("[DataManager] Using ONLINE_FIRST strategy."),this.connectionStatusService.setConnecting(),this.onlineDataService.getData(t).pipe((0,en.M)(()=>this.connectionStatusService.setOnline()),(0,tn.W)(o=>(console.warn("[DataManager] ONLINE_FIRST failed, falling back to offline.",o),this.connectionStatusService.setOffline(),this.offlineDataService.getData(t))));case"OFFLINE_FIRST":return console.log("[DataManager] Using OFFLINE_FIRST strategy."),this.offlineDataService.getData(t);case"HYBRID":return console.log("[DataManager] Using HYBRID strategy."),this.connectionStatusService.setConnecting(),this.onlineDataService.getData(t).pipe((0,en.M)(o=>{console.log("[DataManager] HYBRID: Fetched online, updating local DB in background."),this.connectionStatusService.setOnline(),this.offlineDataService.bulkUpsert(o.data).subscribe({next:()=>console.log("[DataManager] HYBRID: Local DB updated successfully."),error:a=>console.error("[DataManager] HYBRID: Error updating local DB.",a)})}),(0,tn.W)(o=>(console.warn("[DataManager] HYBRID: Online fetch failed, falling back to offline.",o),this.connectionStatusService.setOffline(),this.offlineDataService.getData(t))));case"SYNC":return console.log("[DataManager] Using SYNC strategy (reading from local DB)."),this.offlineDataService.getData(t);default:return console.warn(`[DataManager] Unknown data strategy: ${i}. Defaulting to ONLINE_FIRST.`),this.connectionStatusService.setConnecting(),this.onlineDataService.getData(t).pipe((0,en.M)(()=>this.connectionStatusService.setOnline()),(0,tn.W)(o=>(this.connectionStatusService.setOffline(),this.offlineDataService.getData(t))))}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Wu=(()=>{class n{constructor(){}logChange(t,i){console.log(`[SyncLogService] Logging action: ${t}`,i)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Yu=W(980);let Qu=(()=>{class n{onlineDataService=(0,s.WQX)(Ei);offlineDataService=(0,s.WQX)(Gi);syncLogService=(0,s.WQX)(Wu);connectionStatusService=(0,s.WQX)(on);persistenceService=(0,s.WQX)(Ee);LAST_SYNC_KEY="smartTableLastSync";isPrimed=(0,s.vPA)(!1);lastSyncTime=(0,s.vPA)(this.persistenceService.loadState(this.LAST_SYNC_KEY));isSyncing=(0,s.vPA)(!1);constructor(){this.lastSyncTime()&&(this.isPrimed.set(!0),console.log("[SyncService] Local data is primed from a previous session."))}startFullSync(){console.log("[SyncService] Starting full sync..."),this.primeDataFromServer()}primeDataFromServer(){this.isSyncing()?console.log("[SyncService] Sync already in progress."):(console.log("[SyncService] Starting to prime data from server..."),this.isSyncing.set(!0),this.isPrimed.set(!1),this.connectionStatusService.setConnecting(),this.onlineDataService.getData({page_number:1,page_size:5e3,search_filters:[],sort_column:[]}).pipe((0,Yu.j)(()=>{this.isSyncing.set(!1),console.log("[SyncService] Data priming finished.")})).subscribe({next:i=>{console.log(`[SyncService] Fetched ${i.data.length} records from server.`),this.offlineDataService.bulkUpsert(i.data).subscribe(()=>{console.log("[SyncService] Successfully saved records to local DB.");const o=Date.now();this.lastSyncTime.set(o),this.persistenceService.saveState(this.LAST_SYNC_KEY,o),this.isPrimed.set(!0)}),this.connectionStatusService.setOnline()},error:i=>{console.error("[SyncService] Error priming data from server:",i),this.connectionStatusService.setOffline()}}))}pushLocalChanges(){console.log("[SyncService] Pushing local changes to server...")}pullRemoteChanges(){console.log("[SyncService] Pulling remote changes from server...")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Ju=(()=>{class n{ai=(0,s.WQX)(Ae).ai;generateFilterFromQuery(t,i){var o=this;return(0,Z.A)(function*(){const a=i.map(u=>({name:u.name,code:u.code,type:u.columnType||"TEXT"})),l=`You are an AI assistant for a data table. Your task is to interpret the user's query and generate a JSON object with filtering instructions and a conversational response.\n    1. If the query is a command to filter or search the data, generate the appropriate filter objects.\n    2. If the query is a general question, set both 'globalSearch' and 'advancedFilters' to null and provide a helpful answer in 'aiResponse'.\n    \n    The JSON object must have these properties: 'globalSearch' (string | null), 'advancedFilters' (array of filter objects | null), and 'aiResponse' (string).\n    - Use 'globalSearch' for general, non-specific text searches (e.g., names, companies).\n    - Use 'advancedFilters' for specific, structured conditions.\n    - 'globalSearch' and 'advancedFilters' should be mutually exclusive. Set one to a value and the other to null.\n    \n    FILTERING RULES:\n    - Multiple Conditions: For queries with multiple conditions (e.g., "web leads with revenue over 1M"), provide an array of filter objects in 'advancedFilters'.\n    - Date Queries: Interpret relative dates (e.g., 'last month', 'yesterday') and return them in YYYY-MM-DD format. Use the 'between' operator for date ranges.\n    - Supported operators for numeric/text are: '=', '!=', '>', '<', '>=', '<=', 'contains', 'between'.\n\n    Available columns for filtering: ${JSON.stringify(a)}\n    \n    User Query: "${t}"\n\n    Example 1 (Global Search):\n    Query: "find contacts at Innovate Inc."\n    Response: { "globalSearch": "Innovate Inc.", "advancedFilters": null, "aiResponse": "Sure, I'm now showing contacts from Innovate Inc." }\n\n    Example 2 (Structured Filter):\n    Query: "show me who has more than 5M revenue"\n    Response: { "globalSearch": null, "advancedFilters": [{ "code": "annual_revenue", "name": "Annual Revenue", "type": "numeric", "operator": ">", "value1": "5000000" }], "aiResponse": "Okay, I've filtered for contacts with annual revenue greater than 5,000,000." }\n    \n    Example 3 (Multiple Conditions):\n    Query: "find web leads with revenue over 1 million"\n    Response: { "globalSearch": null, "advancedFilters": [{ "code": "lead_source", "name": "Lead Source", "type": "select", "operator": "=", "value1": "Web" }, { "code": "annual_revenue", "name": "Annual Revenue", "type": "numeric", "operator": ">", "value1": "1000000" }], "aiResponse": "Filtering for web leads with revenue over 1M." }\n\n    Example 4 (Date Range):\n    Query: "show contacts created last month"\n    Response: { "globalSearch": null, "advancedFilters": [{ "code": "created_time", "name": "Created", "type": "date", "operator": "between", "value1": "2024-07-01", "value2": "2024-07-31"}], "aiResponse": "Showing contacts created last month." }\n    \n    Example 5 (Question):\n    Query: "how many contacts are there?"\n    Response: { "globalSearch": null, "advancedFilters": null, "aiResponse": "I can't count the contacts, but I can help you filter them. For example, you can ask me to show contacts from a specific company." }\n    `,d=(yield o.ai.models.generateContent({model:"gemini-2.5-flash",contents:l,config:{responseMimeType:"application/json",responseSchema:{type:R.ZU.OBJECT,properties:{globalSearch:{type:R.ZU.STRING,nullable:!0},advancedFilters:{type:R.ZU.ARRAY,nullable:!0,items:{type:R.ZU.OBJECT,properties:{code:{type:R.ZU.STRING},name:{type:R.ZU.STRING},type:{type:R.ZU.STRING,enum:["numeric","text","date","select"]},operator:{type:R.ZU.STRING},value1:{type:R.ZU.STRING},value2:{type:R.ZU.STRING,nullable:!0}},required:["code","name","type","operator","value1"]}},aiResponse:{type:R.ZU.STRING}},required:["globalSearch","advancedFilters","aiResponse"]}}})).text.trim();return JSON.parse(d)})()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Zu=["chatInput"];function qu(n,r){if(1&n&&(e.rj2(0,"div",17),e.EFF(1),e.eux()),2&n){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.text," ")}}function Ku(n,r){if(1&n&&(e.rj2(0,"div",18)(1,"div",19)(2,"p",20),e.EFF(3),e.eux()()()),2&n){const t=e.XpG().$implicit;e.R7$(3),e.JRh(t.text)}}function ep(n,r){if(1&n&&(e.rj2(0,"div",11)(1,"div",21),e.Hgh(2,"p",22),e.eux()()),2&n){const t=e.XpG().$implicit;e.R7$(2),e.Avn("innerHTML",t.text.replace(/\n/g,"<br>"),e.npT)}}function tp(n,r){if(1&n&&e.nVh(0,qu,2,1,"div",17)(1,Ku,4,1,"div",18)(2,ep,3,1,"div",11),2&n){let t;e.vxM("system"===(t=r.$implicit.sender)?0:"user"===t?1:"ai"===t?2:-1)}}function np(n,r){1&n&&(e.rj2(0,"div",11)(1,"div",23)(2,"div",24),e.Hgh(3,"span",25)(4,"span",26)(5,"span",27),e.eux()()())}let ip=(()=>{class n{data=f.hFB.required();columns=f.hFB.required();close=(0,f.CGW)();filterApplied=(0,f.CGW)();aiChatbotService=(0,s.WQX)(Ju);messages=(0,s.vPA)([{sender:"system",text:"Ask me anything or tell me how to filter the data."}]);isLoading=(0,s.vPA)(!1);chatInput=(0,f.ebz)("chatInput");sendMessage(){var t=this;return(0,Z.A)(function*(){const i=t.chatInput()?.nativeElement;if(!i||!i.value.trim()||t.isLoading())return;const o=i.value.trim();i.value="",t.messages.update(a=>[...a,{sender:"user",text:o}]),t.isLoading.set(!0);try{const a=yield t.aiChatbotService.generateFilterFromQuery(o,t.columns());t.messages.update(l=>[...l,{sender:"ai",text:a.aiResponse}]),(a.globalSearch||a.advancedFilters&&a.advancedFilters.length>0)&&(t.filterApplied.emit({globalSearch:a.globalSearch,advancedFilters:a.advancedFilters}),setTimeout(()=>t.close.emit(),1e3))}catch(a){console.error("Error querying AI:",a);const l="Sorry, I encountered an error. Please try again.";t.messages.update(c=>[...c,{sender:"system",text:l}])}finally{t.isLoading.set(!1)}})()}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-ai-chatbot"]],viewQuery:function(i,o){1&i&&e.wEZ(o.chatInput,Zu,5),2&i&&e.NyB()},inputs:{data:[1,"data"],columns:[1,"columns"]},outputs:{close:"close",filterApplied:"filterApplied"},decls:20,vars:3,consts:[["chatInput",""],[1,"fixed","bottom-20","right-8","w-96","h-[60vh]","max-h-[700px]","bg-white","dark:bg-gray-800","rounded-lg","shadow-2xl","z-50","flex","flex-col","border","border-gray-200","dark:border-gray-700"],[1,"flex","items-center","justify-between","p-3","border-b","border-gray-200","dark:border-gray-700","flex-shrink-0"],[1,"flex","items-center","gap-3"],[1,"p-1.5","bg-indigo-100","dark:bg-indigo-900","rounded-full"],[1,"pi","pi-sparkles","text-indigo-600","dark:text-indigo-400"],[1,"text-md","font-semibold","text-gray-800","dark:text-white"],["title","Close Chat",1,"p-2","rounded-full","text-gray-500","hover:text-gray-700","dark:text-gray-400","dark:hover:text-white","hover:bg-gray-100","dark:hover:bg-gray-700",3,"click"],[1,"pi","pi-times"],[1,"flex-grow","p-4","overflow-y-auto"],[1,"space-y-4"],[1,"flex","justify-start"],[1,"p-3","border-t","border-gray-200","dark:border-gray-700","flex-shrink-0"],[1,"flex","items-center","gap-2"],["type","text","placeholder","Type your question...",1,"flex-1","w-full","px-3","py-2","text-sm","border","border-gray-300","dark:border-gray-600","rounded-md","bg-white","dark:bg-gray-900","focus:ring-indigo-500","focus:border-indigo-500","disabled:opacity-50",3,"keydown.enter","disabled"],[1,"px-4","py-2","text-sm","font-medium","text-white","bg-indigo-600","border","border-transparent","rounded-md","hover:bg-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"pi","pi-send"],[1,"text-center","text-xs","text-gray-500","dark:text-gray-400","italic"],[1,"flex","justify-end"],[1,"bg-indigo-600","text-white","rounded-lg","rounded-br-none","py-2","px-3","max-w-xs"],[1,"text-sm"],[1,"bg-gray-200","dark:bg-gray-700","text-gray-800","dark:text-gray-200","rounded-lg","rounded-bl-none","py-2","px-3","max-w-xs"],[1,"text-sm",3,"innerHTML"],[1,"bg-gray-200","dark:bg-gray-700","rounded-lg","rounded-bl-none","py-2","px-3"],[1,"flex","items-center","space-x-1"],[1,"h-2","w-2","bg-indigo-400","rounded-full","animate-pulse","[animation-delay:-0.3s]"],[1,"h-2","w-2","bg-indigo-400","rounded-full","animate-pulse","[animation-delay:-0.15s]"],[1,"h-2","w-2","bg-indigo-400","rounded-full","animate-pulse"]],template:function(i,o){if(1&i){const a=e.RV6();e.rj2(0,"div",1)(1,"header",2)(2,"div",3)(3,"div",4),e.Hgh(4,"i",5),e.eux(),e.rj2(5,"h2",6),e.EFF(6,"AI Assistant"),e.eux()(),e.rj2(7,"button",7),e.VwU("click",function(){return s.eBV(a),s.Njj(o.close.emit())}),e.Hgh(8,"i",8),e.eux()(),e.rj2(9,"div",9)(10,"div",10),e.Z7z(11,tp,3,1,null,null,e.Vm6),e.nVh(13,np,6,0,"div",11),e.eux()(),e.rj2(14,"footer",12)(15,"div",13)(16,"input",14,0),e.VwU("keydown.enter",function(){return s.eBV(a),s.Njj(o.sendMessage())}),e.eux(),e.rj2(18,"button",15),e.VwU("click",function(){return s.eBV(a),s.Njj(o.sendMessage())}),e.Hgh(19,"i",16),e.eux()()()()}2&i&&(e.R7$(11),e.Dyx(o.messages()),e.R7$(2),e.vxM(o.isLoading()?13:-1),e.R7$(3),e.Avn("disabled",o.isLoading()),e.R7$(2),e.Avn("disabled",o.isLoading()))},dependencies:[P.MD],encapsulation:2,changeDetection:0})}return n})(),op=(()=>{class n{STORAGE_KEY="smartTableSavedQueries";getQueriesFromStorage(){try{const t=localStorage.getItem(this.STORAGE_KEY);return t?JSON.parse(t):[]}catch(t){return console.error("Error reading saved queries from localStorage",t),[]}}saveQueriesToStorage(t){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(i){console.error("Error saving queries to localStorage",i)}}getSavedQueries(){return(0,me.of)(this.getQueriesFromStorage())}saveQuery(t,i){const o=this.getQueriesFromStorage(),a={id:(new Date).toISOString(),name:t,state:i};return o.push(a),this.saveQueriesToStorage(o),(0,me.of)(a)}deleteQuery(t){let i=this.getQueriesFromStorage();return i=i.filter(o=>o.id!==t),this.saveQueriesToStorage(i),(0,me.of)(void 0)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function rp(n,r){if(1&n){const t=e.RV6();e.rj2(0,"div",2),e.VwU("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.close.emit())}),e.rj2(1,"div",3),e.VwU("click",function(o){return s.eBV(t),s.Njj(o.stopPropagation())}),e.rj2(2,"header",4)(3,"h3",5),e.EFF(4,"Save Current View"),e.eux(),e.rj2(5,"button",6),e.VwU("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.close.emit())}),e.Hgh(6,"i",7),e.eux()(),e.rj2(7,"div",8)(8,"label",9),e.EFF(9,"View Name"),e.eux(),e.rj2(10,"input",10,0),e.VwU("input",function(){s.eBV(t);const o=e.sdS(11),a=e.XpG();return s.Njj(a.queryName.set(o.value))})("keydown.enter",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.handleSave())}),e.eux()(),e.rj2(12,"footer",11)(13,"button",12),e.VwU("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.close.emit())}),e.EFF(14,"Cancel"),e.eux(),e.rj2(15,"button",13),e.VwU("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.handleSave())}),e.EFF(16,"Save"),e.eux()()()()}if(2&n){const t=e.XpG();e.R7$(10),e.Avn("value",t.queryName()),e.R7$(5),e.Avn("disabled",!t.queryName().trim())}}let ap=(()=>{class n{isOpen=f.hFB.required();close=(0,f.CGW)();save=(0,f.CGW)();queryName=(0,s.vPA)("");handleSave(){const t=this.queryName().trim();t&&(this.save.emit(t),this.close.emit())}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-save-query-modal"]],inputs:{isOpen:[1,"isOpen"]},outputs:{close:"close",save:"save"},decls:1,vars:1,consts:[["queryNameInput",""],[1,"fixed","inset-0","bg-gray-900/60","flex","items-center","justify-center","z-50"],[1,"fixed","inset-0","bg-gray-900/60","flex","items-center","justify-center","z-50",3,"click"],[1,"bg-white","rounded-lg","shadow-xl","w-full","max-w-md","m-4",3,"click"],[1,"flex","items-center","justify-between","p-4","border-b","border-gray-200"],[1,"text-lg","font-semibold"],[1,"p-2","rounded-full","hover:bg-gray-100",3,"click"],[1,"pi","pi-times"],[1,"p-6"],["for","queryName",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","queryName","placeholder","e.g., 'High-Revenue Web Leads'",1,"mt-1","block","w-full","text-sm","rounded-md","border-gray-300","shadow-sm","focus:border-indigo-500","focus:ring-indigo-500",3,"input","keydown.enter","value"],[1,"p-4","border-t","border-gray-200","flex","justify-end","gap-3"],[1,"px-4","py-2","text-sm","font-medium","text-gray-700","bg-white","border","border-gray-300","rounded-md","hover:bg-gray-50",3,"click"],[1,"px-4","py-2","text-sm","font-medium","text-white","bg-slate-900","border","border-transparent","rounded-md","hover:bg-slate-800","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"]],template:function(i,o){1&i&&e.nVh(0,rp,17,2,"div",1),2&i&&e.vxM(o.isOpen()?0:-1)},dependencies:[P.MD],encapsulation:2,changeDetection:0})}return n})(),sp=(()=>{class n{STORAGE_KEY="smartTableCustomLayouts";getLayoutsFromStorage(){try{const t=localStorage.getItem(this.STORAGE_KEY);return t?JSON.parse(t):[]}catch(t){return console.error("Error reading custom layouts from localStorage",t),[]}}saveLayoutsToStorage(t){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(i){console.error("Error saving layouts to localStorage",i)}}getLayouts(){return(0,me.of)(this.getLayoutsFromStorage())}saveLayout(t){const i=this.getLayoutsFromStorage(),o={id:(new Date).toISOString(),...t};return i.push(o),this.saveLayoutsToStorage(i),(0,me.of)(o)}deleteLayout(t){let i=this.getLayoutsFromStorage();return i=i.filter(o=>o.id!==t),this.saveLayoutsToStorage(i),(0,me.of)(void 0)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function lp(n,r){if(1&n&&(e.rj2(0,"span",35),e.EFF(1),e.eux(),e.EFF(2," selected ")),2&n){const t=e.XpG(2);e.R7$(),e.JRh(t.fileName())}}function cp(n,r){1&n&&(e.rj2(0,"span"),e.EFF(1,"Upload a file"),e.eux(),e.EFF(2," or drag and drop "))}function dp(n,r){if(1&n){const t=e.RV6();e.rj2(0,"div")(1,"label",27)(2,"div",28)(3,"div",29),e.Hgh(4,"i",30),e.rj2(5,"div",31)(6,"p",32),e.nVh(7,lp,3,1)(8,cp,3,0),e.eux()(),e.rj2(9,"p",33),e.EFF(10,"PNG, JPG, GIF up to 10MB"),e.eux()()()(),e.rj2(11,"input",34),e.VwU("change",function(o){s.eBV(t);const a=e.XpG();return s.Njj(a.handleFileChange(o))}),e.eux()()}if(2&n){const t=e.XpG();e.R7$(7),e.vxM(t.fileName()?7:8)}}function up(n,r){if(1&n){const t=e.RV6();e.rj2(0,"div")(1,"textarea",36,2),e.VwU("input",function(){s.eBV(t);const o=e.sdS(2),a=e.XpG();return s.Njj(a.htmlPrompt.set(o.value))}),e.eux(),e.rj2(3,"p",37),e.EFF(4,"Provide a simple HTML structure. The AI will add styling and map the data fields."),e.eux()()}if(2&n){const t=e.XpG();e.R7$(),e.Avn("placeholder",e.VkB("e.g., <div><h2>",t.organization_name,"</h2></div>"))("value",t.htmlPrompt())}}let pp=(()=>{class n{close=(0,f.CGW)();generate=(0,f.CGW)();activeTab=(0,s.vPA)("image");layoutName=(0,s.vPA)("");targetView=(0,s.vPA)("card");htmlPrompt=(0,s.vPA)("");imageBase64=(0,s.vPA)(null);fileName=(0,s.vPA)("");formIsValid=(0,N.EW)(()=>{const t=this.layoutName().trim().length>0,i="image"===this.activeTab()&&!!this.imageBase64()||"html"===this.activeTab()&&this.htmlPrompt().trim().length>0;return t&&i});handleFileChange(t){const o=t.target.files?.[0];if(o){this.fileName.set(o.name);const a=new FileReader;a.onload=l=>{this.imageBase64.set(l.target?.result)},a.readAsDataURL(o)}}handleGenerate(){if(!this.formIsValid())return;const t={name:this.layoutName().trim(),targetView:this.targetView(),prompt:{}};if("image"===this.activeTab()&&this.imageBase64()){const i=this.imageBase64().split(","),o=i[0].match(/:(.*?);/)?.[1]||"image/jpeg";t.prompt.image={data:i[1],mimeType:o}}else t.prompt.html=this.htmlPrompt();this.generate.emit(t)}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-create-layout-modal"]],outputs:{close:"close",generate:"generate"},decls:46,vars:16,consts:[["nameInput",""],["targetSelect",""],["htmlInput",""],[1,"fixed","inset-0","bg-gray-900/60","flex","items-center","justify-center","z-50",3,"click"],[1,"bg-white","dark:bg-gray-800","rounded-lg","shadow-xl","w-full","max-w-2xl","m-4","flex","flex-col","max-h-[90vh]",3,"click"],[1,"flex","items-center","justify-between","p-4","border-b","border-gray-200","dark:border-gray-700"],[1,"text-lg","font-semibold","flex","items-center","gap-2"],[1,"pi","pi-sparkles","text-indigo-500"],[1,"p-2","rounded-full","hover:bg-gray-100","dark:hover:bg-gray-700",3,"click"],[1,"pi","pi-times"],[1,"p-6","space-y-6","overflow-y-auto"],[1,"font-medium","text-gray-800","dark:text-gray-200","mb-2"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["for","layoutName",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["type","text","id","layoutName","placeholder","e.g., 'Modern Contact Card'",1,"mt-1","block","w-full","text-sm","rounded-md","border-gray-300","shadow-sm","focus:border-indigo-500","focus:ring-indigo-500","dark:bg-gray-700","dark:border-gray-600",3,"input","value"],["for","targetView",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","targetView",1,"mt-1","block","w-full","text-sm","rounded-md","border-gray-300","shadow-sm","focus:border-indigo-500","focus:ring-indigo-500","dark:bg-gray-700","dark:border-gray-600",3,"change","value"],["value","card"],["value","list-item"],["value","table-row"],[1,"border-b","border-gray-200","dark:border-gray-700"],["aria-label","Tabs",1,"-mb-px","flex","space-x-4"],[1,"border-transparent","text-gray-500","hover:text-gray-700","hover:border-gray-300","dark:text-gray-400","dark:hover:text-gray-300","whitespace-nowrap","py-3","px-1","border-b-2","font-medium","text-sm",3,"click"],[1,"pt-4"],[1,"p-4","border-t","border-gray-200","dark:border-gray-700","flex","justify-end","gap-3"],[1,"px-4","py-2","text-sm","font-medium","text-gray-700","dark:text-gray-200","bg-white","dark:bg-gray-700","border","border-gray-300","dark:border-gray-600","rounded-md","hover:bg-gray-50","dark:hover:bg-gray-600",3,"click"],[1,"px-4","py-2","text-sm","font-medium","text-white","bg-indigo-600","border","border-transparent","rounded-md","hover:bg-indigo-700","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["for","file-upload",1,"relative","cursor-pointer","bg-white","dark:bg-gray-700","rounded-md","font-medium","text-indigo-600","dark:text-indigo-400","hover:text-indigo-500"],[1,"mt-1","flex","justify-center","px-6","pt-5","pb-6","border-2","border-gray-300","dark:border-gray-600","border-dashed","rounded-md"],[1,"space-y-1","text-center"],[1,"pi","pi-image","mx-auto","h-12","w-12","text-gray-400"],[1,"flex","text-sm","text-gray-600","dark:text-gray-400"],[1,"pl-1"],[1,"text-xs","text-gray-500","dark:text-gray-500"],["id","file-upload","name","file-upload","type","file","accept","image/*",1,"sr-only",3,"change"],[1,"font-semibold"],["rows","8",1,"block","w-full","text-sm","rounded-md","border-gray-300","shadow-sm","focus:border-indigo-500","focus:ring-indigo-500","dark:bg-gray-900","dark:border-gray-600","font-mono",3,"input","placeholder","value"],[1,"mt-2","text-xs","text-gray-500","dark:text-gray-400"]],template:function(i,o){if(1&i){const a=e.RV6();e.rj2(0,"div",3),e.VwU("click",function(){return s.eBV(a),s.Njj(o.close.emit())}),e.rj2(1,"div",4),e.VwU("click",function(c){return s.eBV(a),s.Njj(c.stopPropagation())}),e.rj2(2,"header",5)(3,"h3",6),e.Hgh(4,"i",7),e.EFF(5,"Create Layout with AI"),e.eux(),e.rj2(6,"button",8),e.VwU("click",function(){return s.eBV(a),s.Njj(o.close.emit())}),e.Hgh(7,"i",9),e.eux()(),e.rj2(8,"div",10)(9,"div")(10,"h4",11),e.EFF(11,"1. Name and Target"),e.eux(),e.rj2(12,"div",12)(13,"div")(14,"label",13),e.EFF(15,"Layout Name"),e.eux(),e.rj2(16,"input",14,0),e.VwU("input",function(){s.eBV(a);const c=e.sdS(17);return s.Njj(o.layoutName.set(c.value))}),e.eux()(),e.rj2(18,"div")(19,"label",15),e.EFF(20,"Target View"),e.eux(),e.rj2(21,"select",16,1),e.VwU("change",function(){s.eBV(a);const c=e.sdS(22);return s.Njj(o.targetView.set(c.value))}),e.rj2(23,"option",17),e.EFF(24,"Card"),e.eux(),e.rj2(25,"option",18),e.EFF(26,"List Item"),e.eux(),e.rj2(27,"option",19),e.EFF(28,"Table Row"),e.eux()()()()(),e.rj2(29,"div")(30,"h4",11),e.EFF(31,"2. Provide Design Input"),e.eux(),e.rj2(32,"div",20)(33,"nav",21)(34,"button",22),e.VwU("click",function(){return s.eBV(a),s.Njj(o.activeTab.set("image"))}),e.EFF(35," Upload Image "),e.eux(),e.rj2(36,"button",22),e.VwU("click",function(){return s.eBV(a),s.Njj(o.activeTab.set("html"))}),e.EFF(37," Use HTML "),e.eux()()(),e.rj2(38,"div",23),e.nVh(39,dp,12,1,"div")(40,up,5,3,"div"),e.eux()()(),e.rj2(41,"footer",24)(42,"button",25),e.VwU("click",function(){return s.eBV(a),s.Njj(o.close.emit())}),e.EFF(43,"Cancel"),e.eux(),e.rj2(44,"button",26),e.VwU("click",function(){return s.eBV(a),s.Njj(o.handleGenerate())}),e.EFF(45," Generate "),e.eux()()()()}2&i&&(e.R7$(16),e.Avn("value",o.layoutName()),e.R7$(5),e.Avn("value",o.targetView()),e.R7$(13),e.AVh("border-indigo-500","image"===o.activeTab())("text-indigo-600","image"===o.activeTab())("dark:text-indigo-400","image"===o.activeTab()),e.R7$(2),e.AVh("border-indigo-500","html"===o.activeTab())("text-indigo-600","html"===o.activeTab())("dark:text-indigo-400","html"===o.activeTab()),e.R7$(3),e.vxM("image"===o.activeTab()?39:40),e.R7$(5),e.Avn("disabled",!o.formIsValid()))},dependencies:[P.MD],encapsulation:2,changeDetection:0})}return n})();const mp={type:R.ZU.OBJECT,properties:{index:{type:R.ZU.NUMBER},name:{type:R.ZU.STRING},code:{type:R.ZU.STRING},display:{type:R.ZU.STRING},columnType:{type:R.ZU.STRING,nullable:!0},width:{type:R.ZU.STRING,nullable:!0},align:{type:R.ZU.STRING,nullable:!0},sortable:{type:R.ZU.BOOLEAN,nullable:!0},filterable:{type:R.ZU.BOOLEAN,nullable:!0},cardHeader:{type:R.ZU.BOOLEAN,nullable:!0},cardHeader1:{type:R.ZU.BOOLEAN,nullable:!0},cardRow:{type:R.ZU.BOOLEAN,nullable:!0},listRow:{type:R.ZU.BOOLEAN,nullable:!0},showOnColumnChooser:{type:R.ZU.BOOLEAN,nullable:!0}},required:["index","name","code","display"]};let Ii=(()=>{class n{ai=(0,s.WQX)(Ae).ai;getAutoAdoptedConfig(t,i){var o=this;return(0,Z.A)(function*(){const a=`You are a UI/UX expert tasked with making a data table responsive. Given a screen width of ${i}px, adapt the following table configuration JSON to provide the best user experience. \n    For smaller screens (under 768px), you should: \n    1. Reduce 'cardsPerRow' to 1 or 2. \n    2. Hide less important columns in the table view by setting their 'display' property to 'none'. Keep essential columns like contact name and primary contact info visible.\n    For medium screens (768px to 1280px), you can show more columns and set 'cardsPerRow' to 3 or 4.\n    For large screens (above 1280px), most columns can be visible and 'cardsPerRow' can be 4 or more.\n    Return the complete, modified JSON object that adheres to the provided schema. Original Config: \n\n${JSON.stringify(t,null,2)}`;let c=(yield o.ai.models.generateContent({model:"gemini-2.5-flash",contents:a,config:{responseMimeType:"application/json",responseSchema:{type:R.ZU.OBJECT,properties:{config:{type:R.ZU.OBJECT,properties:{cardViewConfig:{type:R.ZU.OBJECT,properties:{cardsPerRow:{type:R.ZU.INTEGER}},required:["cardsPerRow"],nullable:!0}}},columns:{type:R.ZU.ARRAY,items:mp}},required:["config","columns"]}}})).text.trim();const d=JSON.parse(c),u=JSON.parse(JSON.stringify(t));return u.config.cardViewConfig=d.config.cardViewConfig,u.columns=d.columns,u})()}generateLayout(t,i,o){var a=this;return(0,Z.A)(function*(){const l=o.map(g=>`\`${g.code}\` (${g.name})`).join(", ");let c=`You are an expert front-end developer specializing in Tailwind CSS. Your task is to create a single, self-contained HTML template for a ${i}.\nThe component must display data from the following available fields: ${l}.\nUse placeholders in the format \`{{ field_code }}\` to show where the data should go. For example, to display the organization's name, use \`{{ organization_name }}\`.\n\n**Styling Rules:**\n1.  **Use ONLY Tailwind CSS classes for styling.** Do not use inline styles or \`<style>\` tags.\n2.  The design must be **fully responsive**.\n3.  The design must support **dark mode** using \`dark:\` variants (e.g., \`bg-white dark:bg-gray-800\`).\n4.  Ensure good contrast and accessibility.\n5.  The final HTML should be a single block, like one \`<div>\` or one \`<li>\` that contains everything. For a 'table-row' target, you can use a \`<td>\` with a div inside it, and you must apply a colspan like \`<td colspan="100%">\`.\n\n**Input:**\nYou will be given either a basic HTML structure or an image of a design. You must interpret this input and create a production-ready component from it.\n`;const d={parts:[]};if(t.image)c+="\n**Design Input (Image):** Create an HTML component based on the provided image.",d.parts.push({text:c}),d.parts.push({inlineData:{mimeType:t.image.mimeType,data:t.image.data}});else{if(!t.html)throw new Error("No prompt provided for layout generation.");c+=`\n**Design Input (HTML):** Create an HTML component based on the following structure: \n\`\`\`html\n${t.html}\n\`\`\``,d.parts.push({text:c})}const p=(yield a.ai.models.generateContent({model:"gemini-2.5-flash",contents:d,config:{responseMimeType:"application/json",responseSchema:{type:R.ZU.OBJECT,properties:{htmlTemplate:{type:R.ZU.STRING}},required:["htmlTemplate"]}}})).text.trim();return JSON.parse(p)})()}suggestLayoutImprovements(t,i,o){var a=this;return(0,Z.A)(function*(){const l=`You are a UI/UX expert specializing in responsive design with Tailwind CSS and dark mode.\n    Analyze the following HTML template and suggest improvements.\n\n    **Context:**\n    - Screen Width: ${i}px\n    - Data Density: ${o} (e.g., 'compact' means less space per item, 'comfortable' means more space)\n    - The template is used to display a single item in a list or grid.\n    - It must be responsive and support dark mode (using 'dark:' prefixes).\n\n    **HTML Template:**\n    \`\`\`html\n    ${t}\n    \`\`\`\n\n    **Your Task:**\n    Provide a bulleted list of 2-4 actionable suggestions using markdown to improve the layout's responsiveness, readability, and modern aesthetics for the given screen size and density. Focus on better use of space, typography, and component structure. The suggestions should be concise.\n\n    Respond with a JSON object containing a single key "suggestions" which is a string containing the markdown-formatted bullet points.`,d=(yield a.ai.models.generateContent({model:"gemini-2.5-flash",contents:l,config:{responseMimeType:"application/json",responseSchema:{type:R.ZU.OBJECT,properties:{suggestions:{type:R.ZU.STRING}},required:["suggestions"]}}})).text.trim();return JSON.parse(d)})()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),rn=(()=>{class n{persistenceService=(0,s.WQX)(Ee);configService=(0,s.WQX)(he);STORAGE_KEY="smartTableDensity";density=(0,s.vPA)(this.getInitialDensity());constructor(){(0,s.QZP)(()=>{this.persistenceService.saveState(this.STORAGE_KEY,this.density())})}setDensity(t){this.density.set(t)}getInitialDensity(){return this.persistenceService.loadState(this.STORAGE_KEY)??this.configService.config().config.sizerConfig.defaultDensity}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const gp=(n,r)=>r.id;function _p(n,r){1&n&&(e.j41(0,"div",20),e.nrm(1,"i",22),e.k0s())}function fp(n,r){1&n&&(e.j41(0,"div",20),e.nrm(1,"i",22),e.k0s())}function hp(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",15),e.bIt("click",function(){const o=s.eBV(t).$implicit,a=e.XpG(2);return s.Njj(a.handleApply(o.id))}),e.j41(1,"div",23),e.nrm(2,"div",24),e.k0s(),e.j41(3,"div",18)(4,"h4",19),e.EFF(5),e.k0s(),e.j41(6,"p",25),e.EFF(7),e.k0s()(),e.nVh(8,fp,2,0,"div",20),e.j41(9,"button",26),e.bIt("click",function(o){const a=s.eBV(t).$implicit,l=e.XpG(2);return o.stopPropagation(),s.Njj(l.deleteLayout.emit(a.id))}),e.nrm(10,"i",27),e.k0s()()}if(2&n){const t=r.$implicit,i=e.XpG(2);e.AVh("border-indigo-500",i.isLayoutActive(t.id))("border-gray-300",!i.isLayoutActive(t.id))("dark:border-gray-600",!i.isLayoutActive(t.id)),e.R7$(2),e.Y8G("innerHTML",t.htmlTemplate,e.npT),e.R7$(3),e.JRh(t.name),e.R7$(2),e.JRh(t.targetView.replace("-"," ")),e.R7$(),e.vxM(i.isLayoutActive(t.id)?8:-1)}}function bp(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",2),e.bIt("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.close.emit())}),e.j41(1,"div",3),e.bIt("click",function(o){return s.eBV(t),s.Njj(o.stopPropagation())}),e.j41(2,"header",4)(3,"h3",5),e.EFF(4,"UI Gallery"),e.k0s(),e.j41(5,"div",6)(6,"button",7),e.bIt("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.handleSuggestImprovements())}),e.nrm(7,"i",8),e.j41(8,"span"),e.EFF(9,"Suggest Improvements"),e.k0s()(),e.j41(10,"button",9),e.bIt("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.showCreateModal.set(!0))}),e.nrm(11,"i",10),e.j41(12,"span"),e.EFF(13,"Create with AI"),e.k0s()(),e.j41(14,"button",11),e.bIt("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.close.emit())}),e.nrm(15,"i",12),e.k0s()()(),e.j41(16,"div",13)(17,"div",14)(18,"div",15),e.bIt("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.handleApply(null))}),e.j41(19,"div",16),e.nrm(20,"i",17),e.k0s(),e.j41(21,"div",18)(22,"h4",19),e.EFF(23,"Default Layout"),e.k0s()(),e.nVh(24,_p,2,0,"div",20),e.k0s(),e.Z7z(25,hp,11,10,"div",21,gp),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(6),e.Y8G("disabled",!t.activeCustomLayout()),e.R7$(12),e.AVh("border-indigo-500",t.isLayoutActive(null))("border-gray-300",!t.isLayoutActive(null))("dark:border-gray-600",!t.isLayoutActive(null)),e.R7$(6),e.vxM(t.isLayoutActive(null)?24:-1),e.R7$(),e.Dyx(t.layouts())}}function yp(n,r){if(1&n){const t=e.RV6();e.j41(0,"app-create-layout-modal",28),e.bIt("close",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.showCreateModal.set(!1))})("generate",function(o){s.eBV(t);const a=e.XpG();return a.generateLayout.emit(o),s.Njj(a.showCreateModal.set(!1))}),e.k0s()}}function vp(n,r){1&n&&(e.j41(0,"div",34),e.nrm(1,"i",36),e.j41(2,"p"),e.EFF(3,"Analyzing your layout..."),e.k0s()())}function Cp(n,r){if(1&n&&e.nrm(0,"div",35),2&n){const t=e.XpG(2);e.Y8G("innerHTML",t.suggestions(),e.npT)}}function xp(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",29),e.bIt("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.suggestions.set(""))}),e.j41(1,"div",30),e.bIt("click",function(o){return s.eBV(t),s.Njj(o.stopPropagation())}),e.j41(2,"header",4)(3,"h3",31),e.nrm(4,"i",32),e.EFF(5,"AI Suggestions"),e.k0s(),e.j41(6,"button",11),e.bIt("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.suggestions.set(""))}),e.nrm(7,"i",12),e.k0s()(),e.j41(8,"div",33),e.nVh(9,vp,4,0,"div",34)(10,Cp,1,1,"div",35),e.k0s()()()}if(2&n){const t=e.XpG();e.R7$(9),e.vxM(t.isGeneratingSuggestions()?9:10)}}let wp=(()=>{class n{isOpen=f.hFB.required();layouts=f.hFB.required();currentView=f.hFB.required();activeLayouts=f.hFB.required();close=(0,f.CGW)();applyLayout=(0,f.CGW)();deleteLayout=(0,f.CGW)();generateLayout=(0,f.CGW)();aiLayoutService=(0,s.WQX)(Ii);densityService=(0,s.WQX)(rn);showCreateModal=(0,s.vPA)(!1);suggestions=(0,s.vPA)("");isGeneratingSuggestions=(0,s.vPA)(!1);activeCustomLayout=(0,N.EW)(()=>{const t=this.currentView(),i=this.activeLayouts();let o=null;return"table"===t&&(o=i.table),"list"===t&&(o=i.list),"card"===t&&(o=i.card),o?this.layouts().find(a=>a.id===o)??null:null});getLayoutTarget(){return"table"===this.currentView()?"table-row":"list"===this.currentView()?"list-item":"card"}isLayoutActive(t){const i=this.currentView();return"table"===i?this.activeLayouts().table===t:"list"===i?this.activeLayouts().list===t:this.activeLayouts().card===t}handleApply(t){this.applyLayout.emit({view:this.currentView(),layoutId:t}),this.close.emit()}handleSuggestImprovements(){var t=this;return(0,Z.A)(function*(){const i=t.activeCustomLayout();if(i){t.isGeneratingSuggestions.set(!0),t.suggestions.set("");try{let a=(yield t.aiLayoutService.suggestLayoutImprovements(i.htmlTemplate,window.innerWidth,t.densityService.density())).suggestions;a=a.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),a=a.replace(/^\* (.*)$/gm,'<li class="ml-4 list-disc">$1</li>'),a.includes("<li")&&(a=`<ul>${a}</ul>`),t.suggestions.set(a)}catch(o){console.error("Error getting layout suggestions:",o),t.suggestions.set('<p class="text-red-500">Sorry, I was unable to generate suggestions at this time.</p>')}finally{t.isGeneratingSuggestions.set(!1)}}})()}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-ui-gallery"]],inputs:{isOpen:[1,"isOpen"],layouts:[1,"layouts"],currentView:[1,"currentView"],activeLayouts:[1,"activeLayouts"]},outputs:{close:"close",applyLayout:"applyLayout",deleteLayout:"deleteLayout",generateLayout:"generateLayout"},decls:3,vars:3,consts:[[1,"fixed","inset-0","bg-gray-900/60","flex","items-center","justify-center","z-50"],[1,"fixed","inset-0","bg-gray-900/80","flex","items-center","justify-center","z-[60]"],[1,"fixed","inset-0","bg-gray-900/60","flex","items-center","justify-center","z-50",3,"click"],[1,"bg-white","dark:bg-gray-800","rounded-lg","shadow-xl","w-full","max-w-4xl","m-4","flex","flex-col","max-h-[90vh]",3,"click"],[1,"flex","items-center","justify-between","p-4","border-b","border-gray-200","dark:border-gray-700"],[1,"text-lg","font-semibold"],[1,"flex","items-center","gap-2"],["title","Get AI suggestions for the active custom layout",1,"flex","items-center","gap-2","px-3","py-1.5","text-sm","font-medium","text-indigo-600","bg-indigo-100","dark:text-indigo-300","dark:bg-indigo-900/50","border","border-transparent","rounded-md","hover:bg-indigo-200","dark:hover:bg-indigo-900","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"pi","pi-lightbulb"],[1,"flex","items-center","gap-2","px-4","py-2","text-sm","font-medium","text-white","bg-indigo-600","border","border-transparent","rounded-md","hover:bg-indigo-700",3,"click"],[1,"pi","pi-sparkles"],[1,"p-2","rounded-full","hover:bg-gray-100","dark:hover:bg-gray-700",3,"click"],[1,"pi","pi-times"],[1,"p-6","overflow-y-auto"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-3","lg:grid-cols-4","gap-6"],[1,"border-2","rounded-lg","cursor-pointer","transition-all","group","relative",3,"click"],[1,"aspect-[4/3]","bg-gray-100","dark:bg-gray-700","flex","items-center","justify-center","rounded-t-md"],[1,"pi","pi-table","text-4xl","text-gray-400","dark:text-gray-500"],[1,"p-3"],[1,"font-semibold","text-sm","truncate"],[1,"absolute","top-2","right-2","bg-indigo-600","text-white","rounded-full","h-6","w-6","flex","items-center","justify-center"],[1,"border-2","rounded-lg","cursor-pointer","transition-all","group","relative",3,"border-indigo-500","border-gray-300","dark:border-gray-600"],[1,"pi","pi-check","text-xs"],[1,"aspect-[4/3]","bg-gray-100","dark:bg-gray-700","flex","items-center","justify-center","rounded-t-md","p-2","overflow-hidden"],[1,"transform","scale-[0.3]","origin-top-left",3,"innerHTML"],[1,"text-xs","text-gray-500","dark:text-gray-400","capitalize"],["title","Delete this layout",1,"absolute","top-1","right-1","p-1","rounded-full","opacity-0","group-hover:opacity-100","bg-white/50","dark:bg-gray-900/50","hover:bg-red-100","dark:hover:bg-red-900/50","text-red-500","dark:text-red-400","transition-opacity",3,"click"],[1,"pi","pi-trash","text-xs"],[3,"close","generate"],[1,"fixed","inset-0","bg-gray-900/80","flex","items-center","justify-center","z-[60]",3,"click"],[1,"bg-white","dark:bg-gray-800","rounded-lg","shadow-xl","w-full","max-w-lg","m-4",3,"click"],[1,"text-lg","font-semibold","flex","items-center","gap-2"],[1,"pi","pi-lightbulb","text-yellow-400"],[1,"p-6"],[1,"flex","items-center","gap-3"],[1,"prose","dark:prose-invert","max-w-none","text-sm",3,"innerHTML"],[1,"pi","pi-spin","pi-spinner","text-2xl","text-indigo-500"]],template:function(i,o){1&i&&(e.nVh(0,bp,27,8,"div",0),e.nVh(1,yp,1,0,"app-create-layout-modal"),e.nVh(2,xp,11,1,"div",1)),2&i&&(e.vxM(o.isOpen()?0:-1),e.R7$(),e.vxM(o.showCreateModal()?1:-1),e.R7$(),e.vxM((o.isGeneratingSuggestions()||o.suggestions())&&o.isOpen()?2:-1))},dependencies:[P.MD,pp],encapsulation:2,changeDetection:0})}return n})();var kt=W(177);let Xi=(()=>{class n{platformId=(0,s.WQX)(e.Agw);STORAGE_KEY_THEME="smart-table-theme";STORAGE_KEY_DIR="smart-table-dir";STORAGE_KEY_LAYOUT="smart-table-layout";theme=(0,s.vPA)("system");direction=(0,s.vPA)("ltr");layout=(0,s.vPA)("full");mediaQuery;mediaQueryListener;constructor(){(0,kt.UE)(this.platformId)&&(this.theme.set(this.getInitialState(this.STORAGE_KEY_THEME,"system")),this.direction.set(this.getInitialState(this.STORAGE_KEY_DIR,"ltr")),this.layout.set(this.getInitialState(this.STORAGE_KEY_LAYOUT,"full")),this.applyTheme(this.theme()),this.applyDirection(this.direction()),(0,s.QZP)(()=>{const t=this.theme();localStorage.setItem(this.STORAGE_KEY_THEME,t),this.applyTheme(t)}),(0,s.QZP)(()=>{const t=this.direction();localStorage.setItem(this.STORAGE_KEY_DIR,t),this.applyDirection(t)}),(0,s.QZP)(()=>{const t=this.layout();localStorage.setItem(this.STORAGE_KEY_LAYOUT,t)}),this.mediaQuery=window.matchMedia("(prefers-color-scheme: dark)"),this.mediaQueryListener=t=>{"system"===this.theme()&&this.applySystemTheme()},this.mediaQuery.addEventListener("change",this.mediaQueryListener))}ngOnDestroy(){(0,kt.UE)(this.platformId)&&this.mediaQuery&&this.mediaQueryListener&&this.mediaQuery.removeEventListener("change",this.mediaQueryListener)}setTheme(t){this.theme.set(t)}setDirection(t){this.direction.set(t)}setLayout(t){this.layout.set(t)}getInitialState(t,i){try{return localStorage.getItem(t)||i}catch{return i}}applyTheme(t){if(!(0,kt.UE)(this.platformId))return;const i=document.documentElement;i.classList.remove("dark"),"system"===t?this.applySystemTheme():"dark"===t&&i.classList.add("dark")}applyDirection(t){(0,kt.UE)(this.platformId)&&document.documentElement.setAttribute("dir",t)}applySystemTheme(){const t=window.matchMedia("(prefers-color-scheme: dark)").matches,i=document.documentElement;t?i.classList.add("dark"):i.classList.remove("dark")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),kp=(()=>{class n{STORAGE_KEY="smartTableSavedCalendarViews";getViewsFromStorage(){try{const t=localStorage.getItem(this.STORAGE_KEY);return t?JSON.parse(t):[]}catch(t){return console.error("Error reading saved calendar views from localStorage",t),[]}}saveViewsToStorage(t){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(i){console.error("Error saving calendar views to localStorage",i)}}getSavedViews(){return(0,me.of)(this.getViewsFromStorage())}saveView(t,i){const o=this.getViewsFromStorage(),a={id:(new Date).toISOString(),name:t,dateFieldCode:i};return o.push(a),this.saveViewsToStorage(o),(0,me.of)(a)}deleteView(t){let i=this.getViewsFromStorage();return i=i.filter(o=>o.id!==t),this.saveViewsToStorage(i),(0,me.of)(void 0)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Sp=(()=>{class n{ai=(0,s.WQX)(Ae).ai;suggestCalendarViewName(t){var i=this;return(0,Z.A)(function*(){const o=`You are a helpful assistant. Your task is to suggest a short, descriptive name for a saved calendar view in a data table. The view is based on a date field.\n\n    Date Field Name: "${t}"\n\n    Respond with a JSON object containing a single key "name".\n\n    Example 1:\n    Date Field Name: "Created Time"\n    Response: { "name": "Contacts by Creation Date" }\n\n    Example 2:\n    Date Field Name: "last_activity_date"\n    Response: { "name": "Contacts by Last Activity" }\n    \n    Example 3:\n    Date Field Name: "Subscription End Date"\n    Response: { "name": "Subscription Expirations" }`,l=(yield i.ai.models.generateContent({model:"gemini-2.5-flash",contents:o,config:{responseMimeType:"application/json",responseSchema:{type:R.ZU.OBJECT,properties:{name:{type:R.ZU.STRING}},required:["name"]}}})).text.trim();return JSON.parse(l)})()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Fp=(n,r)=>r.code,Tp=(n,r)=>r.id;function Mp(n,r){if(1&n){const t=e.RV6();e.rj2(0,"div",12)(1,"div",18)(2,"input",19),e.VwU("change",function(){const o=s.eBV(t).$implicit,a=e.XpG(2);return s.Njj(a.selectField(o.code))}),e.eux()(),e.rj2(3,"div",20)(4,"label",21),e.EFF(5),e.eux()()()}if(2&n){const t=r.$implicit,i=e.XpG(2);e.R7$(2),e.Avn("id","date-field-"+t.code)("checked",i.selectedFieldCode()===t.code),e.R7$(2),e.Avn("htmlFor","date-field-"+t.code),e.R7$(),e.JRh(t.name)}}function jp(n,r){1&n&&(e.Hgh(0,"i",27),e.EFF(1," Saving... "))}function Rp(n,r){1&n&&(e.Hgh(0,"i",28),e.EFF(1," Save View "))}function Vp(n,r){if(1&n){const t=e.RV6();e.rj2(0,"div")(1,"h4",10),e.EFF(2,"2. Save this view for later"),e.eux(),e.rj2(3,"div",22)(4,"input",23,0),e.VwU("input",function(){s.eBV(t);const o=e.sdS(5),a=e.XpG(2);return s.Njj(a.newViewName.set(o.value))}),e.eux(),e.rj2(6,"button",24),e.VwU("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.suggestName())}),e.Hgh(7,"i",25),e.eux()(),e.rj2(8,"button",26),e.VwU("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.saveView())}),e.nVh(9,jp,2,0)(10,Rp,2,0),e.eux()()}if(2&n){const t=e.XpG(2);e.R7$(4),e.Avn("value",t.newViewName()),e.R7$(2),e.Avn("disabled",t.isSuggestingName()),e.R7$(),e.AVh("pi-sparkles",!t.isSuggestingName())("pi-spin",t.isSuggestingName())("pi-spinner",t.isSuggestingName()),e.R7$(),e.Avn("disabled",!t.canSave()||t.isSaving()),e.R7$(),e.vxM(t.isSaving()?9:10)}}function Dp(n,r){if(1&n){const t=e.RV6();e.rj2(0,"li",29)(1,"div")(2,"p",30),e.EFF(3),e.eux(),e.rj2(4,"p",31),e.EFF(5),e.eux()(),e.rj2(6,"div",32)(7,"button",33),e.VwU("click",function(){const o=s.eBV(t).$implicit,a=e.XpG(3);return s.Njj(a.applyView(o.dateFieldCode))}),e.Hgh(8,"i",34),e.eux(),e.rj2(9,"button",35),e.VwU("click",function(){const o=s.eBV(t).$implicit,a=e.XpG(3);return s.Njj(a.deleteView(o.id))}),e.Hgh(10,"i",36),e.eux()()()}if(2&n){const t=r.$implicit,i=e.XpG(3);e.R7$(3),e.JRh(t.name),e.R7$(2),e.SpI("Field: ",i.getDateFieldName(t.dateFieldCode))}}function Ap(n,r){if(1&n&&(e.rj2(0,"ul",11),e.Z7z(1,Dp,11,2,"li",29,Tp),e.eux()),2&n){const t=e.XpG(2);e.R7$(),e.Dyx(t.savedViews())}}function Np(n,r){1&n&&(e.rj2(0,"p",14),e.EFF(1,"No saved views yet. Select a field and save it to get started."),e.eux())}function Ep(n,r){if(1&n){const t=e.RV6();e.rj2(0,"div",2),e.VwU("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.close.emit())}),e.rj2(1,"div",3),e.VwU("click",function(o){return s.eBV(t),s.Njj(o.stopPropagation())}),e.rj2(2,"header",4)(3,"h3",5),e.EFF(4,"Configure Calendar View"),e.eux(),e.rj2(5,"button",6),e.VwU("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.close.emit())}),e.Hgh(6,"i",7),e.eux()(),e.rj2(7,"div",8)(8,"div",9)(9,"div")(10,"h4",10),e.EFF(11,"1. Choose a date field to plot"),e.eux(),e.rj2(12,"fieldset",11),e.Z7z(13,Mp,6,4,"div",12,Fp),e.eux()(),e.nVh(15,Vp,11,10,"div"),e.eux(),e.rj2(16,"div",13)(17,"h4",10),e.EFF(18,"Saved Calendar Views"),e.eux(),e.nVh(19,Ap,3,0,"ul",11)(20,Np,2,0,"p",14),e.eux()(),e.rj2(21,"footer",15)(22,"button",16),e.VwU("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.close.emit())}),e.EFF(23,"Cancel"),e.eux(),e.rj2(24,"button",17),e.VwU("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.applyView(o.selectedFieldCode()))}),e.EFF(25," Apply Selected Field "),e.eux()()()()}if(2&n){const t=e.XpG();e.R7$(13),e.Dyx(t.dateColumns()),e.R7$(2),e.vxM(t.selectedFieldCode()?15:-1),e.R7$(4),e.vxM(t.savedViews().length>0?19:20),e.R7$(5),e.Avn("disabled",!t.selectedFieldCode())}}let $p=(()=>{class n{isOpen=f.hFB.required();dateColumns=f.hFB.required();close=(0,f.CGW)();apply=(0,f.CGW)();calendarViewConfigService=(0,s.WQX)(kp);aiNamingService=(0,s.WQX)(Sp);savedViews=(0,s.vPA)([]);selectedFieldCode=(0,s.vPA)("");newViewName=(0,s.vPA)("");isSaving=(0,s.vPA)(!1);isSuggestingName=(0,s.vPA)(!1);canSave=(0,N.EW)(()=>this.selectedFieldCode()&&this.newViewName().trim().length>0);constructor(){this.loadSavedViews()}loadSavedViews(){this.calendarViewConfigService.getSavedViews().subscribe(t=>{this.savedViews.set(t)})}selectField(t){this.selectedFieldCode.set(t),this.newViewName.set("")}suggestName(){var t=this;return(0,Z.A)(function*(){const i=t.selectedFieldCode();if(!i)return;const o=t.dateColumns().find(a=>a.code===i);if(o){t.isSuggestingName.set(!0);try{const a=yield t.aiNamingService.suggestCalendarViewName(o.name);t.newViewName.set(a.name)}catch(a){console.error("Error suggesting name:",a)}finally{t.isSuggestingName.set(!1)}}})()}saveView(){this.canSave()&&(this.isSaving.set(!0),this.calendarViewConfigService.saveView(this.newViewName().trim(),this.selectedFieldCode()).subscribe(()=>{this.loadSavedViews(),this.newViewName.set(""),this.isSaving.set(!1)}))}deleteView(t){this.calendarViewConfigService.deleteView(t).subscribe(()=>{this.loadSavedViews()})}applyView(t){this.apply.emit({dateFieldCode:t})}getDateFieldName(t){const i=this.dateColumns().find(o=>o.code===t);return i?i.name:t}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-calendar-config-modal"]],inputs:{isOpen:[1,"isOpen"],dateColumns:[1,"dateColumns"]},outputs:{close:"close",apply:"apply"},decls:1,vars:1,consts:[["nameInput",""],[1,"fixed","inset-0","bg-gray-900/60","flex","items-center","justify-center","z-50"],[1,"fixed","inset-0","bg-gray-900/60","flex","items-center","justify-center","z-50",3,"click"],[1,"bg-white","rounded-lg","shadow-xl","w-full","max-w-2xl","m-4","flex","flex-col","max-h-[90vh]",3,"click"],[1,"flex","items-center","justify-between","p-4","border-b","border-gray-200"],[1,"text-lg","font-semibold"],[1,"p-2","rounded-full","hover:bg-gray-100",3,"click"],[1,"pi","pi-times"],[1,"p-6","grid","grid-cols-1","md:grid-cols-2","gap-6","overflow-y-auto"],[1,"space-y-6"],[1,"font-medium","text-gray-800","mb-2"],[1,"space-y-2"],[1,"relative","flex","items-start"],[1,"border-t","md:border-t-0","md:border-l","border-gray-200","md:pl-6","pt-6","md:pt-0"],[1,"text-sm","text-gray-500","italic"],[1,"p-4","border-t","border-gray-200","flex","justify-end","gap-3"],[1,"px-4","py-2","text-sm","font-medium","text-gray-700","bg-white","border","border-gray-300","rounded-md","hover:bg-gray-50",3,"click"],[1,"px-4","py-2","text-sm","font-medium","text-white","bg-slate-900","border","border-transparent","rounded-md","hover:bg-slate-800","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"flex","h-6","items-center"],["name","date-field","type","radio",1,"h-4","w-4","border-gray-300","text-indigo-600","focus:ring-indigo-600",3,"change","id","checked"],[1,"ml-3","text-sm","leading-6"],[1,"font-medium","text-gray-900",3,"for"],[1,"flex","items-center","gap-2"],["type","text","placeholder","e.g., Contacts by Creation",1,"flex-grow","block","w-full","text-sm","rounded-md","border-gray-300","shadow-sm","focus:border-indigo-500","focus:ring-indigo-500",3,"input","value"],["title","Suggest a name with AI",1,"p-2","rounded-md","bg-indigo-50","text-indigo-600","hover:bg-indigo-100","disabled:opacity-50",3,"click","disabled"],[1,"pi"],[1,"mt-3","w-full","flex","justify-center","items-center","gap-2","px-4","py-2","text-sm","font-medium","text-white","bg-slate-900","border","border-transparent","rounded-md","hover:bg-slate-800","disabled:opacity-50",3,"click","disabled"],[1,"pi","pi-spin","pi-spinner"],[1,"pi","pi-save"],[1,"p-2","rounded-md","bg-gray-50","flex","items-center","justify-between"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"flex","items-center","gap-1"],["title","Apply this view",1,"p-2","text-sm","rounded-md","text-white","bg-slate-900","hover:bg-slate-800",3,"click"],[1,"pi","pi-check"],["title","Delete this view",1,"p-2","text-sm","rounded-md","text-red-600","hover:bg-red-100",3,"click"],[1,"pi","pi-trash"]],template:function(i,o){1&i&&e.nVh(0,Ep,26,3,"div",1),2&i&&e.vxM(o.isOpen()?0:-1)},dependencies:[P.MD],encapsulation:2,changeDetection:0})}return n})();const Gp=(n,r)=>r.name;function Ip(n,r){if(1&n){const t=e.RV6();e.rj2(0,"button",2),e.VwU("click",function(){const o=s.eBV(t).$implicit,a=e.XpG();return s.Njj(a.setDensity(o.name))}),e.Hgh(1,"i",3),e.eux()}if(2&n){const t=r.$implicit,i=e.XpG();e.AVh("bg-slate-900",i.currentDensity()===t.name)("text-white",i.currentDensity()===t.name)("bg-white",i.currentDensity()!==t.name)("text-gray-700",i.currentDensity()!==t.name)("hover:bg-gray-100",i.currentDensity()!==t.name),e.Avn("title","Set density to "+t.name),e.R7$(),e.HbH(i.getIconForDensity(t.name))}}let Xp=(()=>{class n{densityService=(0,s.WQX)(rn);configService=(0,s.WQX)(he);densities=this.configService.config().config.sizerConfig.densities;currentDensity=this.densityService.density;setDensity(t){this.densityService.setDensity(t)}getIconForDensity(t){switch(t){case"comfortable":return"pi-align-justify";case"cozy":return"pi-bars";case"compact":return"pi-table";case"ultra-compact":return"pi-compress"}}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-density-chooser"]],decls:3,vars:0,consts:[[1,"flex","items-center","gap-1"],[1,"px-4","py-2","rounded-md","border","text-sm","transition-colors","duration-200",3,"bg-slate-900","text-white","bg-white","text-gray-700","hover:bg-gray-100","title"],[1,"px-4","py-2","rounded-md","border","text-sm","transition-colors","duration-200",3,"click","title"],[1,"pi"]],template:function(i,o){1&i&&(e.rj2(0,"div",0),e.Z7z(1,Ip,2,13,"button",1,Gp),e.eux()),2&i&&(e.R7$(),e.Dyx(o.densities))},dependencies:[P.MD],encapsulation:2,changeDetection:0})}return n})(),Bp=(()=>{class n{close=(0,f.CGW)();startSync=(0,f.CGW)();static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-sync-options-modal"]],outputs:{close:"close",startSync:"startSync"},decls:21,vars:0,consts:[[1,"fixed","inset-0","bg-gray-900/60","flex","items-center","justify-center","z-50",3,"click"],[1,"bg-white","dark:bg-gray-800","rounded-lg","shadow-xl","w-full","max-w-md","m-4",3,"click"],[1,"flex","items-center","justify-between","p-4","border-b","border-gray-200","dark:border-gray-700"],[1,"text-lg","font-semibold","flex","items-center","gap-2"],[1,"pi","pi-sync","text-indigo-500"],[1,"p-2","rounded-full","hover:bg-gray-100","dark:hover:bg-gray-700",3,"click"],[1,"pi","pi-times"],[1,"p-6","text-sm","text-gray-600","dark:text-gray-300","space-y-4"],[1,"p-4","border-t","border-gray-200","dark:border-gray-700","flex","justify-end","gap-3"],[1,"px-4","py-2","text-sm","font-medium","text-gray-700","dark:text-gray-200","bg-white","dark:bg-gray-700","border","border-gray-300","dark:border-gray-600","rounded-md","hover:bg-gray-50","dark:hover:bg-gray-600",3,"click"],[1,"px-4","py-2","text-sm","font-medium","text-white","bg-indigo-600","border","border-transparent","rounded-md","hover:bg-indigo-700",3,"click"]],template:function(i,o){1&i&&(e.rj2(0,"div",0),e.VwU("click",function(){return o.close.emit()}),e.rj2(1,"div",1),e.VwU("click",function(l){return l.stopPropagation()}),e.rj2(2,"header",2)(3,"h3",3),e.Hgh(4,"i",4),e.EFF(5,"Enable Offline Sync?"),e.eux(),e.rj2(6,"button",5),e.VwU("click",function(){return o.close.emit()}),e.Hgh(7,"i",6),e.eux()(),e.rj2(8,"div",7)(9,"p"),e.EFF(10," Switching to "),e.rj2(11,"strong"),e.EFF(12,"SYNC"),e.eux(),e.EFF(13," mode will download all contact data to your device for fast, offline access. "),e.eux(),e.rj2(14,"p"),e.EFF(15," The initial download may take a moment. Future loads will be instantaneous. "),e.eux()(),e.rj2(16,"footer",8)(17,"button",9),e.VwU("click",function(){return o.close.emit()}),e.EFF(18,"Cancel"),e.eux(),e.rj2(19,"button",10),e.VwU("click",function(){return o.startSync.emit()}),e.EFF(20," Start Sync "),e.eux()()()())},dependencies:[P.MD],encapsulation:2,changeDetection:0})}return n})(),zp=(()=>{class n{persistenceService=(0,s.WQX)(Ee);STORAGE_KEY="smartTableChips";chips=(0,s.vPA)(this.loadChips());constructor(){(0,s.QZP)(()=>{this.saveChips(this.chips())})}addChip(t){const i={id:(new Date).toISOString(),...t};this.chips.update(o=>[...o,i])}removeChip(t){this.chips.update(i=>i.filter(o=>o.id!==t))}loadChips(){return this.persistenceService.loadState(this.STORAGE_KEY)??[]}saveChips(t){this.persistenceService.saveState(this.STORAGE_KEY,t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Op=(()=>{class n{ai=(0,s.WQX)(Ae).ai;generateChipConfig(t,i){var o=this;return(0,Z.A)(function*(){const a=i.map(u=>({name:u.name,code:u.code,type:u.columnType||"TEXT"})),l=`You are an AI assistant that creates configuration for summary "chips" based on user requests.\n    Analyze the user's prompt and determine the correct column, aggregation method, and label.\n    - For requests to count specific categories (e.g., "count web leads"), use the 'count' aggregation and specify the 'filterValue'. The label should reflect this, like "Web Leads".\n    - For requests to summarize a numeric column (e.g., "total revenue"), use 'sum' or 'average' and do not provide a 'filterValue'. The label should be "Total Revenue".\n    - If the user just says "show revenue", assume they mean 'sum'.\n    - If the user just says "count contacts", use 'count' on the primary key 'organization_id' and label it "Total Contacts".\n    \n    Respond with a single JSON object.\n\n    Available columns: ${JSON.stringify(a)}\n    `,d=(yield o.ai.models.generateContent({model:"gemini-2.5-flash",contents:t,config:{systemInstruction:l,responseMimeType:"application/json",responseSchema:{type:R.ZU.OBJECT,properties:{label:{type:R.ZU.STRING},columnCode:{type:R.ZU.STRING},aggregation:{type:R.ZU.STRING,enum:["count","sum","average"]},filterValue:{type:R.ZU.STRING,nullable:!0}},required:["label","columnCode","aggregation"]}}})).text.trim();return JSON.parse(d)})()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Bi=(n,r)=>r.code;function Pp(n,r){if(1&n&&(e.rj2(0,"option",28),e.EFF(1),e.eux()),2&n){const t=r.$implicit;e.Avn("value",t.code),e.R7$(),e.JRh(t.name)}}function Lp(n,r){if(1&n&&(e.rj2(0,"option",28),e.EFF(1),e.eux()),2&n){const t=r.$implicit;e.Avn("value",t.code),e.R7$(),e.JRh(t.name)}}function Hp(n,r){if(1&n&&(e.rj2(0,"option",32),e.EFF(1),e.eux()),2&n){const t=r.$implicit;e.Avn("value",t),e.R7$(),e.JRh(t)}}function Up(n,r){if(1&n){const t=e.RV6();e.rj2(0,"div")(1,"label",30),e.EFF(2,"Calculation"),e.eux(),e.rj2(3,"select",31,2),e.VwU("change",function(){s.eBV(t);const o=e.sdS(4),a=e.XpG(3);return s.Njj(a.selectedAggregation.set(o.value))}),e.Z7z(5,Hp,2,2,"option",32,e.fX1),e.eux()()}if(2&n){const t=e.XpG(3);e.R7$(3),e.Avn("value",t.selectedAggregation()),e.R7$(2),e.Dyx(t.availableAggregations())}}function Wp(n,r){if(1&n){const t=e.RV6();e.rj2(0,"div")(1,"label",33),e.EFF(2,"Value to Count"),e.eux(),e.rj2(3,"input",34,3),e.VwU("input",function(){s.eBV(t);const o=e.sdS(4),a=e.XpG(3);return s.Njj(a.filterValue.set(o.value))}),e.eux(),e.rj2(5,"p",35),e.EFF(6,"Specify which value in the selected column to count (e.g., 'Web' for Lead Source)."),e.eux()()}if(2&n){const t=e.XpG(3);e.R7$(3),e.Avn("value",t.filterValue())}}function Yp(n,r){if(1&n){const t=e.RV6();e.rj2(0,"div",17)(1,"div")(2,"label",22),e.EFF(3,"Chip Label"),e.eux(),e.rj2(4,"input",23,0),e.VwU("input",function(){s.eBV(t);const o=e.sdS(5),a=e.XpG(2);return s.Njj(a.label.set(o.value))}),e.eux()(),e.rj2(6,"div")(7,"label",24),e.EFF(8,"Column"),e.eux(),e.rj2(9,"select",25,1),e.VwU("change",function(){s.eBV(t);const o=e.sdS(10),a=e.XpG(2);return a.selectedColumnCode.set(o.value),s.Njj(a.selectedAggregation.set("count"))}),e.rj2(11,"option",26),e.EFF(12,"Select a column..."),e.eux(),e.rj2(13,"optgroup",27),e.Z7z(14,Pp,2,2,"option",28,Bi),e.eux(),e.rj2(16,"optgroup",29),e.Z7z(17,Lp,2,2,"option",28,Bi),e.eux()()(),e.nVh(19,Up,7,1,"div"),e.nVh(20,Wp,7,1,"div"),e.eux()}if(2&n){const t=e.XpG(2);e.R7$(4),e.Avn("value",t.label()),e.R7$(5),e.Avn("value",t.selectedColumnCode()),e.R7$(5),e.Dyx(t.numericColumns()),e.R7$(3),e.Dyx(t.categoricalColumns()),e.R7$(2),e.vxM(t.selectedColumnCode()?19:-1),e.R7$(),e.vxM(t.isCategoricalCount()?20:-1)}}function Qp(n,r){if(1&n){const t=e.RV6();e.rj2(0,"div",17)(1,"div")(2,"label",36),e.EFF(3,"What do you want to see?"),e.eux(),e.rj2(4,"textarea",37,4),e.VwU("input",function(){s.eBV(t);const o=e.sdS(5),a=e.XpG(2);return s.Njj(a.aiPrompt.set(o.value))}),e.eux()()()}if(2&n){const t=e.XpG(2);e.R7$(4),e.Avn("value",t.aiPrompt())}}function Jp(n,r){if(1&n){const t=e.RV6();e.rj2(0,"button",38),e.VwU("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.handleManualSave())}),e.EFF(1," Add Chip "),e.eux()}if(2&n){const t=e.XpG(2);e.Avn("disabled",!t.manualFormIsValid())}}function Zp(n,r){1&n&&(e.Hgh(0,"i",40),e.rj2(1,"span"),e.EFF(2,"Generating..."),e.eux())}function qp(n,r){1&n&&(e.Hgh(0,"i",41),e.rj2(1,"span"),e.EFF(2,"Generate & Add"),e.eux())}function Kp(n,r){if(1&n){const t=e.RV6();e.rj2(0,"button",39),e.VwU("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.handleAiGenerate())}),e.nVh(1,Zp,3,0)(2,qp,3,0),e.eux()}if(2&n){const t=e.XpG(2);e.Avn("disabled",!t.aiPrompt().trim()||t.isGenerating()),e.R7$(),e.vxM(t.isGenerating()?1:2)}}function em(n,r){if(1&n){const t=e.RV6();e.rj2(0,"div",6),e.VwU("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.close.emit())}),e.rj2(1,"div",7),e.VwU("click",function(o){return s.eBV(t),s.Njj(o.stopPropagation())}),e.rj2(2,"header",8)(3,"h3",9),e.EFF(4,"Add Summary Chip"),e.eux(),e.rj2(5,"button",10),e.VwU("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.close.emit())}),e.Hgh(6,"i",11),e.eux()(),e.rj2(7,"div",12)(8,"div",13)(9,"nav",14)(10,"button",15),e.VwU("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.activeTab.set("manual"))}),e.EFF(11," Manual "),e.eux(),e.rj2(12,"button",15),e.VwU("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.activeTab.set("ai"))}),e.EFF(13," Create with AI "),e.eux()()(),e.rj2(14,"div",16),e.nVh(15,Yp,21,4,"div",17)(16,Qp,6,1,"div",17),e.eux()(),e.rj2(17,"footer",18)(18,"button",19),e.VwU("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.close.emit())}),e.EFF(19,"Cancel"),e.eux(),e.nVh(20,Jp,2,1,"button",20)(21,Kp,3,2,"button",21),e.eux()()()}if(2&n){const t=e.XpG();e.R7$(10),e.AVh("border-indigo-500","manual"===t.activeTab())("text-indigo-600","manual"===t.activeTab()),e.R7$(2),e.AVh("border-indigo-500","ai"===t.activeTab())("text-indigo-600","ai"===t.activeTab()),e.R7$(3),e.vxM("manual"===t.activeTab()?15:16),e.R7$(5),e.vxM("manual"===t.activeTab()?20:21)}}let tm=(()=>{class n{isOpen=f.hFB.required();columns=f.hFB.required();close=(0,f.CGW)();addChip=(0,f.CGW)();aiChipService=(0,s.WQX)(Op);activeTab=(0,s.vPA)("manual");label=(0,s.vPA)("");selectedColumnCode=(0,s.vPA)("");selectedAggregation=(0,s.vPA)("count");filterValue=(0,s.vPA)("");aiPrompt=(0,s.vPA)("");isGenerating=(0,s.vPA)(!1);numericColumns=(0,N.EW)(()=>this.columns().filter(t=>"numeric"===t.columnType));categoricalColumns=(0,N.EW)(()=>this.columns().filter(t=>"numeric"!==t.columnType&&t.filterable));availableAggregations=(0,N.EW)(()=>{const t=this.selectedColumnCode();return this.numericColumns().some(o=>o.code===t)?["sum","average","count"]:["count"]});isCategoricalCount=(0,N.EW)(()=>{const t=this.selectedColumnCode(),i=this.numericColumns().some(o=>o.code===t);return"count"===this.selectedAggregation()&&!i});manualFormIsValid=(0,N.EW)(()=>this.label().trim()&&this.selectedColumnCode());handleManualSave(){this.manualFormIsValid()&&(this.addChip.emit({label:this.label().trim(),columnCode:this.selectedColumnCode(),aggregation:this.selectedAggregation(),filterValue:this.isCategoricalCount()?this.filterValue().trim():void 0}),this.resetForms())}handleAiGenerate(){var t=this;return(0,Z.A)(function*(){if(t.aiPrompt().trim()){t.isGenerating.set(!0);try{const i=yield t.aiChipService.generateChipConfig(t.aiPrompt(),t.columns());t.addChip.emit(i),t.resetForms()}catch(i){console.error("AI chip generation failed",i)}finally{t.isGenerating.set(!1)}}})()}resetForms(){this.label.set(""),this.selectedColumnCode.set(""),this.selectedAggregation.set("count"),this.filterValue.set(""),this.aiPrompt.set("")}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-add-chip-modal"]],inputs:{isOpen:[1,"isOpen"],columns:[1,"columns"]},outputs:{close:"close",addChip:"addChip"},decls:1,vars:1,consts:[["labelInput",""],["columnSelect",""],["aggSelect",""],["filterValueInput",""],["promptInput",""],[1,"fixed","inset-0","bg-gray-900/60","flex","items-center","justify-center","z-50"],[1,"fixed","inset-0","bg-gray-900/60","flex","items-center","justify-center","z-50",3,"click"],[1,"bg-white","rounded-lg","shadow-xl","w-full","max-w-lg","m-4","flex","flex-col","max-h-[90vh]",3,"click"],[1,"flex","items-center","justify-between","p-4","border-b","border-gray-200"],[1,"text-lg","font-semibold"],[1,"p-2","rounded-full","hover:bg-gray-100",3,"click"],[1,"pi","pi-times"],[1,"p-6","overflow-y-auto"],[1,"border-b","border-gray-200"],["aria-label","Tabs",1,"-mb-px","flex","space-x-6"],[1,"border-transparent","text-gray-500","hover:text-gray-700","hover:border-gray-300","whitespace-nowrap","py-3","px-1","border-b-2","font-medium","text-sm",3,"click"],[1,"pt-6"],[1,"space-y-4"],[1,"p-4","border-t","border-gray-200","flex","justify-end","gap-3"],[1,"px-4","py-2","text-sm","font-medium","text-gray-700","bg-white","border","border-gray-300","rounded-md","hover:bg-gray-50",3,"click"],[1,"px-4","py-2","text-sm","font-medium","text-white","bg-slate-900","border","border-transparent","rounded-md","hover:bg-slate-800","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[1,"px-4","py-2","text-sm","font-medium","text-white","bg-slate-900","border","border-transparent","rounded-md","hover:bg-slate-800","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","gap-2",3,"disabled"],["for","chipLabel",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","chipLabel","placeholder","e.g., Total Revenue",1,"mt-1","block","w-full","text-sm","rounded-md","border-gray-300","shadow-sm","focus:border-indigo-500","focus:ring-indigo-500",3,"input","value"],["for","chipColumn",1,"block","text-sm","font-medium","text-gray-700"],["id","chipColumn",1,"mt-1","block","w-full","text-sm","rounded-md","border-gray-300","shadow-sm","focus:border-indigo-500","focus:ring-indigo-500",3,"change","value"],["value","","disabled",""],["label","Numeric Fields"],[3,"value"],["label","Other Fields"],["for","chipAggregation",1,"block","text-sm","font-medium","text-gray-700"],["id","chipAggregation",1,"mt-1","block","w-full","text-sm","rounded-md","border-gray-300","shadow-sm","focus:border-indigo-500","focus:ring-indigo-500",3,"change","value"],[1,"capitalize",3,"value"],["for","chipFilterValue",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","chipFilterValue","placeholder","e.g., Web",1,"mt-1","block","w-full","text-sm","rounded-md","border-gray-300","shadow-sm","focus:border-indigo-500","focus:ring-indigo-500",3,"input","value"],[1,"mt-1","text-xs","text-gray-500"],["for","aiPrompt",1,"block","text-sm","font-medium","text-gray-700"],["id","aiPrompt","rows","4","placeholder","e.g., 'Show total revenue' or 'Count of leads from Web'",1,"mt-1","block","w-full","text-sm","rounded-md","border-gray-300","shadow-sm","focus:border-indigo-500","focus:ring-indigo-500","font-mono",3,"input","value"],[1,"px-4","py-2","text-sm","font-medium","text-white","bg-slate-900","border","border-transparent","rounded-md","hover:bg-slate-800","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"px-4","py-2","text-sm","font-medium","text-white","bg-slate-900","border","border-transparent","rounded-md","hover:bg-slate-800","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","gap-2",3,"click","disabled"],[1,"pi","pi-spin","pi-spinner"],[1,"pi","pi-sparkles"]],template:function(i,o){1&i&&e.nVh(0,em,22,10,"div",5),2&i&&e.vxM(o.isOpen()?0:-1)},dependencies:[P.MD],encapsulation:2,changeDetection:0})}return n})();const nm=(n,r)=>r.id;function im(n,r){if(1&n){const t=e.RV6();e.rj2(0,"div",4),e.VwU("click",function(){const o=s.eBV(t).$implicit,a=e.XpG();return s.Njj(a.onChipClick(o))}),e.rj2(1,"span"),e.EFF(2),e.rj2(3,"span",5),e.EFF(4),e.eux()(),e.rj2(5,"button",6),e.VwU("click",function(o){const a=s.eBV(t).$implicit,l=e.XpG();return o.stopPropagation(),s.Njj(l.removeChip.emit(a.id))}),e.Hgh(6,"i",7),e.eux()()}if(2&n){const t=r.$implicit;e.AVh("cursor-pointer","count"===t.aggregation&&t.filterValue)("hover:bg-indigo-200","count"===t.aggregation&&t.filterValue)("dark:hover:bg-indigo-800","count"===t.aggregation&&t.filterValue),e.Avn("title","count"===t.aggregation&&t.filterValue?"Click to filter":""),e.R7$(2),e.SpI("",t.label,": "),e.R7$(2),e.JRh(t.displayValue)}}let om=(()=>{class n{chips=f.hFB.required();chipClicked=(0,f.CGW)();removeChip=(0,f.CGW)();addChip=(0,f.CGW)();onChipClick(t){"count"===t.aggregation&&t.filterValue&&this.chipClicked.emit(t)}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-chip-filter-bar"]],inputs:{chips:[1,"chips"]},outputs:{chipClicked:"chipClicked",removeChip:"removeChip",addChip:"addChip"},decls:7,vars:0,consts:[[1,"flex","items-center","gap-2","flex-wrap"],[1,"flex","items-center","gap-2","pl-3","pr-1","py-1","rounded-full","text-xs","font-medium","bg-gray-200","dark:bg-gray-700","text-gray-800","dark:text-gray-200",3,"cursor-pointer","hover:bg-indigo-200","dark:hover:bg-indigo-800","title"],["title","Add another chip",1,"flex","items-center","gap-1.5","px-2","py-1","rounded-full","text-xs","font-medium","border","border-dashed","border-gray-400","dark:border-gray-500","text-gray-600","dark:text-gray-400","hover:bg-gray-100","dark:hover:bg-gray-700",3,"click"],[1,"pi","pi-plus","text-xs"],[1,"flex","items-center","gap-2","pl-3","pr-1","py-1","rounded-full","text-xs","font-medium","bg-gray-200","dark:bg-gray-700","text-gray-800","dark:text-gray-200",3,"click","title"],[1,"font-bold"],["title","Remove chip",1,"p-1","rounded-full","hover:bg-gray-300","dark:hover:bg-gray-600",3,"click"],[1,"pi","pi-times","text-xs"]],template:function(i,o){1&i&&(e.rj2(0,"div",0),e.Z7z(1,im,7,9,"div",1,nm),e.rj2(3,"button",2),e.VwU("click",function(){return o.addChip.emit()}),e.Hgh(4,"i",3),e.rj2(5,"span"),e.EFF(6,"Add"),e.eux()()()),2&i&&(e.R7$(),e.Dyx(o.chips()))},dependencies:[P.MD],encapsulation:2,changeDetection:0})}return n})();class rm{data=[];activeIndex=null;selection=new Set;anchorIndex=null;updateState(r,t,i,o){this.data=r,this.activeIndex=t,this.selection=i,this.anchorIndex=o}handleKeydown(r){if(0===this.data.length)return null;if(r.ctrlKey&&"a"===r.key.toLowerCase())return r.preventDefault(),this.handleSelectAll();const t=["ArrowUp","ArrowDown","Home","End"].includes(r.key),i=[" ","Enter"].includes(r.key);return t||i?(r.preventDefault(),i?this.handleToggleSelection(r.shiftKey):t?this.handleNavigation(r.key,r.shiftKey):null):null}handleSelectAll(){const r=this.activeIndex??0,t=this.anchorIndex??r;return{newActiveIndex:r,newSelection:new Set(this.data.map(i=>i.organization_id)),newAnchorIndex:t}}handleToggleSelection(r){if(null===this.activeIndex&&!r)return null;if(r){const t=this.activeIndex??0,i=this.anchorIndex??t,o=Math.min(i,t),a=Math.max(i,t),l=new Set(this.selection);for(let c=o;c<=a;c++)l.add(this.data[c].organization_id);return{newActiveIndex:t,newSelection:l,newAnchorIndex:i}}{const t=this.activeIndex,i=new Set(this.selection),o=this.data[t].organization_id;return i.has(o)?i.delete(o):i.add(o),{newActiveIndex:t,newSelection:i,newAnchorIndex:t}}}handleNavigation(r,t){const i=this.activeIndex??-1;let o=i;switch(r){case"ArrowUp":o=i<=0?0:i-1;break;case"ArrowDown":o=i<0?0:Math.min(this.data.length-1,i+1);break;case"Home":o=0;break;case"End":o=this.data.length-1}let a=new Set(this.selection),l=this.anchorIndex;if(t){const c=this.anchorIndex??this.activeIndex??0,d=Math.min(c,o),u=Math.max(c,o),p=new Set;for(let g=d;g<=u;g++)p.add(this.data[g].organization_id);a=p}else l=o;return{newActiveIndex:o,newSelection:a,newAnchorIndex:l}}}const an=(n,r)=>r.value;function am(n,r){if(1&n){const t=e.RV6();e.rj2(0,"div",11),e.VwU("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.close.emit())}),e.eux()}}function sm(n,r){if(1&n){const t=e.RV6();e.rj2(0,"button",12),e.VwU("click",function(){const o=s.eBV(t).$implicit,a=e.XpG();return s.Njj(a.themeService.setTheme(o.value))}),e.Hgh(1,"i"),e.rj2(2,"span"),e.EFF(3),e.eux()()}if(2&n){const t=r.$implicit,i=e.XpG();e.HbH(i.themeService.theme()===t.value?"bg-indigo-100 dark:bg-indigo-900/50 text-indigo-700 dark:text-indigo-300":"bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600"),e.AVh("ring-2",i.themeService.theme()===t.value),e.R7$(),e.HbH(t.icon),e.R7$(2),e.JRh(t.label)}}function lm(n,r){if(1&n){const t=e.RV6();e.rj2(0,"button",12),e.VwU("click",function(){const o=s.eBV(t).$implicit,a=e.XpG();return s.Njj(a.themeService.setDirection(o.value))}),e.Hgh(1,"i"),e.rj2(2,"span"),e.EFF(3),e.eux()()}if(2&n){const t=r.$implicit,i=e.XpG();e.HbH(i.themeService.direction()===t.value?"bg-indigo-100 dark:bg-indigo-900/50 text-indigo-700 dark:text-indigo-300":"bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600"),e.AVh("ring-2",i.themeService.direction()===t.value),e.R7$(),e.HbH(t.icon),e.R7$(2),e.JRh(t.label)}}function cm(n,r){if(1&n){const t=e.RV6();e.rj2(0,"button",12),e.VwU("click",function(){const o=s.eBV(t).$implicit,a=e.XpG();return s.Njj(a.themeService.setLayout(o.value))}),e.Hgh(1,"i"),e.rj2(2,"span"),e.EFF(3),e.eux()()}if(2&n){const t=r.$implicit,i=e.XpG();e.HbH(i.themeService.layout()===t.value?"bg-indigo-100 dark:bg-indigo-900/50 text-indigo-700 dark:text-indigo-300":"bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600"),e.AVh("ring-2",i.themeService.layout()===t.value),e.R7$(),e.HbH(t.icon),e.R7$(2),e.JRh(t.label)}}let dm=(()=>{class n{isOpen=f.hFB.required();close=(0,f.CGW)();themeService=(0,s.WQX)(Xi);themes=[{label:"Light",value:"light",icon:"pi pi-sun"},{label:"Dark",value:"dark",icon:"pi pi-moon"},{label:"System",value:"system",icon:"pi pi-desktop"}];directions=[{label:"LTR",value:"ltr",icon:"pi pi-align-left"},{label:"RTL",value:"rtl",icon:"pi pi-align-right"}];layouts=[{label:"Full",value:"full",icon:"pi pi-window-maximize"},{label:"Boxed",value:"box",icon:"pi pi-th-large"}];static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-theme-settings"]],inputs:{isOpen:[1,"isOpen"]},outputs:{close:"close"},decls:26,vars:5,consts:[[1,"fixed","inset-0","bg-black/20","z-40"],[1,"fixed","top-0","right-0","h-full","w-72","bg-white","dark:bg-gray-800","shadow-lg","transform","transition-transform","duration-300","ease-in-out","z-50","border-l","border-gray-200","dark:border-gray-700"],[1,"p-4","border-b","border-gray-200","dark:border-gray-700","flex","justify-between","items-center"],[1,"text-lg","font-semibold","text-gray-800","dark:text-gray-200"],[1,"text-gray-500","hover:text-gray-700","dark:hover:text-gray-300","p-1","rounded-full","hover:bg-gray-100","dark:hover:bg-gray-600","transition-colors",3,"click"],[1,"pi","pi-times","text-sm"],[1,"p-4","space-y-6"],[1,"font-medium","text-gray-700","dark:text-gray-300","mb-2"],[1,"grid","grid-cols-3","gap-2"],[1,"px-3","py-2","text-sm","rounded-md","flex","items-center","justify-center","gap-2","ring-indigo-500","transition-all","focus:outline-none","focus:ring-2","focus:ring-offset-2","dark:focus:ring-offset-gray-800","focus:ring-indigo-500",3,"ring-2","class"],[1,"grid","grid-cols-2","gap-2"],[1,"fixed","inset-0","bg-black/20","z-40",3,"click"],[1,"px-3","py-2","text-sm","rounded-md","flex","items-center","justify-center","gap-2","ring-indigo-500","transition-all","focus:outline-none","focus:ring-2","focus:ring-offset-2","dark:focus:ring-offset-gray-800","focus:ring-indigo-500",3,"click"]],template:function(i,o){1&i&&(e.nVh(0,am,1,0,"div",0),e.rj2(1,"div",1)(2,"div",2)(3,"h2",3),e.EFF(4,"Theme Settings"),e.eux(),e.rj2(5,"button",4),e.VwU("click",function(){return o.close.emit()}),e.Hgh(6,"i",5),e.eux()(),e.rj2(7,"div",6)(8,"div")(9,"h3",7),e.EFF(10,"Color Scheme"),e.eux(),e.rj2(11,"div",8),e.Z7z(12,sm,4,7,"button",9,an),e.eux()(),e.rj2(14,"div")(15,"h3",7),e.EFF(16,"Direction"),e.eux(),e.rj2(17,"div",10),e.Z7z(18,lm,4,7,"button",9,an),e.eux()(),e.rj2(20,"div")(21,"h3",7),e.EFF(22,"Layout Mode"),e.eux(),e.rj2(23,"div",10),e.Z7z(24,cm,4,7,"button",9,an),e.eux()()()()),2&i&&(e.vxM(o.isOpen()?0:-1),e.R7$(),e.AVh("translate-x-0",o.isOpen())("translate-x-full",!o.isOpen()),e.R7$(11),e.Dyx(o.themes),e.R7$(6),e.Dyx(o.directions),e.R7$(6),e.Dyx(o.layouts))},dependencies:[P.MD],encapsulation:2,changeDetection:0})}return n})(),um=(()=>{class n{exportData(t,i,o,a){switch(t){case"csv":this.exportAsCsv(i,o,a);break;case"excel":this.exportAsCsv(i,o,a,"xlsx");break;case"pdf":alert("PDF export is not implemented in this demo."),console.warn("PDF export is not implemented.")}}exportAsCsv(t,i,o,a="csv"){if(!t||0===t.length)return;const c=i.filter(b=>"ACTION"!==b.columnType&&"CHECKBOX"!==b.columnType),p=[c.map(b=>this.escapeCsvCell(b.name)).join(","),...t.map(b=>c.map(S=>{let V;V=S.cellTemplate?S.cellTemplate.filter(h=>"IMAGE"!==h.columnType).map(h=>b[h.code]).join(" "):b[S.code];const y=null==V?"":String(V);return this.escapeCsvCell(y)}).join(","))].join("\n"),g=new Blob(["\ufeff"+p],{type:"text/csv;charset=utf-8;"}),m=document.createElement("a");if(void 0!==m.download){const b=URL.createObjectURL(g);m.setAttribute("href",b);const S=o.replace(/[^a-z0-9]/gi,"_").toLowerCase(),V=(new Date).toISOString().split("T")[0];m.setAttribute("download",`${S}_${V}.${a}`),document.body.appendChild(m),m.click(),document.body.removeChild(m)}}escapeCsvCell(t){return/[",\n]/.test(t)?`"${t.replace(/"/g,'""')}"`:t}static \u0275fac=function(i){return new(i||n)};static \u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const pm=(n,r)=>r.key,mm=(n,r)=>r.src;function gm(n,r){if(1&n&&e.Hgh(0,"img",1),2&n){const t=e.XpG();e.Avn("src",t.imageUrl,e.B4B)}}function _m(n,r){1&n&&e.Hgh(0,"i",2)}function fm(n,r){if(1&n&&e.Hgh(0,"i"),2&n){const t=e.XpG().$implicit;e.HbH(t.icon+" mr-2")}}function hm(n,r){if(1&n){const t=e.RV6();e.rj2(0,"button",8),e.VwU("click",function(){const o=s.eBV(t).$implicit,a=e.XpG(3);return s.Njj(a.action.emit(o.key))}),e.nVh(1,fm,1,2,"i",9),e.rj2(2,"span"),e.EFF(3),e.eux()()}if(2&n){const t=r.$implicit;e.HbH(t.class||"bg-indigo-600 hover:bg-indigo-700 text-white"),e.R7$(),e.vxM(t.icon?1:-1),e.R7$(2),e.JRh(t.label)}}function bm(n,r){if(1&n&&(e.rj2(0,"div",5),e.Z7z(1,hm,4,4,"button",7,pm),e.eux()),2&n){const t=e.XpG();e.R7$(),e.Dyx(t.actions)}}function ym(n,r){if(1&n&&e.Hgh(0,"img",12),2&n){const t=r.$implicit;e.Avn("src",t.src,e.B4B)("alt",t.alt)}}function vm(n,r){if(1&n&&(e.rj2(0,"span",13),e.EFF(1),e.eux()),2&n){const t=e.XpG(2);e.R7$(),e.JRh(t.migration.moreText)}}function Cm(n,r){if(1&n&&e.Hgh(0,"i"),2&n){const t=e.XpG(3);e.HbH(t.migration.action.icon+" mr-2")}}function xm(n,r){if(1&n){const t=e.RV6();e.rj2(0,"div",14)(1,"button",15),e.VwU("click",function(){s.eBV(t);const o=e.XpG(2),a=e.XpG();return s.Njj(a.action.emit(o.migration.action.key))}),e.nVh(2,Cm,1,2,"i",9),e.rj2(3,"span"),e.EFF(4),e.eux()()()}if(2&n){const t=e.XpG(2);e.R7$(),e.HbH(t.migration.action.class||"bg-cyan-500 hover:bg-cyan-600 text-white"),e.R7$(),e.vxM(t.migration.action.icon?2:-1),e.R7$(2),e.JRh(t.migration.action.label)}}function wm(n,r){if(1&n&&(e.rj2(0,"div",6)(1,"p",10),e.EFF(2),e.eux(),e.rj2(3,"div",11),e.Z7z(4,ym,1,2,"img",12,mm),e.nVh(6,vm,2,1,"span",13),e.eux(),e.nVh(7,xm,5,4,"div",14),e.eux()),2&n){const t=e.XpG();e.R7$(2),e.JRh(t.migration.title),e.R7$(2),e.Dyx(t.migration.logos),e.R7$(2),e.vxM(t.migration.moreText?6:-1),e.R7$(),e.vxM(t.migration.action?7:-1)}}function km(n,r){if(1&n&&(e.rj2(0,"div",0),e.nVh(1,gm,1,1,"img",1)(2,_m,1,0,"i",2),e.rj2(3,"h2",3),e.EFF(4),e.eux(),e.rj2(5,"p",4),e.EFF(6),e.eux(),e.nVh(7,bm,3,0,"div",5),e.nVh(8,wm,8,3,"div",6),e.eux()),2&n){const t=r;e.R7$(),e.vxM(t.imageUrl?1:2),e.R7$(3),e.JRh(t.title),e.R7$(2),e.JRh(t.subtitle),e.R7$(),e.vxM(t.actions&&t.actions.length>0?7:-1),e.R7$(),e.vxM(null!=t.migration&&t.migration.enabled?8:-1)}}let Sm=(()=>{class n{config=f.hFB.required();action=(0,f.CGW)();static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-empty-view"]],inputs:{config:[1,"config"]},outputs:{action:"action"},decls:1,vars:1,consts:[[1,"flex","flex-col","items-center","justify-center","h-full","text-center","p-8"],["alt","",1,"h-40","w-40","mb-6","text-gray-400",3,"src"],[1,"pi","pi-inbox","text-6xl","text-gray-400","dark:text-gray-500","mb-6"],[1,"text-2xl","font-semibold","text-gray-800","dark:text-white"],[1,"mt-2","max-w-lg","text-gray-600","dark:text-gray-400"],[1,"mt-8","flex","items-center","justify-center","gap-4"],[1,"mt-12","p-8","rounded-lg","bg-cyan-50","dark:bg-cyan-900/20","w-full","max-w-2xl","border","border-cyan-200","dark:border-cyan-800"],[1,"px-5","py-2.5","text-sm","font-semibold","rounded-md","shadow-sm","focus-visible:outline","focus-visible:outline-2","focus-visible:outline-offset-2","focus-visible:outline-indigo-600","flex","items-center",3,"class"],[1,"px-5","py-2.5","text-sm","font-semibold","rounded-md","shadow-sm","focus-visible:outline","focus-visible:outline-2","focus-visible:outline-offset-2","focus-visible:outline-indigo-600","flex","items-center",3,"click"],[3,"class"],[1,"font-medium","text-gray-700","dark:text-cyan-200"],[1,"mt-4","flex","justify-center","items-center","gap-6","flex-wrap"],[1,"h-8","object-contain",3,"src","alt"],[1,"text-sm","text-gray-600","dark:text-gray-400"],[1,"mt-8"],[1,"px-8","py-2.5","text-sm","font-semibold","rounded-md","shadow-sm","focus-visible:outline","focus-visible:outline-2","focus-visible:outline-offset-2","focus-visible:outline-cyan-600","flex","items-center","mx-auto",3,"click"]],template:function(i,o){if(1&i&&e.nVh(0,km,9,5,"div",0),2&i){let a;e.vxM((a=o.config())?0:-1,a)}},dependencies:[P.MD],encapsulation:2,changeDetection:0})}return n})();const Fm=["scrollContainer"],Tm=()=>[1,2,3,4,5,6],zi=(n,r)=>r.key;function Mm(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",42),e.bIt("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.handleManualSync())}),e.nrm(1,"i",43),e.j41(2,"span"),e.EFF(3),e.k0s()()}if(2&n){const t=e.XpG(2);e.Y8G("disabled",t.syncService.isSyncing()),e.R7$(),e.AVh("pi-sync",!t.syncService.isSyncing())("pi-spin",t.syncService.isSyncing())("pi-spinner",t.syncService.isSyncing()),e.R7$(2),e.JRh(t.syncService.isSyncing()?"Syncing...":"Sync Now")}}function jm(n,r){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.label)}}function Rm(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",44),e.bIt("click",function(){const o=s.eBV(t).$implicit,a=e.XpG(2);return s.Njj(a.handleToolbarAction(o.key))}),e.nrm(1,"i"),e.nVh(2,jm,2,1,"span"),e.k0s()}if(2&n){const t=r.$implicit,i=e.XpG(),o=e.XpG();e.AVh("bg-slate-900","toggle:filter-sidebar"===t.key&&o.showFilterSidebar()||"toggle:config-sidebar"===t.key&&o.showConfigSidebar())("text-white","toggle:filter-sidebar"===t.key&&o.showFilterSidebar()||"toggle:config-sidebar"===t.key&&o.showConfigSidebar())("!bg-indigo-600","add:contacts"===t.key)("!text-white","add:contacts"===t.key),e.Y8G("title","iconOnly"===i.config.toolbarButtonMode?t.label:"toggle:filter-sidebar"===t.key?"Toggle Advanced Filters (Alt + S)":t.label),e.R7$(),e.HbH(t.icon),e.R7$(),e.vxM("iconOnly"!==i.config.toolbarButtonMode?2:-1)}}function Vm(n,r){if(1&n){const t=e.RV6();e.j41(0,"button",45),e.bIt("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.showAddChipModal.set(!0))}),e.nrm(1,"i",46),e.j41(2,"span"),e.EFF(3,"Chips"),e.k0s()()}}function Dm(n,r){1&n&&e.nrm(0,"i",53)}function Am(n,r){if(1&n){const t=e.RV6();e.j41(0,"a",52),e.bIt("click",function(){const o=s.eBV(t).$implicit,a=e.XpG(4);return a.handleCardsPerRowChange(o),s.Njj(a.showCardsPerRowChooser.set(!1))}),e.j41(1,"span"),e.EFF(2),e.k0s(),e.nVh(3,Dm,1,0,"i",53),e.k0s()}if(2&n){const t=r.$implicit,i=e.XpG(3);e.R7$(2),e.Lme("",t," ",1===t?"Card":"Cards"," / row"),e.R7$(),e.vxM(((null==i.config.cardViewConfig?null:i.config.cardViewConfig.cardsPerRow)??4)===t?3:-1)}}function Nm(n,r){1&n&&(e.j41(0,"div",49)(1,"div",50),e.Z7z(2,Am,4,3,"a",51,e.fX1),e.k0s()()),2&n&&(e.R7$(2),e.Dyx(e.lJ4(0,Tm)))}function Em(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",14),e.bIt("clickOutside",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.showCardsPerRowChooser.set(!1))}),e.j41(1,"button",47),e.bIt("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.showCardsPerRowChooser.set(!o.showCardsPerRowChooser()))}),e.nrm(2,"i",48),e.j41(3,"span"),e.EFF(4),e.k0s()(),e.nVh(5,Nm,4,1,"div",49),e.k0s()}if(2&n){const t=e.XpG(),i=e.XpG();e.R7$(),e.AVh("bg-slate-900",i.showCardsPerRowChooser())("text-white",i.showCardsPerRowChooser()),e.R7$(3),e.SpI("",(null==t.config.cardViewConfig?null:t.config.cardViewConfig.cardsPerRow)??4," Cards"),e.R7$(),e.vxM(i.showCardsPerRowChooser()?5:-1)}}function $m(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",18)(1,"div",50)(2,"a",56),e.bIt("click",function(){s.eBV(t);const o=e.XpG(3);return s.Njj(o.handleFreezeColumns(0))}),e.EFF(3,"Unfreeze All"),e.k0s(),e.j41(4,"a",56),e.bIt("click",function(){s.eBV(t);const o=e.XpG(3);return s.Njj(o.handleFreezeColumns(1))}),e.EFF(5,"Freeze 1 Column"),e.k0s(),e.j41(6,"a",56),e.bIt("click",function(){s.eBV(t);const o=e.XpG(3);return s.Njj(o.handleFreezeColumns(2))}),e.EFF(7,"Freeze 2 Columns"),e.k0s(),e.j41(8,"a",56),e.bIt("click",function(){s.eBV(t);const o=e.XpG(3);return s.Njj(o.handleFreezeColumns(3))}),e.EFF(9,"Freeze 3 Columns"),e.k0s()()()}}function Gm(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",14),e.bIt("clickOutside",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.showFreezeOptions.set(!1))}),e.j41(1,"button",54),e.bIt("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.showFreezeOptions.set(!o.showFreezeOptions()))}),e.nrm(2,"i",55),e.j41(3,"span"),e.EFF(4,"Freeze"),e.k0s()(),e.nVh(5,$m,10,0,"div",18),e.k0s()}if(2&n){const t=e.XpG(2);e.R7$(),e.AVh("bg-slate-900",t.showFreezeOptions())("text-white",t.showFreezeOptions()),e.R7$(4),e.vxM(t.showFreezeOptions()?5:-1)}}function Im(n,r){if(1&n){const t=e.RV6();e.j41(0,"app-column-chooser",60),e.bIt("visibilityChange",function(o){s.eBV(t);const a=e.XpG(3);return s.Njj(a.toggleColumnVisibility(o))})("orderChange",function(o){s.eBV(t);const a=e.XpG(3);return s.Njj(a.handleAllColumnsOrderChange(o))}),e.k0s()}if(2&n){const t=e.XpG(3);e.Y8G("allColumns",t.chooserColumns())("visibleColumns",t.visibleTableColumns())}}function Xm(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",14),e.bIt("clickOutside",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.showColumnChooser.set(!1))}),e.j41(1,"button",57),e.bIt("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.showColumnChooser.set(!o.showColumnChooser()))}),e.nrm(2,"i",58),e.j41(3,"span"),e.EFF(4,"Columns"),e.k0s()(),e.nVh(5,Im,1,2,"app-column-chooser",59),e.k0s()}if(2&n){const t=e.XpG(2);e.R7$(),e.AVh("bg-slate-900",t.showColumnChooser())("text-white",t.showColumnChooser()),e.R7$(4),e.vxM(t.showColumnChooser()?5:-1)}}function Bm(n,r){1&n&&e.nrm(0,"i",53)}function zm(n,r){if(1&n){const t=e.RV6();e.j41(0,"a",62),e.bIt("click",function(){const o=s.eBV(t).$implicit,a=e.XpG(3);return a.changeDataStrategy(o),s.Njj(a.showStrategyChooser.set(!1))}),e.j41(1,"span"),e.EFF(2),e.k0s(),e.nVh(3,Bm,1,0,"i",53),e.k0s()}if(2&n){const t=r.$implicit,i=e.XpG(2),o=e.XpG();e.Y8G("title",o.strategyDescriptions[t]),e.R7$(2),e.JRh(t),e.R7$(),e.vxM(i.config.dataStrategy===t?3:-1)}}function Om(n,r){if(1&n&&(e.j41(0,"div",18)(1,"div",50),e.Z7z(2,zm,4,3,"a",61,e.fX1),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(2),e.Dyx(t.dataStrategies)}}function Pm(n,r){if(1&n){const t=e.RV6();e.j41(0,"a",65),e.bIt("click",function(){const o=s.eBV(t).$implicit,a=e.XpG(4);return s.Njj(a.handleExport(o.key))}),e.nrm(1,"i"),e.j41(2,"span"),e.EFF(3),e.k0s()()}if(2&n){const t=r.$implicit;e.R7$(),e.HbH(t.icon),e.R7$(2),e.JRh(t.label)}}function Lm(n,r){if(1&n&&(e.j41(0,"div",49)(1,"div",50),e.Z7z(2,Pm,4,3,"a",64,zi),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(2),e.Dyx(t.config.exportConfig.options)}}function Hm(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",14),e.bIt("clickOutside",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.showExportOptions.set(!1))}),e.j41(1,"button",19),e.bIt("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.showExportOptions.set(!o.showExportOptions()))}),e.nrm(2,"i",63),e.j41(3,"span"),e.EFF(4,"Export"),e.k0s(),e.nrm(5,"i",17),e.k0s(),e.nVh(6,Lm,4,0,"div",49),e.k0s()}if(2&n){const t=e.XpG(2);e.R7$(),e.AVh("bg-slate-900",t.showExportOptions())("text-white",t.showExportOptions()),e.R7$(4),e.AVh("rotate-180",t.showExportOptions()),e.R7$(),e.vxM(t.showExportOptions()?6:-1)}}function Um(n,r){1&n&&e.nrm(0,"i",53)}function Wm(n,r){1&n&&e.nrm(0,"i",53)}function Ym(n,r){1&n&&e.nrm(0,"i",53)}function Qm(n,r){1&n&&e.nrm(0,"i",53)}function Jm(n,r){1&n&&e.nrm(0,"i",53)}function Zm(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",21)(1,"div",50)(2,"a",52),e.bIt("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.changeView("table"))}),e.j41(3,"span",66),e.nrm(4,"i",48),e.EFF(5," Table"),e.k0s(),e.nVh(6,Um,1,0,"i",53),e.k0s(),e.j41(7,"a",52),e.bIt("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.changeView("card"))}),e.j41(8,"span",66),e.nrm(9,"i",67),e.EFF(10," Card"),e.k0s(),e.nVh(11,Wm,1,0,"i",53),e.k0s(),e.j41(12,"a",52),e.bIt("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.changeView("list"))}),e.j41(13,"span",66),e.nrm(14,"i",68),e.EFF(15," List"),e.k0s(),e.nVh(16,Ym,1,0,"i",53),e.k0s(),e.nrm(17,"div",69),e.j41(18,"a",52),e.bIt("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.changeView("bi"))}),e.j41(19,"span",66),e.nrm(20,"i",70),e.EFF(21," BI Dashboard"),e.k0s(),e.nVh(22,Qm,1,0,"i",53),e.k0s(),e.j41(23,"a",52),e.bIt("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.changeView("calendar"))}),e.j41(24,"span",66),e.nrm(25,"i",71),e.EFF(26," Calendar"),e.k0s(),e.nVh(27,Jm,1,0,"i",53),e.k0s(),e.nrm(28,"div",69),e.j41(29,"a",65),e.bIt("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.resetViewAndFilters())}),e.nrm(30,"i",72),e.j41(31,"span"),e.EFF(32,"Reset View & Filters"),e.k0s()()()()}if(2&n){const t=e.XpG(2);e.R7$(6),e.vxM("table"===t.viewMode()?6:-1),e.R7$(5),e.vxM("card"===t.viewMode()?11:-1),e.R7$(5),e.vxM("list"===t.viewMode()?16:-1),e.R7$(6),e.vxM("bi"===t.viewMode()?22:-1),e.R7$(5),e.vxM("calendar"===t.viewMode()?27:-1)}}function qm(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",21)(1,"div",50)(2,"a",65),e.bIt("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.handleAiAction("adopt"))}),e.nrm(3,"i",73),e.j41(4,"span"),e.EFF(5,"Auto-Adopt Layout"),e.k0s()(),e.j41(6,"a",65),e.bIt("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.handleAiAction("narrate"))}),e.nrm(7,"i",74),e.j41(8,"span"),e.EFF(9,"Generate Narration"),e.k0s()(),e.j41(10,"a",65),e.bIt("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.handleAiAction("insights"))}),e.nrm(11,"i",75),e.j41(12,"span"),e.EFF(13,"Suggest Insights"),e.k0s()(),e.j41(14,"a",65),e.bIt("click",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.handleAiAction("metrics"))}),e.nrm(15,"i",76),e.j41(16,"span"),e.EFF(17,"Get Quick Metrics"),e.k0s()(),e.nrm(18,"div",69),e.j41(19,"a",65),e.bIt("click",function(){s.eBV(t);const o=e.XpG(2);return o.showUiGallery.set(!0),s.Njj(o.showAiActions.set(!1))}),e.nrm(20,"i",77),e.j41(21,"span"),e.EFF(22,"Customize UI..."),e.k0s()()()()}}function Km(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",28)(1,"app-chip-filter-bar",78),e.bIt("addChip",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.showAddChipModal.set(!0))})("removeChip",function(o){s.eBV(t);const a=e.XpG(2);return s.Njj(a.handleRemoveChip(o))})("chipClicked",function(o){s.eBV(t);const a=e.XpG(2);return s.Njj(a.handleApplyChipFilter(o))}),e.k0s()()}if(2&n){const t=e.XpG(2);e.R7$(),e.Y8G("chips",t.calculatedChips())}}function eg(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",29)(1,"app-paginator",79),e.bIt("pageChange",function(o){s.eBV(t);const a=e.XpG(2);return s.Njj(a.handlePageChange(o))})("pageSizeChange",function(o){s.eBV(t);const a=e.XpG(2);return s.Njj(a.handlePageSizeChange(o))})("autoSizingToggle",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.handleAutoSizingToggle())})("chatbotToggle",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.showChatbot.set(!0))}),e.k0s()()}if(2&n){const t=e.XpG(),i=e.XpG();e.R7$(),e.Y8G("currentPage",i.currentPage())("pageSize",i.pageSize())("totalRecords",i.totalRecords())("autoSizingEnabled",i.autoSizingEnabled())("infiniteScroll",i.isInfiniteScroll())("infiniteScrollBehavior",t.config.infiniteScrollBehavior??"append")("currentRecordCount",i.data().length)("dataStrategy",t.config.dataStrategy)("connectionStatus",i.connectionStatus())("lastSyncTime",i.syncService.lastSyncTime())("isSyncing",i.syncService.isSyncing())}}function tg(n,r){if(1&n&&e.nrm(0,"app-table-skeleton-loader",80),2&n){const t=e.XpG(3);e.Y8G("columns",t.visibleTableColumns())("rows",t.pageSize())}}function ng(n,r){if(1&n&&e.nrm(0,"app-card-skeleton-loader",81),2&n){const t=e.XpG(3);e.Y8G("count",t.pageSize())}}function ig(n,r){if(1&n&&e.nrm(0,"app-list-skeleton-loader",81),2&n){const t=e.XpG(3);e.Y8G("count",t.pageSize())}}function og(n,r){1&n&&(e.j41(0,"div",82),e.EFF(1,"Loading..."),e.k0s())}function rg(n,r){if(1&n&&e.nVh(0,tg,1,2,"app-table-skeleton-loader",80)(1,ng,1,1,"app-card-skeleton-loader",81)(2,ig,1,1,"app-list-skeleton-loader",81)(3,og,2,0,"div",82),2&n){let t;const i=e.XpG(2);e.vxM("table"===(t=i.viewMode())?0:"card"===t?1:"list"===t?2:3)}}function ag(n,r){if(1&n){const t=e.RV6();e.j41(0,"app-empty-view",85),e.bIt("action",function(o){s.eBV(t);const a=e.XpG(3);return s.Njj(a.handleEmptyStateAction(o))}),e.k0s()}if(2&n){const t=e.XpG(2);e.Y8G("config",t.config.emptyStateConfig)}}function sg(n,r){1&n&&(e.j41(0,"div",84),e.nrm(1,"i",86),e.j41(2,"span",87),e.EFF(3,"No Records Found"),e.k0s()())}function lg(n,r){if(1&n&&e.nVh(0,ag,1,1,"app-empty-view",83)(1,sg,4,0,"div",84),2&n){const t=e.XpG();e.vxM(null!=t.config.emptyStateConfig&&t.config.emptyStateConfig.enabled?0:1)}}function cg(n,r){if(1&n){const t=e.RV6();e.j41(0,"app-table-view",91),e.bIt("sortChange",function(o){s.eBV(t);const a=e.XpG(3);return s.Njj(a.handleSort(o))})("rowAction",function(o){s.eBV(t);const a=e.XpG(3);return s.Njj(a.handleRowAction(o))})("rowClicked",function(o){s.eBV(t);const a=e.XpG(3);return s.Njj(a.handleRowClick(o))})("headerAction",function(o){s.eBV(t);const a=e.XpG(3);return s.Njj(a.handleHeaderAction(o))})("columnReorder",function(o){s.eBV(t);const a=e.XpG(3);return s.Njj(a.handleVisibleColumnReorder(o))})("filterChange",function(o){s.eBV(t);const a=e.XpG(3);return s.Njj(a.handleFilterChange(o))})("selectionChange",function(o){s.eBV(t);const a=e.XpG(3);return s.Njj(a.handleSelectionChange(o))}),e.k0s()}if(2&n){const t=e.XpG(2),i=e.XpG();e.Y8G("columns",i.visibleTableColumns())("data",i.data())("sortColumn",i.sortColumn())("sortDirection",i.sortDirection())("density",i.currentDensity())("densityClass",i.currentDensitySetting().cssClass)("rowMenuConfig",t.rowMenu)("rowActions",t.rowActions)("headerMenuConfig",t.headerMenu)("enableMultiSelect",t.config.enableMultiSelect??!1)("selectedIds",i.selectedIds())("activeFilters",i.advancedFilters())("customTemplate",i.activeCustomTemplate())("loading",i.loading())("keyboardActiveRowIndex",i.keyboardActiveRowIndex())("pageSize",i.pageSize())("isInfiniteScroll",i.isInfiniteScroll())("stripedRows",t.config.stripedRows??!0)("showGridlines",t.config.showGridlines??!1)("rowHover",t.config.rowHover??!0)("footerConfig",t.config.footerConfig)}}function dg(n,r){if(1&n){const t=e.RV6();e.j41(0,"app-card-view",92),e.bIt("selectionChange",function(o){s.eBV(t);const a=e.XpG(3);return s.Njj(a.handleSelectionChange(o))})("rowAction",function(o){s.eBV(t);const a=e.XpG(3);return s.Njj(a.handleRowAction(o))})("rowClicked",function(o){s.eBV(t);const a=e.XpG(3);return s.Njj(a.handleRowClick(o))}),e.k0s()}if(2&n){const t=e.XpG(2),i=e.XpG();e.Y8G("columns",i.allTableColumns())("data",i.data())("density",i.currentDensity())("densityClass",i.currentDensitySetting().cssClass)("selectedIds",i.selectedIds())("rowMenuConfig",t.rowMenu)("rowActions",t.rowActions)("enableMultiSelect",t.config.enableMultiSelect??!1)("cardViewConfig",t.config.cardViewConfig)("customTemplate",i.activeCustomTemplate())("keyboardActiveRowIndex",i.keyboardActiveRowIndex())}}function ug(n,r){if(1&n){const t=e.RV6();e.j41(0,"app-list-view",93),e.bIt("selectionChange",function(o){s.eBV(t);const a=e.XpG(3);return s.Njj(a.handleSelectionChange(o))})("rowClicked",function(o){s.eBV(t);const a=e.XpG(3);return s.Njj(a.handleRowClick(o))}),e.k0s()}if(2&n){const t=e.XpG(2),i=e.XpG();e.Y8G("columns",i.allTableColumns())("data",i.data())("density",i.currentDensity())("densityClass",i.currentDensitySetting().cssClass)("selectedIds",i.selectedIds())("enableMultiSelect",t.config.enableMultiSelect??!1)("customTemplate",i.activeCustomTemplate())("keyboardActiveRowIndex",i.keyboardActiveRowIndex())}}function pg(n,r){if(1&n&&e.nrm(0,"app-bi-view",36),2&n){const t=e.XpG(3);e.Y8G("data",t.data())("columns",t.allTableColumns())}}function mg(n,r){if(1&n&&e.nrm(0,"app-calendar-view",94),2&n){const t=e.XpG(4);e.Y8G("data",t.data())("columns",t.allTableColumns())("config",r)}}function gg(n,r){1&n&&(e.j41(0,"div",95),e.EFF(1,"Please configure the calendar view first by clicking the 'Calendar' view button again."),e.k0s())}function _g(n,r){if(1&n&&e.nVh(0,mg,1,3,"app-calendar-view",94)(1,gg,2,0,"div",95),2&n){let t;const i=e.XpG(3);e.vxM((t=i.activeCalendarConfig())?0:1,t)}}function fg(n,r){if(1&n&&e.nVh(0,cg,1,21,"app-table-view",88)(1,dg,1,11,"app-card-view",89)(2,ug,1,8,"app-list-view",90)(3,pg,1,2,"app-bi-view",36)(4,_g,2,1),2&n){let t;const i=e.XpG(2);e.vxM("table"===(t=i.viewMode())?0:"card"===t?1:"list"===t?2:"bi"===t?3:"calendar"===t?4:-1)}}function hg(n,r){1&n&&(e.j41(0,"div",31),e.nrm(1,"i",96),e.k0s())}function bg(n,r){if(1&n){const t=e.RV6();e.j41(0,"footer",32)(1,"app-paginator",79),e.bIt("pageChange",function(o){s.eBV(t);const a=e.XpG(2);return s.Njj(a.handlePageChange(o))})("pageSizeChange",function(o){s.eBV(t);const a=e.XpG(2);return s.Njj(a.handlePageSizeChange(o))})("autoSizingToggle",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.handleAutoSizingToggle())})("chatbotToggle",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.showChatbot.set(!0))}),e.k0s()()}if(2&n){const t=e.XpG(),i=e.XpG();e.R7$(),e.Y8G("currentPage",i.currentPage())("pageSize",i.pageSize())("totalRecords",i.totalRecords())("autoSizingEnabled",i.autoSizingEnabled())("infiniteScroll",i.isInfiniteScroll())("infiniteScrollBehavior",t.config.infiniteScrollBehavior??"append")("currentRecordCount",i.data().length)("dataStrategy",t.config.dataStrategy)("connectionStatus",i.connectionStatus())("lastSyncTime",i.syncService.lastSyncTime())("isSyncing",i.syncService.isSyncing())}}function yg(n,r){if(1&n){const t=e.RV6();e.j41(0,"app-filter-sidebar",97),e.bIt("close",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.showFilterSidebar.set(!1))})("apply",function(o){s.eBV(t);const a=e.XpG(2);return s.Njj(a.handleApplyFilters(o))}),e.k0s()}if(2&n){const t=e.XpG(),i=e.XpG();e.Y8G("isOpen",i.showFilterSidebar())("config",t.advancedFilters)("activeFilters",i.advancedFilters())}}function vg(n,r){if(1&n){const t=e.RV6();e.j41(0,"app-config-sidebar",98),e.bIt("close",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.showConfigSidebar.set(!1))})("save",function(o){s.eBV(t);const a=e.XpG(2);return s.Njj(a.handleConfigSave(o))})("resetToDefaults",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.handleConfigReset())}),e.k0s()}if(2&n){const t=e.XpG(2);e.Y8G("isOpen",t.showConfigSidebar())("config",t.config())}}function Cg(n,r){if(1&n){const t=e.RV6();e.j41(0,"app-ai-chatbot",99),e.bIt("close",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.showChatbot.set(!1))})("filterApplied",function(o){s.eBV(t);const a=e.XpG(2);return s.Njj(a.handleAiFilter(o))}),e.k0s()}if(2&n){const t=e.XpG(2);e.Y8G("data",t.data())("columns",t.allTableColumns())}}function xg(n,r){if(1&n){const t=e.RV6();e.j41(0,"app-sync-options-modal",100),e.bIt("close",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.showSyncOptionsModal.set(!1))})("startSync",function(){s.eBV(t);const o=e.XpG(2);return s.Njj(o.handleStartSync())}),e.k0s()}}function wg(n,r){1&n&&(e.j41(0,"div",101),e.nrm(1,"i",103),e.j41(2,"p",104),e.EFF(3,"AI is thinking..."),e.k0s()())}function kg(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",105),e.bIt("click",function(o){return s.eBV(t),s.Njj(o.stopPropagation())}),e.j41(1,"header",106)(2,"h3",107),e.nrm(3,"i",108),e.EFF(4),e.k0s(),e.j41(5,"button",109),e.bIt("click",function(){s.eBV(t);const o=e.XpG(3);return s.Njj(o.aiModalContent.set(null))}),e.nrm(6,"i",110),e.k0s()(),e.nrm(7,"div",111),e.k0s()}if(2&n){const t=e.XpG(3);e.R7$(4),e.JRh(t.aiModalFormattedContent().title),e.R7$(3),e.Y8G("innerHTML",t.aiModalFormattedContent().content,e.npT)}}function Sg(n,r){if(1&n&&(e.j41(0,"div",41),e.nVh(1,wg,4,0,"div",101),e.nVh(2,kg,8,2,"div",102),e.k0s()),2&n){let t;const i=e.XpG(2);e.R7$(),e.vxM(i.isAiLoading()&&!i.aiModalContent()?1:-1),e.R7$(),e.vxM((t=i.aiModalContent())?2:-1,t)}}function Fg(n,r){if(1&n&&(e.j41(0,"div",41)(1,"div",112),e.nrm(2,"i",103),e.j41(3,"p",104),e.EFF(4),e.k0s()()()),2&n){const t=e.XpG(2);e.R7$(4),e.JRh(t.exportingMessage())}}function Tg(n,r){if(1&n){const t=e.RV6();e.j41(0,"div",1)(1,"header",2)(2,"div",3)(3,"div",4)(4,"h1",5),e.EFF(5),e.k0s(),e.j41(6,"div",6),e.EFF(7),e.k0s()(),e.j41(8,"div",7)(9,"div",8),e.nVh(10,Mm,4,8,"button",9),e.Z7z(11,Rm,3,12,"button",10,zi),e.nVh(13,Vm,4,0,"button",11),e.nrm(14,"div",12)(15,"app-density-chooser"),e.nVh(16,Em,6,6,"div",13),e.nVh(17,Gm,6,5,"div",13),e.nVh(18,Xm,6,5,"div",13),e.j41(19,"div",14),e.bIt("clickOutside",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.showStrategyChooser.set(!1))}),e.j41(20,"button",15),e.bIt("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.showStrategyChooser.set(!o.showStrategyChooser()))}),e.nrm(21,"i",16),e.j41(22,"span"),e.EFF(23),e.k0s(),e.nrm(24,"i",17),e.k0s(),e.nVh(25,Om,4,0,"div",18),e.k0s(),e.nVh(26,Hm,7,7,"div",13),e.j41(27,"div",14),e.bIt("clickOutside",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.showViewOptions.set(!1))}),e.j41(28,"button",19),e.bIt("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.showViewOptions.set(!o.showViewOptions()))}),e.nrm(29,"i",20),e.j41(30,"span"),e.EFF(31,"View"),e.k0s(),e.nrm(32,"i",17),e.k0s(),e.nVh(33,Zm,33,5,"div",21),e.k0s(),e.j41(34,"div",14),e.bIt("clickOutside",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.showAiActions.set(!1))}),e.j41(35,"button",22),e.bIt("click",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.showAiActions.set(!o.showAiActions()))}),e.nrm(36,"i",23),e.k0s(),e.nVh(37,qm,23,0,"div",21),e.k0s()()(),e.j41(38,"div",24)(39,"div",25),e.nrm(40,"i",26),e.k0s(),e.j41(41,"input",27),e.bIt("input",function(o){s.eBV(t);const a=e.XpG();return s.Njj(a.onGlobalSearch(o))}),e.k0s()()(),e.nVh(42,Km,2,1,"div",28),e.k0s(),e.nVh(43,eg,2,11,"div",29),e.j41(44,"main",30,0),e.bIt("scroll",function(o){s.eBV(t);const a=e.XpG();return s.Njj(a.onContentScroll(o))})("keydown",function(o){s.eBV(t);const a=e.XpG();return s.Njj(a.handleContentKeydown(o))}),e.nVh(46,rg,4,1)(47,lg,2,1)(48,fg,5,1),e.nVh(49,hg,2,0,"div",31),e.k0s(),e.nVh(50,bg,2,11,"footer",32),e.k0s(),e.nVh(51,yg,1,3,"app-filter-sidebar",33),e.nVh(52,vg,1,2,"app-config-sidebar",34),e.j41(53,"app-theme-settings",35),e.bIt("close",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.showThemeSettings.set(!1))}),e.k0s(),e.nVh(54,Cg,1,2,"app-ai-chatbot",36),e.j41(55,"app-save-query-modal",37),e.bIt("close",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.showSaveQueryModal.set(!1))})("save",function(o){s.eBV(t);const a=e.XpG();return s.Njj(a.handleSaveQuery(o))}),e.k0s(),e.j41(56,"app-ui-gallery",38),e.bIt("close",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.showUiGallery.set(!1))})("applyLayout",function(o){s.eBV(t);const a=e.XpG();return s.Njj(a.handleApplyLayout(o))})("deleteLayout",function(o){s.eBV(t);const a=e.XpG();return s.Njj(a.handleDeleteLayout(o))})("generateLayout",function(o){s.eBV(t);const a=e.XpG();return s.Njj(a.handleGenerateLayout(o))}),e.k0s(),e.j41(57,"app-calendar-config-modal",39),e.bIt("close",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.showCalendarConfigModal.set(!1))})("apply",function(o){s.eBV(t);const a=e.XpG();return s.Njj(a.handleApplyCalendarConfig(o))}),e.k0s(),e.nVh(58,xg,1,0,"app-sync-options-modal"),e.j41(59,"app-add-chip-modal",40),e.bIt("close",function(){s.eBV(t);const o=e.XpG();return s.Njj(o.showAddChipModal.set(!1))})("addChip",function(o){s.eBV(t);const a=e.XpG();return s.Njj(a.handleAddChip(o))}),e.k0s(),e.nVh(60,Sg,3,2,"div",41),e.nVh(61,Fg,5,1,"div",41)}if(2&n){const t=r,i=e.XpG();e.R7$(5),e.JRh(t.config.title),e.R7$(2),e.SpI(" ",i.totalRecords()," "),e.R7$(3),e.vxM("SYNC"===t.config.dataStrategy?10:-1),e.R7$(),e.Dyx(t.config.toolbarActions),e.R7$(2),e.vxM(t.config.enableChipFilters?13:-1),e.R7$(3),e.vxM("card"===i.viewMode()?16:-1),e.R7$(),e.vxM("table"===i.viewMode()&&t.config.enableFreeze?17:-1),e.R7$(),e.vxM(t.config.enableColumnChooser?18:-1),e.R7$(2),e.Y8G("title","Current Data Strategy: "+t.config.dataStrategy),e.R7$(3),e.JRh(t.config.dataStrategy),e.R7$(),e.AVh("rotate-180",i.showStrategyChooser()),e.R7$(),e.vxM(i.showStrategyChooser()?25:-1),e.R7$(),e.vxM(null!=t.config.exportConfig&&t.config.exportConfig.enabled?26:-1),e.R7$(2),e.AVh("bg-slate-900",i.showViewOptions())("text-white",i.showViewOptions()),e.R7$(4),e.AVh("rotate-180",i.showViewOptions()),e.R7$(),e.vxM(i.showViewOptions()?33:-1),e.R7$(4),e.vxM(i.showAiActions()?37:-1),e.R7$(4),e.Y8G("value",i.globalFilterTerm()),e.R7$(),e.vxM(t.config.enableChipFilters&&i.calculatedChips().length>0?42:-1),e.R7$(),e.vxM(i.isInfiniteScroll()||"top"!==t.config.paginatorPosition&&"both"!==t.config.paginatorPosition?-1:43),e.R7$(3),e.vxM(i.loading()&&0===i.data().length?46:0===i.data().length?47:48),e.R7$(3),e.vxM(i.isInfiniteScroll()&&i.loading()&&i.data().length>0?49:-1),e.R7$(),e.vxM(i.isInfiniteScroll()||"bottom"!==t.config.paginatorPosition&&"both"!==t.config.paginatorPosition&&t.config.paginatorPosition?-1:50),e.R7$(),e.vxM(i.showFilterSidebar()?51:-1),e.R7$(),e.vxM(i.showConfigSidebar()?52:-1),e.R7$(),e.Y8G("isOpen",i.showThemeSettings()),e.R7$(),e.vxM(i.showChatbot()?54:-1),e.R7$(),e.Y8G("isOpen",i.showSaveQueryModal()),e.R7$(),e.Y8G("isOpen",i.showUiGallery())("layouts",i.customLayouts())("currentView",i.viewMode())("activeLayouts",i.activeLayouts()),e.R7$(),e.Y8G("isOpen",i.showCalendarConfigModal())("dateColumns",i.dateColumns()),e.R7$(),e.vxM(i.showSyncOptionsModal()?58:-1),e.R7$(),e.Y8G("isOpen",i.showAddChipModal())("columns",i.allTableColumns()),e.R7$(),e.vxM(i.isAiLoading()||i.aiModalContent()?60:-1),e.R7$(),e.vxM(i.isExporting()?61:-1)}}let Mg=(()=>{class n{configService=(0,s.WQX)(he);dataManager=(0,s.WQX)(Uu);syncService=(0,s.WQX)(Qu);connectionStatusService=(0,s.WQX)(on);persistenceService=(0,s.WQX)(Ee);savedQueriesService=(0,s.WQX)(op);customLayoutService=(0,s.WQX)(sp);themeService=(0,s.WQX)(Xi);densityService=(0,s.WQX)(rn);aiSummaryService=(0,s.WQX)(ji);aiLayoutService=(0,s.WQX)(Ii);chipFilterService=(0,s.WQX)(zp);exportService=(0,s.WQX)(um);config=this.configService.config;data=(0,s.vPA)([]);totalRecords=(0,s.vPA)(0);loading=(0,s.vPA)(!0);showAiActions=(0,s.vPA)(!1);isAiLoading=(0,s.vPA)(!1);aiModalContent=(0,s.vPA)(null);showChatbot=(0,s.vPA)(!1);showSavedQueriesMenu=(0,s.vPA)(!1);showSaveQueryModal=(0,s.vPA)(!1);savedQueries=(0,s.vPA)([]);showUiGallery=(0,s.vPA)(!1);customLayouts=(0,s.vPA)([]);activeLayouts;showCalendarConfigModal=(0,s.vPA)(!1);activeCalendarConfig=(0,s.vPA)(null);showSyncOptionsModal=(0,s.vPA)(!1);showAddChipModal=(0,s.vPA)(!1);chips=this.chipFilterService.chips;showExportOptions=(0,s.vPA)(!1);isExporting=(0,s.vPA)(!1);exportingMessage=(0,s.vPA)("");isMobile=(0,s.vPA)(window.innerWidth<640);viewMode;currentPage;pageSize;sortColumn;sortDirection;globalFilterTerm;advancedFilters;showFilterSidebar=(0,s.vPA)(!1);showConfigSidebar=(0,s.vPA)(!1);showThemeSettings=(0,s.vPA)(!1);showFreezeOptions=(0,s.vPA)(!1);showColumnChooser=(0,s.vPA)(!1);showCardsPerRowChooser=(0,s.vPA)(!1);showViewOptions=(0,s.vPA)(!1);showMobileActionsMenu=(0,s.vPA)(!1);allTableColumns=(0,s.vPA)([]);visibleTableColumns=(0,s.vPA)([]);scrollContainer=(0,f.ebz)("scrollContainer");autoSizingEnabled=(0,s.vPA)(this.config().config.sizerConfig.enabled);currentDensity=this.densityService.density;currentDensitySetting=(0,N.EW)(()=>{const t=this.currentDensity(),i=this.config().config.sizerConfig;return i.densities.find(o=>o.name===t)??i.densities[1]});keyboardActiveRowIndex=(0,s.vPA)(null);selectionAnchorIndex=(0,s.vPA)(null);keyboardManager=new rm;postFetchFocus=(0,s.vPA)(null);showStrategyChooser=(0,s.vPA)(!1);dataStrategies=["SYNC","ONLINE_FIRST","OFFLINE_FIRST","HYBRID"];strategyDescriptions={SYNC:"Fast, offline access. Data is synced with the server in the background.",ONLINE_FIRST:"Always fetches the latest data from the server. Falls back to local data if the server is unavailable.",OFFLINE_FIRST:"Loads instantly from your device. May not be the absolute latest data.",HYBRID:"Fetches latest data and updates your device for offline use. Falls back to local data if the server is unavailable."};isInfiniteScroll=(0,N.EW)(()=>"infinite"===this.config().config.pagingMode);totalPages=(0,N.EW)(()=>{const t=this.totalRecords(),i=this.pageSize();return i<=0?0:Math.ceil(t/i)});allDataLoaded=(0,N.EW)(()=>{const t=this.totalRecords();return!(0===t&&this.data().length>0||0!==t&&!("append"===(this.config().config.infiniteScrollBehavior??"append")?this.data().length>=t:this.currentPage()>=this.totalPages()))});chooserColumns=(0,N.EW)(()=>this.allTableColumns().filter(t=>!1!==t.showOnColumnChooser));dateColumns=(0,N.EW)(()=>this.allTableColumns().filter(t=>"DATE"===t.columnType));connectionStatus=(0,N.EW)(()=>{switch(this.connectionStatusService.status()){case"Online":return{text:"Online",class:"bg-green-500"};case"Connecting":return{text:"Connecting...",class:"bg-yellow-500 animate-pulse"};case"Offline":return{text:"Offline",class:"bg-red-500"};default:return{text:"Unknown",class:"bg-gray-500"}}});aiModalFormattedContent=(0,N.EW)(()=>{const t=this.aiModalContent();if(!t||!t.content)return{title:"",content:""};let i=t.content;return i=i.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),i.match(/^\* .*/m)&&(i="<ul>"+i.replace(/^\* (.*)$/gm,'<li class="ml-4 list-disc">$1</li>')+"</ul>"),{title:t.title,content:i}});activeCustomTemplate=(0,N.EW)(()=>{const t=this.customLayouts(),i=this.activeLayouts(),o=this.viewMode();let a=null;if("card"===o&&(a=i.card),"list"===o&&(a=i.list),"table"===o&&(a=i.table),!a)return null;const l=t.find(c=>c.id===a);return l?l.htmlTemplate:null});calculatedChips=(0,N.EW)(()=>{const t=this.data(),i=this.chips();if(0===t.length||0===i.length)return[];const o=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}),a=new Intl.NumberFormat("en-US");return i.map(l=>{let c,d,u=t;switch("count"===l.aggregation&&l.filterValue&&(u=t.filter(p=>String(p[l.columnCode]).toLowerCase()===String(l.filterValue).toLowerCase())),l.aggregation){case"count":c=u.length,d=a.format(c);break;case"sum":c=u.reduce((g,m)=>g+(Number(m[l.columnCode])||0),0),d=o.format(c);break;case"average":const p=u.reduce((g,m)=>g+(Number(m[l.columnCode])||0),0);c=u.length>0?p/u.length:0,d=o.format(c);break;default:c=0,d="N/A"}return{...l,displayValue:d}})});searchSubject=new Di.B;lastFocusedElementId=(0,s.vPA)(null);initialFetchDone=(0,s.vPA)(!1);initialState;selectedIds=(0,s.vPA)(new Set);constructor(){this.initialState={viewMode:this.isMobile()?"card":"table",currentPage:1,pageSize:this.config().api.defaultPageSize,sortColumn:"organization_name",sortDirection:"asc",globalFilterTerm:"",advancedFilters:{},activeLayouts:{card:null,list:null,table:null}};const t=this.persistenceService.loadState("smartTableState");this.viewMode=(0,s.vPA)(t?.viewMode??this.initialState.viewMode),this.currentPage=(0,s.vPA)(t?.currentPage??this.initialState.currentPage),this.pageSize=(0,s.vPA)(t?.pageSize??this.initialState.pageSize),this.sortColumn=(0,s.vPA)(t?.sortColumn??this.initialState.sortColumn),this.sortDirection=(0,s.vPA)(t?.sortDirection??this.initialState.sortDirection),this.globalFilterTerm=(0,s.vPA)(t?.globalFilterTerm??this.initialState.globalFilterTerm),this.advancedFilters=(0,s.vPA)(t?.advancedFilters??this.initialState.advancedFilters),this.activeLayouts=(0,s.vPA)(t?.activeLayouts??this.initialState.activeLayouts),this.loadSavedQueries(),this.loadCustomLayouts();const i=()=>{this.loading.set(!0);const a=this.currentPage();if(this.isInfiniteScroll()&&"append"===this.config().config.infiniteScrollBehavior&&a>1)this.fetchPagesSequentially(a).then(()=>{this.initialFetchDone.set(!0)});else{const l=this.isInfiniteScroll()&&"replace"===this.config().config.infiniteScrollBehavior?1:a;this.isInfiniteScroll()&&"replace"===this.config().config.infiniteScrollBehavior&&this.currentPage.set(1),this.fetchPage(l),this.initialFetchDone.set(!0)}};(0,s.QZP)(()=>{"SYNC"===this.config().config.dataStrategy&&this.syncService.isPrimed()&&!this.initialFetchDone()&&(i(),this.showSyncOptionsModal()&&setTimeout(()=>this.showSyncOptionsModal.set(!1),500))},{allowSignalWrites:!0}),"SYNC"===this.config().config.dataStrategy?this.syncService.isPrimed()?i():(this.showSyncOptionsModal.set(!0),this.loading.set(!1)):i(),(0,s.QZP)(()=>{const a=[...this.config().columns].sort((d,u)=>d.index-u.index);this.allTableColumns.set(a);const l=a.filter(d=>"table_cell"===d.display).map(d=>d.code),c=new Set(t?.visibleColumnCodes??l);this.visibleTableColumns.set(a.filter(d=>c.has(d.code)))},{allowSignalWrites:!0}),this.searchSubject.pipe((0,Ri.B)(400),(0,Vi.F)()).subscribe(a=>{this.globalFilterTerm.set(a),this.resetAndFetch()}),(0,s.QZP)(()=>{const a=this.loading(),l=this.lastFocusedElementId();!a&&l&&setTimeout(()=>{const c=document.getElementById(l);c&&(c.focus(),c instanceof HTMLInputElement&&c.select()),this.lastFocusedElementId.set(null)},0)}),(0,s.QZP)(a=>{const l=this.currentDensity(),c=this.config().config.sizerConfig,d=()=>{if(this.isMobile.set(window.innerWidth<640),this.autoSizingEnabled()){const u=this.scrollContainer()?.nativeElement;if(u){const b=Ni(u,(c.densities.find(S=>S.name===l)??c.densities[1]).rowHeight,c.additionalReservedSpace??0);b!==this.pageSize()&&(this.pageSize.set(b),this.resetAndFetch())}}};window.addEventListener("resize",d),setTimeout(()=>d(),50),a(()=>window.removeEventListener("resize",d))},{allowSignalWrites:!0}),this.setupStatePersistence()}setupStatePersistence(){(0,s.QZP)(()=>{const t={viewMode:this.viewMode(),currentPage:this.currentPage(),pageSize:this.pageSize(),sortColumn:this.sortColumn(),sortDirection:this.sortDirection(),globalFilterTerm:this.globalFilterTerm(),advancedFilters:this.advancedFilters(),visibleColumnCodes:this.visibleTableColumns().map(i=>i.code),activeLayouts:this.activeLayouts()};this.persistenceService.saveState("smartTableState",t)})}resetViewAndFilters(){this.persistenceService.clearState("smartTableState"),this.densityService.setDensity(this.config().config.sizerConfig.defaultDensity),this.viewMode.set(this.initialState.viewMode),this.currentPage.set(this.initialState.currentPage),this.pageSize.set(this.initialState.pageSize),this.sortColumn.set(this.initialState.sortColumn),this.sortDirection.set(this.initialState.sortDirection),this.globalFilterTerm.set(""),this.advancedFilters.set(this.initialState.advancedFilters),this.visibleTableColumns.set(this.allTableColumns().filter(t=>"table_cell"===t.display)),this.activeLayouts.set(this.initialState.activeLayouts),this.showViewOptions.set(!1),this.resetAndFetch()}handleAiAction(t){var i=this;return(0,Z.A)(function*(){i.showAiActions.set(!1),i.isAiLoading.set(!0);try{switch(t){case"narrate":const o=yield i.aiSummaryService.generateNarration(i.data(),i.allTableColumns());i.aiModalContent.set({title:"Data Narration",content:o});break;case"insights":const a=yield i.aiSummaryService.suggestInsights(i.data(),i.allTableColumns());i.aiModalContent.set({title:"Suggested Insights",content:a});break;case"adopt":const l=yield i.aiLayoutService.getAutoAdoptedConfig(i.config(),window.innerWidth);i.configService.updateFullConfig(l);break;case"metrics":const c=yield i.aiSummaryService.getQuickMetrics(i.data(),i.allTableColumns());i.aiModalContent.set({title:"Key Metrics",content:c})}}catch(o){console.error(`AI Action '${t}' failed:`,o),i.aiModalContent.set({title:"Error",content:"An error occurred while processing the AI request."})}finally{i.isAiLoading.set(!1)}})()}handleAiFilter(t){if(t.globalSearch)this.globalFilterTerm.set(t.globalSearch),this.advancedFilters.set({});else if(t.advancedFilters&&t.advancedFilters.length>0){const i={};for(const o of t.advancedFilters)i[o.code]=o;this.advancedFilters.set(i),this.globalFilterTerm.set("")}this.resetAndFetch()}loadSavedQueries(){this.savedQueriesService.getSavedQueries().subscribe(t=>{this.savedQueries.set(t)})}openSaveQueryModal(){this.showSavedQueriesMenu.set(!1),this.showSaveQueryModal.set(!0)}handleSaveQuery(t){this.showSaveQueryModal.set(!1);const i={globalFilterTerm:this.globalFilterTerm(),advancedFilters:this.advancedFilters(),sortColumn:this.sortColumn(),sortDirection:this.sortDirection()};this.savedQueriesService.saveQuery(t,i).subscribe(()=>{this.loadSavedQueries()})}handleApplySavedQuery(t){this.showSavedQueriesMenu.set(!1);const i=this.savedQueries().find(o=>o.id===t);if(i){const o=i.state;this.globalFilterTerm.set(o.globalFilterTerm??this.initialState.globalFilterTerm),this.advancedFilters.set(o.advancedFilters??this.initialState.advancedFilters),this.sortColumn.set(o.sortColumn??this.initialState.sortColumn),this.sortDirection.set(o.sortDirection??this.initialState.sortDirection),this.resetAndFetch()}}handleDeleteSavedQuery(t){this.savedQueriesService.deleteQuery(t).subscribe(()=>{this.loadSavedQueries()})}loadCustomLayouts(){this.customLayoutService.getLayouts().subscribe(t=>{this.customLayouts.set(t)})}handleGenerateLayout(t){var i=this;return(0,Z.A)(function*(){i.isAiLoading.set(!0);try{const o=yield i.aiLayoutService.generateLayout(t.prompt,t.targetView,i.allTableColumns());i.customLayoutService.saveLayout({name:t.name,targetView:t.targetView,htmlTemplate:o.htmlTemplate}).subscribe(()=>{i.loadCustomLayouts()})}catch(o){console.error("AI layout generation failed:",o),i.aiModalContent.set({title:"Layout Generation Error",content:"An error occurred while generating the layout."})}finally{i.isAiLoading.set(!1)}})()}handleApplyLayout(t){const{view:i,layoutId:o}=t;this.activeLayouts.update(a=>{const l={...a};return"card"===i&&(l.card=o),"list"===i&&(l.list=o),"table"===i&&(l.table=o),l})}handleDeleteLayout(t){this.customLayoutService.deleteLayout(t).subscribe(()=>{this.loadCustomLayouts()})}handleAddChip(t){this.chipFilterService.addChip(t),this.showAddChipModal.set(!1)}handleRemoveChip(t){this.chipFilterService.removeChip(t)}handleApplyChipFilter(t){const i=this.allTableColumns().find(a=>a.code===t.columnCode);if(!i||!t.filterValue)return;const o={code:t.columnCode,name:i.name,type:"select",operator:"=",value1:t.filterValue};this.advancedFilters.set({[o.code]:o}),this.resetAndFetch()}handleFreezeColumns(t){this.showFreezeOptions.set(!1);const i=this.config(),o=JSON.parse(JSON.stringify(i)),a=this.visibleTableColumns().map(l=>l.code);o.columns.forEach(l=>{const c=a.indexOf(l.code);l.frozen=-1!==c&&c<t}),this.configService.updateFullConfig(o)}checkAndFetchForFill(){setTimeout(()=>{const t=this.config().config;if("infinite"!==t.pagingMode||"append"!==t.infiniteScrollBehavior)return;const i=this.scrollContainer()?.nativeElement;i&&!this.allDataLoaded()&&i.scrollHeight<=i.clientHeight&&(this.loading()||this.fetchMoreData())},100)}fetchPagesSequentially(t){var i=this;return(0,Z.A)(function*(){if(t<1)i.loading.set(!1);else{i.loading.set(!0),i.currentPage.set(0),i.data.set([]);try{for(let o=1;o<=t;o++)yield i.fetchAndAppendPage(o)}catch{}finally{i.loading.set(!1),i.checkAndFetchForFill()}}})()}fetchAndAppendPage(t){return new Promise((i,o)=>{const a=wt(t,this.pageSize(),this.sortColumn(),this.sortDirection(),this.globalFilterTerm(),this.advancedFilters(),this.config());this.dataManager.getData(a).subscribe({next:l=>{this.data.update(c=>[...c,...l.data]),this.totalRecords.set(l.total_records),this.currentPage.set(t),i()},error:l=>{console.error(`Failed to fetch page ${t}`,l),this.loading.set(!1),o(l)}})})}fetchPage(t){if(t<1)return;this.loading.set(!0);const i=wt(t,this.pageSize(),this.sortColumn(),this.sortDirection(),this.globalFilterTerm(),this.advancedFilters(),this.config());this.dataManager.getData(i).subscribe({next:o=>{this.data.set(o.data),this.totalRecords.set(o.total_records),this.currentPage.set(t),this.loading.set(!1),this.checkAndFetchForFill();const a=this.postFetchFocus(),l=this.data();if("first"===a&&l.length>0)this.keyboardActiveRowIndex.set(0),this.scrollActiveItemIntoView(l[0].organization_id);else if("last"===a&&l.length>0){const c=l.length-1;this.keyboardActiveRowIndex.set(c),this.scrollActiveItemIntoView(l[c].organization_id)}else this.keyboardActiveRowIndex.set(null);this.postFetchFocus.set(null)},error:o=>{console.error("Failed to fetch data",o),this.loading.set(!1)}})}fetchMoreData(){if(this.loading()||!this.isInfiniteScroll()||this.allDataLoaded())return;this.loading.set(!0);const t=this.currentPage()+1,i=wt(t,this.pageSize(),this.sortColumn(),this.sortDirection(),this.globalFilterTerm(),this.advancedFilters(),this.config()),o=this.config().config.infiniteScrollBehavior??"append";this.dataManager.getData(i).subscribe({next:a=>{"append"===o?this.data.update(l=>[...l,...a.data]):(this.data.set(a.data),this.scrollContainer()?.nativeElement.scrollTo({top:0,behavior:"smooth"})),this.totalRecords.set(a.total_records),this.currentPage.set(t),this.loading.set(!1),this.checkAndFetchForFill()},error:a=>{console.error("Failed to fetch more data",a),this.loading.set(!1)}})}resetAndFetch(){this.currentPage.set(1),this.keyboardActiveRowIndex.set(null),this.selectedIds.set(new Set),this.isInfiniteScroll()&&this.data.set([]),this.fetchPage(1)}handleSort(t){this.sortColumn.set(t.column),this.sortDirection.set(t.direction),this.resetAndFetch()}onGlobalSearch(t){this.searchSubject.next(t.target.value)}handleFilterChange(t){this.advancedFilters.update(i=>{const o={...i};return t.filter?o[t.code]=t.filter:delete o[t.code],o}),this.resetAndFetch()}handlePageChange(t){this.isInfiniteScroll()||(this.currentPage.set(t),this.fetchPage(t),this.selectedIds.set(new Set))}onContentScroll(t){if(!this.isInfiniteScroll())return;const i=t.target;i.scrollTop+i.clientHeight>=i.scrollHeight-100&&this.fetchMoreData()}handlePageSizeChange(t){this.pageSize.set(t),this.resetAndFetch()}handleAutoSizingToggle(){if(this.autoSizingEnabled.update(t=>!t),this.autoSizingEnabled()){const t=this.scrollContainer()?.nativeElement;if(t){const i=this.currentDensity(),o=this.config().config.sizerConfig,d=Ni(t,(o.densities.find(u=>u.name===i)??o.densities[1]).rowHeight,o.additionalReservedSpace??0);d!==this.pageSize()&&(this.pageSize.set(d),this.resetAndFetch())}}}handleApplyFilters(t){this.advancedFilters.set(t),this.resetAndFetch(),this.showFilterSidebar.set(!1)}handleRowClick(t){const i=this.data().findIndex(o=>o.organization_id===t.organization_id);i>-1&&(this.keyboardActiveRowIndex.set(i),this.selectionAnchorIndex.set(i))}handleSelectionChange(t){this.selectedIds.set(t)}toggleSelectionByIndex(t){if(t<0||t>=this.data().length)return;const i=this.data()[t].organization_id,o=new Set(this.selectedIds());o.has(i)?o.delete(i):o.add(i),this.selectedIds.set(o)}changeView(t){"calendar"!==t||this.activeCalendarConfig()?(this.viewMode.set(t),this.showViewOptions.set(!1)):this.showCalendarConfigModal.set(!0)}toggleColumnVisibility(t){this.visibleTableColumns.update(i=>{if(i.some(a=>a.code===t.code))return i.filter(a=>a.code!==t.code);{const a=[];for(const l of this.allTableColumns())(i.some(c=>c.code===l.code)||l.code===t.code)&&a.push(l);return a}})}handleVisibleColumnReorder(t){this.visibleTableColumns.set(t)}handleAllColumnsOrderChange(t){this.allTableColumns.set(t),this.visibleTableColumns.update(i=>{const o=new Set(i.map(a=>a.code));return t.filter(a=>o.has(a.code))})}handleRowAction(t){const{action:i,row:o}=t,a=o.communication_detail?.replace(/\D/g,"");switch(i){case"call":a&&(window.location.href=`tel:${a}`);break;case"whatsapp":a&&window.open(`https://wa.me/${a}`,"_blank");break;case"email":o.email_id&&(window.location.href=`mailto:${o.email_id}`);break;case"sms":a&&(window.location.href=`sms:${a}`);break;default:console.log("Unhandled row action:",i,"on row:",o)}}handleHeaderAction(t){console.log("Header action:",t.action,"on IDs:",t.selectedIds)}handleToolbarAction(t){switch(t){case"refresh":this.resetAndFetch();break;case"toggle:filter-sidebar":this.showFilterSidebar.update(i=>!i);break;case"toggle:config-sidebar":this.showConfigSidebar.update(i=>!i);break;case"toggle:theme-settings":this.showThemeSettings.update(i=>!i);break;case"add:contacts":console.log("Add new contact clicked");break;default:console.log("Toolbar action:",t)}}handleEmptyStateAction(t){console.log("Empty state action triggered:",t),this.handleToolbarAction(t)}handleConfigSave(t){this.configService.updateFullConfig(t),this.showConfigSidebar.set(!1)}handleConfigReset(){this.configService.resetToDefaults(),this.showConfigSidebar.set(!1)}handleCardsPerRowChange(t){this.configService.updateCardsPerRow(t)}changeDataStrategy(t){this.showStrategyChooser.set(!1),"SYNC"===t?this.showSyncOptionsModal.set(!0):(this.configService.updateDataStrategy(t),this.initialFetchDone.set(!1),this.resetAndFetch())}handleStartSync(){this.configService.updateDataStrategy("SYNC"),this.initialFetchDone.set(!1),this.syncService.startFullSync()}handleManualSync(){this.syncService.startFullSync()}toggleInfiniteScrollBehavior(){const i="append"===(this.config().config.infiniteScrollBehavior??"append")?"replace":"append";this.configService.updateInfiniteScrollBehavior(i),this.resetAndFetch()}handleApplyCalendarConfig(t){this.activeCalendarConfig.set(t),this.showCalendarConfigModal.set(!1),this.viewMode.set("calendar")}handleExport(t){var i=this;return(0,Z.A)(function*(){i.showExportOptions.set(!1);const o=i.totalRecords();if(0===o)return void console.warn("No data to export.");i.isExporting.set(!0),i.exportingMessage.set(`Fetching all ${o} records for export...`);const a=wt(1,o,i.sortColumn(),i.sortDirection(),i.globalFilterTerm(),i.advancedFilters(),i.config());i.dataManager.getData(a).subscribe({next:l=>{i.exportingMessage.set(`Generating ${t.toUpperCase()} file...`);const c="table"===i.viewMode()?i.visibleTableColumns():i.allTableColumns();i.exportService.exportData(t,l.data,c,i.config().config.title),setTimeout(()=>{i.isExporting.set(!1),i.exportingMessage.set("")},1e3)},error:l=>{console.error("Failed to fetch data for export:",l),i.exportingMessage.set("Error during export. Please try again."),setTimeout(()=>{i.isExporting.set(!1),i.exportingMessage.set("")},3e3)}})})()}handleContentKeydown(t){const i=this.data(),o=this.keyboardActiveRowIndex(),a=!this.isInfiniteScroll();if("ArrowUp"===t.key&&0===o&&a){t.preventDefault();const c=this.currentPage()-1;return void(c>=1&&(this.postFetchFocus.set("last"),this.handlePageChange(c)))}if("ArrowDown"===t.key&&o===i.length-1&&a){t.preventDefault();const c=this.currentPage()+1;return void(c<=this.totalPages()&&(this.postFetchFocus.set("first"),this.handlePageChange(c)))}this.keyboardManager.updateState(i,o,this.selectedIds(),this.selectionAnchorIndex());const l=this.keyboardManager.handleKeydown(t);if(l){this.keyboardActiveRowIndex.set(l.newActiveIndex),this.selectedIds.set(l.newSelection),this.selectionAnchorIndex.set(l.newAnchorIndex);const c=this.data()[l.newActiveIndex];c&&this.scrollActiveItemIntoView(c.organization_id)}}scrollActiveItemIntoView(t){let o;switch(this.viewMode()){case"table":o=`table-item-${t}`;break;case"card":o=`card-item-${t}`;break;case"list":o=`list-item-${t}`;break;default:return}setTimeout(()=>{document.getElementById(o)?.scrollIntoView({behavior:"smooth",block:"nearest"})},0)}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-smart-table"]],viewQuery:function(i,o){1&i&&e.wEZ(o.scrollContainer,Fm,5),2&i&&e.NyB()},hostAttrs:[1,"block","h-full"],decls:1,vars:1,consts:[["scrollContainer",""],[1,"h-full","flex","flex-col","bg-white","text-sm"],[1,"flex-shrink-0","border-b","border-gray-200","bg-white","shadow-sm"],[1,"flex","flex-wrap","items-center","justify-between","gap-2","p-2"],[1,"flex","items-center","gap-4","flex-shrink-0","order-1"],[1,"text-lg","font-bold","text-gray-900","truncate"],["title","Total Records",1,"px-2","py-0.5","text-xs","font-semibold","rounded-full","bg-indigo-50","text-indigo-700"],[1,"flex","flex-wrap","items-center","justify-end","gap-1.5","order-2","sm:order-3"],[1,"flex","flex-wrap","items-center","gap-1.5"],["title","Refresh offline data from server",1,"flex","items-center","gap-2","px-4","py-2","text-sm","font-medium","rounded-md","border","transition-colors","duration-200","bg-white","text-gray-700","hover:bg-gray-50","border-gray-300","disabled:opacity-60","disabled:cursor-wait",3,"disabled"],[1,"flex","items-center","gap-2","px-4","py-2","text-sm","font-medium","rounded-md","transition-colors","duration-200","bg-white","text-gray-700","hover:bg-gray-50","border","border-gray-300",3,"bg-slate-900","text-white","!bg-indigo-600","!text-white","title"],["title","Add Summary Chip",1,"flex","items-center","gap-2","px-4","py-2","text-sm","font-medium","rounded-md","transition-colors","duration-200","bg-white","text-gray-700","hover:bg-gray-50","border","border-gray-300"],[1,"h-6","w-px","bg-gray-300","mx-1"],[1,"relative"],[1,"relative",3,"clickOutside"],[1,"flex","items-center","gap-2","px-4","py-2","text-sm","font-medium","border","rounded-md","bg-white","hover:bg-gray-50","border-gray-300",3,"click","title"],[1,"pi","pi-database"],[1,"pi","pi-chevron-down","text-xs","transition-transform"],[1,"origin-top-right","absolute","right-0","mt-2","w-48","rounded-md","shadow-lg","bg-white","dark:bg-gray-800","ring-1","ring-black","ring-opacity-5","focus:outline-none","z-30"],[1,"flex","items-center","gap-2","px-4","py-2","text-sm","font-medium","border","rounded-md","bg-white","hover:bg-gray-50","border-gray-300",3,"click"],[1,"pi","pi-eye"],[1,"origin-top-right","absolute","right-0","mt-2","w-56","rounded-md","shadow-lg","bg-white","dark:bg-gray-800","ring-1","ring-black","ring-opacity-5","focus:outline-none","z-30"],["title","AI Actions",1,"flex","items-center","justify-center","h-8","w-8","text-sm","font-medium","border","rounded-md","bg-indigo-50","border-indigo-200","hover:bg-indigo-100","transition-colors","text-indigo-700",3,"click"],[1,"pi","pi-sparkles"],["title","Global Search (Alt + G)",1,"relative","w-full","sm:w-auto","sm:max-w-sm","order-3","sm:order-2"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],[1,"pi","pi-search","text-gray-400"],["id","global-search-input","type","search","placeholder","Search...",1,"block","w-full","pl-10","pr-3","py-1.5","border","border-gray-300","rounded-md","leading-5","bg-white","text-gray-900","placeholder-gray-400","focus:outline-none","focus:placeholder-gray-500","focus:ring-1","focus:ring-indigo-500","focus:border-indigo-500","text-sm",3,"input","value"],[1,"p-2","border-t","border-gray-200"],[1,"flex-shrink-0","border-b","border-gray-300"],["tabindex","0",1,"flex-grow","overflow-auto","p-2","outline-none",3,"scroll","keydown"],[1,"flex","justify-center","items-center","py-4"],[1,"flex-shrink-0","border-t","border-gray-300"],[3,"isOpen","config","activeFilters"],[3,"isOpen","config"],[3,"close","isOpen"],[3,"data","columns"],[3,"close","save","isOpen"],[3,"close","applyLayout","deleteLayout","generateLayout","isOpen","layouts","currentView","activeLayouts"],[3,"close","apply","isOpen","dateColumns"],[3,"close","addChip","isOpen","columns"],[1,"fixed","inset-0","bg-gray-900/60","flex","items-center","justify-center","z-[70]"],["title","Refresh offline data from server",1,"flex","items-center","gap-2","px-4","py-2","text-sm","font-medium","rounded-md","border","transition-colors","duration-200","bg-white","text-gray-700","hover:bg-gray-50","border-gray-300","disabled:opacity-60","disabled:cursor-wait",3,"click","disabled"],[1,"pi"],[1,"flex","items-center","gap-2","px-4","py-2","text-sm","font-medium","rounded-md","transition-colors","duration-200","bg-white","text-gray-700","hover:bg-gray-50","border","border-gray-300",3,"click","title"],["title","Add Summary Chip",1,"flex","items-center","gap-2","px-4","py-2","text-sm","font-medium","rounded-md","transition-colors","duration-200","bg-white","text-gray-700","hover:bg-gray-50","border","border-gray-300",3,"click"],[1,"pi","pi-tag"],["title","Number of cards per row",1,"flex","items-center","gap-2","px-4","py-2","text-sm","font-medium","border","rounded-md","bg-white","hover:bg-gray-50","border-gray-300",3,"click"],[1,"pi","pi-table"],[1,"origin-top-right","absolute","right-0","mt-2","w-40","rounded-md","shadow-lg","bg-white","dark:bg-gray-800","ring-1","ring-black","ring-opacity-5","focus:outline-none","z-30"],[1,"py-1"],["href","javascript:void(0)",1,"flex","items-center","justify-between","px-4","py-2","text-sm","text-gray-700","dark:text-gray-200","hover:bg-gray-100","dark:hover:bg-gray-700"],["href","javascript:void(0)",1,"flex","items-center","justify-between","px-4","py-2","text-sm","text-gray-700","dark:text-gray-200","hover:bg-gray-100","dark:hover:bg-gray-700",3,"click"],[1,"pi","pi-check","text-indigo-500"],["title","Freeze columns",1,"flex","items-center","gap-2","px-4","py-2","text-sm","font-medium","border","rounded-md","bg-white","hover:bg-gray-50","border-gray-300",3,"click"],[1,"pi","pi-snowflake"],["href","javascript:void(0)",1,"block","px-4","py-2","text-sm","text-gray-700","dark:text-gray-200","hover:bg-gray-100","dark:hover:bg-gray-700",3,"click"],["title","Show/Hide Columns",1,"flex","items-center","gap-2","px-4","py-2","text-sm","font-medium","border","rounded-md","bg-white","hover:bg-gray-50","border-gray-300",3,"click"],[1,"pi","pi-th-large"],[3,"allColumns","visibleColumns"],[3,"visibilityChange","orderChange","allColumns","visibleColumns"],["href","javascript:void(0)",1,"flex","items-center","justify-between","px-4","py-2","text-sm","text-gray-700","dark:text-gray-200","hover:bg-gray-100","dark:hover:bg-gray-700",3,"title"],["href","javascript:void(0)",1,"flex","items-center","justify-between","px-4","py-2","text-sm","text-gray-700","dark:text-gray-200","hover:bg-gray-100","dark:hover:bg-gray-700",3,"click","title"],[1,"pi","pi-download"],["href","javascript:void(0)",1,"flex","items-center","gap-3","px-4","py-2","text-sm","text-gray-700","dark:text-gray-200","hover:bg-gray-100","dark:hover:bg-gray-700"],["href","javascript:void(0)",1,"flex","items-center","gap-3","px-4","py-2","text-sm","text-gray-700","dark:text-gray-200","hover:bg-gray-100","dark:hover:bg-gray-700",3,"click"],[1,"flex","items-center","gap-3"],[1,"pi","pi-id-card"],[1,"pi","pi-list"],[1,"my-1","border-t","border-gray-200","dark:border-gray-700"],[1,"pi","pi-chart-bar"],[1,"pi","pi-calendar"],[1,"pi","pi-replay","w-4","text-center"],[1,"pi","pi-desktop","w-4","text-center"],[1,"pi","pi-book","w-4","text-center"],[1,"pi","pi-chart-line","w-4","text-center"],[1,"pi","pi-sort-numeric-down","w-4","text-center"],[1,"pi","pi-palette","w-4","text-center"],[3,"addChip","removeChip","chipClicked","chips"],[3,"pageChange","pageSizeChange","autoSizingToggle","chatbotToggle","currentPage","pageSize","totalRecords","autoSizingEnabled","infiniteScroll","infiniteScrollBehavior","currentRecordCount","dataStrategy","connectionStatus","lastSyncTime","isSyncing"],[3,"columns","rows"],[3,"count"],[1,"text-center","p-8"],[3,"config"],[1,"flex","flex-col","items-center","justify-center","h-full","text-center","text-gray-500"],[3,"action","config"],[1,"pi","pi-inbox","text-5xl","mb-3"],[1,"text-lg"],[3,"columns","data","sortColumn","sortDirection","density","densityClass","rowMenuConfig","rowActions","headerMenuConfig","enableMultiSelect","selectedIds","activeFilters","customTemplate","loading","keyboardActiveRowIndex","pageSize","isInfiniteScroll","stripedRows","showGridlines","rowHover","footerConfig"],[3,"columns","data","density","densityClass","selectedIds","rowMenuConfig","rowActions","enableMultiSelect","cardViewConfig","customTemplate","keyboardActiveRowIndex"],[3,"columns","data","density","densityClass","selectedIds","enableMultiSelect","customTemplate","keyboardActiveRowIndex"],[3,"sortChange","rowAction","rowClicked","headerAction","columnReorder","filterChange","selectionChange","columns","data","sortColumn","sortDirection","density","densityClass","rowMenuConfig","rowActions","headerMenuConfig","enableMultiSelect","selectedIds","activeFilters","customTemplate","loading","keyboardActiveRowIndex","pageSize","isInfiniteScroll","stripedRows","showGridlines","rowHover","footerConfig"],[3,"selectionChange","rowAction","rowClicked","columns","data","density","densityClass","selectedIds","rowMenuConfig","rowActions","enableMultiSelect","cardViewConfig","customTemplate","keyboardActiveRowIndex"],[3,"selectionChange","rowClicked","columns","data","density","densityClass","selectedIds","enableMultiSelect","customTemplate","keyboardActiveRowIndex"],[3,"data","columns","config"],[1,"text-center","p-8","text-gray-500","dark:text-gray-400"],[1,"pi","pi-spin","pi-spinner","text-2xl","text-indigo-500"],[3,"close","apply","isOpen","config","activeFilters"],[3,"close","save","resetToDefaults","isOpen","config"],[3,"close","filterApplied","data","columns"],[3,"close","startSync"],[1,"flex","flex-col","items-center","gap-4","bg-white","dark:bg-gray-800","p-8","rounded-lg","shadow-xl"],[1,"bg-white","rounded-lg","shadow-xl","w-full","max-w-2xl","m-4"],[1,"pi","pi-spin","pi-spinner","text-4xl","text-indigo-500"],[1,"text-lg","font-medium","text-gray-800"],[1,"bg-white","rounded-lg","shadow-xl","w-full","max-w-2xl","m-4",3,"click"],[1,"flex","items-center","justify-between","p-4","border-b","border-gray-200"],[1,"text-lg","font-semibold","flex","items-center","gap-2"],[1,"pi","pi-sparkles","text-indigo-500"],[1,"p-2","rounded-full","hover:bg-gray-100",3,"click"],[1,"pi","pi-times"],[1,"p-6","prose","dark:prose-invert","max-w-none",3,"innerHTML"],[1,"flex","flex-col","items-center","gap-4","bg-white","p-8","rounded-lg","shadow-xl"]],template:function(i,o){if(1&i&&e.nVh(0,Tg,62,43),2&i){let a;e.vxM((a=o.config())?0:-1,a)}},dependencies:[P.MD,ur,jr,Lr,Sd,$d,Yd,Zd,$e,$u,Iu,Bu,pu,Tu,ip,ap,wp,$p,Xp,Bp,tm,om,dm,Sm],encapsulation:2,changeDetection:0})}return n})(),jg=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-smart-table-page"]],decls:2,vars:0,consts:[[1,"h-full","bg-white","rounded-lg","shadow-sm","border","border-gray-200","overflow-hidden"],["tableId","rowcontact"]],template:function(i,o){1&i&&(e.j41(0,"div",0),e.nrm(1,"app-smart-table",1),e.k0s())},dependencies:[P.MD,Mg],encapsulation:2})}return n})()}}]);